<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ | SuoL's Blog</title><meta name="author" content="SuoL"><meta name="copyright" content="SuoL"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="è®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ï¼Œåˆ†æé—®é¢˜åŸå› ï¼Œæ€»ç»“è§£å†³æ–¹æ¡ˆï¼Œç§¯ç´¯æ•…éšœæ’æŸ¥ç»éªŒ"><meta property="og:type" content="article"><meta property="og:title" content="Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ"><meta property="og:url" content="https://suochina.github.io/bug-review-record/index.html"><meta property="og:site_name" content="SuoL&#39;s Blog"><meta property="og:description" content="è®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ï¼Œåˆ†æé—®é¢˜åŸå› ï¼Œæ€»ç»“è§£å†³æ–¹æ¡ˆï¼Œç§¯ç´¯æ•…éšœæ’æŸ¥ç»éªŒ"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://suochina.github.io/images/bug/bug-cover.png"><meta property="article:published_time" content="2025-11-24T15:30:00.000Z"><meta property="article:modified_time" content="2025-11-24T15:30:00.000Z"><meta property="article:author" content="SuoL"><meta property="article:tag" content="Bug"><meta property="article:tag" content="é—®é¢˜æ’æŸ¥"><meta property="article:tag" content="æ•…éšœåˆ†æ"><meta property="article:tag" content="ç»éªŒæ€»ç»“"><meta property="article:tag" content="æŠ€æœ¯å¤ç›˜"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://suochina.github.io/images/bug/bug-cover.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ",
  "url": "https://suochina.github.io/bug-review-record/",
  "image": "https://suochina.github.io/images/bug/bug-cover.png",
  "datePublished": "2025-11-24T15:30:00.000Z",
  "dateModified": "2025-11-24T15:30:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "SuoL",
      "url": "https://suochina.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://suochina.github.io/bug-review-record/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>(()=>{const e={set:(e,t,o)=>{if(!o)return;const a=Date.now()+864e5*o;localStorage.setItem(e,JSON.stringify({value:t,expiry:a}))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const{value:o,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return o;localStorage.removeItem(e)}};window.btf={saveToLocal:e,getScript:(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,Object.entries(t).forEach(([e,t])=>n.setAttribute(e,t)),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)}),getCSS:(e,t)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)}),addGlobalFn:(e,t,o=!1,a=window)=>{if(e.startsWith("pjax"))return;const n=a.globalFn||{};n[e]=n[e]||{},n[e][o||Object.keys(n[e]).length]=t,a.globalFn=n}};const t=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},o=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};btf.activateDarkMode=t,btf.activateLightMode=o;const a=e.get("theme");"dark"===a?t():"light"===a&&o();const n=e.get("aside-status");void 0!==n&&document.documentElement.classList.toggle("hide-aside","hide"===n);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=JetBrains+Mono:wght@400;500;600&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,pagination:{enable:!1,hitsPerPage:8},languages:{hits_empty:"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}",hits_stats:"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1,highlightFullpage:!1,highlightMacStyle:!0},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶å¤±è´¥",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!0,post:!0},runtime:"å¤©",dateSuffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"null",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"åŠ è½½æ›´å¤š"},isPhotoFigcaption:!1,islazyloadPlugin:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ",isHighlightShrink:!1,isToc:!0,pageType:"post"}</script><style>.post-content{line-height:1.8;font-size:16px;font-family:"PingFang SC","Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei","Helvetica Neue",Arial,sans-serif;font-weight:400;color:#2c3e50}.post-content p{margin-bottom:1.2em;text-align:justify}.post-content ol,.post-content ul{margin-bottom:1.2em;padding-left:1.5em}.post-content li{margin-bottom:.5em;line-height:1.7}.post-content h1,.post-content h2,.post-content h3,.post-content h4,.post-content h5,.post-content h6{margin-top:2rem;margin-bottom:1rem;font-weight:600;line-height:1.4}.post-content pre{border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);font-family:"JetBrains Mono","Fira Code",Consolas,Monaco,"Courier New",monospace;font-size:14px;line-height:1.6}.post-content code{font-family:"JetBrains Mono","Fira Code",Consolas,Monaco,"Courier New",monospace}.click-effect{position:fixed;pointer-events:none;z-index:9999;font-size:14px;color:#49b1f5;font-weight:700;animation:clickEffect 1s ease-out forwards;user-select:none}@keyframes clickEffect{0%{opacity:1;transform:scale(.8) translateY(0)}50%{opacity:.8;transform:scale(1.2) translateY(-20px)}100%{opacity:0;transform:scale(1) translateY(-40px)}}.ripple{position:absolute;border-radius:50%;background:rgba(73,177,245,.3);transform:scale(0);animation:ripple .6s linear;pointer-events:none}@keyframes ripple{to{transform:scale(4);opacity:0}}.post-content blockquote{border-left:4px solid #49b1f5;background:#f8f9fa;padding:1rem 1.5rem;margin:1.5rem 0;border-radius:0 8px 8px 0}.post-content table{border-collapse:collapse;width:100%;margin:1.5rem 0;box-shadow:0 2px 8px rgba(0,0,0,.1);border-radius:8px;overflow:hidden}.post-content td,.post-content th{padding:12px 16px;text-align:left;border-bottom:1px solid #e9ecef}.post-content th{background-color:#f8f9fa;font-weight:600}.post-content ol,.post-content ul{padding-left:2rem;margin:1rem 0}.post-content li{margin:.5rem 0;line-height:1.6}.post-content a{color:#49b1f5;text-decoration:none;border-bottom:1px solid transparent;transition:all .3s ease}.post-content a:hover{border-bottom-color:#49b1f5}.post-meta .post-meta-date{display:flex;flex-direction:column;gap:4px}.post-meta .post-meta-date .post-meta-date-created,.post-meta .post-meta-date .post-meta-date-updated{display:flex;align-items:center;gap:8px}.post-meta .post-meta-date .post-meta-date-updated{color:#666;font-size:.9em}.post-meta .post-meta-date .post-meta-date-updated::before{content:"ğŸ“… "}.recent-post-item .post-meta .post-meta-date{margin-bottom:8px}.recent-post-item .post-meta .post-meta-date .post-meta-date-updated{color:#999;font-size:.85em}.avatar-img{transition:transform .3s ease}.avatar-img:hover{transform:rotate(360deg)}</style><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="SuoL's Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/my_cat.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%8F%8B%E9%93%BE/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%85%B3%E4%BA%8E%E6%88%91/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/images/bug/bug-cover.png)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">SuoL's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span> è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%8F%8B%E9%93%BE/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%85%B3%E4%BA%8E%E6%88%91/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-11-24T15:30:00.000Z" title="å‘è¡¨äº 2025-11-24 23:30:00">2025-11-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-11-24T15:30:00.000Z" title="æ›´æ–°äº 2025-11-24 23:30:00">2025-11-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E4%BD%9C%E8%AE%B0%E5%BD%95/">å·¥ä½œè®°å½•</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">6.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>24åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Bugå¤ç›˜è®°å½•-é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ-ğŸ›"><a href="#Bugå¤ç›˜è®°å½•-é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ-ğŸ›" class="headerlink" title="Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ ğŸ›"></a>Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ ğŸ›</h1><blockquote><p>è®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ï¼Œé€šè¿‡è¯¦ç»†çš„é—®é¢˜åˆ†æã€æ’æŸ¥è¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆï¼Œç§¯ç´¯æ•…éšœæ’æŸ¥ç»éªŒï¼Œé¿å…é‡å¤è¸©å‘ã€‚æœ¬è®°å½•å°†å¸®åŠ©ä½ å»ºç«‹ç³»ç»ŸåŒ–çš„é—®é¢˜è§£å†³æ€ç»´ï¼ğŸ”§</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/bug/bug-cover.png" alt="Bugå¤ç›˜è®°å½•"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œè®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ã€‚æ¯ä¸ªé—®é¢˜éƒ½åŒ…å«è¯¦ç»†çš„åˆ†æè¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆã€‚</p></blockquote><hr><h2 id="ğŸ“-æ–‡æ¡£ä¿¡æ¯"><a href="#ğŸ“-æ–‡æ¡£ä¿¡æ¯" class="headerlink" title="ğŸ“ æ–‡æ¡£ä¿¡æ¯"></a>ğŸ“ æ–‡æ¡£ä¿¡æ¯</h2><ul><li><strong>æœ€åæ›´æ–°</strong>: 2025-11-24</li><li><strong>ä½œè€…</strong>: Suo</li><li><strong>æ ‡ç­¾</strong>: Bug, é—®é¢˜æ’æŸ¥, æ•…éšœåˆ†æ, ç»éªŒæ€»ç»“, æŠ€æœ¯å¤ç›˜</li><li><strong>ç‰ˆæœ¬</strong>: v1.0</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£è®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ï¼Œé€šè¿‡å¤ç›˜åˆ†æï¼Œæ€»ç»“ç»éªŒæ•™è®­ï¼Œæå‡é—®é¢˜è§£å†³èƒ½åŠ›ã€‚æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æ”¶è—å’Œåˆ†äº«ã€‚</p></blockquote><hr><h2 id="ğŸ“Š-Bugç»Ÿè®¡"><a href="#ğŸ“Š-Bugç»Ÿè®¡" class="headerlink" title="ğŸ“Š Bugç»Ÿè®¡"></a>ğŸ“Š Bugç»Ÿè®¡</h2><ul><li><strong>æ€»Bugæ•°</strong>: 1</li><li><strong>å·²è§£å†³</strong>: 1</li><li><strong>å¾…è§£å†³</strong>: 0</li><li><strong>é«˜ä¼˜å…ˆçº§</strong>: 1</li><li><strong>ä¸­ä¼˜å…ˆçº§</strong>: 0</li><li><strong>ä½ä¼˜å…ˆçº§</strong>: 0</li></ul><hr><h2 id="ğŸ”-Bugåˆ†ç±»"><a href="#ğŸ”-Bugåˆ†ç±»" class="headerlink" title="ğŸ” Bugåˆ†ç±»"></a>ğŸ” Bugåˆ†ç±»</h2><h3 id="æŒ‰ç±»å‹åˆ†ç±»"><a href="#æŒ‰ç±»å‹åˆ†ç±»" class="headerlink" title="æŒ‰ç±»å‹åˆ†ç±»"></a>æŒ‰ç±»å‹åˆ†ç±»</h3><ul><li><strong>ç©ºæŒ‡é’ˆå¼‚å¸¸</strong>: 0</li><li><strong>å¹¶å‘é—®é¢˜</strong>: 0</li><li><strong>æ€§èƒ½é—®é¢˜</strong>: 1</li><li><strong>æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong>: 0</li><li><strong>é…ç½®é—®é¢˜</strong>: 0</li><li><strong>ç¬¬ä¸‰æ–¹ä¾èµ–é—®é¢˜</strong>: 0</li><li><strong>å…¶ä»–é—®é¢˜</strong>: 0</li></ul><h3 id="æŒ‰æ¨¡å—åˆ†ç±»"><a href="#æŒ‰æ¨¡å—åˆ†ç±»" class="headerlink" title="æŒ‰æ¨¡å—åˆ†ç±»"></a>æŒ‰æ¨¡å—åˆ†ç±»</h3><ul><li><strong>åç«¯æœåŠ¡</strong>: 0</li><li><strong>å‰ç«¯é¡µé¢</strong>: 0</li><li><strong>æ•°æ®åº“</strong>: 1</li><li><strong>ç¼“å­˜</strong>: 0</li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>: 0</li><li><strong>å…¶ä»–</strong>: 0</li></ul><hr><h2 id="ğŸ“-Bugè®°å½•æ¨¡æ¿"><a href="#ğŸ“-Bugè®°å½•æ¨¡æ¿" class="headerlink" title="ğŸ“ Bugè®°å½•æ¨¡æ¿"></a>ğŸ“ Bugè®°å½•æ¨¡æ¿</h2><h3 id="Bug-001-åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap-ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•-æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶"><a href="#Bug-001-åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap-ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•-æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶" class="headerlink" title="Bug #001 - åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶"></a>Bug #001 - åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶</h3><p><strong>å‘ç°æ—¶é—´</strong>: 2025-11-20<br><strong>ä¼˜å…ˆçº§</strong>: é«˜<br><strong>çŠ¶æ€</strong>: å·²è§£å†³<br><strong>å½±å“èŒƒå›´</strong>: æ¥å£å“åº”è¶…æ—¶ï¼Œæ— æ³•æŸ¥çœ‹åˆ—è¡¨ä¿¡æ¯</p><h4 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p>åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶</p><h4 id="é—®é¢˜å¤ç°"><a href="#é—®é¢˜å¤ç°" class="headerlink" title="é—®é¢˜å¤ç°"></a>é—®é¢˜å¤ç°</h4><p>å¤šè¡¨æŸ¥è¯¢ä½¿ç”¨ResultMapæ—¶,æœ‰è¡¨çš„æ•°æ®éå¸¸å¤š</p><h4 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h4><p><strong>æ ¹æœ¬åŸå› </strong>ï¼š</p><ol><li><p><strong>ç¬›å¡å°”ç§¯é—®é¢˜</strong>ï¼š</p><ul><li>ä½¿ç”¨MyBatisçš„<code>&lt;resultMap&gt;</code>è¿›è¡Œå¤šè¡¨å…³è”æŸ¥è¯¢æ—¶ï¼Œå¦‚æœå…³è”è¡¨æ•°æ®é‡å¤§ï¼Œä¼šäº§ç”Ÿç¬›å¡å°”ç§¯</li><li>ä¾‹å¦‚ï¼šä¸»è¡¨10æ¡è®°å½• Ã— å…³è”è¡¨1000æ¡è®°å½• &#x3D; 10,000æ¡ç»“æœé›†</li><li>å¦‚æœæœ‰å¤šå±‚å…³è”ï¼Œé—®é¢˜ä¼šæŒ‡æ•°çº§æ”¾å¤§ï¼š10 Ã— 1000 Ã— 20 &#x3D; 200,000æ¡è®°å½•</li></ul></li><li><p><strong>MyBatis ResultMapçš„å·¥ä½œæœºåˆ¶</strong>ï¼š</p><ul><li>MyBatisåœ¨å†…å­˜ä¸­å¯¹ç»“æœé›†è¿›è¡Œå»é‡å’Œç»„è£…</li><li>å³ä½¿æœ€ç»ˆåªéœ€è¦10æ¡ä¸»è®°å½•ï¼Œä¹Ÿè¦å…ˆæŸ¥è¯¢å‡º20ä¸‡æ¡ä¸­é—´ç»“æœ</li><li>å¤§é‡çš„å†…å­˜åˆ†é…å’Œæ•°æ®è½¬æ¢æ“ä½œå¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™</li></ul></li><li><p><strong>æ€§èƒ½å½±å“</strong>ï¼š</p><ul><li><strong>æ•°æ®åº“å±‚é¢</strong>ï¼šéœ€è¦æ‰«æå¤§é‡æ•°æ®ï¼Œäº§ç”Ÿå¤§é‡ä¸´æ—¶ç»“æœé›†</li><li><strong>ç½‘ç»œä¼ è¾“</strong>ï¼šä¼ è¾“20ä¸‡æ¡è®°å½•çš„ç½‘ç»œå¼€é”€å·¨å¤§</li><li><strong>å†…å­˜æ¶ˆè€—</strong>ï¼šMyBatiséœ€è¦å°†20ä¸‡æ¡è®°å½•åŠ è½½åˆ°å†…å­˜ä¸­è¿›è¡Œå¤„ç†</li><li><strong>CPUæ¶ˆè€—</strong>ï¼šå¤§é‡çš„æ•°æ®å»é‡ã€æ˜ å°„ã€å¯¹è±¡åˆ›å»ºæ“ä½œ</li></ul></li><li><p><strong>é—®é¢˜åœºæ™¯</strong>ï¼š</p><ul><li>ä¸€å¯¹å¤šå…³è”æŸ¥è¯¢ï¼ˆå¦‚è®¢å•-è®¢å•æ˜ç»†ï¼‰</li><li>å¤šå¯¹å¤šå…³è”æŸ¥è¯¢ï¼ˆå¦‚ç”¨æˆ·-è§’è‰²-æƒé™ï¼‰</li><li>åµŒå¥—çš„å…³è”æŸ¥è¯¢ï¼ˆå¤šå±‚å…³è”ï¼‰</li></ul></li></ol><p><strong>é—®é¢˜ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é—®é¢˜SQLç¤ºä¾‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderDetailMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;orderNo&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_no&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€å¯¹å¤šå…³è”ï¼Œå¦‚æœè®¢å•æ˜ç»†æœ‰1000æ¡ï¼Œä¸»æŸ¥è¯¢10æ¡è®¢å•å°±ä¼šäº§ç”Ÿ10000æ¡ç»“æœ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orderItems&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;item_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;productName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;product_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderDetailMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        o.id as order_id,</span><br><span class="line">        o.order_no,</span><br><span class="line">        oi.id as item_id,</span><br><span class="line">        oi.product_name</span><br><span class="line">    FROM orders o</span><br><span class="line">    LEFT JOIN order_items oi ON o.id = oi.order_id</span><br><span class="line">    LIMIT 10</span><br><span class="line">    -- å¦‚æœæ¯ä¸ªè®¢å•æœ‰1000ä¸ªæ˜ç»†ï¼Œå®é™…æŸ¥è¯¢å‡º10000æ¡è®°å½•</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šæ‹†åˆ†SQLæŸ¥è¯¢ï¼ˆæ¨èï¼‰</strong></p><p>å°†å¤šè¡¨å…³è”æŸ¥è¯¢æ‹†åˆ†ä¸ºå¤šæ¬¡æŸ¥è¯¢ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢ä¸»è¡¨æ•°æ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    SELECT id, order_no, create_time</span><br><span class="line">    FROM orders</span><br><span class="line">    LIMIT 10</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç¬¬äºŒæ­¥ï¼šæ‰¹é‡æŸ¥è¯¢å…³è”æ•°æ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderItemsByOrderIds&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">    SELECT id, order_id, product_name</span><br><span class="line">    FROM order_items</span><br><span class="line">    WHERE order_id IN</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;orderIds&quot;</span> <span class="attr">item</span>=<span class="string">&quot;orderId&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">        #&#123;orderId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Javaä»£ç å®ç°</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Order&gt; <span class="title function_">getOrderList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1. å…ˆæŸ¥è¯¢ä¸»è¡¨</span></span><br><span class="line">    List&lt;Order&gt; orders = orderMapper.selectOrderList();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ‰¹é‡æŸ¥è¯¢å…³è”æ•°æ®</span></span><br><span class="line">    List&lt;Long&gt; orderIds = orders.stream()</span><br><span class="line">        .map(Order::getId)</span><br><span class="line">        .collect(Collectors.toList());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!orderIds.isEmpty()) &#123;</span><br><span class="line">        List&lt;OrderItem&gt; items = orderItemMapper.selectOrderItemsByOrderIds(orderIds);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. æ‰‹åŠ¨ç»„è£…æ•°æ®</span></span><br><span class="line">        Map&lt;Long, List&lt;OrderItem&gt;&gt; itemMap = items.stream()</span><br><span class="line">            .collect(Collectors.groupingBy(OrderItem::getOrderId));</span><br><span class="line">        </span><br><span class="line">        orders.forEach(order -&gt; </span><br><span class="line">            order.setOrderItems(itemMap.getOrDefault(order.getId(), Collections.emptyList()))</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> orders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼ˆLazy Loadingï¼‰</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderDetailMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;orderNo&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_no&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼Œåªæœ‰åœ¨è®¿é—®æ—¶æ‰æŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orderItems&quot;</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">ofType</span>=<span class="string">&quot;OrderItem&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">select</span>=<span class="string">&quot;selectOrderItemsByOrderId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">fetchType</span>=<span class="string">&quot;lazy&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderDetailMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT id as order_id, order_no</span><br><span class="line">    FROM orders</span><br><span class="line">    LIMIT 10</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderItemsByOrderId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">    SELECT id, order_id, product_name</span><br><span class="line">    FROM order_items</span><br><span class="line">    WHERE order_id = #&#123;orderId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ3ï¼šä½¿ç”¨åˆ†é¡µæŸ¥è¯¢å…³è”æ•°æ®</strong></p><p>å¦‚æœå…³è”æ•°æ®å¿…é¡»ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼Œå¯ä»¥è€ƒè™‘åˆ†é¡µï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹å…³è”è¡¨è¿›è¡Œåˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Order&gt; <span class="title function_">getOrderListWithPagedItems</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Order&gt; orders = orderMapper.selectOrderList();</span><br><span class="line">    </span><br><span class="line">    orders.forEach(order -&gt; &#123;</span><br><span class="line">        <span class="comment">// åˆ†é¡µæŸ¥è¯¢è®¢å•æ˜ç»†ï¼Œé¿å…ä¸€æ¬¡æ€§æŸ¥è¯¢è¿‡å¤šæ•°æ®</span></span><br><span class="line">        PageHelper.startPage(<span class="number">1</span>, <span class="number">100</span>); <span class="comment">// æ¯é¡µæœ€å¤š100æ¡</span></span><br><span class="line">        List&lt;OrderItem&gt; items = orderItemMapper.selectByOrderId(order.getId());</span><br><span class="line">        order.setOrderItems(items);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> orders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ4ï¼šä½¿ç”¨ç¼“å­˜ä¼˜åŒ–</strong></p><p>å¯¹äºä¸ç»å¸¸å˜åŒ–çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Cacheable(value = &quot;orderItems&quot;, key = &quot;#orderId&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title function_">getOrderItems</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> orderItemMapper.selectByOrderId(orderId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»éªŒæ€»ç»“"><a href="#ç»éªŒæ€»ç»“" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h4><p><strong>æ ¸å¿ƒæ•™è®­</strong>ï¼š</p><ol><li><p><strong>é¿å…å¤§ç»“æœé›†çš„ç¬›å¡å°”ç§¯</strong>ï¼š</p><ul><li>âœ… å¤šè¡¨å…³è”æŸ¥è¯¢æ—¶ï¼Œè¦è¯„ä¼°å…³è”è¡¨çš„æ•°æ®é‡</li><li>âœ… å¦‚æœå…³è”è¡¨æ•°æ®é‡å¤§ï¼ˆ&gt;100æ¡ï¼‰ï¼Œä¼˜å…ˆè€ƒè™‘æ‹†åˆ†æŸ¥è¯¢</li><li>âœ… ä½¿ç”¨<code>EXPLAIN</code>åˆ†æSQLæ‰§è¡Œè®¡åˆ’ï¼Œå…³æ³¨ç»“æœé›†å¤§å°</li></ul></li><li><p><strong>MyBatis ResultMapä½¿ç”¨åŸåˆ™</strong>ï¼š</p><ul><li>âœ… <strong>ä¸€å¯¹å¤šå…³è”</strong>ï¼šæ•°æ®é‡å°ï¼ˆ&lt;50ï¼‰å¯ä»¥ä½¿ç”¨ResultMapï¼Œæ•°æ®é‡å¤§å»ºè®®æ‹†åˆ†</li><li>âœ… <strong>å¤šå¯¹å¤šå…³è”</strong>ï¼šå¿…é¡»æ‹†åˆ†æŸ¥è¯¢ï¼Œé¿å…ç¬›å¡å°”ç§¯</li><li>âœ… <strong>åµŒå¥—å…³è”</strong>ï¼šè¶…è¿‡2å±‚åµŒå¥—æ—¶ï¼Œå¿…é¡»æ‹†åˆ†æŸ¥è¯¢</li></ul></li></ol><p><strong>å…³è”å…³ç³»è¯´æ˜</strong>ï¼š</p><p><strong>ä¸€å¯¹å¤šå…³è”ï¼ˆOne-to-Manyï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šä¸€ä¸ªä¸»è¡¨è®°å½•å¯¹åº”å¤šä¸ªä»è¡¨è®°å½•</li><li><strong>æ•°æ®åº“ä½“ç°</strong>ï¼šä»è¡¨ä¸­æœ‰å¤–é”®æŒ‡å‘ä¸»è¡¨</li><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼š<ul><li>è®¢å•ï¼ˆOrderï¼‰â†’ è®¢å•æ˜ç»†ï¼ˆOrderItemï¼‰ï¼šä¸€ä¸ªè®¢å•æœ‰å¤šä¸ªå•†å“æ˜ç»†</li><li>ç”¨æˆ·ï¼ˆUserï¼‰â†’ è®¢å•ï¼ˆOrderï¼‰ï¼šä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªè®¢å•</li><li>éƒ¨é—¨ï¼ˆDepartmentï¼‰â†’ å‘˜å·¥ï¼ˆEmployeeï¼‰ï¼šä¸€ä¸ªéƒ¨é—¨æœ‰å¤šä¸ªå‘˜å·¥</li></ul></li><li><strong>MyBatiså®ç°</strong>ï¼šä½¿ç”¨<code>&lt;collection&gt;</code>æ ‡ç­¾</li><li><strong>ç¬›å¡å°”ç§¯é£é™©</strong>ï¼šå¦‚æœä»è¡¨æ•°æ®é‡å¤§ï¼Œä¼šäº§ç”Ÿå¤§é‡é‡å¤çš„ä¸»è¡¨è®°å½•</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¸€å¯¹å¤šï¼šè®¢å•å’Œè®¢å•æ˜ç»† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;orderNo&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_no&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€ä¸ªè®¢å•å¯¹åº”å¤šä¸ªè®¢å•æ˜ç»† --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orderItems&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;item_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;productName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;product_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- SQLæŸ¥è¯¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrder&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        o.id as order_id,</span><br><span class="line">        o.order_no,</span><br><span class="line">        oi.id as item_id,</span><br><span class="line">        oi.product_name</span><br><span class="line">    FROM orders o</span><br><span class="line">    LEFT JOIN order_items oi ON o.id = oi.order_id</span><br><span class="line">    WHERE o.id = #&#123;orderId&#125;</span><br><span class="line">    -- å¦‚æœè®¢å•æœ‰100ä¸ªæ˜ç»†ï¼ŒæŸ¥è¯¢ç»“æœä¼šæœ‰100è¡Œï¼ˆè®¢å•ä¿¡æ¯é‡å¤100æ¬¡ï¼‰</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>å¤šå¯¹å¤šå…³è”ï¼ˆMany-to-Manyï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šä¸¤ä¸ªè¡¨ä¹‹é—´æ˜¯å¤šå¯¹å¤šå…³ç³»ï¼Œéœ€è¦é€šè¿‡ä¸­é—´è¡¨å…³è”</li><li><strong>æ•°æ®åº“ä½“ç°</strong>ï¼šéœ€è¦ä¸‰ä¸ªè¡¨ï¼Œä¸­é—´è¡¨å­˜å‚¨å…³è”å…³ç³»</li><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼š<ul><li>ç”¨æˆ·ï¼ˆUserï¼‰â†” è§’è‰²ï¼ˆRoleï¼‰ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè§’è‰²ï¼Œä¸€ä¸ªè§’è‰²å¯ä»¥åˆ†é…ç»™å¤šä¸ªç”¨æˆ·</li><li>å­¦ç”Ÿï¼ˆStudentï¼‰â†” è¯¾ç¨‹ï¼ˆCourseï¼‰ï¼šä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰å¤šé—¨è¯¾ï¼Œä¸€é—¨è¯¾å¯ä»¥æœ‰å¤šä¸ªå­¦ç”Ÿ</li><li>å•†å“ï¼ˆProductï¼‰â†” æ ‡ç­¾ï¼ˆTagï¼‰ï¼šä¸€ä¸ªå•†å“å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ï¼Œä¸€ä¸ªæ ‡ç­¾å¯ä»¥æ ‡è®°å¤šä¸ªå•†å“</li></ul></li><li><strong>MyBatiså®ç°</strong>ï¼šéœ€è¦å…³è”ä¸­é—´è¡¨ï¼Œä½¿ç”¨å¤šä¸ª<code>&lt;collection&gt;</code>æˆ–<code>&lt;association&gt;</code></li><li><strong>ç¬›å¡å°”ç§¯é£é™©</strong>ï¼šæœ€é«˜ï¼å¦‚æœä¸¤è¾¹æ•°æ®éƒ½å¤šï¼Œç»“æœé›†ä¼šæ€¥å‰§è†¨èƒ€</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¤šå¯¹å¤šï¼šç”¨æˆ·å’Œè§’è‰²ï¼ˆé€šè¿‡user_roleä¸­é—´è¡¨ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userRoleMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€ä¸ªç”¨æˆ·å¯¹åº”å¤šä¸ªè§’è‰² --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;roles&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Role&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;roleName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserWithRoles&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userRoleMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        u.id as user_id,</span><br><span class="line">        u.username,</span><br><span class="line">        r.id as role_id,</span><br><span class="line">        r.role_name</span><br><span class="line">    FROM users u</span><br><span class="line">    LEFT JOIN user_role ur ON u.id = ur.user_id</span><br><span class="line">    LEFT JOIN roles r ON ur.role_id = r.id</span><br><span class="line">    WHERE u.id = #&#123;userId&#125;</span><br><span class="line">    -- å¦‚æœç”¨æˆ·æœ‰5ä¸ªè§’è‰²ï¼ŒæŸ¥è¯¢ç»“æœä¼šæœ‰5è¡Œ</span><br><span class="line">    -- å¦‚æœæŸ¥è¯¢10ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·5ä¸ªè§’è‰²ï¼Œç»“æœä¼šæœ‰50è¡Œ</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆå¤šå¯¹å¤šæ›´å®¹æ˜“äº§ç”Ÿç¬›å¡å°”ç§¯</strong>ï¼š</p><p>å‡è®¾åœºæ™¯ï¼šæŸ¥è¯¢10ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰5ä¸ªè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²æœ‰10ä¸ªæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·è¡¨ï¼š10æ¡</span><br><span class="line">  â†“ JOIN</span><br><span class="line">ç”¨æˆ·è§’è‰²ä¸­é—´è¡¨ï¼š50æ¡ï¼ˆ10ç”¨æˆ· Ã— 5è§’è‰²ï¼‰</span><br><span class="line">  â†“ JOIN  </span><br><span class="line">è§’è‰²è¡¨ï¼š50æ¡</span><br><span class="line">  â†“ JOIN</span><br><span class="line">è§’è‰²æƒé™ä¸­é—´è¡¨ï¼š500æ¡ï¼ˆ50è§’è‰² Ã— 10æƒé™ï¼‰</span><br><span class="line">  â†“ JOIN</span><br><span class="line">æƒé™è¡¨ï¼š500æ¡</span><br><span class="line"></span><br><span class="line">æœ€ç»ˆç»“æœé›†ï¼š10 Ã— 5 Ã— 10 = 500æ¡è®°å½•</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨åµŒå¥—çš„ResultMapï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userDetailMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;roles&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Role&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åµŒå¥—å…³è”ï¼šè§’è‰²å’Œæƒé™ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;permissions&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Permission&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;permission_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢10ä¸ªç”¨æˆ·ï¼Œå®é™…ä¼šäº§ç”Ÿ500æ¡ç»“æœé›†ï¼ŒMyBatiséœ€è¦åœ¨å†…å­˜ä¸­å¤„ç†è¿™500æ¡è®°å½•è¿›è¡Œå»é‡å’Œç»„è£…ã€‚</p><ol start="3"><li><p><strong>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p><ul><li>âœ… <strong>æ‹†åˆ†æŸ¥è¯¢</strong>ï¼šå°†å¤§æŸ¥è¯¢æ‹†åˆ†ä¸ºå¤šä¸ªå°æŸ¥è¯¢ï¼Œåœ¨åº”ç”¨å±‚ç»„è£…</li><li>âœ… <strong>å»¶è¿ŸåŠ è½½</strong>ï¼šä½¿ç”¨<code>fetchType=&quot;lazy&quot;</code>ï¼ŒæŒ‰éœ€åŠ è½½å…³è”æ•°æ®</li><li>âœ… <strong>æ‰¹é‡æŸ¥è¯¢</strong>ï¼šä½¿ç”¨<code>IN</code>æŸ¥è¯¢æ›¿ä»£å¤šæ¬¡å•ç‹¬æŸ¥è¯¢</li><li>âœ… <strong>åˆ†é¡µæŸ¥è¯¢</strong>ï¼šå¯¹å…³è”æ•°æ®ä¹Ÿè¿›è¡Œåˆ†é¡µï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤š</li></ul></li><li><p><strong>ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹</strong>ï¼š</p><ul><li>âš ï¸ æ£€æŸ¥ResultMapä¸­çš„<code>&lt;collection&gt;</code>å’Œ<code>&lt;association&gt;</code>åµŒå¥—æ·±åº¦</li><li>âš ï¸ è¯„ä¼°å…³è”è¡¨çš„æ•°æ®é‡ï¼Œç‰¹åˆ«æ˜¯å†å²æ•°æ®è¡¨</li><li>âš ï¸ æ£€æŸ¥SQLçš„<code>EXPLAIN</code>ç»“æœï¼Œå…³æ³¨<code>rows</code>å­—æ®µ</li><li>âš ï¸ ç›‘æ§æ¥å£å“åº”æ—¶é—´ï¼Œè®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</li></ul></li><li><p><strong>é¢„é˜²æªæ–½</strong>ï¼š</p><ul><li>âœ… å»ºç«‹SQLå®¡æŸ¥è§„èŒƒï¼Œç¦æ­¢è¶…è¿‡2å±‚çš„åµŒå¥—å…³è”</li><li>âœ… å¯¹å¤§æ•°æ®é‡çš„å…³è”æŸ¥è¯¢ï¼Œå¼ºåˆ¶è¦æ±‚æ‹†åˆ†</li><li>âœ… æ·»åŠ æ¥å£æ€§èƒ½ç›‘æ§ï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜</li><li>âœ… å®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯æ•°æ®é‡å¢é•¿å</li></ul></li></ol><p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èçš„åšæ³•ï¼šæ‹†åˆ†æŸ¥è¯¢ + æ‰¹é‡æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">public</span> List&lt;OrderDTO&gt; <span class="title function_">getOrderList</span><span class="params">(<span class="type">int</span> pageNum, <span class="type">int</span> pageSize)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. æŸ¥è¯¢ä¸»è¡¨ï¼ˆåˆ†é¡µï¼‰</span></span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    List&lt;Order&gt; orders = orderMapper.selectOrderList();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (orders.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ‰¹é‡æŸ¥è¯¢å…³è”æ•°æ®ï¼ˆé¿å…N+1é—®é¢˜ï¼‰</span></span><br><span class="line">    List&lt;Long&gt; orderIds = orders.stream()</span><br><span class="line">        .map(Order::getId)</span><br><span class="line">        .collect(Collectors.toList());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰¹é‡æŸ¥è¯¢è®¢å•æ˜ç»†</span></span><br><span class="line">    List&lt;OrderItem&gt; items = orderItemMapper.selectByOrderIds(orderIds);</span><br><span class="line">    Map&lt;Long, List&lt;OrderItem&gt;&gt; itemMap = items.stream()</span><br><span class="line">        .collect(Collectors.groupingBy(OrderItem::getOrderId));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    Set&lt;Long&gt; userIds = orders.stream()</span><br><span class="line">        .map(Order::getUserId)</span><br><span class="line">        .collect(Collectors.toSet());</span><br><span class="line">    Map&lt;Long, User&gt; userMap = userMapper.selectByIds(userIds).stream()</span><br><span class="line">        .collect(Collectors.toMap(User::getId, Function.identity()));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. ç»„è£…æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> orders.stream().map(order -&gt; &#123;</span><br><span class="line">        <span class="type">OrderDTO</span> <span class="variable">dto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderDTO</span>();</span><br><span class="line">        BeanUtils.copyProperties(order, dto);</span><br><span class="line">        dto.setOrderItems(itemMap.getOrDefault(order.getId(), Collections.emptyList()));</span><br><span class="line">        dto.setUser(userMap.get(order.getUserId()));</span><br><span class="line">        <span class="keyword">return</span> dto;</span><br><span class="line">    &#125;).collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>æŸ¥è¯¢æ¬¡æ•°</th><th>ç»“æœé›†å¤§å°</th><th>å“åº”æ—¶é—´</th><th>å†…å­˜å ç”¨</th></tr></thead><tbody><tr><td><strong>åŸå§‹æ–¹æ¡ˆï¼ˆResultMapï¼‰</strong></td><td>1æ¬¡</td><td>200,000æ¡</td><td>10ç§’+</td><td>500MB+</td></tr><tr><td><strong>æ‹†åˆ†æŸ¥è¯¢</strong></td><td>2-3æ¬¡</td><td>10 + 10,000æ¡</td><td>200ms</td><td>50MB</td></tr><tr><td><strong>å»¶è¿ŸåŠ è½½</strong></td><td>1+Næ¬¡</td><td>10 + NÃ—1000æ¡</td><td>1-2ç§’</td><td>100MB</td></tr><tr><td><strong>åˆ†é¡µ+æ‹†åˆ†</strong></td><td>2æ¬¡</td><td>10 + 1,000æ¡</td><td>150ms</td><td>20MB</td></tr></tbody></table><h3 id="Bug-002-åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread-interrupt-å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­"><a href="#Bug-002-åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread-interrupt-å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­" class="headerlink" title="Bug #002 - åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread.interrupt()å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­"></a>Bug #002 - åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread.interrupt()å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­</h3><p><strong>å‘ç°æ—¶é—´</strong>: 2025-11-20<br><strong>ä¼˜å…ˆçº§</strong>: é«˜<br><strong>çŠ¶æ€</strong>: å·²è§£å†³<br><strong>å½±å“èŒƒå›´</strong>: MQæ¶ˆæ¯æ¥æ”¶çº¿ç¨‹è¢«ä¸­æ–­ï¼Œæ— æ³•ç»§ç»­æ¥æ”¶æ¶ˆæ¯ï¼Œå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±</p><h4 id="é—®é¢˜æè¿°-1"><a href="#é—®é¢˜æè¿°-1" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p>åœ¨MQæ¶ˆæ¯æ¥æ”¶çš„ä»£ç ä¸­ï¼Œé”™è¯¯åœ°ä½¿ç”¨äº† <code>Thread.currentThread().interrupt()</code> æ–¹æ³•ï¼Œå¯¼è‡´æ¶ˆæ¯æ¥æ”¶çº¿ç¨‹è¢«ä¸­æ–­ï¼Œæ— æ³•ç»§ç»­æ¥æ”¶MQæ¶ˆæ¯ã€‚</p><h4 id="é—®é¢˜å¤ç°-1"><a href="#é—®é¢˜å¤ç°-1" class="headerlink" title="é—®é¢˜å¤ç°"></a>é—®é¢˜å¤ç°</h4><p>åœ¨MQæ¶ˆæ¯æ¥æ”¶çš„å¾ªç¯ä¸­ï¼Œæ•è·å¼‚å¸¸åè°ƒç”¨äº† <code>Thread.currentThread().interrupt()</code>ï¼Œå¯¼è‡´åç»­çš„é˜»å¡æ“ä½œï¼ˆå¦‚ <code>BlockingQueue.take()</code>ï¼‰æŠ›å‡º <code>InterruptedException</code>ï¼Œå¦‚æœå¼‚å¸¸å¤„ç†ä¸å½“ï¼Œä¼šå¯¼è‡´æ¥æ”¶å¾ªç¯é€€å‡ºã€‚</p><h4 id="é—®é¢˜åˆ†æ-1"><a href="#é—®é¢˜åˆ†æ-1" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h4><p><strong>æ ¹æœ¬åŸå› </strong>ï¼š</p><ol><li><p><strong><code>Thread.interrupt()</code> çš„å·¥ä½œæœºåˆ¶</strong>ï¼š</p><ul><li><code>interrupt()</code> æ–¹æ³•åªæ˜¯<strong>è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½</strong>ï¼Œä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹</li><li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œ<strong>å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</strong>ï¼ˆå¦‚ <code>Thread.sleep()</code>, <code>Object.wait()</code>, <code>BlockingQueue.take()</code> ç­‰ï¼‰ï¼Œè¿™äº›æ“ä½œä¼š<strong>ç«‹å³æŠ›å‡º <code>InterruptedException</code></strong></li><li>æŠ›å‡ºå¼‚å¸¸åï¼Œ<strong>ä¸­æ–­æ ‡å¿—ä½ä¼šè¢«æ¸…é™¤</strong></li></ul></li><li><p><strong>MQæ¥æ”¶ä»£ç çš„å…¸å‹å®ç°</strong>ï¼š</p><ul><li>MQæ¥æ”¶é€šå¸¸ä½¿ç”¨ <code>BlockingQueue.take()</code> æˆ– <code>BlockingQueue.poll(timeout)</code> ç­‰é˜»å¡æ–¹æ³•</li><li>è¿™äº›æ–¹æ³•åœ¨æ”¶åˆ°ä¸­æ–­ä¿¡å·æ—¶ä¼šæŠ›å‡º <code>InterruptedException</code></li><li>å¦‚æœå¼‚å¸¸å¤„ç†ä¸å½“ï¼ˆç›´æ¥returnæˆ–é€€å‡ºå¾ªç¯ï¼‰ï¼Œå°±ä¼šå¯¼è‡´<strong>ä¸å†æ¥æ”¶MQæ¶ˆæ¯</strong></li></ul></li><li><p><strong>é—®é¢˜åœºæ™¯</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ç¤ºä¾‹ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è°ƒç”¨interrupt()</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> messageQueue.take(); <span class="comment">// é˜»å¡ç­‰å¾…æ¶ˆæ¯</span></span><br><span class="line">        processMessage(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        Thread.currentThread().interrupt(); <span class="comment">// è®¾ç½®ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">return</span>; <span class="comment">// âŒ ç›´æ¥é€€å‡ºï¼Œå¯¼è‡´ä¸å†æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä¸ºä»€ä¹ˆä¼šåœæ­¢æ¥æ”¶</strong>ï¼š</p><ul><li>è°ƒç”¨ <code>interrupt()</code> åï¼Œä¸­æ–­æ ‡å¿—è¢«è®¾ç½®</li><li>ä¸‹æ¬¡æ‰§è¡Œ <code>messageQueue.take()</code> æ—¶ï¼Œä¼šç«‹å³æŠ›å‡º <code>InterruptedException</code></li><li>å¦‚æœæ•è·å¼‚å¸¸åç›´æ¥ <code>return</code> æˆ– <code>break</code>ï¼Œå¾ªç¯å°±ä¼šé€€å‡º</li><li><strong>ç»“æœï¼šMQæ¥æ”¶çº¿ç¨‹åœæ­¢å·¥ä½œï¼Œæ— æ³•ç»§ç»­æ¥æ”¶æ¶ˆæ¯</strong></li></ul></li></ol><p><strong>é—®é¢˜ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ä»£ç ï¼šä¼šå¯¼è‡´MQæ¥æ”¶åœæ­¢</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">        processOrder(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥&quot;</span>, e);</span><br><span class="line">        <span class="comment">// âŒ é”™è¯¯ï¼šè°ƒç”¨interrupt()åï¼Œå¦‚æœåç»­æœ‰é˜»å¡æ“ä½œä¼šç«‹å³ä¸­æ–­</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">        <span class="comment">// å¦‚æœè¿™é‡Œç›´æ¥returnï¼Œä¼šå¯¼è‡´ç›‘å¬å™¨åœæ­¢å·¥ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ æ›´ä¸¥é‡çš„é”™è¯¯ï¼šåœ¨å¾ªç¯ä¸­é”™è¯¯ä½¿ç”¨interrupt()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> blockingQueue.take(); <span class="comment">// é˜»å¡ç­‰å¾…</span></span><br><span class="line">            handleMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt(); <span class="comment">// è®¾ç½®ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">            <span class="keyword">return</span>; <span class="comment">// âŒ ç›´æ¥é€€å‡ºï¼Œå¯¼è‡´ä¸å†æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šæ­£ç¡®å¤„ç†ä¸­æ–­å¼‚å¸¸ï¼ˆæ¨èï¼‰</strong></p><p>å¦‚æœç¡®å®éœ€è¦ä¸­æ–­çº¿ç¨‹ï¼Œåº”è¯¥æ­£ç¡®å¤„ç†å¼‚å¸¸ï¼Œå¹¶å…è®¸çº¿ç¨‹æ­£å¸¸é€€å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®åšæ³•1ï¼šå…è®¸çº¿ç¨‹æ­£å¸¸é€€å‡º</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> blockingQueue.take();</span><br><span class="line">            handleMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Œè®©ä¸Šå±‚è°ƒç”¨è€…çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// é€€å‡ºå¾ªç¯ï¼Œå…è®¸çº¿ç¨‹æ­£å¸¸ç»“æŸ</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    log.info(<span class="string">&quot;æ¶ˆæ¯æ¥æ”¶çº¿ç¨‹å·²åœæ­¢&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šä¸ä¸­æ–­çº¿ç¨‹ï¼Œç»§ç»­æ¥æ”¶æ¶ˆæ¯ï¼ˆæ¨èç”¨äºMQåœºæ™¯ï¼‰</strong></p><p>å¯¹äºMQæ¶ˆæ¯æ¥æ”¶åœºæ™¯ï¼Œé€šå¸¸ä¸åº”è¯¥ä¸­æ–­çº¿ç¨‹ï¼Œåº”è¯¥ç»§ç»­æ¥æ”¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®åšæ³•2ï¼šç»§ç»­æ¥æ”¶æ¶ˆæ¯ï¼Œä¸ä¸­æ–­çº¿ç¨‹</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">        processOrder(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥ï¼Œæ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, message, e);</span><br><span class="line">        <span class="comment">// âœ… ä¸è°ƒç”¨interrupt()ï¼Œç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯</span></span><br><span class="line">        <span class="comment">// å¯ä»¥é€‰æ‹©é‡è¯•ã€è®°å½•æ—¥å¿—ã€å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ç­‰</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®åšæ³•3ï¼šåœ¨å¾ªç¯ä¸­ç»§ç»­æ¥æ”¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> blockingQueue.take();</span><br><span class="line">            handleMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆå¦‚æœç¡®å®éœ€è¦ä¸­æ–­ï¼‰</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// âœ… ä½†æ˜¯ç»§ç»­å¾ªç¯ï¼Œä¸é€€å‡ºï¼ˆæˆ–è€…æ ¹æ®ä¸šåŠ¡éœ€æ±‚å†³å®šæ˜¯å¦é€€å‡ºï¼‰</span></span><br><span class="line">            log.warn(<span class="string">&quot;æ¥æ”¶æ¶ˆæ¯æ—¶è¢«ä¸­æ–­ï¼Œç»§ç»­æ¥æ”¶...&quot;</span>);</span><br><span class="line">            <span class="comment">// å¯ä»¥é€‰æ‹©ï¼šbreakï¼ˆé€€å‡ºï¼‰æˆ– continueï¼ˆç»§ç»­ï¼‰</span></span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// ç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ3ï¼šä½¿ç”¨Springçš„MQç›‘å¬å™¨ï¼ˆæœ€ä½³å®è·µï¼‰</strong></p><p>ä½¿ç”¨Springçš„ <code>@RabbitListener</code> æˆ– <code>@KafkaListener</code>ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†å¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æœ€ä½³å®è·µï¼šä½¿ç”¨Springçš„MQç›‘å¬å™¨</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderMessageConsumer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;order.queue&quot;, </span></span><br><span class="line"><span class="meta">                   containerFactory = &quot;rabbitListenerContainerFactory&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleOrderMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">            orderService.processOrder(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// âœ… Springæ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†å¼‚å¸¸ï¼Œä¸ä¼šä¸­æ–­ç›‘å¬å™¨</span></span><br><span class="line">            log.error(<span class="string">&quot;å¤„ç†è®¢å•æ¶ˆæ¯å¤±è´¥ï¼Œæ¶ˆæ¯IDï¼š&#123;&#125;&quot;</span>, message.getId(), e);</span><br><span class="line">            <span class="comment">// å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œè®©Springè¿›è¡Œé‡è¯•æˆ–å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ4ï¼šé…ç½®é‡è¯•å’Œæ­»ä¿¡é˜Ÿåˆ—</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… é…ç½®é‡è¯•æœºåˆ¶å’Œæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RabbitListenerContainerFactory&lt;SimpleMessageListenerContainer&gt; </span><br><span class="line">           <span class="title function_">rabbitListenerContainerFactory</span><span class="params">(ConnectionFactory connectionFactory)</span> &#123;</span><br><span class="line">        <span class="type">SimpleRabbitListenerContainerFactory</span> <span class="variable">factory</span> <span class="operator">=</span> </span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">SimpleRabbitListenerContainerFactory</span>();</span><br><span class="line">        factory.setConnectionFactory(connectionFactory);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é…ç½®é‡è¯•</span></span><br><span class="line">        factory.setAdviceChain(retryInterceptor());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é…ç½®é”™è¯¯å¤„ç†</span></span><br><span class="line">        factory.setErrorHandler(<span class="keyword">new</span> <span class="title class_">ConditionalRejectingErrorHandler</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">FatalExceptionStrategy</span>()</span><br><span class="line">        ));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»éªŒæ€»ç»“-1"><a href="#ç»éªŒæ€»ç»“-1" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h4><p><strong>æ ¸å¿ƒæ•™è®­</strong>ï¼š</p><ol><li><p><strong>ç†è§£ <code>interrupt()</code> çš„ä½œç”¨</strong>ï¼š</p><ul><li>âœ… <code>interrupt()</code> <strong>ä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹</strong>ï¼Œåªæ˜¯è®¾ç½®ä¸­æ–­æ ‡å¿—</li><li>âœ… å¯ä¸­æ–­çš„é˜»å¡æ“ä½œï¼ˆ<code>sleep()</code>, <code>wait()</code>, <code>take()</code> ç­‰ï¼‰ä¼šæŠ›å‡º <code>InterruptedException</code></li><li>âœ… æŠ›å‡ºå¼‚å¸¸åï¼Œ<strong>ä¸­æ–­æ ‡å¿—ä¼šè¢«æ¸…é™¤</strong></li></ul></li><li><p><strong>MQæ¥æ”¶åœºæ™¯çš„å¤„ç†åŸåˆ™</strong>ï¼š</p><ul><li>âœ… <strong>ä¸è¦éšæ„è°ƒç”¨ <code>interrupt()</code></strong>ï¼šMQæ¥æ”¶çº¿ç¨‹é€šå¸¸åº”è¯¥æŒç»­è¿è¡Œ</li><li>âœ… <strong>æ­£ç¡®å¤„ç† <code>InterruptedException</code></strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚å†³å®šæ˜¯ç»§ç»­è¿˜æ˜¯é€€å‡º</li><li>âœ… <strong>ä½¿ç”¨æ¡†æ¶çš„å¼‚å¸¸å¤„ç†æœºåˆ¶</strong>ï¼šSpringçš„MQç›‘å¬å™¨ä¼šè‡ªåŠ¨å¤„ç†å¼‚å¸¸</li></ul></li><li><p><strong>å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šç»§ç»­æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    Thread.currentThread().interrupt(); <span class="comment">// æ¢å¤æ ‡å¿—ï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span><br><span class="line">    <span class="keyword">continue</span>; <span class="comment">// ç»§ç»­æ¥æ”¶</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šå…è®¸çº¿ç¨‹é€€å‡º</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    Thread.currentThread().interrupt(); <span class="comment">// æ¢å¤æ ‡å¿—</span></span><br><span class="line">    <span class="keyword">break</span>; <span class="comment">// é€€å‡ºå¾ªç¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šç›´æ¥returnï¼Œå¯èƒ½å¯¼è‡´èµ„æºæœªé‡Šæ”¾</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="keyword">return</span>; <span class="comment">// ä¸æ¨è</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="comment">// ä»€ä¹ˆéƒ½ä¸åšï¼Œä¸­æ–­æ ‡å¿—è¢«æ¸…é™¤ï¼Œä¸Šå±‚æ— æ³•æ„ŸçŸ¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹</strong>ï¼š</p><ul><li>âš ï¸ æ£€æŸ¥æ˜¯å¦æœ‰åœ¨MQæ¥æ”¶ä»£ç ä¸­è°ƒç”¨ <code>interrupt()</code></li><li>âš ï¸ æ£€æŸ¥ <code>InterruptedException</code> çš„å¤„ç†æ˜¯å¦æ­£ç¡®</li><li>âš ï¸ æ£€æŸ¥å¼‚å¸¸å¤„ç†åæ˜¯å¦ç»§ç»­æ¥æ”¶æ¶ˆæ¯</li><li>âš ï¸ æ£€æŸ¥æ˜¯å¦æœ‰èµ„æºæ³„æ¼ï¼ˆè¿æ¥æœªå…³é—­ç­‰ï¼‰</li></ul></li><li><p><strong>é¢„é˜²æªæ–½</strong>ï¼š</p><ul><li>âœ… ä½¿ç”¨Springçš„MQç›‘å¬å™¨ï¼Œé¿å…æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹</li><li>âœ… å»ºç«‹ä»£ç è§„èŒƒï¼Œç¦æ­¢åœ¨MQæ¥æ”¶ä»£ç ä¸­éšæ„è°ƒç”¨ <code>interrupt()</code></li><li>âœ… æ·»åŠ ç›‘æ§ï¼ŒåŠæ—¶å‘ç°MQæ¥æ”¶åœæ­¢çš„é—®é¢˜</li><li>âœ… å®šæœŸè¿›è¡Œä»£ç å®¡æŸ¥ï¼Œæ£€æŸ¥å¼‚å¸¸å¤„ç†é€»è¾‘</li></ul></li></ol><p><strong>å…³é”®çŸ¥è¯†ç‚¹</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>ä¸­æ–­æ ‡å¿—çŠ¶æ€</th><th>é˜»å¡æ“ä½œè¡Œä¸º</th></tr></thead><tbody><tr><td><strong>æ­£å¸¸æ‰§è¡Œ</strong></td><td><code>false</code></td><td>æ­£å¸¸é˜»å¡ç­‰å¾…</td></tr><tr><td><strong>è°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code></td><td>ç«‹å³æŠ›å‡º <code>InterruptedException</code></td></tr><tr><td><strong>æ•è·å¼‚å¸¸å</strong></td><td><code>false</code>ï¼ˆè¢«æ¸…é™¤ï¼‰</td><td>å¦‚æœç»§ç»­æ‰§è¡Œï¼Œä¼šå†æ¬¡é˜»å¡</td></tr><tr><td><strong>æ•è·å¼‚å¸¸åè°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code>ï¼ˆæ¢å¤ï¼‰</td><td>å¦‚æœç»§ç»­æ‰§è¡Œï¼Œä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸</td></tr></tbody></table><p><strong>æœ€ä½³å®è·µæ€»ç»“</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ¨èï¼šMQæ¶ˆæ¯æ¥æ”¶çš„æ ‡å‡†æ¨¡å¼</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">// 2. å¼‚å¸¸æ—¶è®°å½•æ—¥å¿—ï¼Œä¸ä¸­æ–­çº¿ç¨‹</span></span><br><span class="line">    <span class="comment">// 3. è®©æ¡†æ¶å¤„ç†é‡è¯•å’Œæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šæ‰‹åŠ¨ç®¡ç†æ¥æ”¶å¾ªç¯çš„æ ‡å‡†æ¨¡å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> queue.take();</span><br><span class="line">            processMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// æ ¹æ®ä¸šåŠ¡éœ€æ±‚å†³å®šï¼šbreakï¼ˆé€€å‡ºï¼‰æˆ– continueï¼ˆç»§ç»­ï¼‰</span></span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// æˆ– continue</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†ä¸šåŠ¡å¼‚å¸¸ï¼Œä¸ä¸­æ–­çº¿ç¨‹</span></span><br><span class="line">            log.error(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ“š-é™„å½•ï¼šThread-currentThread-interrupt-è¯¦è§£"><a href="#ğŸ“š-é™„å½•ï¼šThread-currentThread-interrupt-è¯¦è§£" class="headerlink" title="ğŸ“š é™„å½•ï¼šThread.currentThread().interrupt() è¯¦è§£"></a>ğŸ“š é™„å½•ï¼šThread.currentThread().interrupt() è¯¦è§£</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p><code>Thread.currentThread().interrupt()</code> æ˜¯Javaå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼Œç”¨äº<strong>è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½</strong>ã€‚</p><h3 id="æ ¸å¿ƒä½œç”¨"><a href="#æ ¸å¿ƒä½œç”¨" class="headerlink" title="æ ¸å¿ƒä½œç”¨"></a>æ ¸å¿ƒä½œç”¨</h3><ol><li><p><strong>è®¾ç½®ä¸­æ–­æ ‡å¿—</strong>ï¼š</p><ul><li>è°ƒç”¨ <code>interrupt()</code> ä¼šå°†å½“å‰çº¿ç¨‹çš„<strong>ä¸­æ–­æ ‡å¿—è®¾ç½®ä¸º <code>true</code></strong></li><li>è¿™<strong>ä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹</strong>ï¼Œåªæ˜¯è®¾ç½®ä¸€ä¸ªæ ‡å¿—</li></ul></li><li><p><strong>è§¦å‘å¯ä¸­æ–­çš„é˜»å¡æ“ä½œæŠ›å‡ºå¼‚å¸¸</strong>ï¼š</p><ul><li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œ<strong>å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</strong>ï¼Œè¿™äº›æ“ä½œä¼š<strong>ç«‹å³æŠ›å‡º <code>InterruptedException</code></strong></li><li>æŠ›å‡ºå¼‚å¸¸åï¼Œ<strong>ä¸­æ–­æ ‡å¿—ä¼šè¢«æ¸…é™¤</strong>ï¼ˆå˜ä¸º <code>false</code>ï¼‰</li></ul></li><li><p><strong>é€šçŸ¥çº¿ç¨‹åº”è¯¥åœæ­¢</strong>ï¼š</p><ul><li>è¿™æ˜¯ä¸€ç§<strong>åä½œå¼çš„ä¸­æ–­æœºåˆ¶</strong></li><li>çº¿ç¨‹éœ€è¦<strong>ä¸»åŠ¨æ£€æŸ¥ä¸­æ–­æ ‡å¿—</strong>æˆ–<strong>å¤„ç† <code>InterruptedException</code></strong> æ¥å†³å®šæ˜¯å¦åœæ­¢</li></ul></li></ol><h3 id="å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ"><a href="#å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ" class="headerlink" title="å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ"></a>å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</h3><p>ä»¥ä¸‹æ“ä½œåœ¨æ”¶åˆ°ä¸­æ–­ä¿¡å·æ—¶ä¼šç«‹å³æŠ›å‡º <code>InterruptedException</code>ï¼š</p><table><thead><tr><th>æ“ä½œç±»å‹</th><th>æ–¹æ³•ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>çº¿ç¨‹ä¼‘çœ </strong></td><td><code>Thread.sleep(millis)</code></td><td>çº¿ç¨‹ä¼‘çœ æ—¶è¢«ä¸­æ–­</td></tr><tr><td><strong>å¯¹è±¡ç­‰å¾…</strong></td><td><code>Object.wait()</code>, <code>Object.wait(timeout)</code></td><td>ç­‰å¾…å¯¹è±¡é”æ—¶è¢«ä¸­æ–­</td></tr><tr><td><strong>é˜»å¡é˜Ÿåˆ—</strong></td><td><code>BlockingQueue.take()</code>, <code>BlockingQueue.put()</code></td><td>é˜Ÿåˆ—æ“ä½œæ—¶è¢«ä¸­æ–­</td></tr><tr><td><strong>IOæ“ä½œ</strong></td><td><code>InputStream.read()</code>, <code>ServerSocket.accept()</code></td><td>IOé˜»å¡æ—¶è¢«ä¸­æ–­ï¼ˆæŸäº›å®ç°ï¼‰</td></tr><tr><td><strong>é”æ“ä½œ</strong></td><td><code>Lock.lockInterruptibly()</code></td><td>å¯ä¸­æ–­çš„é”è·å–</td></tr><tr><td><strong>çº¿ç¨‹ç­‰å¾…</strong></td><td><code>Thread.join()</code>, <code>Thread.join(timeout)</code></td><td>ç­‰å¾…çº¿ç¨‹ç»“æŸæ—¶è¢«ä¸­æ–­</td></tr></tbody></table><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><h4 id="åœºæ™¯1ï¼šåœ¨-catch-å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰"><a href="#åœºæ™¯1ï¼šåœ¨-catch-å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰" class="headerlink" title="åœºæ™¯1ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰"></a>åœºæ™¯1ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            <span class="comment">// æˆ–è€…</span></span><br><span class="line">            <span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> blockingQueue.take();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Œè®©ä¸Šå±‚è°ƒç”¨è€…çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// é€€å‡ºå¾ªç¯ï¼Œå…è®¸çº¿ç¨‹æ­£å¸¸ç»“æŸ</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Ÿ</strong></p><ul><li>æ•è· <code>InterruptedException</code> åï¼Œä¸­æ–­æ ‡å¿—ä¼šè¢«æ¸…é™¤</li><li>å¦‚æœä¸æ¢å¤ï¼Œä¸Šå±‚è°ƒç”¨è€…æ— æ³•çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†</li><li>æ¢å¤æ ‡å¿—å¯ä»¥è®©ä¸Šå±‚ä»£ç æ£€æŸ¥ <code>isInterrupted()</code> æ¥å†³å®šæ˜¯å¦åœæ­¢</li></ul><h4 id="åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"><a href="#åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º" class="headerlink" title="åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"></a>åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">longRunningTask</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// å®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;ä»»åŠ¡è¢«ä¸­æ–­ï¼Œé€€å‡º&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        doSomething(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸-éœ€è°¨æ…ï¼‰"><a href="#åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸-éœ€è°¨æ…ï¼‰" class="headerlink" title="åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸ éœ€è°¨æ…ï¼‰"></a>åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸ éœ€è°¨æ…ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        handleMessage(msg);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// âš ï¸ è°¨æ…ä½¿ç”¨ï¼šè¿™ä¼šå½±å“å½“å‰çº¿ç¨‹</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">        log.error(<span class="string">&quot;å¤„ç†å¤±è´¥&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šåœ¨MQæ¥æ”¶ç­‰åœºæ™¯ä¸­ï¼Œé€šå¸¸<strong>ä¸åº”è¯¥</strong>è°ƒç”¨ <code>interrupt()</code>ï¼Œå› ä¸ºä¼šå½±å“åç»­æ¶ˆæ¯æ¥æ”¶ã€‚</p><h3 id="ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–"><a href="#ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–" class="headerlink" title="ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–"></a>ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–</h3><table><thead><tr><th>æ“ä½œ</th><th>ä¸­æ–­æ ‡å¿—çŠ¶æ€</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>çº¿ç¨‹å¯åŠ¨</strong></td><td><code>false</code></td><td>åˆå§‹çŠ¶æ€</td></tr><tr><td><strong>è°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code></td><td>è®¾ç½®ä¸­æ–­æ ‡å¿—</td></tr><tr><td><strong>æŠ›å‡º <code>InterruptedException</code></strong></td><td><code>false</code></td><td><strong>å¼‚å¸¸æŠ›å‡ºåæ ‡å¿—è¢«æ¸…é™¤</strong></td></tr><tr><td><strong>æ•è·å¼‚å¸¸åè°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code></td><td>æ¢å¤ä¸­æ–­æ ‡å¿—</td></tr></tbody></table><h3 id="å¸¸è§é”™è¯¯ç”¨æ³•"><a href="#å¸¸è§é”™è¯¯ç”¨æ³•" class="headerlink" title="å¸¸è§é”™è¯¯ç”¨æ³•"></a>å¸¸è§é”™è¯¯ç”¨æ³•</h3><h4 id="âŒ-é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—"><a href="#âŒ-é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—" class="headerlink" title="âŒ é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—"></a>âŒ é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="comment">// âŒ é”™è¯¯ï¼šä»€ä¹ˆéƒ½ä¸åšï¼Œä¸­æ–­æ ‡å¿—è¢«æ¸…é™¤ï¼Œä¸Šå±‚æ— æ³•æ„ŸçŸ¥</span></span><br><span class="line">    log.warn(<span class="string">&quot;è¢«ä¸­æ–­&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šä¸Šå±‚è°ƒç”¨è€…æ— æ³•çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†ã€‚</p><h4 id="âŒ-é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨"><a href="#âŒ-é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨" class="headerlink" title="âŒ é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨"></a>âŒ é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        processOrder(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// âŒ é”™è¯¯ï¼šä¼šå½±å“åç»­æ¶ˆæ¯æ¥æ”¶</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šå¦‚æœåç»­æœ‰é˜»å¡æ“ä½œï¼Œä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸ï¼Œå¯èƒ½å½±å“æ¶ˆæ¯æ¥æ”¶ã€‚</p><h4 id="âŒ-é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ"><a href="#âŒ-é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ" class="headerlink" title="âŒ é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ"></a>âŒ é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123; <span class="comment">// âŒ åº”è¯¥æ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// âŒ ç»§ç»­å¾ªç¯ï¼Œä½†ä¸‹æ¬¡sleepä¼šç«‹å³æŠ›å¼‚å¸¸</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šä¼šå½¢æˆæ­»å¾ªç¯ï¼Œæ¯æ¬¡é˜»å¡æ“ä½œéƒ½ç«‹å³æŠ›å¼‚å¸¸ã€‚</p><h3 id="æ­£ç¡®ç”¨æ³•æ€»ç»“"><a href="#æ­£ç¡®ç”¨æ³•æ€»ç»“" class="headerlink" title="æ­£ç¡®ç”¨æ³•æ€»ç»“"></a>æ­£ç¡®ç”¨æ³•æ€»ç»“</h3><h4 id="âœ…-æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"><a href="#âœ…-æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"></a>âœ… æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// é˜»å¡æ“ä½œ</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// âœ… é€€å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âœ…-æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­"><a href="#âœ…-æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­"></a>âœ… æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">        <span class="comment">// âœ… é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œè®©ä¸Šå±‚å¤„ç†</span></span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âœ…-æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—"><a href="#âœ…-æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—"></a>âœ… æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">longRunningTask</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// âœ… å®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;ä»»åŠ¡è¢«ä¸­æ–­&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        doSomething(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol><li><p><strong>åœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—</strong>ï¼š</p><ul><li>æ•è· <code>InterruptedException</code> åï¼Œåº”è¯¥è°ƒç”¨ <code>interrupt()</code> æ¢å¤æ ‡å¿—</li><li>è¿™æ ·ä¸Šå±‚è°ƒç”¨è€…å¯ä»¥æ£€æŸ¥ <code>isInterrupted()</code> æ¥å†³å®šæ˜¯å¦åœæ­¢</li></ul></li><li><p><strong>ä¸è¦éšæ„è°ƒç”¨ <code>interrupt()</code></strong>ï¼š</p><ul><li>åœ¨MQæ¥æ”¶ã€Webè¯·æ±‚å¤„ç†ç­‰åœºæ™¯ä¸­ï¼Œé€šå¸¸ä¸åº”è¯¥è°ƒç”¨</li><li>åªåœ¨ç¡®å®éœ€è¦ä¸­æ–­çº¿ç¨‹æ—¶æ‰è°ƒç”¨</li></ul></li><li><p><strong>æ£€æŸ¥ä¸­æ–­æ ‡å¿—</strong>ï¼š</p><ul><li>åœ¨é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ä¸­ï¼Œå®šæœŸæ£€æŸ¥ <code>isInterrupted()</code></li><li>ä½¿ç”¨ <code>while (!Thread.currentThread().isInterrupted())</code> è€Œä¸æ˜¯ <code>while (true)</code></li></ul></li><li><p><strong>æ­£ç¡®å¤„ç†å¼‚å¸¸</strong>ï¼š</p><ul><li>ä¸è¦åæ‰ <code>InterruptedException</code></li><li>è¦ä¹ˆæ¢å¤æ ‡å¿—å¹¶é€€å‡ºï¼Œè¦ä¹ˆé‡æ–°æŠ›å‡ºå¼‚å¸¸</li></ul></li></ol><h3 id="ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”"><a href="#ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”" class="headerlink" title="ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”"></a>ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”</h3><table><thead><tr><th>æ–¹æ³•</th><th>ä½œç”¨</th><th>æ˜¯å¦åœæ­¢çº¿ç¨‹</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong><code>interrupt()</code></strong></td><td>è®¾ç½®ä¸­æ–­æ ‡å¿—</td><td>âŒ ä¸ç«‹å³åœæ­¢</td><td>åä½œå¼ä¸­æ–­ï¼Œé€šçŸ¥çº¿ç¨‹åº”è¯¥åœæ­¢</td></tr><tr><td><strong><code>stop()</code></strong></td><td>å¼ºåˆ¶åœæ­¢çº¿ç¨‹</td><td>âœ… ç«‹å³åœæ­¢</td><td>âš ï¸ <strong>å·²åºŸå¼ƒ</strong>ï¼Œä¸å®‰å…¨</td></tr><tr><td><strong><code>suspend()</code></strong></td><td>æš‚åœçº¿ç¨‹</td><td>â¸ï¸ æš‚åœ</td><td>âš ï¸ <strong>å·²åºŸå¼ƒ</strong>ï¼Œå®¹æ˜“æ­»é”</td></tr><tr><td><strong><code>resume()</code></strong></td><td>æ¢å¤çº¿ç¨‹</td><td>â–¶ï¸ æ¢å¤</td><td>âš ï¸ <strong>å·²åºŸå¼ƒ</strong>ï¼Œé…åˆsuspendä½¿ç”¨</td></tr></tbody></table><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>âœ… <strong>ä½œç”¨</strong>ï¼šè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ï¼Œè§¦å‘å¯ä¸­æ–­çš„é˜»å¡æ“ä½œæŠ›å‡ºå¼‚å¸¸</li><li>âœ… <strong>ç‰¹ç‚¹</strong>ï¼šä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹ï¼Œæ˜¯åä½œå¼çš„ä¸­æ–­æœºåˆ¶</li><li>âœ… <strong>ä½¿ç”¨</strong>ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Œè®©ä¸Šå±‚çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­</li><li>âš ï¸ <strong>æ³¨æ„</strong>ï¼šä¸è¦éšæ„è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨MQæ¥æ”¶ç­‰æŒç»­è¿è¡Œçš„åœºæ™¯ä¸­</li><li>âœ… <strong>æœ€ä½³å®è·µ</strong>ï¼šæ¢å¤æ ‡å¿—å¹¶é€€å‡ºï¼Œæˆ–å®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</li></ul><hr><h2 id="ğŸ™-è‡´è°¢"><a href="#ğŸ™-è‡´è°¢" class="headerlink" title="ğŸ™ è‡´è°¢"></a>ğŸ™ è‡´è°¢</h2><p>æ„Ÿè°¢æ‰€æœ‰åœ¨é—®é¢˜æ’æŸ¥è¿‡ç¨‹ä¸­æä¾›å¸®åŠ©çš„åŒäº‹å’Œæœ‹å‹ä»¬ã€‚</p><hr><h2 id="ğŸ“„-ç‰ˆæƒå£°æ˜"><a href="#ğŸ“„-ç‰ˆæƒå£°æ˜" class="headerlink" title="ğŸ“„ ç‰ˆæƒå£°æ˜"></a>ğŸ“„ ç‰ˆæƒå£°æ˜</h2><p>æœ¬æ–‡æ¡£é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://suochina.github.io">SuoL</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://suochina.github.io/bug-review-record/">https://suochina.github.io/bug-review-record/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://suochina.github.io" target="_blank">SuoL's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Bug/">Bug</a><a class="post-meta__tags" href="/tags/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/">é—®é¢˜æ’æŸ¥</a><a class="post-meta__tags" href="/tags/%E6%95%85%E9%9A%9C%E5%88%86%E6%9E%90/">æ•…éšœåˆ†æ</a><a class="post-meta__tags" href="/tags/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/">ç»éªŒæ€»ç»“</a><a class="post-meta__tags" href="/tags/%E6%8A%80%E6%9C%AF%E5%A4%8D%E7%9B%98/">æŠ€æœ¯å¤ç›˜</a></div><div class="post-share"><div class="social-share" data-image="/images/bug/bug-cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/java-reflection-annotation-guide/" title="Javaåå°„ä¸æ³¨è§£å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/java/reflection-cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">Javaåå°„ä¸æ³¨è§£å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜</div></div><div class="info-2"><div class="info-item-1">å…¨é¢å­¦ä¹ Javaåå°„å’Œæ³¨è§£æœºåˆ¶ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼ŒæŒæ¡åå°„APIã€æ³¨è§£å®šä¹‰ã€æ³¨è§£å¤„ç†ç­‰æ ¸å¿ƒçŸ¥è¯†ï¼Œä¸ºæ¡†æ¶å¼€å‘æ‰“ä¸‹åšå®åŸºç¡€</div></div></div></a><a class="pagination-related" href="/java-multithreading-learning/" title="å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/java/threading-cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜</div></div><div class="info-2"><div class="info-item-1">å…¨é¢å­¦ä¹ Javaå¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼ŒæŒæ¡çº¿ç¨‹ã€çº¿ç¨‹æ± ã€å¹¶å‘å·¥å…·ç±»ç­‰æ ¸å¿ƒçŸ¥è¯†</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/my_cat.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">SuoL</div><div class="author-info-description">çƒ­çˆ±æŠ€æœ¯çš„å¼€å‘è€…ï¼Œä¸“æ³¨äºå‰ç«¯å¼€å‘å’Œå…¨æ ˆå¼€å‘</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/suoChina"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ°æˆ‘çš„æŠ€æœ¯åšå®¢ï¼è¿™é‡Œåˆ†äº«æŠ€æœ¯å­¦ä¹ ä¸æˆé•¿å¿ƒå¾— ğŸš€</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Bug%E5%A4%8D%E7%9B%98%E8%AE%B0%E5%BD%95-%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-%F0%9F%90%9B"><span class="toc-number">1.</span> <span class="toc-text">Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ ğŸ›</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8B-%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">ğŸ“‹ ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9D-%E6%96%87%E6%A1%A3%E4%BF%A1%E6%81%AF"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ“ æ–‡æ¡£ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8A-Bug%E7%BB%9F%E8%AE%A1"><span class="toc-number">1.3.</span> <span class="toc-text">ğŸ“Š Bugç»Ÿè®¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%8D-Bug%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.</span> <span class="toc-text">ğŸ” Bugåˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%B1%BB%E5%9E%8B%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.1.</span> <span class="toc-text">æŒ‰ç±»å‹åˆ†ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E6%A8%A1%E5%9D%97%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.2.</span> <span class="toc-text">æŒ‰æ¨¡å—åˆ†ç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9D-Bug%E8%AE%B0%E5%BD%95%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.5.</span> <span class="toc-text">ğŸ“ Bugè®°å½•æ¨¡æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bug-001-%E5%9C%A8SQL%E6%9F%A5%E8%AF%A2%E4%B8%AD%E4%BD%BF%E7%94%A8ResultMap-%E4%BD%86%E6%98%AF%E5%85%B6%E4%B8%AD%E6%9C%89%E4%B8%80%E4%B8%AA%E8%A1%A8%E4%BC%9A%E6%9F%A5%E5%87%BA1000%E5%A4%9A%E8%A1%8C%E7%9B%B8%E5%85%B3%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%AF%BC%E8%87%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E4%B9%98%E7%A7%AF%E5%A4%AA%E5%A4%A7%EF%BC%8C%E6%9F%A5%E8%AF%A2%E5%88%97%E8%A1%A810%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E7%AC%9B%E5%8D%A1%E5%B0%94%E4%B9%98%E7%A7%AF%E5%AF%BC%E8%87%B4%E6%9F%A5%E5%87%BA%E6%9D%A520%E4%B8%87%E6%9D%A1SQL%E8%AE%B0%E5%BD%95-%E6%9C%80%E7%BB%88%E5%AF%BC%E8%87%B4%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E8%B6%85%E6%97%B6"><span class="toc-number">1.5.1.</span> <span class="toc-text">Bug #001 - åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">é—®é¢˜æè¿°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">é—®é¢˜å¤ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">é—®é¢˜åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.1.5.</span> <span class="toc-text">ç»éªŒæ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bug-002-%E5%9C%A8java%E7%9A%84mq%E6%8E%A5%E6%94%B6%E7%9A%84%E4%BB%A3%E7%A0%81%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%BA%86Thread-interrupt-%E5%AF%BC%E8%87%B4MQ%E6%B6%88%E6%81%AF%E6%8E%A5%E6%94%B6%E4%B8%AD%E6%96%AD"><span class="toc-number">1.5.2.</span> <span class="toc-text">Bug #002 - åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread.interrupt()å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">é—®é¢˜æè¿°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%A4%8D%E7%8E%B0-1"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">é—®é¢˜å¤ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90-1"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">é—®é¢˜åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-1"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93-1"><span class="toc-number">1.5.2.5.</span> <span class="toc-text">ç»éªŒæ€»ç»“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9A-%E9%99%84%E5%BD%95%EF%BC%9AThread-currentThread-interrupt-%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.6.</span> <span class="toc-text">ğŸ“š é™„å½•ï¼šThread.currentThread().interrupt() è¯¦è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.6.1.</span> <span class="toc-text">åŸºæœ¬æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BD%9C%E7%94%A8"><span class="toc-number">1.6.2.</span> <span class="toc-text">æ ¸å¿ƒä½œç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E4%B8%AD%E6%96%AD%E7%9A%84%E9%98%BB%E5%A1%9E%E6%93%8D%E4%BD%9C"><span class="toc-number">1.6.3.</span> <span class="toc-text">å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.6.4.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF1%EF%BC%9A%E5%9C%A8-catch-%E5%9D%97%E4%B8%AD%E6%81%A2%E5%A4%8D%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">åœºæ™¯1ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF2%EF%BC%9A%E6%A3%80%E6%9F%A5%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97%E5%B9%B6%E9%80%80%E5%87%BA"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF3%EF%BC%9A%E5%9C%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%AD%E8%AE%BE%E7%BD%AE%E4%B8%AD%E6%96%AD%EF%BC%88%E2%9A%A0%EF%B8%8F-%E9%9C%80%E8%B0%A8%E6%85%8E%EF%BC%89"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸ éœ€è°¨æ…ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96"><span class="toc-number">1.6.5.</span> <span class="toc-text">ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E7%94%A8%E6%B3%95"><span class="toc-number">1.6.6.</span> <span class="toc-text">å¸¸è§é”™è¯¯ç”¨æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9D%8C-%E9%94%99%E8%AF%AF1%EF%BC%9A%E5%90%9E%E6%8E%89%E5%BC%82%E5%B8%B8%EF%BC%8C%E4%B8%8D%E6%81%A2%E5%A4%8D%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">âŒ é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9D%8C-%E9%94%99%E8%AF%AF2%EF%BC%9A%E5%9C%A8MQ%E6%8E%A5%E6%94%B6%E4%B8%AD%E9%9A%8F%E6%84%8F%E8%B0%83%E7%94%A8"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">âŒ é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9D%8C-%E9%94%99%E8%AF%AF3%EF%BC%9A%E4%B8%8D%E6%A3%80%E6%9F%A5%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97%E5%B0%B1%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C"><span class="toc-number">1.6.6.3.</span> <span class="toc-text">âŒ é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.7.</span> <span class="toc-text">æ­£ç¡®ç”¨æ³•æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E6%AD%A3%E7%A1%AE%E7%94%A8%E6%B3%951%EF%BC%9A%E6%81%A2%E5%A4%8D%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97%E5%B9%B6%E9%80%80%E5%87%BA"><span class="toc-number">1.6.7.1.</span> <span class="toc-text">âœ… æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E6%AD%A3%E7%A1%AE%E7%94%A8%E6%B3%952%EF%BC%9A%E6%81%A2%E5%A4%8D%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97%E5%B9%B6%E5%90%91%E4%B8%8A%E4%BC%A0%E6%92%AD"><span class="toc-number">1.6.7.2.</span> <span class="toc-text">âœ… æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E6%AD%A3%E7%A1%AE%E7%94%A8%E6%B3%953%EF%BC%9A%E5%AE%9A%E6%9C%9F%E6%A3%80%E6%9F%A5%E4%B8%AD%E6%96%AD%E6%A0%87%E5%BF%97"><span class="toc-number">1.6.7.3.</span> <span class="toc-text">âœ… æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.6.8.</span> <span class="toc-text">æœ€ä½³å®è·µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.9.</span> <span class="toc-text">ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.10.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%99%8F-%E8%87%B4%E8%B0%A2"><span class="toc-number">1.7.</span> <span class="toc-text">ğŸ™ è‡´è°¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%84-%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E"><span class="toc-number">1.8.</span> <span class="toc-text">ğŸ“„ ç‰ˆæƒå£°æ˜</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/java-multithreading-learning/" title="å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/java/threading-cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜"></a><div class="content"><a class="title" href="/java-multithreading-learning/" title="å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜">å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜</a><time datetime="2025-11-24T15:30:00.000Z" title="å‘è¡¨äº 2025-11-24 23:30:00">2025-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/bug-review-record/" title="Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/bug/bug-cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ"></a><div class="content"><a class="title" href="/bug-review-record/" title="Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ">Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ</a><time datetime="2025-11-24T15:30:00.000Z" title="å‘è¡¨äº 2025-11-24 23:30:00">2025-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/java-reflection-annotation-guide/" title="Javaåå°„ä¸æ³¨è§£å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/java/reflection-cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Javaåå°„ä¸æ³¨è§£å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜"></a><div class="content"><a class="title" href="/java-reflection-annotation-guide/" title="Javaåå°„ä¸æ³¨è§£å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜">Javaåå°„ä¸æ³¨è§£å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜</a><time datetime="2025-11-24T15:30:00.000Z" title="å‘è¡¨äº 2025-11-24 23:30:00">2025-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/redis-learning-guide/" title="Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/redis/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜"></a><div class="content"><a class="title" href="/redis-learning-guide/" title="Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜">Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜</a><time datetime="2025-11-09T15:30:00.000Z" title="å‘è¡¨äº 2025-11-09 23:30:00">2025-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/programming-shortcuts-guide/" title="ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/shortcuts/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—"></a><div class="content"><a class="title" href="/programming-shortcuts-guide/" title="ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—">ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—</a><time datetime="2025-11-09T15:00:00.000Z" title="å‘è¡¨äº 2025-11-09 23:00:00">2025-11-09</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By SuoL</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.2.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.0</a></span></div><div class="footer_custom_text">æ„Ÿè°¢è®¿é—®æˆ‘çš„æŠ€æœ¯åšå®¢ï¼å¦‚æœ‰é—®é¢˜æ¬¢è¿äº¤æµè®¨è®º ğŸš€</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"></div><script>const clickTexts=["âœ¨ å“‡ï¼","ğŸ’« å¤ªæ£’äº†ï¼","ğŸ‰ èµï¼","ğŸŒŸ ç²¾å½©ï¼","ğŸ’– å–œæ¬¢ï¼","ğŸš€ é…·ï¼","â­ æ£’ï¼","ğŸ’ ç¾ï¼","ğŸ”¥ çƒ­ï¼","ğŸ’¯ å®Œç¾ï¼","ğŸ˜Š å¼€å¿ƒï¼","ğŸŠ åº†ç¥ï¼","ğŸ’ æƒŠå–œï¼","ğŸŒˆ å½©è™¹ï¼","ğŸˆ æ°”çƒï¼","ğŸ€ å¹¸è¿ï¼","ğŸ ç¤¼ç‰©ï¼","ğŸ’ é²œèŠ±ï¼","ğŸµ éŸ³ä¹ï¼","ğŸ¨ è‰ºæœ¯ï¼"];function createClickEffect(e){const t=document.createElement("div");t.className="click-effect",t.textContent=clickTexts[Math.floor(Math.random()*clickTexts.length)],t.style.left=e.clientX+"px",t.style.top=e.clientY+"px",document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1e3),createRipple(e)}function createRipple(e){const t=document.createElement("div");t.className="ripple";t.style.width="20px",t.style.height="20px",t.style.left=e.clientX-10+"px",t.style.top=e.clientY-10+"px",document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},600)}document.addEventListener("click",createClickEffect);let isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);isMobile&&document.addEventListener("touchstart",(function(e){1===e.touches.length&&createClickEffect(e.touches[0])}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> æ•°æ®åŠ è½½ä¸­</span></div><div class="local-search-input"><input placeholder="æœç´¢æ–‡ç« ..." type="text"></div><hr><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>