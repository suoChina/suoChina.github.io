<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜</title>
      <link href="//java-multithreading-learning/"/>
      <url>//java-multithreading-learning/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤šçº¿ç¨‹å­¦ä¹ è®°å½•-ä»å…¥é—¨åˆ°å®æˆ˜-ğŸš€"><a href="#å¤šçº¿ç¨‹å­¦ä¹ è®°å½•-ä»å…¥é—¨åˆ°å®æˆ˜-ğŸš€" class="headerlink" title="å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜ ğŸš€"></a>å¤šçº¿ç¨‹å­¦ä¹ è®°å½• - ä»å…¥é—¨åˆ°å®æˆ˜ ğŸš€</h1><blockquote><p>Javaå¤šçº¿ç¨‹ç¼–ç¨‹æ˜¯Javaå¼€å‘ä¸­çš„é‡è¦æŠ€èƒ½ï¼ŒæŒæ¡å¤šçº¿ç¨‹å¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸CPUèµ„æºï¼Œæé«˜ç¨‹åºæ€§èƒ½ã€‚æœ¬æŒ‡å—å°†å¸¦ä½ å…¨é¢å­¦ä¹ Javaå¤šçº¿ç¨‹ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼ŒæŒæ¡å¹¶å‘ç¼–ç¨‹çš„æ ¸å¿ƒçŸ¥è¯†ï¼ğŸ’»</p></blockquote><p><img src="/images/java/threading-cover.png" alt="å¤šçº¿ç¨‹å­¦ä¹ æŒ‡å—"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æ”¶è—ã€‚åç»­å°†è¡¥å……å®Œæ•´çš„å®æˆ˜æ¡ˆä¾‹å’Œä»£ç ç¤ºä¾‹ã€‚</p></blockquote><hr><h2 id="ğŸ“-æ–‡æ¡£ä¿¡æ¯"><a href="#ğŸ“-æ–‡æ¡£ä¿¡æ¯" class="headerlink" title="ğŸ“ æ–‡æ¡£ä¿¡æ¯"></a>ğŸ“ æ–‡æ¡£ä¿¡æ¯</h2><ul><li><strong>æœ€åæ›´æ–°</strong>: 2025-11-24</li><li><strong>ä½œè€…</strong>: Suo</li><li><strong>æ ‡ç­¾</strong>: Java, å¤šçº¿ç¨‹, å¹¶å‘ç¼–ç¨‹, çº¿ç¨‹æ± , å¹¶å‘</li><li><strong>ç‰ˆæœ¬</strong>: v1.0</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£æ˜¯ä¸€ä»½å…¨é¢çš„Javaå¤šçº¿ç¨‹å­¦ä¹ æŒ‡å—ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼Œæ¶µç›–äº†å¤šçº¿ç¨‹çš„å„ä¸ªæ–¹é¢ã€‚æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æ”¶è—å’Œåˆ†äº«ã€‚</p></blockquote><hr><h2 id="ğŸ™-è‡´è°¢"><a href="#ğŸ™-è‡´è°¢" class="headerlink" title="ğŸ™ è‡´è°¢"></a>ğŸ™ è‡´è°¢</h2><p>æ„Ÿè°¢æ‰€æœ‰ä¸ºJavaç¤¾åŒºåšå‡ºè´¡çŒ®çš„å¼€å‘è€…ä»¬ï¼Œä»¥åŠæ‰€æœ‰æä¾›ä¼˜ç§€å­¦ä¹ èµ„æºçš„ä½œè€…ä»¬ã€‚</p><hr><h2 id="ğŸ“„-ç‰ˆæƒå£°æ˜"><a href="#ğŸ“„-ç‰ˆæƒå£°æ˜" class="headerlink" title="ğŸ“„ ç‰ˆæƒå£°æ˜"></a>ğŸ“„ ç‰ˆæƒå£°æ˜</h2><p>æœ¬æ–‡æ¡£é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
            <tag> å¹¶å‘ç¼–ç¨‹ </tag>
            
            <tag> çº¿ç¨‹æ±  </tag>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ</title>
      <link href="//bug-review-record/"/>
      <url>//bug-review-record/</url>
      
        <content type="html"><![CDATA[<h1 id="Bugå¤ç›˜è®°å½•-é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ-ğŸ›"><a href="#Bugå¤ç›˜è®°å½•-é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ-ğŸ›" class="headerlink" title="Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ ğŸ›"></a>Bugå¤ç›˜è®°å½• - é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ ğŸ›</h1><blockquote><p>è®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ï¼Œé€šè¿‡è¯¦ç»†çš„é—®é¢˜åˆ†æã€æ’æŸ¥è¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆï¼Œç§¯ç´¯æ•…éšœæ’æŸ¥ç»éªŒï¼Œé¿å…é‡å¤è¸©å‘ã€‚æœ¬è®°å½•å°†å¸®åŠ©ä½ å»ºç«‹ç³»ç»ŸåŒ–çš„é—®é¢˜è§£å†³æ€ç»´ï¼ğŸ”§</p></blockquote><p><img src="/images/bug/bug-cover.png" alt="Bugå¤ç›˜è®°å½•"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œè®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ã€‚æ¯ä¸ªé—®é¢˜éƒ½åŒ…å«è¯¦ç»†çš„åˆ†æè¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆã€‚</p></blockquote><hr><h2 id="ğŸ“-æ–‡æ¡£ä¿¡æ¯"><a href="#ğŸ“-æ–‡æ¡£ä¿¡æ¯" class="headerlink" title="ğŸ“ æ–‡æ¡£ä¿¡æ¯"></a>ğŸ“ æ–‡æ¡£ä¿¡æ¯</h2><ul><li><strong>æœ€åæ›´æ–°</strong>: 2025-11-24</li><li><strong>ä½œè€…</strong>: Suo</li><li><strong>æ ‡ç­¾</strong>: Bug, é—®é¢˜æ’æŸ¥, æ•…éšœåˆ†æ, ç»éªŒæ€»ç»“, æŠ€æœ¯å¤ç›˜</li><li><strong>ç‰ˆæœ¬</strong>: v1.0</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£è®°å½•å·¥ä½œä¸­é‡åˆ°çš„å„ç§Bugå’Œé—®é¢˜ï¼Œé€šè¿‡å¤ç›˜åˆ†æï¼Œæ€»ç»“ç»éªŒæ•™è®­ï¼Œæå‡é—®é¢˜è§£å†³èƒ½åŠ›ã€‚æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æ”¶è—å’Œåˆ†äº«ã€‚</p></blockquote><hr><h2 id="ğŸ“Š-Bugç»Ÿè®¡"><a href="#ğŸ“Š-Bugç»Ÿè®¡" class="headerlink" title="ğŸ“Š Bugç»Ÿè®¡"></a>ğŸ“Š Bugç»Ÿè®¡</h2><ul><li><strong>æ€»Bugæ•°</strong>: 1</li><li><strong>å·²è§£å†³</strong>: 1</li><li><strong>å¾…è§£å†³</strong>: 0</li><li><strong>é«˜ä¼˜å…ˆçº§</strong>: 1</li><li><strong>ä¸­ä¼˜å…ˆçº§</strong>: 0</li><li><strong>ä½ä¼˜å…ˆçº§</strong>: 0</li></ul><hr><h2 id="ğŸ”-Bugåˆ†ç±»"><a href="#ğŸ”-Bugåˆ†ç±»" class="headerlink" title="ğŸ” Bugåˆ†ç±»"></a>ğŸ” Bugåˆ†ç±»</h2><h3 id="æŒ‰ç±»å‹åˆ†ç±»"><a href="#æŒ‰ç±»å‹åˆ†ç±»" class="headerlink" title="æŒ‰ç±»å‹åˆ†ç±»"></a>æŒ‰ç±»å‹åˆ†ç±»</h3><ul><li><strong>ç©ºæŒ‡é’ˆå¼‚å¸¸</strong>: 0</li><li><strong>å¹¶å‘é—®é¢˜</strong>: 0</li><li><strong>æ€§èƒ½é—®é¢˜</strong>: 1</li><li><strong>æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong>: 0</li><li><strong>é…ç½®é—®é¢˜</strong>: 0</li><li><strong>ç¬¬ä¸‰æ–¹ä¾èµ–é—®é¢˜</strong>: 0</li><li><strong>å…¶ä»–é—®é¢˜</strong>: 0</li></ul><h3 id="æŒ‰æ¨¡å—åˆ†ç±»"><a href="#æŒ‰æ¨¡å—åˆ†ç±»" class="headerlink" title="æŒ‰æ¨¡å—åˆ†ç±»"></a>æŒ‰æ¨¡å—åˆ†ç±»</h3><ul><li><strong>åç«¯æœåŠ¡</strong>: 0</li><li><strong>å‰ç«¯é¡µé¢</strong>: 0</li><li><strong>æ•°æ®åº“</strong>: 1</li><li><strong>ç¼“å­˜</strong>: 0</li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>: 0</li><li><strong>å…¶ä»–</strong>: 0</li></ul><hr><h2 id="ğŸ“-Bugè®°å½•æ¨¡æ¿"><a href="#ğŸ“-Bugè®°å½•æ¨¡æ¿" class="headerlink" title="ğŸ“ Bugè®°å½•æ¨¡æ¿"></a>ğŸ“ Bugè®°å½•æ¨¡æ¿</h2><h3 id="Bug-001-åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap-ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•-æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶"><a href="#Bug-001-åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap-ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•-æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶" class="headerlink" title="Bug #001 - åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶"></a>Bug #001 - åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶</h3><p><strong>å‘ç°æ—¶é—´</strong>: 2025-11-20<br><strong>ä¼˜å…ˆçº§</strong>: é«˜<br><strong>çŠ¶æ€</strong>: å·²è§£å†³<br><strong>å½±å“èŒƒå›´</strong>: æ¥å£å“åº”è¶…æ—¶ï¼Œæ— æ³•æŸ¥çœ‹åˆ—è¡¨ä¿¡æ¯</p><h4 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p>åœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨ResultMap,ä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªè¡¨ä¼šæŸ¥å‡º1000å¤šè¡Œç›¸å…³æ•°æ®ï¼Œå¯¼è‡´ç¬›å¡å°”ä¹˜ç§¯å¤ªå¤§ï¼ŒæŸ¥è¯¢åˆ—è¡¨10æ¡æ•°æ®ï¼Œç¬›å¡å°”ä¹˜ç§¯å¯¼è‡´æŸ¥å‡ºæ¥20ä¸‡æ¡SQLè®°å½•,æœ€ç»ˆå¯¼è‡´æ¥å£è¿”å›è¶…æ—¶</p><h4 id="é—®é¢˜å¤ç°"><a href="#é—®é¢˜å¤ç°" class="headerlink" title="é—®é¢˜å¤ç°"></a>é—®é¢˜å¤ç°</h4><p>å¤šè¡¨æŸ¥è¯¢ä½¿ç”¨ResultMapæ—¶,æœ‰è¡¨çš„æ•°æ®éå¸¸å¤š</p><h4 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h4><p><strong>æ ¹æœ¬åŸå› </strong>ï¼š</p><ol><li><p><strong>ç¬›å¡å°”ç§¯é—®é¢˜</strong>ï¼š</p><ul><li>ä½¿ç”¨MyBatisçš„<code>&lt;resultMap&gt;</code>è¿›è¡Œå¤šè¡¨å…³è”æŸ¥è¯¢æ—¶ï¼Œå¦‚æœå…³è”è¡¨æ•°æ®é‡å¤§ï¼Œä¼šäº§ç”Ÿç¬›å¡å°”ç§¯</li><li>ä¾‹å¦‚ï¼šä¸»è¡¨10æ¡è®°å½• Ã— å…³è”è¡¨1000æ¡è®°å½• &#x3D; 10,000æ¡ç»“æœé›†</li><li>å¦‚æœæœ‰å¤šå±‚å…³è”ï¼Œé—®é¢˜ä¼šæŒ‡æ•°çº§æ”¾å¤§ï¼š10 Ã— 1000 Ã— 20 &#x3D; 200,000æ¡è®°å½•</li></ul></li><li><p><strong>MyBatis ResultMapçš„å·¥ä½œæœºåˆ¶</strong>ï¼š</p><ul><li>MyBatisåœ¨å†…å­˜ä¸­å¯¹ç»“æœé›†è¿›è¡Œå»é‡å’Œç»„è£…</li><li>å³ä½¿æœ€ç»ˆåªéœ€è¦10æ¡ä¸»è®°å½•ï¼Œä¹Ÿè¦å…ˆæŸ¥è¯¢å‡º20ä¸‡æ¡ä¸­é—´ç»“æœ</li><li>å¤§é‡çš„å†…å­˜åˆ†é…å’Œæ•°æ®è½¬æ¢æ“ä½œå¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™</li></ul></li><li><p><strong>æ€§èƒ½å½±å“</strong>ï¼š</p><ul><li><strong>æ•°æ®åº“å±‚é¢</strong>ï¼šéœ€è¦æ‰«æå¤§é‡æ•°æ®ï¼Œäº§ç”Ÿå¤§é‡ä¸´æ—¶ç»“æœé›†</li><li><strong>ç½‘ç»œä¼ è¾“</strong>ï¼šä¼ è¾“20ä¸‡æ¡è®°å½•çš„ç½‘ç»œå¼€é”€å·¨å¤§</li><li><strong>å†…å­˜æ¶ˆè€—</strong>ï¼šMyBatiséœ€è¦å°†20ä¸‡æ¡è®°å½•åŠ è½½åˆ°å†…å­˜ä¸­è¿›è¡Œå¤„ç†</li><li><strong>CPUæ¶ˆè€—</strong>ï¼šå¤§é‡çš„æ•°æ®å»é‡ã€æ˜ å°„ã€å¯¹è±¡åˆ›å»ºæ“ä½œ</li></ul></li><li><p><strong>é—®é¢˜åœºæ™¯</strong>ï¼š</p><ul><li>ä¸€å¯¹å¤šå…³è”æŸ¥è¯¢ï¼ˆå¦‚è®¢å•-è®¢å•æ˜ç»†ï¼‰</li><li>å¤šå¯¹å¤šå…³è”æŸ¥è¯¢ï¼ˆå¦‚ç”¨æˆ·-è§’è‰²-æƒé™ï¼‰</li><li>åµŒå¥—çš„å…³è”æŸ¥è¯¢ï¼ˆå¤šå±‚å…³è”ï¼‰</li></ul></li></ol><p><strong>é—®é¢˜ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é—®é¢˜SQLç¤ºä¾‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderDetailMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;orderNo&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_no&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€å¯¹å¤šå…³è”ï¼Œå¦‚æœè®¢å•æ˜ç»†æœ‰1000æ¡ï¼Œä¸»æŸ¥è¯¢10æ¡è®¢å•å°±ä¼šäº§ç”Ÿ10000æ¡ç»“æœ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orderItems&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;item_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;productName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;product_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderDetailMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        o.id as order_id,</span><br><span class="line">        o.order_no,</span><br><span class="line">        oi.id as item_id,</span><br><span class="line">        oi.product_name</span><br><span class="line">    FROM orders o</span><br><span class="line">    LEFT JOIN order_items oi ON o.id = oi.order_id</span><br><span class="line">    LIMIT 10</span><br><span class="line">    -- å¦‚æœæ¯ä¸ªè®¢å•æœ‰1000ä¸ªæ˜ç»†ï¼Œå®é™…æŸ¥è¯¢å‡º10000æ¡è®°å½•</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šæ‹†åˆ†SQLæŸ¥è¯¢ï¼ˆæ¨èï¼‰</strong></p><p>å°†å¤šè¡¨å…³è”æŸ¥è¯¢æ‹†åˆ†ä¸ºå¤šæ¬¡æŸ¥è¯¢ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢ä¸»è¡¨æ•°æ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    SELECT id, order_no, create_time</span><br><span class="line">    FROM orders</span><br><span class="line">    LIMIT 10</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç¬¬äºŒæ­¥ï¼šæ‰¹é‡æŸ¥è¯¢å…³è”æ•°æ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderItemsByOrderIds&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">    SELECT id, order_id, product_name</span><br><span class="line">    FROM order_items</span><br><span class="line">    WHERE order_id IN</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;orderIds&quot;</span> <span class="attr">item</span>=<span class="string">&quot;orderId&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">        #&#123;orderId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Javaä»£ç å®ç°</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Order&gt; <span class="title function_">getOrderList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1. å…ˆæŸ¥è¯¢ä¸»è¡¨</span></span><br><span class="line">    List&lt;Order&gt; orders = orderMapper.selectOrderList();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ‰¹é‡æŸ¥è¯¢å…³è”æ•°æ®</span></span><br><span class="line">    List&lt;Long&gt; orderIds = orders.stream()</span><br><span class="line">        .map(Order::getId)</span><br><span class="line">        .collect(Collectors.toList());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!orderIds.isEmpty()) &#123;</span><br><span class="line">        List&lt;OrderItem&gt; items = orderItemMapper.selectOrderItemsByOrderIds(orderIds);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. æ‰‹åŠ¨ç»„è£…æ•°æ®</span></span><br><span class="line">        Map&lt;Long, List&lt;OrderItem&gt;&gt; itemMap = items.stream()</span><br><span class="line">            .collect(Collectors.groupingBy(OrderItem::getOrderId));</span><br><span class="line">        </span><br><span class="line">        orders.forEach(order -&gt; </span><br><span class="line">            order.setOrderItems(itemMap.getOrDefault(order.getId(), Collections.emptyList()))</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> orders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼ˆLazy Loadingï¼‰</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderDetailMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;orderNo&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_no&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼Œåªæœ‰åœ¨è®¿é—®æ—¶æ‰æŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orderItems&quot;</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">ofType</span>=<span class="string">&quot;OrderItem&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">select</span>=<span class="string">&quot;selectOrderItemsByOrderId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">fetchType</span>=<span class="string">&quot;lazy&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderDetailMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT id as order_id, order_no</span><br><span class="line">    FROM orders</span><br><span class="line">    LIMIT 10</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrderItemsByOrderId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">    SELECT id, order_id, product_name</span><br><span class="line">    FROM order_items</span><br><span class="line">    WHERE order_id = #&#123;orderId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ3ï¼šä½¿ç”¨åˆ†é¡µæŸ¥è¯¢å…³è”æ•°æ®</strong></p><p>å¦‚æœå…³è”æ•°æ®å¿…é¡»ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼Œå¯ä»¥è€ƒè™‘åˆ†é¡µï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹å…³è”è¡¨è¿›è¡Œåˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Order&gt; <span class="title function_">getOrderListWithPagedItems</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Order&gt; orders = orderMapper.selectOrderList();</span><br><span class="line">    </span><br><span class="line">    orders.forEach(order -&gt; &#123;</span><br><span class="line">        <span class="comment">// åˆ†é¡µæŸ¥è¯¢è®¢å•æ˜ç»†ï¼Œé¿å…ä¸€æ¬¡æ€§æŸ¥è¯¢è¿‡å¤šæ•°æ®</span></span><br><span class="line">        PageHelper.startPage(<span class="number">1</span>, <span class="number">100</span>); <span class="comment">// æ¯é¡µæœ€å¤š100æ¡</span></span><br><span class="line">        List&lt;OrderItem&gt; items = orderItemMapper.selectByOrderId(order.getId());</span><br><span class="line">        order.setOrderItems(items);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> orders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ4ï¼šä½¿ç”¨ç¼“å­˜ä¼˜åŒ–</strong></p><p>å¯¹äºä¸ç»å¸¸å˜åŒ–çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Cacheable(value = &quot;orderItems&quot;, key = &quot;#orderId&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title function_">getOrderItems</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> orderItemMapper.selectByOrderId(orderId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»éªŒæ€»ç»“"><a href="#ç»éªŒæ€»ç»“" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h4><p><strong>æ ¸å¿ƒæ•™è®­</strong>ï¼š</p><ol><li><p><strong>é¿å…å¤§ç»“æœé›†çš„ç¬›å¡å°”ç§¯</strong>ï¼š</p><ul><li>âœ… å¤šè¡¨å…³è”æŸ¥è¯¢æ—¶ï¼Œè¦è¯„ä¼°å…³è”è¡¨çš„æ•°æ®é‡</li><li>âœ… å¦‚æœå…³è”è¡¨æ•°æ®é‡å¤§ï¼ˆ&gt;100æ¡ï¼‰ï¼Œä¼˜å…ˆè€ƒè™‘æ‹†åˆ†æŸ¥è¯¢</li><li>âœ… ä½¿ç”¨<code>EXPLAIN</code>åˆ†æSQLæ‰§è¡Œè®¡åˆ’ï¼Œå…³æ³¨ç»“æœé›†å¤§å°</li></ul></li><li><p><strong>MyBatis ResultMapä½¿ç”¨åŸåˆ™</strong>ï¼š</p><ul><li>âœ… <strong>ä¸€å¯¹å¤šå…³è”</strong>ï¼šæ•°æ®é‡å°ï¼ˆ&lt;50ï¼‰å¯ä»¥ä½¿ç”¨ResultMapï¼Œæ•°æ®é‡å¤§å»ºè®®æ‹†åˆ†</li><li>âœ… <strong>å¤šå¯¹å¤šå…³è”</strong>ï¼šå¿…é¡»æ‹†åˆ†æŸ¥è¯¢ï¼Œé¿å…ç¬›å¡å°”ç§¯</li><li>âœ… <strong>åµŒå¥—å…³è”</strong>ï¼šè¶…è¿‡2å±‚åµŒå¥—æ—¶ï¼Œå¿…é¡»æ‹†åˆ†æŸ¥è¯¢</li></ul></li></ol><p><strong>å…³è”å…³ç³»è¯´æ˜</strong>ï¼š</p><p><strong>ä¸€å¯¹å¤šå…³è”ï¼ˆOne-to-Manyï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šä¸€ä¸ªä¸»è¡¨è®°å½•å¯¹åº”å¤šä¸ªä»è¡¨è®°å½•</li><li><strong>æ•°æ®åº“ä½“ç°</strong>ï¼šä»è¡¨ä¸­æœ‰å¤–é”®æŒ‡å‘ä¸»è¡¨</li><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼š<ul><li>è®¢å•ï¼ˆOrderï¼‰â†’ è®¢å•æ˜ç»†ï¼ˆOrderItemï¼‰ï¼šä¸€ä¸ªè®¢å•æœ‰å¤šä¸ªå•†å“æ˜ç»†</li><li>ç”¨æˆ·ï¼ˆUserï¼‰â†’ è®¢å•ï¼ˆOrderï¼‰ï¼šä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªè®¢å•</li><li>éƒ¨é—¨ï¼ˆDepartmentï¼‰â†’ å‘˜å·¥ï¼ˆEmployeeï¼‰ï¼šä¸€ä¸ªéƒ¨é—¨æœ‰å¤šä¸ªå‘˜å·¥</li></ul></li><li><strong>MyBatiså®ç°</strong>ï¼šä½¿ç”¨<code>&lt;collection&gt;</code>æ ‡ç­¾</li><li><strong>ç¬›å¡å°”ç§¯é£é™©</strong>ï¼šå¦‚æœä»è¡¨æ•°æ®é‡å¤§ï¼Œä¼šäº§ç”Ÿå¤§é‡é‡å¤çš„ä¸»è¡¨è®°å½•</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¸€å¯¹å¤šï¼šè®¢å•å’Œè®¢å•æ˜ç»† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;orderNo&quot;</span> <span class="attr">column</span>=<span class="string">&quot;order_no&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€ä¸ªè®¢å•å¯¹åº”å¤šä¸ªè®¢å•æ˜ç»† --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orderItems&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;OrderItem&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;item_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;productName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;product_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- SQLæŸ¥è¯¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOrder&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        o.id as order_id,</span><br><span class="line">        o.order_no,</span><br><span class="line">        oi.id as item_id,</span><br><span class="line">        oi.product_name</span><br><span class="line">    FROM orders o</span><br><span class="line">    LEFT JOIN order_items oi ON o.id = oi.order_id</span><br><span class="line">    WHERE o.id = #&#123;orderId&#125;</span><br><span class="line">    -- å¦‚æœè®¢å•æœ‰100ä¸ªæ˜ç»†ï¼ŒæŸ¥è¯¢ç»“æœä¼šæœ‰100è¡Œï¼ˆè®¢å•ä¿¡æ¯é‡å¤100æ¬¡ï¼‰</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>å¤šå¯¹å¤šå…³è”ï¼ˆMany-to-Manyï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šä¸¤ä¸ªè¡¨ä¹‹é—´æ˜¯å¤šå¯¹å¤šå…³ç³»ï¼Œéœ€è¦é€šè¿‡ä¸­é—´è¡¨å…³è”</li><li><strong>æ•°æ®åº“ä½“ç°</strong>ï¼šéœ€è¦ä¸‰ä¸ªè¡¨ï¼Œä¸­é—´è¡¨å­˜å‚¨å…³è”å…³ç³»</li><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼š<ul><li>ç”¨æˆ·ï¼ˆUserï¼‰â†” è§’è‰²ï¼ˆRoleï¼‰ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè§’è‰²ï¼Œä¸€ä¸ªè§’è‰²å¯ä»¥åˆ†é…ç»™å¤šä¸ªç”¨æˆ·</li><li>å­¦ç”Ÿï¼ˆStudentï¼‰â†” è¯¾ç¨‹ï¼ˆCourseï¼‰ï¼šä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰å¤šé—¨è¯¾ï¼Œä¸€é—¨è¯¾å¯ä»¥æœ‰å¤šä¸ªå­¦ç”Ÿ</li><li>å•†å“ï¼ˆProductï¼‰â†” æ ‡ç­¾ï¼ˆTagï¼‰ï¼šä¸€ä¸ªå•†å“å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ï¼Œä¸€ä¸ªæ ‡ç­¾å¯ä»¥æ ‡è®°å¤šä¸ªå•†å“</li></ul></li><li><strong>MyBatiså®ç°</strong>ï¼šéœ€è¦å…³è”ä¸­é—´è¡¨ï¼Œä½¿ç”¨å¤šä¸ª<code>&lt;collection&gt;</code>æˆ–<code>&lt;association&gt;</code></li><li><strong>ç¬›å¡å°”ç§¯é£é™©</strong>ï¼šæœ€é«˜ï¼å¦‚æœä¸¤è¾¹æ•°æ®éƒ½å¤šï¼Œç»“æœé›†ä¼šæ€¥å‰§è†¨èƒ€</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¤šå¯¹å¤šï¼šç”¨æˆ·å’Œè§’è‰²ï¼ˆé€šè¿‡user_roleä¸­é—´è¡¨ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userRoleMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€ä¸ªç”¨æˆ·å¯¹åº”å¤šä¸ªè§’è‰² --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;roles&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Role&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;roleName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserWithRoles&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userRoleMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        u.id as user_id,</span><br><span class="line">        u.username,</span><br><span class="line">        r.id as role_id,</span><br><span class="line">        r.role_name</span><br><span class="line">    FROM users u</span><br><span class="line">    LEFT JOIN user_role ur ON u.id = ur.user_id</span><br><span class="line">    LEFT JOIN roles r ON ur.role_id = r.id</span><br><span class="line">    WHERE u.id = #&#123;userId&#125;</span><br><span class="line">    -- å¦‚æœç”¨æˆ·æœ‰5ä¸ªè§’è‰²ï¼ŒæŸ¥è¯¢ç»“æœä¼šæœ‰5è¡Œ</span><br><span class="line">    -- å¦‚æœæŸ¥è¯¢10ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·5ä¸ªè§’è‰²ï¼Œç»“æœä¼šæœ‰50è¡Œ</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆå¤šå¯¹å¤šæ›´å®¹æ˜“äº§ç”Ÿç¬›å¡å°”ç§¯</strong>ï¼š</p><p>å‡è®¾åœºæ™¯ï¼šæŸ¥è¯¢10ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰5ä¸ªè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²æœ‰10ä¸ªæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·è¡¨ï¼š10æ¡</span><br><span class="line">  â†“ JOIN</span><br><span class="line">ç”¨æˆ·è§’è‰²ä¸­é—´è¡¨ï¼š50æ¡ï¼ˆ10ç”¨æˆ· Ã— 5è§’è‰²ï¼‰</span><br><span class="line">  â†“ JOIN  </span><br><span class="line">è§’è‰²è¡¨ï¼š50æ¡</span><br><span class="line">  â†“ JOIN</span><br><span class="line">è§’è‰²æƒé™ä¸­é—´è¡¨ï¼š500æ¡ï¼ˆ50è§’è‰² Ã— 10æƒé™ï¼‰</span><br><span class="line">  â†“ JOIN</span><br><span class="line">æƒé™è¡¨ï¼š500æ¡</span><br><span class="line"></span><br><span class="line">æœ€ç»ˆç»“æœé›†ï¼š10 Ã— 5 Ã— 10 = 500æ¡è®°å½•</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨åµŒå¥—çš„ResultMapï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userDetailMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;roles&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Role&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åµŒå¥—å…³è”ï¼šè§’è‰²å’Œæƒé™ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;permissions&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Permission&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;permission_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢10ä¸ªç”¨æˆ·ï¼Œå®é™…ä¼šäº§ç”Ÿ500æ¡ç»“æœé›†ï¼ŒMyBatiséœ€è¦åœ¨å†…å­˜ä¸­å¤„ç†è¿™500æ¡è®°å½•è¿›è¡Œå»é‡å’Œç»„è£…ã€‚</p><ol start="3"><li><p><strong>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p><ul><li>âœ… <strong>æ‹†åˆ†æŸ¥è¯¢</strong>ï¼šå°†å¤§æŸ¥è¯¢æ‹†åˆ†ä¸ºå¤šä¸ªå°æŸ¥è¯¢ï¼Œåœ¨åº”ç”¨å±‚ç»„è£…</li><li>âœ… <strong>å»¶è¿ŸåŠ è½½</strong>ï¼šä½¿ç”¨<code>fetchType=&quot;lazy&quot;</code>ï¼ŒæŒ‰éœ€åŠ è½½å…³è”æ•°æ®</li><li>âœ… <strong>æ‰¹é‡æŸ¥è¯¢</strong>ï¼šä½¿ç”¨<code>IN</code>æŸ¥è¯¢æ›¿ä»£å¤šæ¬¡å•ç‹¬æŸ¥è¯¢</li><li>âœ… <strong>åˆ†é¡µæŸ¥è¯¢</strong>ï¼šå¯¹å…³è”æ•°æ®ä¹Ÿè¿›è¡Œåˆ†é¡µï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤š</li></ul></li><li><p><strong>ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹</strong>ï¼š</p><ul><li>âš ï¸ æ£€æŸ¥ResultMapä¸­çš„<code>&lt;collection&gt;</code>å’Œ<code>&lt;association&gt;</code>åµŒå¥—æ·±åº¦</li><li>âš ï¸ è¯„ä¼°å…³è”è¡¨çš„æ•°æ®é‡ï¼Œç‰¹åˆ«æ˜¯å†å²æ•°æ®è¡¨</li><li>âš ï¸ æ£€æŸ¥SQLçš„<code>EXPLAIN</code>ç»“æœï¼Œå…³æ³¨<code>rows</code>å­—æ®µ</li><li>âš ï¸ ç›‘æ§æ¥å£å“åº”æ—¶é—´ï¼Œè®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</li></ul></li><li><p><strong>é¢„é˜²æªæ–½</strong>ï¼š</p><ul><li>âœ… å»ºç«‹SQLå®¡æŸ¥è§„èŒƒï¼Œç¦æ­¢è¶…è¿‡2å±‚çš„åµŒå¥—å…³è”</li><li>âœ… å¯¹å¤§æ•°æ®é‡çš„å…³è”æŸ¥è¯¢ï¼Œå¼ºåˆ¶è¦æ±‚æ‹†åˆ†</li><li>âœ… æ·»åŠ æ¥å£æ€§èƒ½ç›‘æ§ï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜</li><li>âœ… å®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯æ•°æ®é‡å¢é•¿å</li></ul></li></ol><p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èçš„åšæ³•ï¼šæ‹†åˆ†æŸ¥è¯¢ + æ‰¹é‡æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">public</span> List&lt;OrderDTO&gt; <span class="title function_">getOrderList</span><span class="params">(<span class="type">int</span> pageNum, <span class="type">int</span> pageSize)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. æŸ¥è¯¢ä¸»è¡¨ï¼ˆåˆ†é¡µï¼‰</span></span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    List&lt;Order&gt; orders = orderMapper.selectOrderList();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (orders.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ‰¹é‡æŸ¥è¯¢å…³è”æ•°æ®ï¼ˆé¿å…N+1é—®é¢˜ï¼‰</span></span><br><span class="line">    List&lt;Long&gt; orderIds = orders.stream()</span><br><span class="line">        .map(Order::getId)</span><br><span class="line">        .collect(Collectors.toList());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰¹é‡æŸ¥è¯¢è®¢å•æ˜ç»†</span></span><br><span class="line">    List&lt;OrderItem&gt; items = orderItemMapper.selectByOrderIds(orderIds);</span><br><span class="line">    Map&lt;Long, List&lt;OrderItem&gt;&gt; itemMap = items.stream()</span><br><span class="line">        .collect(Collectors.groupingBy(OrderItem::getOrderId));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    Set&lt;Long&gt; userIds = orders.stream()</span><br><span class="line">        .map(Order::getUserId)</span><br><span class="line">        .collect(Collectors.toSet());</span><br><span class="line">    Map&lt;Long, User&gt; userMap = userMapper.selectByIds(userIds).stream()</span><br><span class="line">        .collect(Collectors.toMap(User::getId, Function.identity()));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. ç»„è£…æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> orders.stream().map(order -&gt; &#123;</span><br><span class="line">        <span class="type">OrderDTO</span> <span class="variable">dto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderDTO</span>();</span><br><span class="line">        BeanUtils.copyProperties(order, dto);</span><br><span class="line">        dto.setOrderItems(itemMap.getOrDefault(order.getId(), Collections.emptyList()));</span><br><span class="line">        dto.setUser(userMap.get(order.getUserId()));</span><br><span class="line">        <span class="keyword">return</span> dto;</span><br><span class="line">    &#125;).collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>æŸ¥è¯¢æ¬¡æ•°</th><th>ç»“æœé›†å¤§å°</th><th>å“åº”æ—¶é—´</th><th>å†…å­˜å ç”¨</th></tr></thead><tbody><tr><td><strong>åŸå§‹æ–¹æ¡ˆï¼ˆResultMapï¼‰</strong></td><td>1æ¬¡</td><td>200,000æ¡</td><td>10ç§’+</td><td>500MB+</td></tr><tr><td><strong>æ‹†åˆ†æŸ¥è¯¢</strong></td><td>2-3æ¬¡</td><td>10 + 10,000æ¡</td><td>200ms</td><td>50MB</td></tr><tr><td><strong>å»¶è¿ŸåŠ è½½</strong></td><td>1+Næ¬¡</td><td>10 + NÃ—1000æ¡</td><td>1-2ç§’</td><td>100MB</td></tr><tr><td><strong>åˆ†é¡µ+æ‹†åˆ†</strong></td><td>2æ¬¡</td><td>10 + 1,000æ¡</td><td>150ms</td><td>20MB</td></tr></tbody></table><h3 id="Bug-002-åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread-interrupt-å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­"><a href="#Bug-002-åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread-interrupt-å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­" class="headerlink" title="Bug #002 - åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread.interrupt()å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­"></a>Bug #002 - åœ¨javaçš„mqæ¥æ”¶çš„ä»£ç ä¸­ä½¿ç”¨äº†Thread.interrupt()å¯¼è‡´MQæ¶ˆæ¯æ¥æ”¶ä¸­æ–­</h3><p><strong>å‘ç°æ—¶é—´</strong>: 2025-11-20<br><strong>ä¼˜å…ˆçº§</strong>: é«˜<br><strong>çŠ¶æ€</strong>: å·²è§£å†³<br><strong>å½±å“èŒƒå›´</strong>: MQæ¶ˆæ¯æ¥æ”¶çº¿ç¨‹è¢«ä¸­æ–­ï¼Œæ— æ³•ç»§ç»­æ¥æ”¶æ¶ˆæ¯ï¼Œå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±</p><h4 id="é—®é¢˜æè¿°-1"><a href="#é—®é¢˜æè¿°-1" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h4><p>åœ¨MQæ¶ˆæ¯æ¥æ”¶çš„ä»£ç ä¸­ï¼Œé”™è¯¯åœ°ä½¿ç”¨äº† <code>Thread.currentThread().interrupt()</code> æ–¹æ³•ï¼Œå¯¼è‡´æ¶ˆæ¯æ¥æ”¶çº¿ç¨‹è¢«ä¸­æ–­ï¼Œæ— æ³•ç»§ç»­æ¥æ”¶MQæ¶ˆæ¯ã€‚</p><h4 id="é—®é¢˜å¤ç°-1"><a href="#é—®é¢˜å¤ç°-1" class="headerlink" title="é—®é¢˜å¤ç°"></a>é—®é¢˜å¤ç°</h4><p>åœ¨MQæ¶ˆæ¯æ¥æ”¶çš„å¾ªç¯ä¸­ï¼Œæ•è·å¼‚å¸¸åè°ƒç”¨äº† <code>Thread.currentThread().interrupt()</code>ï¼Œå¯¼è‡´åç»­çš„é˜»å¡æ“ä½œï¼ˆå¦‚ <code>BlockingQueue.take()</code>ï¼‰æŠ›å‡º <code>InterruptedException</code>ï¼Œå¦‚æœå¼‚å¸¸å¤„ç†ä¸å½“ï¼Œä¼šå¯¼è‡´æ¥æ”¶å¾ªç¯é€€å‡ºã€‚</p><h4 id="é—®é¢˜åˆ†æ-1"><a href="#é—®é¢˜åˆ†æ-1" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h4><p><strong>æ ¹æœ¬åŸå› </strong>ï¼š</p><ol><li><p><strong><code>Thread.interrupt()</code> çš„å·¥ä½œæœºåˆ¶</strong>ï¼š</p><ul><li><code>interrupt()</code> æ–¹æ³•åªæ˜¯<strong>è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½</strong>ï¼Œä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹</li><li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œ<strong>å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</strong>ï¼ˆå¦‚ <code>Thread.sleep()</code>, <code>Object.wait()</code>, <code>BlockingQueue.take()</code> ç­‰ï¼‰ï¼Œè¿™äº›æ“ä½œä¼š<strong>ç«‹å³æŠ›å‡º <code>InterruptedException</code></strong></li><li>æŠ›å‡ºå¼‚å¸¸åï¼Œ<strong>ä¸­æ–­æ ‡å¿—ä½ä¼šè¢«æ¸…é™¤</strong></li></ul></li><li><p><strong>MQæ¥æ”¶ä»£ç çš„å…¸å‹å®ç°</strong>ï¼š</p><ul><li>MQæ¥æ”¶é€šå¸¸ä½¿ç”¨ <code>BlockingQueue.take()</code> æˆ– <code>BlockingQueue.poll(timeout)</code> ç­‰é˜»å¡æ–¹æ³•</li><li>è¿™äº›æ–¹æ³•åœ¨æ”¶åˆ°ä¸­æ–­ä¿¡å·æ—¶ä¼šæŠ›å‡º <code>InterruptedException</code></li><li>å¦‚æœå¼‚å¸¸å¤„ç†ä¸å½“ï¼ˆç›´æ¥returnæˆ–é€€å‡ºå¾ªç¯ï¼‰ï¼Œå°±ä¼šå¯¼è‡´<strong>ä¸å†æ¥æ”¶MQæ¶ˆæ¯</strong></li></ul></li><li><p><strong>é—®é¢˜åœºæ™¯</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ç¤ºä¾‹ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è°ƒç”¨interrupt()</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> messageQueue.take(); <span class="comment">// é˜»å¡ç­‰å¾…æ¶ˆæ¯</span></span><br><span class="line">        processMessage(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        Thread.currentThread().interrupt(); <span class="comment">// è®¾ç½®ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">return</span>; <span class="comment">// âŒ ç›´æ¥é€€å‡ºï¼Œå¯¼è‡´ä¸å†æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä¸ºä»€ä¹ˆä¼šåœæ­¢æ¥æ”¶</strong>ï¼š</p><ul><li>è°ƒç”¨ <code>interrupt()</code> åï¼Œä¸­æ–­æ ‡å¿—è¢«è®¾ç½®</li><li>ä¸‹æ¬¡æ‰§è¡Œ <code>messageQueue.take()</code> æ—¶ï¼Œä¼šç«‹å³æŠ›å‡º <code>InterruptedException</code></li><li>å¦‚æœæ•è·å¼‚å¸¸åç›´æ¥ <code>return</code> æˆ– <code>break</code>ï¼Œå¾ªç¯å°±ä¼šé€€å‡º</li><li><strong>ç»“æœï¼šMQæ¥æ”¶çº¿ç¨‹åœæ­¢å·¥ä½œï¼Œæ— æ³•ç»§ç»­æ¥æ”¶æ¶ˆæ¯</strong></li></ul></li></ol><p><strong>é—®é¢˜ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ä»£ç ï¼šä¼šå¯¼è‡´MQæ¥æ”¶åœæ­¢</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">        processOrder(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥&quot;</span>, e);</span><br><span class="line">        <span class="comment">// âŒ é”™è¯¯ï¼šè°ƒç”¨interrupt()åï¼Œå¦‚æœåç»­æœ‰é˜»å¡æ“ä½œä¼šç«‹å³ä¸­æ–­</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">        <span class="comment">// å¦‚æœè¿™é‡Œç›´æ¥returnï¼Œä¼šå¯¼è‡´ç›‘å¬å™¨åœæ­¢å·¥ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ æ›´ä¸¥é‡çš„é”™è¯¯ï¼šåœ¨å¾ªç¯ä¸­é”™è¯¯ä½¿ç”¨interrupt()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> blockingQueue.take(); <span class="comment">// é˜»å¡ç­‰å¾…</span></span><br><span class="line">            handleMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt(); <span class="comment">// è®¾ç½®ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">            <span class="keyword">return</span>; <span class="comment">// âŒ ç›´æ¥é€€å‡ºï¼Œå¯¼è‡´ä¸å†æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šæ­£ç¡®å¤„ç†ä¸­æ–­å¼‚å¸¸ï¼ˆæ¨èï¼‰</strong></p><p>å¦‚æœç¡®å®éœ€è¦ä¸­æ–­çº¿ç¨‹ï¼Œåº”è¯¥æ­£ç¡®å¤„ç†å¼‚å¸¸ï¼Œå¹¶å…è®¸çº¿ç¨‹æ­£å¸¸é€€å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®åšæ³•1ï¼šå…è®¸çº¿ç¨‹æ­£å¸¸é€€å‡º</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> blockingQueue.take();</span><br><span class="line">            handleMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Œè®©ä¸Šå±‚è°ƒç”¨è€…çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// é€€å‡ºå¾ªç¯ï¼Œå…è®¸çº¿ç¨‹æ­£å¸¸ç»“æŸ</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    log.info(<span class="string">&quot;æ¶ˆæ¯æ¥æ”¶çº¿ç¨‹å·²åœæ­¢&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šä¸ä¸­æ–­çº¿ç¨‹ï¼Œç»§ç»­æ¥æ”¶æ¶ˆæ¯ï¼ˆæ¨èç”¨äºMQåœºæ™¯ï¼‰</strong></p><p>å¯¹äºMQæ¶ˆæ¯æ¥æ”¶åœºæ™¯ï¼Œé€šå¸¸ä¸åº”è¯¥ä¸­æ–­çº¿ç¨‹ï¼Œåº”è¯¥ç»§ç»­æ¥æ”¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®åšæ³•2ï¼šç»§ç»­æ¥æ”¶æ¶ˆæ¯ï¼Œä¸ä¸­æ–­çº¿ç¨‹</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">        processOrder(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥ï¼Œæ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, message, e);</span><br><span class="line">        <span class="comment">// âœ… ä¸è°ƒç”¨interrupt()ï¼Œç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯</span></span><br><span class="line">        <span class="comment">// å¯ä»¥é€‰æ‹©é‡è¯•ã€è®°å½•æ—¥å¿—ã€å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ç­‰</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®åšæ³•3ï¼šåœ¨å¾ªç¯ä¸­ç»§ç»­æ¥æ”¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> blockingQueue.take();</span><br><span class="line">            handleMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆå¦‚æœç¡®å®éœ€è¦ä¸­æ–­ï¼‰</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// âœ… ä½†æ˜¯ç»§ç»­å¾ªç¯ï¼Œä¸é€€å‡ºï¼ˆæˆ–è€…æ ¹æ®ä¸šåŠ¡éœ€æ±‚å†³å®šæ˜¯å¦é€€å‡ºï¼‰</span></span><br><span class="line">            log.warn(<span class="string">&quot;æ¥æ”¶æ¶ˆæ¯æ—¶è¢«ä¸­æ–­ï¼Œç»§ç»­æ¥æ”¶...&quot;</span>);</span><br><span class="line">            <span class="comment">// å¯ä»¥é€‰æ‹©ï¼šbreakï¼ˆé€€å‡ºï¼‰æˆ– continueï¼ˆç»§ç»­ï¼‰</span></span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// ç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ3ï¼šä½¿ç”¨Springçš„MQç›‘å¬å™¨ï¼ˆæœ€ä½³å®è·µï¼‰</strong></p><p>ä½¿ç”¨Springçš„ <code>@RabbitListener</code> æˆ– <code>@KafkaListener</code>ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†å¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æœ€ä½³å®è·µï¼šä½¿ç”¨Springçš„MQç›‘å¬å™¨</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderMessageConsumer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;order.queue&quot;, </span></span><br><span class="line"><span class="meta">                   containerFactory = &quot;rabbitListenerContainerFactory&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleOrderMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">            orderService.processOrder(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// âœ… Springæ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†å¼‚å¸¸ï¼Œä¸ä¼šä¸­æ–­ç›‘å¬å™¨</span></span><br><span class="line">            log.error(<span class="string">&quot;å¤„ç†è®¢å•æ¶ˆæ¯å¤±è´¥ï¼Œæ¶ˆæ¯IDï¼š&#123;&#125;&quot;</span>, message.getId(), e);</span><br><span class="line">            <span class="comment">// å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œè®©Springè¿›è¡Œé‡è¯•æˆ–å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ4ï¼šé…ç½®é‡è¯•å’Œæ­»ä¿¡é˜Ÿåˆ—</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… é…ç½®é‡è¯•æœºåˆ¶å’Œæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RabbitListenerContainerFactory&lt;SimpleMessageListenerContainer&gt; </span><br><span class="line">           <span class="title function_">rabbitListenerContainerFactory</span><span class="params">(ConnectionFactory connectionFactory)</span> &#123;</span><br><span class="line">        <span class="type">SimpleRabbitListenerContainerFactory</span> <span class="variable">factory</span> <span class="operator">=</span> </span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">SimpleRabbitListenerContainerFactory</span>();</span><br><span class="line">        factory.setConnectionFactory(connectionFactory);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é…ç½®é‡è¯•</span></span><br><span class="line">        factory.setAdviceChain(retryInterceptor());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é…ç½®é”™è¯¯å¤„ç†</span></span><br><span class="line">        factory.setErrorHandler(<span class="keyword">new</span> <span class="title class_">ConditionalRejectingErrorHandler</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">FatalExceptionStrategy</span>()</span><br><span class="line">        ));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»éªŒæ€»ç»“-1"><a href="#ç»éªŒæ€»ç»“-1" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h4><p><strong>æ ¸å¿ƒæ•™è®­</strong>ï¼š</p><ol><li><p><strong>ç†è§£ <code>interrupt()</code> çš„ä½œç”¨</strong>ï¼š</p><ul><li>âœ… <code>interrupt()</code> <strong>ä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹</strong>ï¼Œåªæ˜¯è®¾ç½®ä¸­æ–­æ ‡å¿—</li><li>âœ… å¯ä¸­æ–­çš„é˜»å¡æ“ä½œï¼ˆ<code>sleep()</code>, <code>wait()</code>, <code>take()</code> ç­‰ï¼‰ä¼šæŠ›å‡º <code>InterruptedException</code></li><li>âœ… æŠ›å‡ºå¼‚å¸¸åï¼Œ<strong>ä¸­æ–­æ ‡å¿—ä¼šè¢«æ¸…é™¤</strong></li></ul></li><li><p><strong>MQæ¥æ”¶åœºæ™¯çš„å¤„ç†åŸåˆ™</strong>ï¼š</p><ul><li>âœ… <strong>ä¸è¦éšæ„è°ƒç”¨ <code>interrupt()</code></strong>ï¼šMQæ¥æ”¶çº¿ç¨‹é€šå¸¸åº”è¯¥æŒç»­è¿è¡Œ</li><li>âœ… <strong>æ­£ç¡®å¤„ç† <code>InterruptedException</code></strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚å†³å®šæ˜¯ç»§ç»­è¿˜æ˜¯é€€å‡º</li><li>âœ… <strong>ä½¿ç”¨æ¡†æ¶çš„å¼‚å¸¸å¤„ç†æœºåˆ¶</strong>ï¼šSpringçš„MQç›‘å¬å™¨ä¼šè‡ªåŠ¨å¤„ç†å¼‚å¸¸</li></ul></li><li><p><strong>å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šç»§ç»­æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    Thread.currentThread().interrupt(); <span class="comment">// æ¢å¤æ ‡å¿—ï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span><br><span class="line">    <span class="keyword">continue</span>; <span class="comment">// ç»§ç»­æ¥æ”¶</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šå…è®¸çº¿ç¨‹é€€å‡º</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    Thread.currentThread().interrupt(); <span class="comment">// æ¢å¤æ ‡å¿—</span></span><br><span class="line">    <span class="keyword">break</span>; <span class="comment">// é€€å‡ºå¾ªç¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šç›´æ¥returnï¼Œå¯èƒ½å¯¼è‡´èµ„æºæœªé‡Šæ”¾</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="keyword">return</span>; <span class="comment">// ä¸æ¨è</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="comment">// ä»€ä¹ˆéƒ½ä¸åšï¼Œä¸­æ–­æ ‡å¿—è¢«æ¸…é™¤ï¼Œä¸Šå±‚æ— æ³•æ„ŸçŸ¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹</strong>ï¼š</p><ul><li>âš ï¸ æ£€æŸ¥æ˜¯å¦æœ‰åœ¨MQæ¥æ”¶ä»£ç ä¸­è°ƒç”¨ <code>interrupt()</code></li><li>âš ï¸ æ£€æŸ¥ <code>InterruptedException</code> çš„å¤„ç†æ˜¯å¦æ­£ç¡®</li><li>âš ï¸ æ£€æŸ¥å¼‚å¸¸å¤„ç†åæ˜¯å¦ç»§ç»­æ¥æ”¶æ¶ˆæ¯</li><li>âš ï¸ æ£€æŸ¥æ˜¯å¦æœ‰èµ„æºæ³„æ¼ï¼ˆè¿æ¥æœªå…³é—­ç­‰ï¼‰</li></ul></li><li><p><strong>é¢„é˜²æªæ–½</strong>ï¼š</p><ul><li>âœ… ä½¿ç”¨Springçš„MQç›‘å¬å™¨ï¼Œé¿å…æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹</li><li>âœ… å»ºç«‹ä»£ç è§„èŒƒï¼Œç¦æ­¢åœ¨MQæ¥æ”¶ä»£ç ä¸­éšæ„è°ƒç”¨ <code>interrupt()</code></li><li>âœ… æ·»åŠ ç›‘æ§ï¼ŒåŠæ—¶å‘ç°MQæ¥æ”¶åœæ­¢çš„é—®é¢˜</li><li>âœ… å®šæœŸè¿›è¡Œä»£ç å®¡æŸ¥ï¼Œæ£€æŸ¥å¼‚å¸¸å¤„ç†é€»è¾‘</li></ul></li></ol><p><strong>å…³é”®çŸ¥è¯†ç‚¹</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>ä¸­æ–­æ ‡å¿—çŠ¶æ€</th><th>é˜»å¡æ“ä½œè¡Œä¸º</th></tr></thead><tbody><tr><td><strong>æ­£å¸¸æ‰§è¡Œ</strong></td><td><code>false</code></td><td>æ­£å¸¸é˜»å¡ç­‰å¾…</td></tr><tr><td><strong>è°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code></td><td>ç«‹å³æŠ›å‡º <code>InterruptedException</code></td></tr><tr><td><strong>æ•è·å¼‚å¸¸å</strong></td><td><code>false</code>ï¼ˆè¢«æ¸…é™¤ï¼‰</td><td>å¦‚æœç»§ç»­æ‰§è¡Œï¼Œä¼šå†æ¬¡é˜»å¡</td></tr><tr><td><strong>æ•è·å¼‚å¸¸åè°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code>ï¼ˆæ¢å¤ï¼‰</td><td>å¦‚æœç»§ç»­æ‰§è¡Œï¼Œä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸</td></tr></tbody></table><p><strong>æœ€ä½³å®è·µæ€»ç»“</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… æ¨èï¼šMQæ¶ˆæ¯æ¥æ”¶çš„æ ‡å‡†æ¨¡å¼</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. å¤„ç†æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">// 2. å¼‚å¸¸æ—¶è®°å½•æ—¥å¿—ï¼Œä¸ä¸­æ–­çº¿ç¨‹</span></span><br><span class="line">    <span class="comment">// 3. è®©æ¡†æ¶å¤„ç†é‡è¯•å’Œæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šæ‰‹åŠ¨ç®¡ç†æ¥æ”¶å¾ªç¯çš„æ ‡å‡†æ¨¡å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consumeMessages</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> queue.take();</span><br><span class="line">            processMessage(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// æ ¹æ®ä¸šåŠ¡éœ€æ±‚å†³å®šï¼šbreakï¼ˆé€€å‡ºï¼‰æˆ– continueï¼ˆç»§ç»­ï¼‰</span></span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// æˆ– continue</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†ä¸šåŠ¡å¼‚å¸¸ï¼Œä¸ä¸­æ–­çº¿ç¨‹</span></span><br><span class="line">            log.error(<span class="string">&quot;å¤„ç†æ¶ˆæ¯å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ“š-é™„å½•ï¼šThread-currentThread-interrupt-è¯¦è§£"><a href="#ğŸ“š-é™„å½•ï¼šThread-currentThread-interrupt-è¯¦è§£" class="headerlink" title="ğŸ“š é™„å½•ï¼šThread.currentThread().interrupt() è¯¦è§£"></a>ğŸ“š é™„å½•ï¼šThread.currentThread().interrupt() è¯¦è§£</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p><code>Thread.currentThread().interrupt()</code> æ˜¯Javaå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼Œç”¨äº<strong>è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½</strong>ã€‚</p><h3 id="æ ¸å¿ƒä½œç”¨"><a href="#æ ¸å¿ƒä½œç”¨" class="headerlink" title="æ ¸å¿ƒä½œç”¨"></a>æ ¸å¿ƒä½œç”¨</h3><ol><li><p><strong>è®¾ç½®ä¸­æ–­æ ‡å¿—</strong>ï¼š</p><ul><li>è°ƒç”¨ <code>interrupt()</code> ä¼šå°†å½“å‰çº¿ç¨‹çš„<strong>ä¸­æ–­æ ‡å¿—è®¾ç½®ä¸º <code>true</code></strong></li><li>è¿™<strong>ä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹</strong>ï¼Œåªæ˜¯è®¾ç½®ä¸€ä¸ªæ ‡å¿—</li></ul></li><li><p><strong>è§¦å‘å¯ä¸­æ–­çš„é˜»å¡æ“ä½œæŠ›å‡ºå¼‚å¸¸</strong>ï¼š</p><ul><li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œ<strong>å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</strong>ï¼Œè¿™äº›æ“ä½œä¼š<strong>ç«‹å³æŠ›å‡º <code>InterruptedException</code></strong></li><li>æŠ›å‡ºå¼‚å¸¸åï¼Œ<strong>ä¸­æ–­æ ‡å¿—ä¼šè¢«æ¸…é™¤</strong>ï¼ˆå˜ä¸º <code>false</code>ï¼‰</li></ul></li><li><p><strong>é€šçŸ¥çº¿ç¨‹åº”è¯¥åœæ­¢</strong>ï¼š</p><ul><li>è¿™æ˜¯ä¸€ç§<strong>åä½œå¼çš„ä¸­æ–­æœºåˆ¶</strong></li><li>çº¿ç¨‹éœ€è¦<strong>ä¸»åŠ¨æ£€æŸ¥ä¸­æ–­æ ‡å¿—</strong>æˆ–<strong>å¤„ç† <code>InterruptedException</code></strong> æ¥å†³å®šæ˜¯å¦åœæ­¢</li></ul></li></ol><h3 id="å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ"><a href="#å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ" class="headerlink" title="å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ"></a>å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</h3><p>ä»¥ä¸‹æ“ä½œåœ¨æ”¶åˆ°ä¸­æ–­ä¿¡å·æ—¶ä¼šç«‹å³æŠ›å‡º <code>InterruptedException</code>ï¼š</p><table><thead><tr><th>æ“ä½œç±»å‹</th><th>æ–¹æ³•ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>çº¿ç¨‹ä¼‘çœ </strong></td><td><code>Thread.sleep(millis)</code></td><td>çº¿ç¨‹ä¼‘çœ æ—¶è¢«ä¸­æ–­</td></tr><tr><td><strong>å¯¹è±¡ç­‰å¾…</strong></td><td><code>Object.wait()</code>, <code>Object.wait(timeout)</code></td><td>ç­‰å¾…å¯¹è±¡é”æ—¶è¢«ä¸­æ–­</td></tr><tr><td><strong>é˜»å¡é˜Ÿåˆ—</strong></td><td><code>BlockingQueue.take()</code>, <code>BlockingQueue.put()</code></td><td>é˜Ÿåˆ—æ“ä½œæ—¶è¢«ä¸­æ–­</td></tr><tr><td><strong>IOæ“ä½œ</strong></td><td><code>InputStream.read()</code>, <code>ServerSocket.accept()</code></td><td>IOé˜»å¡æ—¶è¢«ä¸­æ–­ï¼ˆæŸäº›å®ç°ï¼‰</td></tr><tr><td><strong>é”æ“ä½œ</strong></td><td><code>Lock.lockInterruptibly()</code></td><td>å¯ä¸­æ–­çš„é”è·å–</td></tr><tr><td><strong>çº¿ç¨‹ç­‰å¾…</strong></td><td><code>Thread.join()</code>, <code>Thread.join(timeout)</code></td><td>ç­‰å¾…çº¿ç¨‹ç»“æŸæ—¶è¢«ä¸­æ–­</td></tr></tbody></table><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><h4 id="åœºæ™¯1ï¼šåœ¨-catch-å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰"><a href="#åœºæ™¯1ï¼šåœ¨-catch-å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰" class="headerlink" title="åœºæ™¯1ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰"></a>åœºæ™¯1ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼ˆæ¨èï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å¯ä¸­æ–­çš„é˜»å¡æ“ä½œ</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            <span class="comment">// æˆ–è€…</span></span><br><span class="line">            <span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> blockingQueue.take();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Œè®©ä¸Šå±‚è°ƒç”¨è€…çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// é€€å‡ºå¾ªç¯ï¼Œå…è®¸çº¿ç¨‹æ­£å¸¸ç»“æŸ</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Ÿ</strong></p><ul><li>æ•è· <code>InterruptedException</code> åï¼Œä¸­æ–­æ ‡å¿—ä¼šè¢«æ¸…é™¤</li><li>å¦‚æœä¸æ¢å¤ï¼Œä¸Šå±‚è°ƒç”¨è€…æ— æ³•çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†</li><li>æ¢å¤æ ‡å¿—å¯ä»¥è®©ä¸Šå±‚ä»£ç æ£€æŸ¥ <code>isInterrupted()</code> æ¥å†³å®šæ˜¯å¦åœæ­¢</li></ul><h4 id="åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"><a href="#åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º" class="headerlink" title="åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"></a>åœºæ™¯2ï¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">longRunningTask</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// å®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;ä»»åŠ¡è¢«ä¸­æ–­ï¼Œé€€å‡º&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        doSomething(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸-éœ€è°¨æ…ï¼‰"><a href="#åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸-éœ€è°¨æ…ï¼‰" class="headerlink" title="åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸ éœ€è°¨æ…ï¼‰"></a>åœºæ™¯3ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­è®¾ç½®ä¸­æ–­ï¼ˆâš ï¸ éœ€è°¨æ…ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        handleMessage(msg);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// âš ï¸ è°¨æ…ä½¿ç”¨ï¼šè¿™ä¼šå½±å“å½“å‰çº¿ç¨‹</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">        log.error(<span class="string">&quot;å¤„ç†å¤±è´¥&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šåœ¨MQæ¥æ”¶ç­‰åœºæ™¯ä¸­ï¼Œé€šå¸¸<strong>ä¸åº”è¯¥</strong>è°ƒç”¨ <code>interrupt()</code>ï¼Œå› ä¸ºä¼šå½±å“åç»­æ¶ˆæ¯æ¥æ”¶ã€‚</p><h3 id="ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–"><a href="#ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–" class="headerlink" title="ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–"></a>ä¸­æ–­æ ‡å¿—çš„çŠ¶æ€å˜åŒ–</h3><table><thead><tr><th>æ“ä½œ</th><th>ä¸­æ–­æ ‡å¿—çŠ¶æ€</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>çº¿ç¨‹å¯åŠ¨</strong></td><td><code>false</code></td><td>åˆå§‹çŠ¶æ€</td></tr><tr><td><strong>è°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code></td><td>è®¾ç½®ä¸­æ–­æ ‡å¿—</td></tr><tr><td><strong>æŠ›å‡º <code>InterruptedException</code></strong></td><td><code>false</code></td><td><strong>å¼‚å¸¸æŠ›å‡ºåæ ‡å¿—è¢«æ¸…é™¤</strong></td></tr><tr><td><strong>æ•è·å¼‚å¸¸åè°ƒç”¨ <code>interrupt()</code></strong></td><td><code>true</code></td><td>æ¢å¤ä¸­æ–­æ ‡å¿—</td></tr></tbody></table><h3 id="å¸¸è§é”™è¯¯ç”¨æ³•"><a href="#å¸¸è§é”™è¯¯ç”¨æ³•" class="headerlink" title="å¸¸è§é”™è¯¯ç”¨æ³•"></a>å¸¸è§é”™è¯¯ç”¨æ³•</h3><h4 id="âŒ-é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—"><a href="#âŒ-é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—" class="headerlink" title="âŒ é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—"></a>âŒ é”™è¯¯1ï¼šåæ‰å¼‚å¸¸ï¼Œä¸æ¢å¤ä¸­æ–­æ ‡å¿—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="comment">// âŒ é”™è¯¯ï¼šä»€ä¹ˆéƒ½ä¸åšï¼Œä¸­æ–­æ ‡å¿—è¢«æ¸…é™¤ï¼Œä¸Šå±‚æ— æ³•æ„ŸçŸ¥</span></span><br><span class="line">    log.warn(<span class="string">&quot;è¢«ä¸­æ–­&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šä¸Šå±‚è°ƒç”¨è€…æ— æ³•çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­äº†ã€‚</p><h4 id="âŒ-é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨"><a href="#âŒ-é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨" class="headerlink" title="âŒ é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨"></a>âŒ é”™è¯¯2ï¼šåœ¨MQæ¥æ”¶ä¸­éšæ„è°ƒç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;order.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(OrderMessage message)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        processOrder(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// âŒ é”™è¯¯ï¼šä¼šå½±å“åç»­æ¶ˆæ¯æ¥æ”¶</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šå¦‚æœåç»­æœ‰é˜»å¡æ“ä½œï¼Œä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸ï¼Œå¯èƒ½å½±å“æ¶ˆæ¯æ¥æ”¶ã€‚</p><h4 id="âŒ-é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ"><a href="#âŒ-é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ" class="headerlink" title="âŒ é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ"></a>âŒ é”™è¯¯3ï¼šä¸æ£€æŸ¥ä¸­æ–­æ ‡å¿—å°±ç»§ç»­æ‰§è¡Œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123; <span class="comment">// âŒ åº”è¯¥æ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// âŒ ç»§ç»­å¾ªç¯ï¼Œä½†ä¸‹æ¬¡sleepä¼šç«‹å³æŠ›å¼‚å¸¸</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šä¼šå½¢æˆæ­»å¾ªç¯ï¼Œæ¯æ¬¡é˜»å¡æ“ä½œéƒ½ç«‹å³æŠ›å¼‚å¸¸ã€‚</p><h3 id="æ­£ç¡®ç”¨æ³•æ€»ç»“"><a href="#æ­£ç¡®ç”¨æ³•æ€»ç»“" class="headerlink" title="æ­£ç¡®ç”¨æ³•æ€»ç»“"></a>æ­£ç¡®ç”¨æ³•æ€»ç»“</h3><h4 id="âœ…-æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"><a href="#âœ…-æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º"></a>âœ… æ­£ç¡®ç”¨æ³•1ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶é€€å‡º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// é˜»å¡æ“ä½œ</span></span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="comment">// âœ… é€€å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âœ…-æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­"><a href="#âœ…-æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­"></a>âœ… æ­£ç¡®ç”¨æ³•2ï¼šæ¢å¤ä¸­æ–­æ ‡å¿—å¹¶å‘ä¸Šä¼ æ’­</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doWork</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        <span class="comment">// âœ… æ¢å¤ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">        <span class="comment">// âœ… é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œè®©ä¸Šå±‚å¤„ç†</span></span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âœ…-æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—"><a href="#âœ…-æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—"></a>âœ… æ­£ç¡®ç”¨æ³•3ï¼šå®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">longRunningTask</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// âœ… å®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</span></span><br><span class="line">        <span class="keyword">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;ä»»åŠ¡è¢«ä¸­æ–­&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        doSomething(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol><li><p><strong>åœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—</strong>ï¼š</p><ul><li>æ•è· <code>InterruptedException</code> åï¼Œåº”è¯¥è°ƒç”¨ <code>interrupt()</code> æ¢å¤æ ‡å¿—</li><li>è¿™æ ·ä¸Šå±‚è°ƒç”¨è€…å¯ä»¥æ£€æŸ¥ <code>isInterrupted()</code> æ¥å†³å®šæ˜¯å¦åœæ­¢</li></ul></li><li><p><strong>ä¸è¦éšæ„è°ƒç”¨ <code>interrupt()</code></strong>ï¼š</p><ul><li>åœ¨MQæ¥æ”¶ã€Webè¯·æ±‚å¤„ç†ç­‰åœºæ™¯ä¸­ï¼Œé€šå¸¸ä¸åº”è¯¥è°ƒç”¨</li><li>åªåœ¨ç¡®å®éœ€è¦ä¸­æ–­çº¿ç¨‹æ—¶æ‰è°ƒç”¨</li></ul></li><li><p><strong>æ£€æŸ¥ä¸­æ–­æ ‡å¿—</strong>ï¼š</p><ul><li>åœ¨é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ä¸­ï¼Œå®šæœŸæ£€æŸ¥ <code>isInterrupted()</code></li><li>ä½¿ç”¨ <code>while (!Thread.currentThread().isInterrupted())</code> è€Œä¸æ˜¯ <code>while (true)</code></li></ul></li><li><p><strong>æ­£ç¡®å¤„ç†å¼‚å¸¸</strong>ï¼š</p><ul><li>ä¸è¦åæ‰ <code>InterruptedException</code></li><li>è¦ä¹ˆæ¢å¤æ ‡å¿—å¹¶é€€å‡ºï¼Œè¦ä¹ˆé‡æ–°æŠ›å‡ºå¼‚å¸¸</li></ul></li></ol><h3 id="ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”"><a href="#ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”" class="headerlink" title="ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”"></a>ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯”</h3><table><thead><tr><th>æ–¹æ³•</th><th>ä½œç”¨</th><th>æ˜¯å¦åœæ­¢çº¿ç¨‹</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong><code>interrupt()</code></strong></td><td>è®¾ç½®ä¸­æ–­æ ‡å¿—</td><td>âŒ ä¸ç«‹å³åœæ­¢</td><td>åä½œå¼ä¸­æ–­ï¼Œé€šçŸ¥çº¿ç¨‹åº”è¯¥åœæ­¢</td></tr><tr><td><strong><code>stop()</code></strong></td><td>å¼ºåˆ¶åœæ­¢çº¿ç¨‹</td><td>âœ… ç«‹å³åœæ­¢</td><td>âš ï¸ <strong>å·²åºŸå¼ƒ</strong>ï¼Œä¸å®‰å…¨</td></tr><tr><td><strong><code>suspend()</code></strong></td><td>æš‚åœçº¿ç¨‹</td><td>â¸ï¸ æš‚åœ</td><td>âš ï¸ <strong>å·²åºŸå¼ƒ</strong>ï¼Œå®¹æ˜“æ­»é”</td></tr><tr><td><strong><code>resume()</code></strong></td><td>æ¢å¤çº¿ç¨‹</td><td>â–¶ï¸ æ¢å¤</td><td>âš ï¸ <strong>å·²åºŸå¼ƒ</strong>ï¼Œé…åˆsuspendä½¿ç”¨</td></tr></tbody></table><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>âœ… <strong>ä½œç”¨</strong>ï¼šè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ï¼Œè§¦å‘å¯ä¸­æ–­çš„é˜»å¡æ“ä½œæŠ›å‡ºå¼‚å¸¸</li><li>âœ… <strong>ç‰¹ç‚¹</strong>ï¼šä¸ä¼šç«‹å³åœæ­¢çº¿ç¨‹ï¼Œæ˜¯åä½œå¼çš„ä¸­æ–­æœºåˆ¶</li><li>âœ… <strong>ä½¿ç”¨</strong>ï¼šåœ¨ catch å—ä¸­æ¢å¤ä¸­æ–­æ ‡å¿—ï¼Œè®©ä¸Šå±‚çŸ¥é“çº¿ç¨‹è¢«ä¸­æ–­</li><li>âš ï¸ <strong>æ³¨æ„</strong>ï¼šä¸è¦éšæ„è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨MQæ¥æ”¶ç­‰æŒç»­è¿è¡Œçš„åœºæ™¯ä¸­</li><li>âœ… <strong>æœ€ä½³å®è·µ</strong>ï¼šæ¢å¤æ ‡å¿—å¹¶é€€å‡ºï¼Œæˆ–å®šæœŸæ£€æŸ¥ä¸­æ–­æ ‡å¿—</li></ul><hr><h2 id="ğŸ™-è‡´è°¢"><a href="#ğŸ™-è‡´è°¢" class="headerlink" title="ğŸ™ è‡´è°¢"></a>ğŸ™ è‡´è°¢</h2><p>æ„Ÿè°¢æ‰€æœ‰åœ¨é—®é¢˜æ’æŸ¥è¿‡ç¨‹ä¸­æä¾›å¸®åŠ©çš„åŒäº‹å’Œæœ‹å‹ä»¬ã€‚</p><hr><h2 id="ğŸ“„-ç‰ˆæƒå£°æ˜"><a href="#ğŸ“„-ç‰ˆæƒå£°æ˜" class="headerlink" title="ğŸ“„ ç‰ˆæƒå£°æ˜"></a>ğŸ“„ ç‰ˆæƒå£°æ˜</h2><p>æœ¬æ–‡æ¡£é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œè®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bug </tag>
            
            <tag> é—®é¢˜æ’æŸ¥ </tag>
            
            <tag> æ•…éšœåˆ†æ </tag>
            
            <tag> ç»éªŒæ€»ç»“ </tag>
            
            <tag> æŠ€æœ¯å¤ç›˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜</title>
      <link href="//redis-learning-guide/"/>
      <url>//redis-learning-guide/</url>
      
        <content type="html"><![CDATA[<h1 id="Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å—-ä»å…¥é—¨åˆ°å®æˆ˜-ğŸš€"><a href="#Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å—-ä»å…¥é—¨åˆ°å®æˆ˜-ğŸš€" class="headerlink" title="Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜ ğŸš€"></a>Redisä¸­é—´ä»¶å­¦ä¹ æŒ‡å— - ä»å…¥é—¨åˆ°å®æˆ˜ ğŸš€</h1><blockquote><p>Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ã€åŸºäºå†…å­˜çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚æœ¬æŒ‡å—å°†å¸¦ä½ å…¨é¢å­¦ä¹ Redisï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼ŒæŒæ¡è¿™ä¸ªå¼ºå¤§çš„ä¸­é—´ä»¶ï¼ğŸ’¾</p></blockquote><p><img src="/images/redis/cover.png" alt="Rediså­¦ä¹ æŒ‡å—"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><ul><li><p><a href="#1-redis%E7%AE%80%E4%BB%8B">1. Redisç®€ä»‹</a></p><ul><li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AFredis">1.1 ä»€ä¹ˆæ˜¯Redis</a></li><li><a href="#12-redis%E7%9A%84%E7%89%B9%E7%82%B9">1.2 Redisçš„ç‰¹ç‚¹</a></li><li><a href="#13-redis%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">1.3 Redisçš„åº”ç”¨åœºæ™¯</a></li><li><a href="#14-redis-vs-%E5%85%B6%E4%BB%96%E7%BC%93%E5%AD%98">1.4 Redis vs å…¶ä»–ç¼“å­˜</a></li></ul></li><li><p><a href="#2-redis%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE">2. Rediså®‰è£…ä¸é…ç½®</a></p><ul><li><a href="#21-linux%E5%AE%89%E8%A3%85">2.1 Linuxå®‰è£…</a></li><li><a href="#22-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE">2.2 åŸºç¡€é…ç½®</a></li></ul></li><li><p><a href="#3-redis%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">3. RedisåŸºç¡€æ•°æ®ç±»å‹</a></p><ul><li><a href="#31-redis%E9%94%AEkey%E9%80%9A%E7%94%A8%E5%91%BD%E4%BB%A4">3.1 Redisé”®(key)é€šç”¨å‘½ä»¤</a></li><li><a href="#32-string%E5%AD%97%E7%AC%A6%E4%B8%B2">3.2 Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</a></li><li><a href="#33-hash%E5%93%88%E5%B8%8C">3.3 Hashï¼ˆå“ˆå¸Œï¼‰</a></li><li><a href="#34-list%E5%88%97%E8%A1%A8">3.4 Listï¼ˆåˆ—è¡¨ï¼‰</a></li><li><a href="#35-set%E9%9B%86%E5%90%88">3.5 Setï¼ˆé›†åˆï¼‰</a></li><li><a href="#36-zset%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88">3.6 ZSetï¼ˆæœ‰åºé›†åˆï¼‰</a></li></ul></li><li><p><a href="#4-redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3">4. Redisé…ç½®æ–‡ä»¶è¯¦è§£</a></p><ul><li><a href="#41-units%E5%8D%95%E4%BD%8D">4.1 Unitsï¼ˆå•ä½ï¼‰</a></li><li><a href="#42-includes%E5%8C%85%E5%90%AB">4.2 INCLUDESï¼ˆåŒ…å«ï¼‰</a></li><li><a href="#43-network%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE">4.3 NETWORKï¼ˆç½‘ç»œé…ç½®ï¼‰</a></li><li><a href="#44-general%E9%80%9A%E7%94%A8%E9%85%8D%E7%BD%AE">4.4 GENERALï¼ˆé€šç”¨é…ç½®ï¼‰</a></li><li><a href="#45-security%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE">4.5 SECURITYï¼ˆå®‰å…¨é…ç½®ï¼‰</a></li><li><a href="#46-limits%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE">4.6 LIMITSï¼ˆé™åˆ¶é…ç½®ï¼‰</a></li></ul></li><li><p><a href="#5-redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85pubsub">5. Rediså‘å¸ƒè®¢é˜…ï¼ˆPub&#x2F;Subï¼‰</a></p><ul><li><a href="#51-%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85">5.1 ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…</a></li><li><a href="#52-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F">5.2 å‘å¸ƒè®¢é˜…æ¨¡å¼</a></li><li><a href="#53-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">5.3 å¸¸ç”¨å‘½ä»¤</a></li><li><a href="#54-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B">5.4 ä½¿ç”¨ç¤ºä¾‹</a></li><li><a href="#55-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">5.5 åº”ç”¨åœºæ™¯</a></li><li><a href="#56-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">5.6 æ³¨æ„äº‹é¡¹</a></li><li><a href="#57-%E5%AF%B9%E6%AF%94%E5%85%B6%E4%BB%96%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6">5.7 å¯¹æ¯”å…¶ä»–æ¶ˆæ¯æœºåˆ¶</a></li><li><a href="#58-%E5%AE%9E%E6%88%98%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8Bjava">5.8 å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</a></li></ul></li><li><p><a href="#6-redis%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">6. Redisé«˜çº§æ•°æ®ç±»å‹</a></p><ul><li><a href="#61-bitmap%E4%BD%8D%E5%9B%BE">6.1 Bitmapï¼ˆä½å›¾ï¼‰</a></li><li><a href="#62-hyperloglog%E5%9F%BA%E6%95%B0%E7%BB%9F%E8%AE%A1">6.2 HyperLogLogï¼ˆåŸºæ•°ç»Ÿè®¡ï¼‰</a></li><li><a href="#63-geo%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE">6.3 GEOï¼ˆåœ°ç†ä½ç½®ï¼‰</a></li><li><a href="#64-stream%E6%B5%81">6.4 Streamï¼ˆæµï¼‰</a></li></ul></li><li><p><a href="#7-redis%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%94%81%E6%9C%BA%E5%88%B6">7. Redisäº‹åŠ¡ä¸é”æœºåˆ¶</a></p><ul><li><a href="#71-%E4%BB%80%E4%B9%88%E6%98%AFredis%E4%BA%8B%E5%8A%A1">7.1 ä»€ä¹ˆæ˜¯Redisäº‹åŠ¡</a></li><li><a href="#72-redis%E4%BA%8B%E5%8A%A1%E5%91%BD%E4%BB%A4">7.2 Redisäº‹åŠ¡å‘½ä»¤</a></li><li><a href="#73-redis%E4%BA%8B%E5%8A%A1%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B">7.3 Redisäº‹åŠ¡æ‰§è¡Œæµç¨‹</a></li><li><a href="#74-%E4%BA%8B%E5%8A%A1%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">7.4 äº‹åŠ¡é”™è¯¯å¤„ç†</a></li><li><a href="#75-%E4%BA%8B%E5%8A%A1%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">7.5 äº‹åŠ¡å†²çªé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li><li><a href="#76-redis%E4%BA%8B%E5%8A%A1%E4%B8%89%E5%A4%A7%E7%89%B9%E6%80%A7">7.6 Redisäº‹åŠ¡ä¸‰å¤§ç‰¹æ€§</a></li><li><a href="#77-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8Bredis%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F">7.7 å®æˆ˜æ¡ˆä¾‹ï¼šRedisç§’æ€ç³»ç»Ÿ</a></li><li><a href="#78-redis%E4%BA%8B%E5%8A%A1%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">7.8 Redisäº‹åŠ¡æœ€ä½³å®è·µ</a></li><li><a href="#79-%E6%80%BB%E7%BB%93">7.9 æ€»ç»“</a></li></ul></li><li><p><a href="#8-redis%E6%8C%81%E4%B9%85%E5%8C%96">8. RedisæŒä¹…åŒ–</a></p><ul><li><a href="#81-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%81%E4%B9%85%E5%8C%96">8.1 ä»€ä¹ˆæ˜¯æŒä¹…åŒ–</a></li><li><a href="#82-rdb%E6%8C%81%E4%B9%85%E5%8C%96">8.2 RDBæŒä¹…åŒ–</a><ul><li><a href="#821-%E4%BB%80%E4%B9%88%E6%98%AFrdb">8.2.1 ä»€ä¹ˆæ˜¯RDB</a></li><li><a href="#822-rdb%E6%8C%81%E4%B9%85%E5%8C%96%E6%B5%81%E7%A8%8B">8.2.2 RDBæŒä¹…åŒ–æµç¨‹</a></li><li><a href="#823-fork%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3">8.2.3 Forkæœºåˆ¶è¯¦è§£</a></li><li><a href="#824-rdb%E8%A7%A6%E5%8F%91%E6%96%B9%E5%BC%8F">8.2.4 RDBè§¦å‘æ–¹å¼</a></li><li><a href="#825-rdb%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3">8.2.5 RDBé…ç½®è¯¦è§£</a></li><li><a href="#826-rdb%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D">8.2.6 RDBå¤‡ä»½ä¸æ¢å¤</a></li><li><a href="#827-rdb%E4%BC%98%E7%BC%BA%E7%82%B9%E5%88%86%E6%9E%90">8.2.7 RDBä¼˜ç¼ºç‚¹åˆ†æ</a></li><li><a href="#828-%E5%8A%A8%E6%80%81%E5%81%9C%E6%AD%A2rdb">8.2.8 åŠ¨æ€åœæ­¢RDB</a></li></ul></li><li><a href="#83-aof%E6%8C%81%E4%B9%85%E5%8C%96">8.3 AOFæŒä¹…åŒ–</a><ul><li><a href="#831-%E4%BB%80%E4%B9%88%E6%98%AFaof">8.3.1 ä»€ä¹ˆæ˜¯AOF</a></li><li><a href="#832-aof%E6%8C%81%E4%B9%85%E5%8C%96%E6%B5%81%E7%A8%8B">8.3.2 AOFæŒä¹…åŒ–æµç¨‹</a></li><li><a href="#833-aof%E9%85%8D%E7%BD%AE">8.3.3 AOFé…ç½®</a></li><li><a href="#834-aof%E9%87%8D%E5%86%99rewrite">8.3.4 AOFé‡å†™ï¼ˆRewriteï¼‰</a></li><li><a href="#835-aof%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D">8.3.5 AOFå¤‡ä»½ä¸æ¢å¤</a></li><li><a href="#836-aof%E4%BC%98%E7%BC%BA%E7%82%B9%E5%88%86%E6%9E%90">8.3.6 AOFä¼˜ç¼ºç‚¹åˆ†æ</a></li></ul></li><li><a href="#84-%E6%B7%B7%E5%90%88%E6%8C%81%E4%B9%85%E5%8C%96redis-40">8.4 æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰</a><ul><li><a href="#841-%E4%BB%80%E4%B9%88%E6%98%AF%E6%B7%B7%E5%90%88%E6%8C%81%E4%B9%85%E5%8C%96">8.4.1 ä»€ä¹ˆæ˜¯æ··åˆæŒä¹…åŒ–</a></li><li><a href="#842-%E6%B7%B7%E5%90%88%E6%8C%81%E4%B9%85%E5%8C%96%E9%85%8D%E7%BD%AE">8.4.2 æ··åˆæŒä¹…åŒ–é…ç½®</a></li><li><a href="#843-%E6%B7%B7%E5%90%88%E6%8C%81%E4%B9%85%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B">8.4.3 æ··åˆæŒä¹…åŒ–å·¥ä½œæµç¨‹</a></li><li><a href="#844-%E6%B7%B7%E5%90%88%E6%8C%81%E4%B9%85%E5%8C%96%E4%BC%98%E5%8A%BF">8.4.4 æ··åˆæŒä¹…åŒ–ä¼˜åŠ¿</a></li></ul></li><li><a href="#85-%E6%8C%81%E4%B9%85%E5%8C%96%E7%AD%96%E7%95%A5%E9%80%89%E6%8B%A9">8.5 æŒä¹…åŒ–ç­–ç•¥é€‰æ‹©</a><ul><li><a href="#851-rdb-vs-aof-vs-%E6%B7%B7%E5%90%88%E6%8C%81%E4%B9%85%E5%8C%96">8.5.1 RDB vs AOF vs æ··åˆæŒä¹…åŒ–</a></li><li><a href="#852-%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE">8.5.2 é€‰æ‹©å»ºè®®</a></li><li><a href="#853-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%8E%A8%E8%8D%90%E9%85%8D%E7%BD%AE">8.5.3 ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®</a></li><li><a href="#854-%E6%8C%81%E4%B9%85%E5%8C%96%E7%9B%91%E6%8E%A7">8.5.4 æŒä¹…åŒ–ç›‘æ§</a></li><li><a href="#855-%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">8.5.5 æŒä¹…åŒ–æœ€ä½³å®è·µ</a></li></ul></li><li><a href="#86-%E6%80%BB%E7%BB%93">8.6 æ€»ç»“</a></li></ul></li><li><p><a href="#9-redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">9. Redisä¸»ä»å¤åˆ¶</a></p><ul><li><a href="#91-%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">9.1 ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶</a><ul><li><a href="#911-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%AE%9A%E4%B9%89">9.1.1 ä¸»ä»å¤åˆ¶å®šä¹‰</a></li><li><a href="#912-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%9A%84%E4%BC%98%E5%8A%BF">9.1.2 ä¸»ä»å¤åˆ¶çš„ä¼˜åŠ¿</a></li><li><a href="#913-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">9.1.3 ä¸»ä»å¤åˆ¶åº”ç”¨åœºæ™¯</a></li></ul></li><li><a href="#92-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86">9.2 ä¸»ä»å¤åˆ¶åŸç†</a><ul><li><a href="#921-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%B5%81%E7%A8%8B">9.2.1 ä¸»ä»å¤åˆ¶æµç¨‹</a></li><li><a href="#922-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5">9.2.2 ä¸»ä»å¤åˆ¶ä¸‰ä¸ªé˜¶æ®µ</a></li><li><a href="#923-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%91%BD%E4%BB%A4">9.2.3 ä¸»ä»å¤åˆ¶å‘½ä»¤</a></li><li><a href="#924-%E5%A4%8D%E5%88%B6%E5%81%8F%E7%A7%BB%E9%87%8F">9.2.4 å¤åˆ¶åç§»é‡</a></li><li><a href="#925-%E5%A4%8D%E5%88%B6%E7%A7%AF%E5%8E%8B%E7%BC%93%E5%86%B2%E5%8C%BA">9.2.5 å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</a></li></ul></li><li><a href="#93-%E9%85%8D%E7%BD%AE%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">9.3 é…ç½®ä¸»ä»å¤åˆ¶</a><ul><li><a href="#931-%E6%96%B9%E5%BC%8F1%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%96%B9%E5%BC%8F%E6%8E%A8%E8%8D%90">9.3.1 æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰</a></li><li><a href="#932-%E6%96%B9%E5%BC%8F2%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%96%B9%E5%BC%8F%E4%B8%B4%E6%97%B6">9.3.2 æ–¹å¼2ï¼šå‘½ä»¤è¡Œæ–¹å¼ï¼ˆä¸´æ—¶ï¼‰</a></li><li><a href="#933-%E6%96%B9%E5%BC%8F3%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0%E6%96%B9%E5%BC%8F">9.3.3 æ–¹å¼3ï¼šå¯åŠ¨å‚æ•°æ–¹å¼</a></li><li><a href="#934-%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E%E9%85%8D%E7%BD%AE">9.3.4 ä¸€ä¸»å¤šä»é…ç½®</a></li><li><a href="#935-%E7%BA%A7%E8%81%94%E5%A4%8D%E5%88%B6%E4%B8%BB-%E4%BB%8E-%E4%BB%8E">9.3.5 çº§è”å¤åˆ¶ï¼ˆä¸»-ä»-ä»ï¼‰</a></li></ul></li><li><a href="#94-%E5%85%A8%E9%87%8F%E5%A4%8D%E5%88%B6%E4%B8%8E%E5%A2%9E%E9%87%8F%E5%A4%8D%E5%88%B6">9.4 å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶</a><ul><li><a href="#941-%E5%85%A8%E9%87%8F%E5%A4%8D%E5%88%B6full-replication">9.4.1 å…¨é‡å¤åˆ¶ï¼ˆFull Replicationï¼‰</a></li><li><a href="#942-%E5%A2%9E%E9%87%8F%E5%A4%8D%E5%88%B6partial-replication">9.4.2 å¢é‡å¤åˆ¶ï¼ˆPartial Replicationï¼‰</a></li><li><a href="#943-%E5%85%A8%E9%87%8F%E5%A4%8D%E5%88%B6-vs-%E5%A2%9E%E9%87%8F%E5%A4%8D%E5%88%B6">9.4.3 å…¨é‡å¤åˆ¶ vs å¢é‡å¤åˆ¶</a></li><li><a href="#944-%E6%97%A0%E7%9B%98%E5%A4%8D%E5%88%B6diskless-replication">9.4.4 æ— ç›˜å¤åˆ¶ï¼ˆDiskless Replicationï¼‰</a></li></ul></li><li><a href="#95-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">9.5 ä¸»ä»å¤åˆ¶æ³¨æ„äº‹é¡¹</a><ul><li><a href="#951-%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7">9.5.1 æ•°æ®ä¸€è‡´æ€§</a></li><li><a href="#952-%E4%B8%BB%E4%BB%8E%E5%88%87%E6%8D%A2">9.5.2 ä¸»ä»åˆ‡æ¢</a></li><li><a href="#953-%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E9%A3%8E%E9%99%A9">9.5.3 æ•°æ®ä¸¢å¤±é£é™©</a></li><li><a href="#954-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">9.5.4 æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="#955-%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE">9.5.5 å®‰å…¨é…ç½®</a></li><li><a href="#956-%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87">9.5.6 ç›‘æ§æŒ‡æ ‡</a></li></ul></li><li><a href="#96-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">9.6 å®æˆ˜æ¡ˆä¾‹</a><ul><li><a href="#961-%E6%A1%88%E4%BE%8B1%E4%B8%80%E4%B8%BB%E4%BA%8C%E4%BB%8E%E6%9E%B6%E6%9E%84">9.6.1 æ¡ˆä¾‹1ï¼šä¸€ä¸»äºŒä»æ¶æ„</a></li><li><a href="#962-%E6%A1%88%E4%BE%8B2%E4%B8%BB%E4%BB%8E%E5%88%87%E6%8D%A2%E6%BC%94%E7%BB%83">9.6.2 æ¡ˆä¾‹2ï¼šä¸»ä»åˆ‡æ¢æ¼”ç»ƒ</a></li><li><a href="#963-%E6%A1%88%E4%BE%8B3%E7%BA%A7%E8%81%94%E5%A4%8D%E5%88%B6%E6%9E%B6%E6%9E%84">9.6.3 æ¡ˆä¾‹3ï¼šçº§è”å¤åˆ¶æ¶æ„</a></li></ul></li><li><a href="#97-%E6%80%BB%E7%BB%93">9.7 æ€»ç»“</a></li></ul></li><li><p><a href="#10-redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F">10. Rediså“¨å…µæ¨¡å¼</a></p><ul><li><a href="#101-%E4%BB%80%E4%B9%88%E6%98%AF%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F">10.1 ä»€ä¹ˆæ˜¯å“¨å…µæ¨¡å¼</a><ul><li><a href="#1011-%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89">10.1.1 å“¨å…µæ¨¡å¼å®šä¹‰</a></li><li><a href="#1012-%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F%E6%9E%B6%E6%9E%84">10.1.2 å“¨å…µæ¨¡å¼æ¶æ„</a></li><li><a href="#1013-%E5%93%A8%E5%85%B5%E7%9A%84%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD">10.1.3 å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½</a></li><li><a href="#1014-%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F-vs-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">10.1.4 å“¨å…µæ¨¡å¼ vs ä¸»ä»å¤åˆ¶</a></li></ul></li><li><a href="#102-%E5%93%A8%E5%85%B5%E9%85%8D%E7%BD%AE">10.2 å“¨å…µé…ç½®</a><ul><li><a href="#1021-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE">10.2.1 åŸºæœ¬é…ç½®</a></li><li><a href="#1022-%E5%90%AF%E5%8A%A8%E5%93%A8%E5%85%B5">10.2.2 å¯åŠ¨å“¨å…µ</a></li><li><a href="#1023-%E5%A4%9A%E5%93%A8%E5%85%B5%E9%85%8D%E7%BD%AE">10.2.3 å¤šå“¨å…µé…ç½®</a></li><li><a href="#1024-%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE">10.2.4 é«˜çº§é…ç½®</a></li></ul></li><li><a href="#103-%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB">10.3 æ•…éšœè½¬ç§»</a><ul><li><a href="#1031-%E6%95%85%E9%9A%9C%E6%A3%80%E6%B5%8B">10.3.1 æ•…éšœæ£€æµ‹</a></li><li><a href="#1032-%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB%E6%B5%81%E7%A8%8B">10.3.2 æ•…éšœè½¬ç§»æµç¨‹</a></li><li><a href="#1033-%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB%E7%A4%BA%E4%BE%8B">10.3.3 æ•…éšœè½¬ç§»ç¤ºä¾‹</a></li><li><a href="#1034-%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D">10.3.4 æ•…éšœæ¢å¤</a></li></ul></li><li><a href="#104-%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4">10.4 å“¨å…µé›†ç¾¤</a><ul><li><a href="#1041-%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84">10.4.1 å“¨å…µé›†ç¾¤æ¶æ„</a></li><li><a href="#1042-%E5%93%A8%E5%85%B5%E8%87%AA%E5%8A%A8%E5%8F%91%E7%8E%B0">10.4.2 å“¨å…µè‡ªåŠ¨å‘ç°</a></li><li><a href="#1043-%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE">10.4.3 å“¨å…µé›†ç¾¤é…ç½®</a></li></ul></li><li><a href="#105-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5">10.5 å®¢æˆ·ç«¯è¿æ¥</a><ul><li><a href="#1051-java%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5">10.5.1 Javaå®¢æˆ·ç«¯è¿æ¥</a></li><li><a href="#1052-python%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5">10.5.2 Pythonå®¢æˆ·ç«¯è¿æ¥</a></li></ul></li><li><a href="#106-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">10.6 å®æˆ˜æ¡ˆä¾‹</a><ul><li><a href="#1061-%E6%A1%88%E4%BE%8B1%E4%B8%89%E5%93%A8%E5%85%B5%E4%B8%80%E4%B8%BB%E4%BA%8C%E4%BB%8E%E6%9E%B6%E6%9E%84">10.6.1 æ¡ˆä¾‹1ï¼šä¸‰å“¨å…µä¸€ä¸»äºŒä»æ¶æ„</a></li><li><a href="#1062-%E6%A1%88%E4%BE%8B2%E5%93%A8%E5%85%B5%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC">10.6.2 æ¡ˆä¾‹2ï¼šå“¨å…µç›‘æ§è„šæœ¬</a></li></ul></li><li><a href="#107-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">10.7 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</a><ul><li><a href="#1071-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">10.7.1 æ³¨æ„äº‹é¡¹</a></li><li><a href="#1072-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">10.7.2 æœ€ä½³å®è·µ</a></li></ul></li><li><a href="#108-%E6%80%BB%E7%BB%93">10.8 æ€»ç»“</a></li></ul></li><li><p><a href="#11-redis%E9%9B%86%E7%BE%A4">11. Redisé›†ç¾¤</a></p><ul><li><a href="#111-%E4%BB%80%E4%B9%88%E6%98%AFredis%E9%9B%86%E7%BE%A4">11.1 ä»€ä¹ˆæ˜¯Redisé›†ç¾¤</a><ul><li><a href="#1111-%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89">11.1.1 é›†ç¾¤æ¨¡å¼å®šä¹‰</a></li><li><a href="#1112-%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84">11.1.2 é›†ç¾¤æ¶æ„</a></li><li><a href="#1113-%E9%9B%86%E7%BE%A4-vs-%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F">11.1.3 é›†ç¾¤ vs å“¨å…µæ¨¡å¼</a></li></ul></li><li><a href="#112-%E6%95%B0%E6%8D%AE%E5%88%86%E7%89%87%E5%93%88%E5%B8%8C%E6%A7%BD">11.2 æ•°æ®åˆ†ç‰‡ï¼ˆå“ˆå¸Œæ§½ï¼‰</a><ul><li><a href="#1121-%E4%BB%80%E4%B9%88%E6%98%AF%E5%93%88%E5%B8%8C%E6%A7%BD">11.2.1 ä»€ä¹ˆæ˜¯å“ˆå¸Œæ§½</a></li><li><a href="#1122-%E9%94%AE%E5%80%BC%E5%AF%B9%E8%B7%AF%E7%94%B1">11.2.2 é”®å€¼å¯¹è·¯ç”±</a></li><li><a href="#1123-%E5%93%88%E5%B8%8C%E6%A0%87%E7%AD%BEhash-tags">11.2.3 å“ˆå¸Œæ ‡ç­¾ï¼ˆHash Tagsï¼‰</a></li></ul></li><li><a href="#113-%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA">11.3 é›†ç¾¤æ­å»º</a><ul><li><a href="#1131-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">11.3.1 å‡†å¤‡å·¥ä½œ</a></li><li><a href="#1132-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">11.3.2 é…ç½®æ–‡ä»¶</a></li><li><a href="#1133-%E5%90%AF%E5%8A%A8%E8%8A%82%E7%82%B9">11.3.3 å¯åŠ¨èŠ‚ç‚¹</a></li><li><a href="#1134-%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4">11.3.4 åˆ›å»ºé›†ç¾¤</a></li><li><a href="#1135-%E9%AA%8C%E8%AF%81%E9%9B%86%E7%BE%A4">11.3.5 éªŒè¯é›†ç¾¤</a></li></ul></li><li><a href="#114-%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9">11.4 é›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹</a><ul><li><a href="#1141-%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9">11.4.1 é›†ç¾¤æ‰©å®¹</a></li><li><a href="#1142-%E9%9B%86%E7%BE%A4%E7%BC%A9%E5%AE%B9">11.4.2 é›†ç¾¤ç¼©å®¹</a></li><li><a href="#1143-%E6%A7%BD%E4%BD%8D%E8%BF%81%E7%A7%BB">11.4.3 æ§½ä½è¿ç§»</a></li></ul></li><li><a href="#115-%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB">11.5 æ•…éšœè½¬ç§»</a><ul><li><a href="#1151-%E8%87%AA%E5%8A%A8%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB">11.5.1 è‡ªåŠ¨æ•…éšœè½¬ç§»</a></li><li><a href="#1152-%E6%89%8B%E5%8A%A8%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB">11.5.2 æ‰‹åŠ¨æ•…éšœè½¬ç§»</a></li></ul></li><li><a href="#116-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5">11.6 å®¢æˆ·ç«¯è¿æ¥</a><ul><li><a href="#1161-java%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5">11.6.1 Javaå®¢æˆ·ç«¯è¿æ¥</a></li><li><a href="#1162-python%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5">11.6.2 Pythonå®¢æˆ·ç«¯è¿æ¥</a></li></ul></li><li><a href="#117-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">11.7 å®æˆ˜æ¡ˆä¾‹</a><ul><li><a href="#1171-%E6%A1%88%E4%BE%8B16%E8%8A%82%E7%82%B9%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA">11.7.1 æ¡ˆä¾‹1ï¼š6èŠ‚ç‚¹é›†ç¾¤æ­å»º</a></li><li><a href="#1172-%E6%A1%88%E4%BE%8B2%E9%9B%86%E7%BE%A4%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC">11.7.2 æ¡ˆä¾‹2ï¼šé›†ç¾¤ç›‘æ§è„šæœ¬</a></li></ul></li><li><a href="#118-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">11.8 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</a><ul><li><a href="#1181-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">11.8.1 æ³¨æ„äº‹é¡¹</a></li><li><a href="#1182-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">11.8.2 æœ€ä½³å®è·µ</a></li></ul></li><li><a href="#119-%E6%80%BB%E7%BB%93">11.9 æ€»ç»“</a></li></ul></li><li><p><a href="#12-redis%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8">12. Rediså®æˆ˜åº”ç”¨</a></p><ul><li><a href="#121-%E7%BC%93%E5%AD%98%E8%AE%BE%E8%AE%A1">12.1 ç¼“å­˜è®¾è®¡</a><ul><li><a href="#1211-%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5">12.1.1 ç¼“å­˜ç­–ç•¥</a></li><li><a href="#1212-%E7%BC%93%E5%AD%98%E6%9B%B4%E6%96%B0%E7%AD%96%E7%95%A5">12.1.2 ç¼“å­˜æ›´æ–°ç­–ç•¥</a></li><li><a href="#1213-%E7%BC%93%E5%AD%98%E9%A2%84%E7%83%AD">12.1.3 ç¼“å­˜é¢„çƒ­</a></li></ul></li><li><a href="#122-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">12.2 åˆ†å¸ƒå¼é”</a><ul><li><a href="#1221-%E5%9F%BA%E4%BA%8Esetnx%E5%AE%9E%E7%8E%B0">12.2.1 åŸºäºSETNXå®ç°</a></li><li><a href="#1222-redisson%E5%AE%9E%E7%8E%B0%E6%8E%A8%E8%8D%90">12.2.2 Redissonå®ç°ï¼ˆæ¨èï¼‰</a></li></ul></li><li><a href="#123-%E5%BB%B6%E6%97%B6%E9%98%9F%E5%88%97">12.3 å»¶æ—¶é˜Ÿåˆ—</a><ul><li><a href="#1231-%E5%9F%BA%E4%BA%8Ezset%E5%AE%9E%E7%8E%B0">12.3.1 åŸºäºZSetå®ç°</a></li><li><a href="#1232-%E5%9F%BA%E4%BA%8Elist%E5%AE%9E%E7%8E%B0">12.3.2 åŸºäºListå®ç°</a></li></ul></li><li><a href="#124-%E6%8E%92%E8%A1%8C%E6%A6%9C">12.4 æ’è¡Œæ¦œ</a><ul><li><a href="#1241-%E5%9F%BA%E4%BA%8Ezset%E5%AE%9E%E7%8E%B0">12.4.1 åŸºäºZSetå®ç°</a></li></ul></li><li><a href="#125-%E9%99%90%E6%B5%81">12.5 é™æµ</a><ul><li><a href="#1251-%E5%9B%BA%E5%AE%9A%E7%AA%97%E5%8F%A3%E9%99%90%E6%B5%81">12.5.1 å›ºå®šçª—å£é™æµ</a></li><li><a href="#1252-%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E9%99%90%E6%B5%81">12.5.2 æ»‘åŠ¨çª—å£é™æµ</a></li><li><a href="#1253-%E4%BB%A4%E7%89%8C%E6%A1%B6%E9%99%90%E6%B5%81">12.5.3 ä»¤ç‰Œæ¡¶é™æµ</a></li></ul></li></ul></li><li><p><a href="#13-redis%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">13. Redisæ€§èƒ½ä¼˜åŒ–</a></p><ul><li><a href="#131-%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96">13.1 å†…å­˜ä¼˜åŒ–</a><ul><li><a href="#1311-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E9%80%89%E6%8B%A9">13.1.1 æ•°æ®ç»“æ„é€‰æ‹©</a></li><li><a href="#1312-%E9%94%AE%E5%90%8D%E4%BC%98%E5%8C%96">13.1.2 é”®åä¼˜åŒ–</a></li><li><a href="#1313-%E8%BF%87%E6%9C%9F%E6%97%B6%E9%97%B4%E8%AE%BE%E7%BD%AE">13.1.3 è¿‡æœŸæ—¶é—´è®¾ç½®</a></li><li><a href="#1314-%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5">13.1.4 å†…å­˜æ·˜æ±°ç­–ç•¥</a></li></ul></li><li><a href="#132-%E5%91%BD%E4%BB%A4%E4%BC%98%E5%8C%96">13.2 å‘½ä»¤ä¼˜åŒ–</a><ul><li><a href="#1321-%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C">13.2.1 æ‰¹é‡æ“ä½œ</a></li><li><a href="#1322-%E9%81%BF%E5%85%8D%E5%A4%A7key">13.2.2 é¿å…å¤§key</a></li><li><a href="#1323-%E4%BD%BF%E7%94%A8lua%E8%84%9A%E6%9C%AC">13.2.3 ä½¿ç”¨Luaè„šæœ¬</a></li></ul></li><li><a href="#133-%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96">13.3 ç½‘ç»œä¼˜åŒ–</a><ul><li><a href="#1331-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E9%85%8D%E7%BD%AE">13.3.1 è¿æ¥æ± é…ç½®</a></li><li><a href="#1332-%E5%87%8F%E5%B0%91%E7%BD%91%E7%BB%9C%E5%BE%80%E8%BF%94">13.3.2 å‡å°‘ç½‘ç»œå¾€è¿”</a></li></ul></li><li><a href="#134-%E6%85%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90">13.4 æ…¢æŸ¥è¯¢åˆ†æ</a><ul><li><a href="#1341-%E6%85%A2%E6%9F%A5%E8%AF%A2%E9%85%8D%E7%BD%AE">13.4.1 æ…¢æŸ¥è¯¢é…ç½®</a></li><li><a href="#1342-%E6%9F%A5%E7%9C%8B%E6%85%A2%E6%9F%A5%E8%AF%A2">13.4.2 æŸ¥çœ‹æ…¢æŸ¥è¯¢</a></li><li><a href="#1343-%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7">13.4.3 æ€§èƒ½ç›‘æ§</a></li></ul></li></ul></li><li><p><a href="#14-redis%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">14. Rediså¸¸è§é—®é¢˜</a></p><ul><li><a href="#141-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F">14.1 ç¼“å­˜ç©¿é€</a><ul><li><a href="#1411-%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">14.1.1 é—®é¢˜æè¿°</a></li><li><a href="#1412-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">14.1.2 è§£å†³æ–¹æ¡ˆ</a></li></ul></li><li><a href="#142-%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF">14.2 ç¼“å­˜å‡»ç©¿</a><ul><li><a href="#1421-%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">14.2.1 é—®é¢˜æè¿°</a></li><li><a href="#1422-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">14.2.2 è§£å†³æ–¹æ¡ˆ</a></li></ul></li><li><a href="#143-%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9">14.3 ç¼“å­˜é›ªå´©</a><ul><li><a href="#1431-%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">14.3.1 é—®é¢˜æè¿°</a></li><li><a href="#1432-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">14.3.2 è§£å†³æ–¹æ¡ˆ</a></li></ul></li><li><a href="#144-%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7">14.4 æ•°æ®ä¸€è‡´æ€§</a><ul><li><a href="#1441-%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">14.4.1 é—®é¢˜æè¿°</a></li><li><a href="#1442-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">14.4.2 è§£å†³æ–¹æ¡ˆ</a></li></ul></li></ul></li></ul><hr><h2 id="1-Redisç®€ä»‹"><a href="#1-Redisç®€ä»‹" class="headerlink" title="1. Redisç®€ä»‹"></a>1. Redisç®€ä»‹</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Redis"><a href="#1-1-ä»€ä¹ˆæ˜¯Redis" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Redis"></a>1.1 ä»€ä¹ˆæ˜¯Redis</h3><p>**Redisï¼ˆRemote Dictionary Serverï¼‰**æ˜¯ä¸€ä¸ªå¼€æºçš„ã€åŸºäºå†…å­˜çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚</p><p><strong>Redisçš„æ ¸å¿ƒç‰¹æ€§</strong>ï¼š</p><ul><li><strong>é«˜æ€§èƒ½</strong>ï¼šåŸºäºå†…å­˜è¿è¡Œï¼Œè¯»å†™é€Ÿåº¦æå¿«</li><li><strong>æ•°æ®ç»“æ„ä¸°å¯Œ</strong>ï¼šæ”¯æŒå­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰ã€é›†åˆï¼ˆSetï¼‰ã€æœ‰åºé›†åˆï¼ˆZSetï¼‰ã€å“ˆå¸Œï¼ˆHashï¼‰ç­‰å¤šç§æ•°æ®ç±»å‹</li><li><strong>åŸå­æ€§æ“ä½œ</strong>ï¼šæ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼Œæ”¯æŒäº‹åŠ¡</li><li><strong>æŒä¹…åŒ–</strong>ï¼šæ”¯æŒRDBå’ŒAOFä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼Œä¿è¯æ•°æ®å®‰å…¨</li><li><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šæ”¯æŒä¸»ä»å¤åˆ¶ï¼Œå®ç°é«˜å¯ç”¨</li><li><strong>åˆ†å¸ƒå¼</strong>ï¼šæ”¯æŒé›†ç¾¤æ¨¡å¼ï¼Œå¯ä»¥æ°´å¹³æ‰©å±•</li></ul><h3 id="1-2-Redisçš„ç‰¹ç‚¹"><a href="#1-2-Redisçš„ç‰¹ç‚¹" class="headerlink" title="1.2 Redisçš„ç‰¹ç‚¹"></a>1.2 Redisçš„ç‰¹ç‚¹</h3><h4 id="æ€§èƒ½ä¼˜åŠ¿"><a href="#æ€§èƒ½ä¼˜åŠ¿" class="headerlink" title="æ€§èƒ½ä¼˜åŠ¿"></a>æ€§èƒ½ä¼˜åŠ¿</h4><table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é«˜æ€§èƒ½</strong></td><td>åŸºäºå†…å­˜ï¼Œè¯»å†™é€Ÿåº¦å¯è¾¾10ä¸‡+QPS</td></tr><tr><td><strong>ä¸°å¯Œçš„æ•°æ®ç±»å‹</strong></td><td>Stringã€Hashã€Listã€Setã€ZSetç­‰</td></tr><tr><td><strong>åŸå­æ€§æ“ä½œ</strong></td><td>æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„</td></tr><tr><td><strong>æŒä¹…åŒ–</strong></td><td>æ”¯æŒRDBå’ŒAOFä¸¤ç§æŒä¹…åŒ–æ–¹å¼</td></tr><tr><td><strong>é«˜å¯ç”¨</strong></td><td>æ”¯æŒä¸»ä»å¤åˆ¶ã€å“¨å…µã€é›†ç¾¤</td></tr></tbody></table><h4 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h4><p>å¾…è¡¥å……â€¦</p><h3 id="1-3-Redisçš„åº”ç”¨åœºæ™¯"><a href="#1-3-Redisçš„åº”ç”¨åœºæ™¯" class="headerlink" title="1.3 Redisçš„åº”ç”¨åœºæ™¯"></a>1.3 Redisçš„åº”ç”¨åœºæ™¯</h3><h4 id="å¸¸è§åº”ç”¨åœºæ™¯"><a href="#å¸¸è§åº”ç”¨åœºæ™¯" class="headerlink" title="å¸¸è§åº”ç”¨åœºæ™¯"></a>å¸¸è§åº”ç”¨åœºæ™¯</h4><ol><li><strong>ç¼“å­˜</strong>ï¼šæœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯</li><li><strong>åˆ†å¸ƒå¼é”</strong>ï¼šè§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¹¶å‘é—®é¢˜</li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šå‘å¸ƒè®¢é˜…ã€å»¶æ—¶é˜Ÿåˆ—</li><li><strong>æ’è¡Œæ¦œ</strong>ï¼šåˆ©ç”¨ZSetå®ç°</li><li><strong>è®¡æ•°å™¨</strong>ï¼šç½‘ç«™è®¿é—®é‡ã€ç‚¹èµæ•°ç­‰</li><li><strong>Sessionå…±äº«</strong>ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„sessionå­˜å‚¨</li></ol><h3 id="1-4-Redis-vs-å…¶ä»–ç¼“å­˜"><a href="#1-4-Redis-vs-å…¶ä»–ç¼“å­˜" class="headerlink" title="1.4 Redis vs å…¶ä»–ç¼“å­˜"></a>1.4 Redis vs å…¶ä»–ç¼“å­˜</h3><h4 id="Redis-vs-Memcached"><a href="#Redis-vs-Memcached" class="headerlink" title="Redis vs Memcached"></a>Redis vs Memcached</h4><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>Redis</th><th>Memcached</th></tr></thead><tbody><tr><td><strong>æ•°æ®ç±»å‹</strong></td><td>æ”¯æŒStringã€Hashã€Listã€Setã€ZSetç­‰å¤šç§æ•°æ®ç»“æ„</td><td>ä»…æ”¯æŒç®€å•çš„key-valueå­—ç¬¦ä¸²</td></tr><tr><td><strong>æŒä¹…åŒ–</strong></td><td>æ”¯æŒRDBå’ŒAOFæŒä¹…åŒ–</td><td>ä¸æ”¯æŒæŒä¹…åŒ–ï¼Œæ•°æ®ä»…å­˜åœ¨äºå†…å­˜</td></tr><tr><td><strong>å†…å­˜ç®¡ç†</strong></td><td>è‡ªå·±å®ç°å†…å­˜æ± ï¼Œå¯ä»¥è®¾ç½®è¿‡æœŸç­–ç•¥</td><td>ä½¿ç”¨Slab Allocationæœºåˆ¶</td></tr><tr><td><strong>çº¿ç¨‹æ¨¡å‹</strong></td><td>å•çº¿ç¨‹ï¼ˆ6.0åæ”¯æŒå¤šçº¿ç¨‹IOï¼‰</td><td>å¤šçº¿ç¨‹</td></tr><tr><td><strong>é›†ç¾¤æ”¯æŒ</strong></td><td>åŸç”Ÿæ”¯æŒé›†ç¾¤</td><td>éœ€è¦å®¢æˆ·ç«¯å®ç°åˆ†ç‰‡</td></tr><tr><td><strong>æ•°æ®å¤‡ä»½</strong></td><td>æ”¯æŒä¸»ä»å¤åˆ¶</td><td>ä¸æ”¯æŒ</td></tr><tr><td><strong>åº”ç”¨åœºæ™¯</strong></td><td>ç¼“å­˜ã€é˜Ÿåˆ—ã€æ’è¡Œæ¦œã€åˆ†å¸ƒå¼é”ç­‰</td><td>çº¯ç¼“å­˜åœºæ™¯</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>å•æ ¸æ€§èƒ½æé«˜ï¼ˆ10ä¸‡+QPSï¼‰</td><td>å¤šæ ¸æ€§èƒ½æ›´å¥½</td></tr><tr><td><strong>å†…å­˜åˆ©ç”¨ç‡</strong></td><td>è¾ƒé«˜ï¼ˆå‹ç¼©åˆ—è¡¨ç­‰ä¼˜åŒ–ï¼‰</td><td>è¾ƒä½ï¼ˆå›ºå®šchunkå¤§å°ï¼‰</td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p><ul><li>éœ€è¦æŒä¹…åŒ–ã€å¤æ‚æ•°æ®ç»“æ„ã€åˆ†å¸ƒå¼é”ç­‰åœºæ™¯ â†’ <strong>Redis</strong></li><li>çº¯ç²¹çš„ç®€å•ç¼“å­˜ï¼Œè¿½æ±‚æè‡´å¤šæ ¸æ€§èƒ½ â†’ <strong>Memcached</strong></li></ul><h4 id="Redis-vs-Ehcache"><a href="#Redis-vs-Ehcache" class="headerlink" title="Redis vs Ehcache"></a>Redis vs Ehcache</h4><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>Redis</th><th>Ehcache</th></tr></thead><tbody><tr><td><strong>éƒ¨ç½²æ–¹å¼</strong></td><td>ç‹¬ç«‹æœåŠ¡ï¼Œæ”¯æŒåˆ†å¸ƒå¼</td><td>åµŒå…¥å¼ï¼Œä¸åº”ç”¨åŒè¿›ç¨‹</td></tr><tr><td><strong>æ•°æ®å…±äº«</strong></td><td>å¯è·¨åº”ç”¨å…±äº«æ•°æ®</td><td>ä»…é™å½“å‰åº”ç”¨ä½¿ç”¨</td></tr><tr><td><strong>è¯­è¨€æ”¯æŒ</strong></td><td>æ”¯æŒå¤šç§è¯­è¨€å®¢æˆ·ç«¯</td><td>ä¸»è¦ç”¨äºJavaåº”ç”¨</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>ç½‘ç»œIOå¼€é”€ï¼Œä½†å¯åˆ†å¸ƒå¼</td><td>æœ¬åœ°ç¼“å­˜ï¼Œé€Ÿåº¦æœ€å¿«</td></tr><tr><td><strong>å®¹é‡é™åˆ¶</strong></td><td>å—æœåŠ¡å™¨å†…å­˜é™åˆ¶ï¼Œå¯æ‰©å±•</td><td>å—JVMå †å†…å­˜é™åˆ¶</td></tr><tr><td><strong>æŒä¹…åŒ–</strong></td><td>æ”¯æŒRDBå’ŒAOF</td><td>æ”¯æŒç£ç›˜å­˜å‚¨ï¼ˆå¯é€‰ï¼‰</td></tr><tr><td><strong>é›†ç¾¤</strong></td><td>åŸç”Ÿæ”¯æŒé›†ç¾¤</td><td>æ”¯æŒTerracottaé›†ç¾¤</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>åˆ†å¸ƒå¼ç³»ç»Ÿã€å¤§æ•°æ®é‡ç¼“å­˜</td><td>å•æœºåº”ç”¨ã€å°æ•°æ®é‡ç¼“å­˜</td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p><ul><li>åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œéœ€è¦è·¨åº”ç”¨å…±äº«æ•°æ® â†’ <strong>Redis</strong></li><li>å•æœºJavaåº”ç”¨ï¼Œè¿½æ±‚æè‡´æœ¬åœ°ç¼“å­˜æ€§èƒ½ â†’ <strong>Ehcache</strong></li><li>ä¹Ÿå¯ä»¥ç»„åˆä½¿ç”¨ï¼šEhcacheä½œä¸ºä¸€çº§ç¼“å­˜ï¼ˆæœ¬åœ°ï¼‰ï¼ŒRedisä½œä¸ºäºŒçº§ç¼“å­˜ï¼ˆåˆ†å¸ƒå¼ï¼‰</li></ul><h4 id="å…¶ä»–ç¼“å­˜æ–¹æ¡ˆå¯¹æ¯”"><a href="#å…¶ä»–ç¼“å­˜æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="å…¶ä»–ç¼“å­˜æ–¹æ¡ˆå¯¹æ¯”"></a>å…¶ä»–ç¼“å­˜æ–¹æ¡ˆå¯¹æ¯”</h4><table><thead><tr><th>ç¼“å­˜æ–¹æ¡ˆ</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Redis</strong></td><td>åŠŸèƒ½ä¸°å¯Œã€æ”¯æŒæŒä¹…åŒ–ã€é«˜å¯ç”¨</td><td>é€šç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ŒåŠŸèƒ½éœ€æ±‚å¤š</td></tr><tr><td><strong>Memcached</strong></td><td>ç®€å•é«˜æ•ˆã€å¤šçº¿ç¨‹</td><td>çº¯ç¼“å­˜åœºæ™¯ï¼Œå¤§è§„æ¨¡ç®€å•æ•°æ®</td></tr><tr><td><strong>Ehcache</strong></td><td>è¿›ç¨‹å†…ç¼“å­˜ã€é›¶ç½‘ç»œå¼€é”€</td><td>Javaå•æœºåº”ç”¨</td></tr><tr><td><strong>Caffeine</strong></td><td>é«˜æ€§èƒ½æœ¬åœ°ç¼“å­˜ã€ç°ä»£åŒ–API</td><td>Javaåº”ç”¨æœ¬åœ°ç¼“å­˜ï¼ˆæ¨èï¼‰</td></tr><tr><td><strong>Guava Cache</strong></td><td>Googleå¼€æºã€ä½¿ç”¨ç®€å•</td><td>è½»é‡çº§æœ¬åœ°ç¼“å­˜</td></tr><tr><td><strong>Hazelcast</strong></td><td>åˆ†å¸ƒå¼å†…å­˜æ•°æ®ç½‘æ ¼</td><td>å¤§è§„æ¨¡åˆ†å¸ƒå¼è®¡ç®—</td></tr></tbody></table><h4 id="å¤šçº§ç¼“å­˜æ¶æ„"><a href="#å¤šçº§ç¼“å­˜æ¶æ„" class="headerlink" title="å¤šçº§ç¼“å­˜æ¶æ„"></a>å¤šçº§ç¼“å­˜æ¶æ„</h4><p>å®é™…é¡¹ç›®ä¸­ï¼Œé€šå¸¸é‡‡ç”¨<strong>å¤šçº§ç¼“å­˜</strong>ç­–ç•¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯è¯·æ±‚</span><br><span class="line">    â†“</span><br><span class="line">[è¿›ç¨‹å†…ç¼“å­˜] (Caffeine/Ehcache)</span><br><span class="line">    â†“ æœªå‘½ä¸­</span><br><span class="line">[åˆ†å¸ƒå¼ç¼“å­˜] (Redis)</span><br><span class="line">    â†“ æœªå‘½ä¸­</span><br><span class="line">[æ•°æ®åº“] (MySQL)</span><br></pre></td></tr></table></figure><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li><strong>L1ç¼“å­˜ï¼ˆæœ¬åœ°ï¼‰</strong>ï¼šé€Ÿåº¦æœ€å¿«ï¼Œæ— ç½‘ç»œå¼€é”€</li><li><strong>L2ç¼“å­˜ï¼ˆRedisï¼‰</strong>ï¼šè·¨åº”ç”¨å…±äº«ï¼Œå®¹é‡æ›´å¤§</li><li><strong>L3å­˜å‚¨ï¼ˆDBï¼‰</strong>ï¼šæŒä¹…åŒ–æ•°æ®ï¼Œæœ€ç»ˆæ•°æ®æº</li></ul><hr><h2 id="2-Rediså®‰è£…ä¸é…ç½®"><a href="#2-Rediså®‰è£…ä¸é…ç½®" class="headerlink" title="2. Rediså®‰è£…ä¸é…ç½®"></a>2. Rediså®‰è£…ä¸é…ç½®</h2><h3 id="2-1-Linuxå®‰è£…"><a href="#2-1-Linuxå®‰è£…" class="headerlink" title="2.1 Linuxå®‰è£…"></a>2.1 Linuxå®‰è£…</h3><h4 id="æ­¥éª¤1ï¼šå®‰è£…GCCç¼–è¯‘å™¨"><a href="#æ­¥éª¤1ï¼šå®‰è£…GCCç¼–è¯‘å™¨" class="headerlink" title="æ­¥éª¤1ï¼šå®‰è£…GCCç¼–è¯‘å™¨"></a>æ­¥éª¤1ï¼šå®‰è£…GCCç¼–è¯‘å™¨</h4><p>Redisæ˜¯Cè¯­è¨€å¼€å‘çš„ï¼Œéœ€è¦å…ˆå®‰è£…ç¼–è¯‘ç¯å¢ƒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…Cè¯­è¨€ç¼–è¯‘ç¯å¢ƒ</span></span><br><span class="line">yum install centos-release-scl scl-utils-build</span><br><span class="line">yum install -y devtoolset-8-toolchain</span><br><span class="line">scl <span class="built_in">enable</span> devtoolset-8 bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•gccç‰ˆæœ¬</span></span><br><span class="line">gcc --version</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯ç»“æœ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@chad /]# gcc --version</span><br><span class="line">gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-36)</span><br><span class="line">Copyright (C) 2015 Free Software Foundation, Inc.</span><br><span class="line">This is free software; see the <span class="built_in">source</span> <span class="keyword">for</span> copying conditions.  There is NO</span><br><span class="line">warranty; not even <span class="keyword">for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br></pre></td></tr></table></figure><h4 id="æ­¥éª¤2ï¼šä¸‹è½½å¹¶è§£å‹Redis"><a href="#æ­¥éª¤2ï¼šä¸‹è½½å¹¶è§£å‹Redis" class="headerlink" title="æ­¥éª¤2ï¼šä¸‹è½½å¹¶è§£å‹Redis"></a>æ­¥éª¤2ï¼šä¸‹è½½å¹¶è§£å‹Redis</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½Rediså®‰è£…åŒ…åˆ°/optç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">wget http://download.redis.io/releases/redis-6.2.1.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å‹</span></span><br><span class="line">tar -zxvf redis-6.2.1.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥è§£å‹åçš„ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> redis-6.2.1</span><br></pre></td></tr></table></figure><h4 id="æ­¥éª¤3ï¼šç¼–è¯‘å®‰è£…"><a href="#æ­¥éª¤3ï¼šç¼–è¯‘å®‰è£…" class="headerlink" title="æ­¥éª¤3ï¼šç¼–è¯‘å®‰è£…"></a>æ­¥éª¤3ï¼šç¼–è¯‘å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¯‘ï¼ˆåªæ˜¯ç¼–è¯‘ï¼Œä¸å®‰è£…ï¼‰</span></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…åˆ°é»˜è®¤ç›®å½•/usr/local/bin</span></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h4 id="æ­¥éª¤4ï¼šæŸ¥çœ‹å®‰è£…æ–‡ä»¶"><a href="#æ­¥éª¤4ï¼šæŸ¥çœ‹å®‰è£…æ–‡ä»¶" class="headerlink" title="æ­¥éª¤4ï¼šæŸ¥çœ‹å®‰è£…æ–‡ä»¶"></a>æ­¥éª¤4ï¼šæŸ¥çœ‹å®‰è£…æ–‡ä»¶</h4><p>å®‰è£…å®Œæˆåï¼Œå¯åœ¨ <code>/usr/local/bin</code> ç›®å½•ä¸‹çœ‹åˆ°ä»¥ä¸‹å¯æ‰§è¡Œæ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@chad bin]# <span class="built_in">ls</span> -l</span><br><span class="line">total 18848</span><br><span class="line">-rw-r--r--. 1 root root      92 Nov 12 08:19 dump.rdb</span><br><span class="line">-rwxr-xr-x. 1 root root 4833352 Nov 12 08:12 redis-benchmark</span><br><span class="line">lrwxrwxrwx. 1 root root      12 Nov 12 08:12 redis-check-aof -&gt; redis-server</span><br><span class="line">lrwxrwxrwx. 1 root root      12 Nov 12 08:12 redis-check-rdb -&gt; redis-server</span><br><span class="line">-rwxr-xr-x. 1 root root 5003400 Nov 12 08:12 redis-cli</span><br><span class="line">lrwxrwxrwx. 1 root root      12 Nov 12 08:12 redis-sentinel -&gt; redis-server</span><br><span class="line">-rwxr-xr-x. 1 root root 9450232 Nov 12 08:12 redis-server</span><br></pre></td></tr></table></figure><p><strong>å„æ–‡ä»¶è¯´æ˜</strong>ï¼š</p><table><thead><tr><th>æ–‡ä»¶å</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>redis-server</code></td><td>RedisæœåŠ¡å™¨å¯åŠ¨ç¨‹åº</td></tr><tr><td><code>redis-cli</code></td><td>Rediså‘½ä»¤è¡Œå®¢æˆ·ç«¯</td></tr><tr><td><code>redis-benchmark</code></td><td>æ€§èƒ½æµ‹è¯•å·¥å…·</td></tr><tr><td><code>redis-check-aof</code></td><td>AOFæ–‡ä»¶ä¿®å¤å·¥å…·</td></tr><tr><td><code>redis-check-rdb</code></td><td>RDBæ–‡ä»¶ä¿®å¤å·¥å…·</td></tr><tr><td><code>redis-sentinel</code></td><td>å“¨å…µæ¨¡å¼å¯åŠ¨ç¨‹åºï¼ˆç”¨äºé›†ç¾¤ï¼‰</td></tr></tbody></table><h4 id="æ­¥éª¤5ï¼šå¯åŠ¨Redis"><a href="#æ­¥éª¤5ï¼šå¯åŠ¨Redis" class="headerlink" title="æ­¥éª¤5ï¼šå¯åŠ¨Redis"></a>æ­¥éª¤5ï¼šå¯åŠ¨Redis</h4><h5 id="æ–¹å¼1ï¼šå‰å°å¯åŠ¨ï¼ˆä¸æ¨èï¼‰"><a href="#æ–¹å¼1ï¼šå‰å°å¯åŠ¨ï¼ˆä¸æ¨èï¼‰" class="headerlink" title="æ–¹å¼1ï¼šå‰å°å¯åŠ¨ï¼ˆä¸æ¨èï¼‰"></a>æ–¹å¼1ï¼šå‰å°å¯åŠ¨ï¼ˆä¸æ¨èï¼‰</h5><p>å‰å°å¯åŠ¨ä¼šå ç”¨å½“å‰å‘½ä»¤è¡Œçª—å£ï¼Œçª—å£å…³é—­åˆ™æœåŠ¡åœæ­¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥å¯åŠ¨</span></span><br><span class="line">redis-server</span><br></pre></td></tr></table></figure><p><img src="/images/redis/image.png" alt="å‰å°å¯åŠ¨"></p><h5 id="æ–¹å¼2ï¼šåå°å¯åŠ¨ï¼ˆæ¨èï¼‰"><a href="#æ–¹å¼2ï¼šåå°å¯åŠ¨ï¼ˆæ¨èï¼‰" class="headerlink" title="æ–¹å¼2ï¼šåå°å¯åŠ¨ï¼ˆæ¨èï¼‰"></a>æ–¹å¼2ï¼šåå°å¯åŠ¨ï¼ˆæ¨èï¼‰</h5><p><strong>é…ç½®æ­¥éª¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> /myredis</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å¤åˆ¶é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cp</span> /opt/redis-6.2.1/redis.conf /myredis/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim /myredis/redis.conf</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ° <code>daemonize</code> é…ç½®é¡¹ï¼Œä¿®æ”¹ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å°† no æ”¹ä¸º yesï¼Œå¯ç”¨åå°è¿è¡Œ</span><br><span class="line">daemonize yes</span><br></pre></td></tr></table></figure><p><img src="/images/redis/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png" alt="é…ç½®æ–‡ä»¶ä¿®æ”¹"></p><p><strong>å¯åŠ¨æœåŠ¡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</span></span><br><span class="line">redis-server /myredis/redis.conf</span><br></pre></td></tr></table></figure><p><strong>è¿æ¥æµ‹è¯•</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿æ¥åˆ°é»˜è®¤ç«¯å£6379</span></span><br><span class="line">redis-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–æŒ‡å®šç«¯å£è¿æ¥</span></span><br><span class="line">redis-cli -p 6379</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯è¿æ¥</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br></pre></td></tr></table></figure><h4 id="æ­¥éª¤6ï¼šå…³é—­Redis"><a href="#æ­¥éª¤6ï¼šå…³é—­Redis" class="headerlink" title="æ­¥éª¤6ï¼šå…³é—­Redis"></a>æ­¥éª¤6ï¼šå…³é—­Redis</h4><h5 id="å•å®ä¾‹å…³é—­"><a href="#å•å®ä¾‹å…³é—­" class="headerlink" title="å•å®ä¾‹å…³é—­"></a>å•å®ä¾‹å…³é—­</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šç›´æ¥å…³é—­</span></span><br><span class="line">redis-cli shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šè¿›å…¥å®¢æˆ·ç«¯åå…³é—­</span></span><br><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt;</span><br></pre></td></tr></table></figure><h5 id="å¤šå®ä¾‹å…³é—­"><a href="#å¤šå®ä¾‹å…³é—­" class="headerlink" title="å¤šå®ä¾‹å…³é—­"></a>å¤šå®ä¾‹å…³é—­</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šç«¯å£å…³é—­</span></span><br><span class="line">redis-cli -p 6379 shutdown</span><br></pre></td></tr></table></figure><p><strong>å®Œæ•´æ“ä½œç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@chad bin]# redis-server /myredis/redis.conf</span><br><span class="line">[root@chad bin]# redis-cli</span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt;</span><br></pre></td></tr></table></figure><h3 id="2-2-åŸºç¡€é…ç½®"><a href="#2-2-åŸºç¡€é…ç½®" class="headerlink" title="2.2 åŸºç¡€é…ç½®"></a>2.2 åŸºç¡€é…ç½®</h3><h4 id="é»˜è®¤ç«¯å£"><a href="#é»˜è®¤ç«¯å£" class="headerlink" title="é»˜è®¤ç«¯å£"></a>é»˜è®¤ç«¯å£</h4><p>Redisé»˜è®¤ä½¿ç”¨ <strong>6379</strong> ç«¯å£ã€‚</p><blockquote><p><strong>å°çŸ¥è¯†</strong>ï¼š6379åœ¨æ‰‹æœºæŒ‰é”®ä¸Šå¯¹åº”MERZï¼Œæ˜¯æ„å¤§åˆ©æ­Œå¥³Alessia Merzçš„åå­—ï¼ŒRedisä½œè€…antirezæ˜¯å¥¹çš„ç²‰ä¸ã€‚</p></blockquote><h4 id="æ•°æ®åº“é…ç½®"><a href="#æ•°æ®åº“é…ç½®" class="headerlink" title="æ•°æ®åº“é…ç½®"></a>æ•°æ®åº“é…ç½®</h4><p>Redisé»˜è®¤æœ‰ <strong>16ä¸ªæ•°æ®åº“</strong>ï¼ˆç¼–å·0-15ï¼‰ï¼Œåˆå§‹é»˜è®¤ä½¿ç”¨ <strong>0å·åº“</strong>ã€‚</p><p><strong>å¸¸ç”¨å‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“</span></span><br><span class="line">SELECT &lt;dbid&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹ï¼šåˆ‡æ¢åˆ°8å·åº“</span></span><br><span class="line">SELECT 8</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰æ•°æ®åº“keyçš„æ•°é‡</span></span><br><span class="line">DBSIZE</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç©ºå½“å‰åº“</span></span><br><span class="line">FLUSHDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç©ºæ‰€æœ‰åº“ï¼ˆæ…ç”¨ï¼ï¼‰</span></span><br><span class="line">FLUSHALL</span><br></pre></td></tr></table></figure><p><strong>æ“ä½œç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SELECT 8</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[8]&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379[8]&gt; SET mykey <span class="string">&quot;test&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[8]&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><h4 id="å¯†ç é…ç½®"><a href="#å¯†ç é…ç½®" class="headerlink" title="å¯†ç é…ç½®"></a>å¯†ç é…ç½®</h4><p>Redisé‡‡ç”¨<strong>ç»Ÿä¸€å¯†ç ç®¡ç†</strong>ï¼Œæ‰€æœ‰æ•°æ®åº“ä½¿ç”¨ç›¸åŒçš„å¯†ç ã€‚</p><p><strong>è®¾ç½®å¯†ç </strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šå‘½ä»¤è¡Œä¸´æ—¶è®¾ç½®ï¼ˆé‡å¯å¤±æ•ˆï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; CONFIG SET requirepass <span class="string">&quot;your_password&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šé…ç½®æ–‡ä»¶æ°¸ä¹…è®¾ç½®</span></span><br><span class="line">vim /myredis/redis.conf</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°å¹¶ä¿®æ”¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å–æ¶ˆæ³¨é‡Šå¹¶è®¾ç½®å¯†ç </span><br><span class="line">requirepass your_password</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨å¯†ç è¿æ¥</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šè¿æ¥æ—¶æŒ‡å®šå¯†ç </span></span><br><span class="line">redis-cli -a your_password</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šè¿æ¥åè®¤è¯</span></span><br><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; AUTH your_password</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–é‡è¦é…ç½®"><a href="#å…¶ä»–é‡è¦é…ç½®" class="headerlink" title="å…¶ä»–é‡è¦é…ç½®"></a>å…¶ä»–é‡è¦é…ç½®</h4><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th><th>æ¨èå€¼</th></tr></thead><tbody><tr><td><code>bind</code></td><td>ç»‘å®šIPåœ°å€</td><td><code>127.0.0.1</code></td><td><code>0.0.0.0</code>ï¼ˆå…è®¸è¿œç¨‹è¿æ¥ï¼‰</td></tr><tr><td><code>port</code></td><td>ç›‘å¬ç«¯å£</td><td><code>6379</code></td><td>æŒ‰éœ€ä¿®æ”¹</td></tr><tr><td><code>daemonize</code></td><td>åå°è¿è¡Œ</td><td><code>no</code></td><td><code>yes</code></td></tr><tr><td><code>databases</code></td><td>æ•°æ®åº“æ•°é‡</td><td><code>16</code></td><td>æŒ‰éœ€è°ƒæ•´</td></tr><tr><td><code>maxmemory</code></td><td>æœ€å¤§å†…å­˜é™åˆ¶</td><td>æ— é™åˆ¶</td><td>å»ºè®®è®¾ç½®ï¼ˆå¦‚<code>2gb</code>ï¼‰</td></tr><tr><td><code>maxmemory-policy</code></td><td>å†…å­˜æ·˜æ±°ç­–ç•¥</td><td><code>noeviction</code></td><td><code>allkeys-lru</code></td></tr><tr><td><code>logfile</code></td><td>æ—¥å¿—æ–‡ä»¶è·¯å¾„</td><td><code>&quot;&quot;</code></td><td><code>/var/log/redis/redis.log</code></td></tr></tbody></table><p><strong>é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># å…è®¸è¿œç¨‹è®¿é—®ï¼ˆæ³¨æ„å®‰å…¨ï¼‰</span><br><span class="line">bind 0.0.0.0</span><br><span class="line"></span><br><span class="line"># ç«¯å£</span><br><span class="line">port 6379</span><br><span class="line"></span><br><span class="line"># åå°è¿è¡Œ</span><br><span class="line">daemonize yes</span><br><span class="line"></span><br><span class="line"># æ•°æ®åº“æ•°é‡</span><br><span class="line">databases 16</span><br><span class="line"></span><br><span class="line"># æœ€å¤§å†…å­˜2GB</span><br><span class="line">maxmemory 2gb</span><br><span class="line"></span><br><span class="line"># å†…å­˜æ·˜æ±°ç­–ç•¥ï¼šä¼˜å…ˆåˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„key</span><br><span class="line">maxmemory-policy allkeys-lru</span><br><span class="line"></span><br><span class="line"># æ—¥å¿—æ–‡ä»¶</span><br><span class="line">logfile &quot;/var/log/redis/redis.log&quot;</span><br><span class="line"></span><br><span class="line"># æŒä¹…åŒ–æ–‡ä»¶ç›®å½•</span><br><span class="line">dir /var/lib/redis/</span><br></pre></td></tr></table></figure><blockquote><p><strong>å®‰å…¨æç¤º</strong>ï¼šå¦‚æœè®¾ç½®äº† <code>bind 0.0.0.0</code> å…è®¸è¿œç¨‹è®¿é—®ï¼ŒåŠ¡å¿…è®¾ç½®å¼ºå¯†ç å¹¶é…ç½®é˜²ç«å¢™è§„åˆ™ï¼</p></blockquote><hr><h2 id="3-RedisåŸºç¡€æ•°æ®ç±»å‹"><a href="#3-RedisåŸºç¡€æ•°æ®ç±»å‹" class="headerlink" title="3. RedisåŸºç¡€æ•°æ®ç±»å‹"></a>3. RedisåŸºç¡€æ•°æ®ç±»å‹</h2><h3 id="Redisé”®-key-é€šç”¨å‘½ä»¤"><a href="#Redisé”®-key-é€šç”¨å‘½ä»¤" class="headerlink" title="Redisé”®(key)é€šç”¨å‘½ä»¤"></a>Redisé”®(key)é€šç”¨å‘½ä»¤</h3><p>åœ¨å­¦ä¹ å„ç§æ•°æ®ç±»å‹ä¹‹å‰ï¼Œå…ˆäº†è§£Redisä¸­<strong>æ‰€æœ‰æ•°æ®ç±»å‹é€šç”¨çš„keyæ“ä½œå‘½ä»¤</strong>ã€‚</p><h4 id="å¸¸ç”¨Keyå‘½ä»¤"><a href="#å¸¸ç”¨Keyå‘½ä»¤" class="headerlink" title="å¸¸ç”¨Keyå‘½ä»¤"></a>å¸¸ç”¨Keyå‘½ä»¤</h4><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>KEYS pattern</code></td><td>æŸ¥çœ‹ç¬¦åˆæ¨¡æ¿çš„æ‰€æœ‰key</td><td><code>KEYS *</code>ï¼ˆæŸ¥çœ‹æ‰€æœ‰ï¼‰<br><code>KEYS *1</code>ï¼ˆæŸ¥çœ‹ä»¥1ç»“å°¾çš„ï¼‰</td></tr><tr><td><code>EXISTS key</code></td><td>åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</td><td><code>EXISTS name</code><br>è¿”å›1è¡¨ç¤ºå­˜åœ¨ï¼Œ0è¡¨ç¤ºä¸å­˜åœ¨</td></tr><tr><td><code>TYPE key</code></td><td>æŸ¥çœ‹keyçš„æ•°æ®ç±»å‹</td><td><code>TYPE name</code><br>è¿”å›ï¼šstring&#x2F;list&#x2F;hash&#x2F;set&#x2F;zset</td></tr><tr><td><code>DEL key [key ...]</code></td><td>åˆ é™¤æŒ‡å®šçš„keyï¼ˆé˜»å¡ï¼‰</td><td><code>DEL name age</code><br>è¿”å›åˆ é™¤çš„keyæ•°é‡</td></tr><tr><td><code>UNLINK key [key ...]</code></td><td>éé˜»å¡åˆ é™¤key</td><td><code>UNLINK name age</code><br>å¼‚æ­¥åˆ é™¤ï¼Œæ€§èƒ½æ›´å¥½</td></tr><tr><td><code>EXPIRE key seconds</code></td><td>è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰</td><td><code>EXPIRE name 10</code><br>10ç§’åè¿‡æœŸ</td></tr><tr><td><code>TTL key</code></td><td>æŸ¥çœ‹keyå‰©ä½™è¿‡æœŸæ—¶é—´</td><td><code>TTL name</code><br>-1ï¼šæ°¸ä¸è¿‡æœŸ<br>-2ï¼šå·²è¿‡æœŸ</td></tr><tr><td><code>RENAME key newkey</code></td><td>é‡å‘½åkey</td><td><code>RENAME oldname newname</code></td></tr><tr><td><code>MOVE key db</code></td><td>ç§»åŠ¨keyåˆ°å…¶ä»–æ•°æ®åº“</td><td><code>MOVE name 1</code>ï¼ˆç§»åŠ¨åˆ°1å·åº“ï¼‰</td></tr></tbody></table><p><strong>æ“ä½œç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET name <span class="string">&quot;Redis&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET age <span class="string">&quot;5&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; KEYS *</span><br><span class="line">1) <span class="string">&quot;name&quot;</span></span><br><span class="line">2) <span class="string">&quot;age&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; EXISTS name</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; TYPE name</span><br><span class="line">string</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; EXPIRE name 60</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; TTL name</span><br><span class="line">(<span class="built_in">integer</span>) 57</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; TTL name</span><br><span class="line">(<span class="built_in">integer</span>) -2</span><br><span class="line">127.0.0.1:6379&gt; EXISTS name</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„</strong>ï¼š<code>DEL</code> æ˜¯é˜»å¡åˆ é™¤ï¼Œåˆ é™¤å¤§keyæ—¶ä¼šé˜»å¡RedisæœåŠ¡ï¼›<code>UNLINK</code> æ˜¯éé˜»å¡åˆ é™¤ï¼Œä»…å°†keyä»keyspaceå…ƒæ•°æ®ä¸­åˆ é™¤ï¼ŒçœŸæ­£çš„åˆ é™¤åœ¨åç»­å¼‚æ­¥æ“ä½œä¸­å®Œæˆï¼Œæ¨èä½¿ç”¨ï¼</p></blockquote><h3 id="3-1-Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"><a href="#3-1-Stringï¼ˆå­—ç¬¦ä¸²ï¼‰" class="headerlink" title="3.1 Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"></a>3.1 Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</h3><h4 id="ç±»å‹ä»‹ç»"><a href="#ç±»å‹ä»‹ç»" class="headerlink" title="ç±»å‹ä»‹ç»"></a>ç±»å‹ä»‹ç»</h4><p>Stringæ˜¯Redis<strong>æœ€åŸºæœ¬</strong>çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ä¸Memcachedçš„ç±»å‹ä¸€è‡´ï¼Œéƒ½æ˜¯ç®€å•çš„key-valueå­˜å‚¨</li><li><strong>äºŒè¿›åˆ¶å®‰å…¨</strong>ï¼šå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ï¼Œå¦‚æ–‡æœ¬ã€æ•°å­—ã€jpgå›¾ç‰‡ã€åºåˆ—åŒ–å¯¹è±¡ç­‰</li><li><strong>æœ€å¤§å€¼</strong>ï¼šå•ä¸ªvalueæœ€å¤šå¯ä»¥å­˜å‚¨ <strong>512MB</strong></li></ul><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>ç¼“å­˜ï¼šç¼“å­˜ç”¨æˆ·ä¿¡æ¯ã€å•†å“è¯¦æƒ…ç­‰</li><li>è®¡æ•°å™¨ï¼šç‚¹èµæ•°ã€æµè§ˆé‡ã€åº“å­˜æ•°é‡</li><li>åˆ†å¸ƒå¼é”ï¼šåˆ©ç”¨SETNXå®ç°</li><li>é™æµï¼šè®°å½•æ¥å£è°ƒç”¨æ¬¡æ•°</li></ul><h4 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="headerlink" title="åŸºæœ¬å‘½ä»¤"></a>åŸºæœ¬å‘½ä»¤</h4><h5 id="1-åŸºç¡€æ“ä½œ"><a href="#1-åŸºç¡€æ“ä½œ" class="headerlink" title="1. åŸºç¡€æ“ä½œ"></a>1. åŸºç¡€æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>SET key value [EX seconds] [NX|XX]</code></td><td>è®¾ç½®é”®å€¼</td><td><code>SET name &quot;Redis&quot;</code></td><td>OK</td></tr><tr><td><code>GET key</code></td><td>è·å–å€¼</td><td><code>GET name</code></td><td>â€œRedisâ€</td></tr><tr><td><code>APPEND key value</code></td><td>è¿½åŠ å€¼åˆ°æœ«å°¾</td><td><code>APPEND name &quot;DB&quot;</code></td><td>æ–°å­—ç¬¦ä¸²é•¿åº¦</td></tr><tr><td><code>STRLEN key</code></td><td>è·å–å€¼çš„é•¿åº¦</td><td><code>STRLEN name</code></td><td>å­—ç¬¦ä¸²é•¿åº¦</td></tr><tr><td><code>SETNX key value</code></td><td>ä¸å­˜åœ¨æ—¶æ‰è®¾ç½®</td><td><code>SETNX lock &quot;1&quot;</code></td><td>1æˆåŠŸï¼Œ0å¤±è´¥</td></tr><tr><td><code>SETEX key seconds value</code></td><td>è®¾ç½®å€¼+è¿‡æœŸæ—¶é—´</td><td><code>SETEX code 60 &quot;123456&quot;</code></td><td>OK</td></tr><tr><td><code>GETSET key value</code></td><td>è®¾ç½®æ–°å€¼å¹¶è¿”å›æ—§å€¼</td><td><code>GETSET name &quot;MySQL&quot;</code></td><td>æ—§å€¼</td></tr></tbody></table><p><strong>SETå‘½ä»¤çš„å¯é€‰å‚æ•°</strong>ï¼š</p><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>EX seconds</code></td><td>è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰</td></tr><tr><td><code>PX milliseconds</code></td><td>è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td><code>NX</code></td><td>ä»…å½“keyä¸å­˜åœ¨æ—¶æ‰è®¾ç½®ï¼ˆNot eXistsï¼‰</td></tr><tr><td><code>XX</code></td><td>ä»…å½“keyå­˜åœ¨æ—¶æ‰è®¾ç½®ï¼ˆeXistsï¼‰</td></tr></tbody></table><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET name <span class="string">&quot;Redis&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; GET name</span><br><span class="line"><span class="string">&quot;Redis&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; APPEND name <span class="string">&quot; Database&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 14</span><br><span class="line">127.0.0.1:6379&gt; GET name</span><br><span class="line"><span class="string">&quot;Redis Database&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; STRLEN name</span><br><span class="line">(<span class="built_in">integer</span>) 14</span><br><span class="line"></span><br><span class="line"><span class="comment"># NXå‚æ•°ï¼škeyä¸å­˜åœ¨æ—¶æ‰è®¾ç½®</span></span><br><span class="line">127.0.0.1:6379&gt; SET lock <span class="string">&quot;user123&quot;</span> NX EX 10</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET lock <span class="string">&quot;user456&quot;</span> NX</span><br><span class="line">(nil)  <span class="comment"># è®¾ç½®å¤±è´¥ï¼Œå› ä¸ºkeyå·²å­˜åœ¨</span></span><br></pre></td></tr></table></figure><h5 id="2-æ•°å€¼æ“ä½œ"><a href="#2-æ•°å€¼æ“ä½œ" class="headerlink" title="2. æ•°å€¼æ“ä½œ"></a>2. æ•°å€¼æ“ä½œ</h5><p>Stringç±»å‹æ”¯æŒå¯¹æ•°å­—è¿›è¡ŒåŸå­æ€§çš„é€’å¢&#x2F;é€’å‡æ“ä½œã€‚</p><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>INCR key</code></td><td>å€¼è‡ªå¢1</td><td><code>INCR counter</code></td><td>è‡ªå¢åçš„å€¼</td></tr><tr><td><code>DECR key</code></td><td>å€¼è‡ªå‡1</td><td><code>DECR counter</code></td><td>è‡ªå‡åçš„å€¼</td></tr><tr><td><code>INCRBY key increment</code></td><td>å€¼å¢åŠ æŒ‡å®šæ­¥é•¿</td><td><code>INCRBY counter 10</code></td><td>å¢åŠ åçš„å€¼</td></tr><tr><td><code>DECRBY key decrement</code></td><td>å€¼å‡å°‘æŒ‡å®šæ­¥é•¿</td><td><code>DECRBY counter 5</code></td><td>å‡å°‘åçš„å€¼</td></tr><tr><td><code>INCRBYFLOAT key increment</code></td><td>æµ®ç‚¹æ•°å¢åŠ </td><td><code>INCRBYFLOAT price 0.5</code></td><td>å¢åŠ åçš„å€¼</td></tr></tbody></table><p><strong>ç‰¹æ€§</strong>ï¼š</p><ul><li>åªèƒ½å¯¹<strong>æ•°å­—å€¼</strong>æ“ä½œ</li><li>å¦‚æœkeyä¸å­˜åœ¨ï¼Œä¼šå…ˆåˆå§‹åŒ–ä¸º0ï¼Œå†æ‰§è¡Œæ“ä½œ</li><li>æ“ä½œæ˜¯<strong>åŸå­æ€§</strong>çš„ï¼Œçº¿ç¨‹å®‰å…¨</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET counter 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; INCR counter</span><br><span class="line">(<span class="built_in">integer</span>) 101</span><br><span class="line">127.0.0.1:6379&gt; INCRBY counter 10</span><br><span class="line">(<span class="built_in">integer</span>) 111</span><br><span class="line">127.0.0.1:6379&gt; DECR counter</span><br><span class="line">(<span class="built_in">integer</span>) 110</span><br><span class="line">127.0.0.1:6379&gt; DECRBY counter 5</span><br><span class="line">(<span class="built_in">integer</span>) 105</span><br><span class="line"></span><br><span class="line"><span class="comment"># keyä¸å­˜åœ¨æ—¶ï¼Œä»0å¼€å§‹</span></span><br><span class="line">127.0.0.1:6379&gt; INCR newCounter</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><h5 id="3-æ‰¹é‡æ“ä½œ"><a href="#3-æ‰¹é‡æ“ä½œ" class="headerlink" title="3. æ‰¹é‡æ“ä½œ"></a>3. æ‰¹é‡æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>MSET key1 value1 key2 value2 ...</code></td><td>åŒæ—¶è®¾ç½®å¤šä¸ªé”®å€¼å¯¹</td><td><code>MSET name &quot;Redis&quot; age &quot;5&quot;</code></td></tr><tr><td><code>MGET key1 key2 key3 ...</code></td><td>åŒæ—¶è·å–å¤šä¸ªå€¼</td><td><code>MGET name age</code></td></tr><tr><td><code>MSETNX key1 value1 key2 value2 ...</code></td><td>æ‰¹é‡è®¾ç½®ï¼ˆä»…å½“æ‰€æœ‰keyéƒ½ä¸å­˜åœ¨ï¼‰</td><td><code>MSETNX k1 &quot;v1&quot; k2 &quot;v2&quot;</code></td></tr></tbody></table><p><strong>MSETNXç‰¹æ€§</strong>ï¼š</p><ul><li><strong>åŸå­æ€§</strong>ï¼šè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</li><li>åªè¦æœ‰ä¸€ä¸ªkeyå­˜åœ¨ï¼Œæ‰€æœ‰è®¾ç½®éƒ½ä¼šå¤±è´¥</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MSET name <span class="string">&quot;Redis&quot;</span> <span class="built_in">type</span> <span class="string">&quot;NoSQL&quot;</span> version <span class="string">&quot;6.2&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MGET name <span class="built_in">type</span> version</span><br><span class="line">1) <span class="string">&quot;Redis&quot;</span></span><br><span class="line">2) <span class="string">&quot;NoSQL&quot;</span></span><br><span class="line">3) <span class="string">&quot;6.2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MSETNX - åŸå­æ€§æ“ä½œ</span></span><br><span class="line">127.0.0.1:6379&gt; MSETNX k1 <span class="string">&quot;v1&quot;</span> k2 <span class="string">&quot;v2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1  <span class="comment"># æˆåŠŸ</span></span><br><span class="line">127.0.0.1:6379&gt; MSETNX k1 <span class="string">&quot;v1_new&quot;</span> k3 <span class="string">&quot;v3&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 0  <span class="comment"># å¤±è´¥ï¼Œå› ä¸ºk1å·²å­˜åœ¨ï¼Œk3ä¹Ÿä¸ä¼šè®¾ç½®</span></span><br><span class="line">127.0.0.1:6379&gt; GET k3</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure><h5 id="4-èŒƒå›´æ“ä½œ"><a href="#4-èŒƒå›´æ“ä½œ" class="headerlink" title="4. èŒƒå›´æ“ä½œ"></a>4. èŒƒå›´æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>GETRANGE key start end</code></td><td>è·å–æŒ‡å®šèŒƒå›´çš„å­ä¸²</td><td><code>GETRANGE name 0 4</code></td></tr><tr><td><code>SETRANGE key offset value</code></td><td>ä»æŒ‡å®šä½ç½®å¼€å§‹è¦†å†™</td><td><code>SETRANGE name 0 &quot;MySQL&quot;</code></td></tr></tbody></table><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ç´¢å¼•ä»<strong>0</strong>å¼€å§‹</li><li><code>GETRANGE</code> åŒ…å«èµ·å§‹å’Œç»“æŸä½ç½®ï¼ˆç±»ä¼¼Javaçš„substringï¼Œä½†æ˜¯<strong>å‰åŒ…ååŒ…</strong>ï¼‰</li><li>æ”¯æŒè´Ÿæ•°ç´¢å¼•ï¼š-1è¡¨ç¤ºæœ€åä¸€ä¸ªå­—ç¬¦ï¼Œ-2è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ª</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET greeting <span class="string">&quot;Hello Redis&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; GETRANGE greeting 0 4</span><br><span class="line"><span class="string">&quot;Hello&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; GETRANGE greeting 6 -1</span><br><span class="line"><span class="string">&quot;Redis&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; SETRANGE greeting 6 <span class="string">&quot;World&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 11</span><br><span class="line">127.0.0.1:6379&gt; GET greeting</span><br><span class="line"><span class="string">&quot;Hello World&quot;</span></span><br></pre></td></tr></table></figure><h4 id="åŸå­æ€§è¯´æ˜"><a href="#åŸå­æ€§è¯´æ˜" class="headerlink" title="åŸå­æ€§è¯´æ˜"></a>åŸå­æ€§è¯´æ˜</h4><p>Redisçš„<strong>å•æ¡å‘½ä»¤</strong>éƒ½æ˜¯åŸå­æ€§çš„ï¼Œè¿™æ˜¯ç”±Redisçš„<strong>å•çº¿ç¨‹</strong>ç‰¹æ€§å†³å®šçš„ã€‚</p><p><strong>åŸå­æ“ä½œå®šä¹‰</strong>ï¼š</p><ul><li>ä¸ä¼šè¢«çº¿ç¨‹è°ƒåº¦æœºåˆ¶æ‰“æ–­çš„æ“ä½œ</li><li>ä¸€æ—¦å¼€å§‹å°±ä¼šè¿è¡Œåˆ°ç»“æŸï¼Œä¸­é—´ä¸ä¼šæœ‰ä»»ä½•ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul><p><strong>å®ç°åŸç†</strong>ï¼š</p><ol><li><strong>å•çº¿ç¨‹ç¯å¢ƒ</strong>ï¼šåœ¨å•æ¡æŒ‡ä»¤ä¸­å®Œæˆçš„æ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œå› ä¸ºä¸­æ–­åªèƒ½å‘ç”Ÿåœ¨æŒ‡ä»¤ä¹‹é—´</li><li><strong>å¤šçº¿ç¨‹ç¯å¢ƒ</strong>ï¼šä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹&#x2F;çº¿ç¨‹æ‰“æ–­çš„æ“ä½œæ‰æ˜¯åŸå­çš„</li><li><strong>Redisä¿è¯</strong>ï¼šå•å‘½ä»¤çš„åŸå­æ€§ä¸»è¦å¾—ç›ŠäºRedisçš„å•çº¿ç¨‹æ¨¡å‹</li></ol><p><strong>å¯¹æ¯”ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Javaä¸­çš„i++ä¸æ˜¯åŸå­æ“ä½œ</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">// ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«å¯¹iè¿›è¡Œ++100æ¬¡</span></span><br><span class="line"><span class="comment">// æœ€ç»ˆç»“æœå¯èƒ½æ˜¯ï¼š102ã€150ã€198ç­‰ï¼Œä¸ä¸€å®šæ˜¯200</span></span><br><span class="line"><span class="comment">// å› ä¸ºi++åŒ…å«ä¸‰æ­¥ï¼šè¯»å–ã€è®¡ç®—ã€å†™å…¥ï¼Œå¯èƒ½è¢«æ‰“æ–­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Redisä¸­çš„INCRæ˜¯åŸå­æ“ä½œ</span></span><br><span class="line">INCR counter  <span class="comment">// è¯»å–ã€è®¡ç®—ã€å†™å…¥ä¸€æ¬¡æ€§å®Œæˆï¼Œä¸ä¼šè¢«æ‰“æ–­</span></span><br></pre></td></tr></table></figure><h4 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>Stringç±»å‹çš„åº•å±‚å®ç°æ˜¯<strong>SDSï¼ˆSimple Dynamic Stringï¼Œç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼‰</strong>ã€‚</p><p><strong>SDS vs Cå­—ç¬¦ä¸²</strong>ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th>SDS</th><th>Cå­—ç¬¦ä¸²</th></tr></thead><tbody><tr><td>è·å–é•¿åº¦</td><td>O(1)</td><td>O(n)</td></tr><tr><td>ç¼“å†²åŒºæº¢å‡º</td><td>ä¸ä¼šæº¢å‡ºï¼ˆè‡ªåŠ¨æ‰©å®¹ï¼‰</td><td>å¯èƒ½æº¢å‡º</td></tr><tr><td>äºŒè¿›åˆ¶å®‰å…¨</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>å†…å­˜é‡åˆ†é…</td><td>ç©ºé—´é¢„åˆ†é…+æƒ°æ€§é‡Šæ”¾</td><td>æ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦</td></tr></tbody></table><p><strong>SDSç»“æ„</strong>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sdshdr</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> len;        <span class="comment">// å·²ä½¿ç”¨é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> <span class="built_in">free</span>;       <span class="comment">// æœªä½¿ç”¨é•¿åº¦</span></span><br><span class="line">    <span class="type">char</span> buf[];     <span class="comment">// å­—èŠ‚æ•°ç»„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p><ul><li><strong>ç©ºé—´é¢„åˆ†é…</strong>ï¼šæ‰©å®¹æ—¶é¢„ç•™é¢å¤–ç©ºé—´ï¼Œå‡å°‘é‡åˆ†é…æ¬¡æ•°</li><li><strong>æƒ°æ€§é‡Šæ”¾</strong>ï¼šç¼©çŸ­æ—¶ä¸ç«‹å³é‡Šæ”¾å†…å­˜ï¼Œç•™å¾…åç”¨</li><li><strong>é•¿åº¦ç¼“å­˜</strong>ï¼šè®°å½•å­—ç¬¦ä¸²é•¿åº¦ï¼Œè·å–é•¿åº¦O(1)</li></ul><h3 id="3-2-Hashï¼ˆå“ˆå¸Œï¼‰"><a href="#3-2-Hashï¼ˆå“ˆå¸Œï¼‰" class="headerlink" title="3.2 Hashï¼ˆå“ˆå¸Œï¼‰"></a>3.2 Hashï¼ˆå“ˆå¸Œï¼‰</h3><h4 id="ç±»å‹ä»‹ç»-1"><a href="#ç±»å‹ä»‹ç»-1" class="headerlink" title="ç±»å‹ä»‹ç»"></a>ç±»å‹ä»‹ç»</h4><p>Hashæ˜¯ä¸€ä¸ª<strong>é”®å€¼å¯¹é›†åˆ</strong>ï¼Œæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ç±»ä¼¼Javaä¸­çš„ <code>Map&lt;String, Object&gt;</code> ç»“æ„</li><li>ç‰¹åˆ«é€‚åˆå­˜å‚¨<strong>å¯¹è±¡</strong></li><li>å¯ä»¥é€šè¿‡ <code>key + field</code> ç²¾ç¡®å®šä½åˆ°å…·ä½“å±æ€§</li><li>æ—¢ä¸éœ€è¦é‡å¤å­˜å‚¨æ•°æ®ï¼Œä¹Ÿé¿å…äº†åºåˆ—åŒ–å’Œå¹¶å‘ä¿®æ”¹é—®é¢˜</li></ul><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><strong>ç”¨æˆ·ä¿¡æ¯å­˜å‚¨</strong>ï¼šç”¨æˆ·IDä½œä¸ºkeyï¼Œå§“åã€å¹´é¾„ã€ç”Ÿæ—¥ç­‰ä½œä¸ºfield</li><li><strong>å•†å“ä¿¡æ¯</strong>ï¼šå•†å“IDä½œä¸ºkeyï¼Œåç§°ã€ä»·æ ¼ã€åº“å­˜ç­‰ä½œä¸ºfield</li><li><strong>è´­ç‰©è½¦</strong>ï¼šç”¨æˆ·IDä½œä¸ºkeyï¼Œå•†å“IDä½œä¸ºfieldï¼Œæ•°é‡ä½œä¸ºvalue</li><li><strong>ä¼šè¯ç¼“å­˜</strong>ï¼šsession IDä½œä¸ºkeyï¼Œå„ç§sessionå±æ€§ä½œä¸ºfield</li></ul><p><strong>å­˜å‚¨ç»“æ„ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼ ç»ŸStringæ–¹å¼ï¼šéœ€è¦åºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡</span></span><br><span class="line">user:1001 -&gt; &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="string">&quot;25&quot;</span>,<span class="string">&quot;city&quot;</span>:<span class="string">&quot;åŒ—äº¬&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hashæ–¹å¼ï¼šå¯ä»¥å•ç‹¬æ“ä½œæ¯ä¸ªå±æ€§</span></span><br><span class="line">user:1001</span><br><span class="line">    â”œâ”€ name: <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">    â”œâ”€ age: <span class="string">&quot;25&quot;</span></span><br><span class="line">    â””â”€ city: <span class="string">&quot;åŒ—äº¬&quot;</span></span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>HSET key field value</code></td><td>è®¾ç½®å•ä¸ªå­—æ®µ</td><td><code>HSET user:1001 name &quot;å¼ ä¸‰&quot;</code></td><td>1ï¼ˆæ–°å¢ï¼‰æˆ–0ï¼ˆæ›´æ–°ï¼‰</td></tr><tr><td><code>HGET key field</code></td><td>è·å–å•ä¸ªå­—æ®µ</td><td><code>HGET user:1001 name</code></td><td>â€œå¼ ä¸‰â€</td></tr><tr><td><code>HMSET key f1 v1 f2 v2 ...</code></td><td>æ‰¹é‡è®¾ç½®å¤šä¸ªå­—æ®µ</td><td><code>HMSET user:1001 name &quot;å¼ ä¸‰&quot; age &quot;25&quot;</code></td><td>OK</td></tr><tr><td><code>HMGET key field1 field2 ...</code></td><td>æ‰¹é‡è·å–å¤šä¸ªå­—æ®µ</td><td><code>HMGET user:1001 name age</code></td><td>[â€œå¼ ä¸‰â€, â€œ25â€]</td></tr><tr><td><code>HGETALL key</code></td><td>è·å–æ‰€æœ‰å­—æ®µå’Œå€¼</td><td><code>HGETALL user:1001</code></td><td>field1, value1, field2, value2â€¦</td></tr><tr><td><code>HEXISTS key field</code></td><td>åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨</td><td><code>HEXISTS user:1001 name</code></td><td>1ï¼ˆå­˜åœ¨ï¼‰æˆ–0ï¼ˆä¸å­˜åœ¨ï¼‰</td></tr><tr><td><code>HKEYS key</code></td><td>è·å–æ‰€æœ‰å­—æ®µå</td><td><code>HKEYS user:1001</code></td><td>[â€œnameâ€, â€œageâ€, â€œcityâ€]</td></tr><tr><td><code>HVALS key</code></td><td>è·å–æ‰€æœ‰å€¼</td><td><code>HVALS user:1001</code></td><td>[â€œå¼ ä¸‰â€, â€œ25â€, â€œåŒ—äº¬â€]</td></tr><tr><td><code>HLEN key</code></td><td>è·å–å­—æ®µæ•°é‡</td><td><code>HLEN user:1001</code></td><td>3</td></tr><tr><td><code>HDEL key field1 field2 ...</code></td><td>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µ</td><td><code>HDEL user:1001 age</code></td><td>åˆ é™¤çš„å­—æ®µæ•°é‡</td></tr><tr><td><code>HINCRBY key field increment</code></td><td>å­—æ®µå€¼å¢åŠ æŒ‡å®šæ•°å€¼</td><td><code>HINCRBY user:1001 age 1</code></td><td>å¢åŠ åçš„å€¼</td></tr><tr><td><code>HINCRBYFLOAT key field increment</code></td><td>å­—æ®µå€¼å¢åŠ æµ®ç‚¹æ•°</td><td><code>HINCRBYFLOAT user:1001 score 0.5</code></td><td>å¢åŠ åçš„å€¼</td></tr><tr><td><code>HSETNX key field value</code></td><td>å­—æ®µä¸å­˜åœ¨æ—¶æ‰è®¾ç½®</td><td><code>HSETNX user:1001 email &quot;xx@qq.com&quot;</code></td><td>1ï¼ˆæˆåŠŸï¼‰æˆ–0ï¼ˆå¤±è´¥ï¼‰</td></tr></tbody></table><h4 id="æ“ä½œç¤ºä¾‹"><a href="#æ“ä½œç¤ºä¾‹" class="headerlink" title="æ“ä½œç¤ºä¾‹"></a>æ“ä½œç¤ºä¾‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">127.0.0.1:6379&gt; HMSET user:1001 name <span class="string">&quot;å¼ ä¸‰&quot;</span> age <span class="string">&quot;25&quot;</span> city <span class="string">&quot;åŒ—äº¬&quot;</span> salary <span class="string">&quot;15000&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å•ä¸ªå­—æ®µ</span></span><br><span class="line">127.0.0.1:6379&gt; HGET user:1001 name</span><br><span class="line"><span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å¤šä¸ªå­—æ®µ</span></span><br><span class="line">127.0.0.1:6379&gt; HMGET user:1001 name age city</span><br><span class="line">1) <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">2) <span class="string">&quot;25&quot;</span></span><br><span class="line">3) <span class="string">&quot;åŒ—äº¬&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ‰€æœ‰å­—æ®µ</span></span><br><span class="line">127.0.0.1:6379&gt; HGETALL user:1001</span><br><span class="line">1) <span class="string">&quot;name&quot;</span></span><br><span class="line">2) <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">3) <span class="string">&quot;age&quot;</span></span><br><span class="line">4) <span class="string">&quot;25&quot;</span></span><br><span class="line">5) <span class="string">&quot;city&quot;</span></span><br><span class="line">6) <span class="string">&quot;åŒ—äº¬&quot;</span></span><br><span class="line">7) <span class="string">&quot;salary&quot;</span></span><br><span class="line">8) <span class="string">&quot;15000&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">127.0.0.1:6379&gt; HEXISTS user:1001 email</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ å¹´é¾„</span></span><br><span class="line">127.0.0.1:6379&gt; HINCRBY user:1001 age 1</span><br><span class="line">(<span class="built_in">integer</span>) 26</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ‰€æœ‰å­—æ®µå</span></span><br><span class="line">127.0.0.1:6379&gt; HKEYS user:1001</span><br><span class="line">1) <span class="string">&quot;name&quot;</span></span><br><span class="line">2) <span class="string">&quot;age&quot;</span></span><br><span class="line">3) <span class="string">&quot;city&quot;</span></span><br><span class="line">4) <span class="string">&quot;salary&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å­—æ®µ</span></span><br><span class="line">127.0.0.1:6379&gt; HDEL user:1001 salary</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><h4 id="æ•°æ®ç»“æ„-1"><a href="#æ•°æ®ç»“æ„-1" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>Hashç±»å‹çš„åº•å±‚å®ç°æœ‰<strong>ä¸¤ç§</strong>æ•°æ®ç»“æ„ï¼š</p><table><thead><tr><th>æ•°æ®ç»“æ„</th><th>ä½¿ç”¨æ¡ä»¶</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>ziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰</strong></td><td>â€¢ field-valueé•¿åº¦è¾ƒçŸ­<br>â€¢ å…ƒç´ ä¸ªæ•°è¾ƒå°‘</td><td>ç´§å‡‘å­˜å‚¨ï¼ŒèŠ‚çœå†…å­˜</td></tr><tr><td><strong>hashtableï¼ˆå“ˆå¸Œè¡¨ï¼‰</strong></td><td>â€¢ field-valueé•¿åº¦è¾ƒé•¿<br>â€¢ å…ƒç´ ä¸ªæ•°è¾ƒå¤š</td><td>å¿«é€ŸæŸ¥æ‰¾ï¼ŒO(1)å¤æ‚åº¦</td></tr></tbody></table><p><strong>è§¦å‘æ¡ä»¶</strong>ï¼ˆå¯åœ¨redis.confä¸­é…ç½®ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“æ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶æ—¶ï¼Œä»ziplistè½¬ä¸ºhashtable</span></span><br><span class="line">hash-max-ziplist-entries 512   <span class="comment"># å…ƒç´ ä¸ªæ•°è¶…è¿‡512</span></span><br><span class="line">hash-max-ziplist-value 64      <span class="comment"># å•ä¸ªå…ƒç´ å¤§å°è¶…è¿‡64å­—èŠ‚</span></span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><ul><li><strong>ziplist</strong>ï¼šå†…å­˜å ç”¨å°ï¼Œä½†æŸ¥æ‰¾æ€§èƒ½O(n)</li><li><strong>hashtable</strong>ï¼šæŸ¥æ‰¾æ€§èƒ½O(1)ï¼Œä½†å†…å­˜å ç”¨è¾ƒå¤§</li></ul><h3 id="3-3-Listï¼ˆåˆ—è¡¨ï¼‰"><a href="#3-3-Listï¼ˆåˆ—è¡¨ï¼‰" class="headerlink" title="3.3 Listï¼ˆåˆ—è¡¨ï¼‰"></a>3.3 Listï¼ˆåˆ—è¡¨ï¼‰</h3><h4 id="ç±»å‹ä»‹ç»-2"><a href="#ç±»å‹ä»‹ç»-2" class="headerlink" title="ç±»å‹ä»‹ç»"></a>ç±»å‹ä»‹ç»</h4><p>Listæ˜¯ä¸€ä¸ª<strong>ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨</strong>ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºï¼Œæ”¯æŒä»å¤´éƒ¨æˆ–å°¾éƒ¨æ“ä½œã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><strong>å•é”®å¤šå€¼</strong>ï¼šä¸€ä¸ªkeyå¯¹åº”å¤šä¸ªvalue</li><li><strong>æœ‰åº</strong>ï¼šæŒ‰ç…§æ’å…¥é¡ºåºæ’åº</li><li><strong>åŒå‘æ“ä½œ</strong>ï¼šå¯ä»¥ä»å·¦è¾¹ï¼ˆå¤´éƒ¨ï¼‰æˆ–å³è¾¹ï¼ˆå°¾éƒ¨ï¼‰æ“ä½œ</li><li><strong>åº•å±‚ç»“æ„</strong>ï¼šåŒå‘é“¾è¡¨ï¼Œä¸¤ç«¯æ“ä½œæ€§èƒ½é«˜O(1)ï¼Œä¸­é—´æ“ä½œæ€§èƒ½è¾ƒå·®O(n)</li><li><strong>å¯é‡å¤</strong>ï¼šå…è®¸å­˜å‚¨é‡å¤å…ƒç´ </li></ul><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šLPUSH + RPOP &#x3D; é˜Ÿåˆ—ï¼ŒLPUSH + LPOP &#x3D; æ ˆ</li><li><strong>æœ€æ–°åˆ—è¡¨</strong>ï¼šæ–‡ç« åˆ—è¡¨ã€è¯„è®ºåˆ—è¡¨ï¼ˆæœ€æ–°çš„åœ¨å‰é¢ï¼‰</li><li><strong>ç²‰ä¸åˆ—è¡¨</strong>ï¼šæŒ‰ç…§å…³æ³¨æ—¶é—´æ’åº</li><li><strong>Timelineæ—¶é—´è½´</strong>ï¼šå¾®åšã€æœ‹å‹åœˆç­‰ç¤¾äº¤åº”ç”¨</li></ul><p><strong>å­˜å‚¨ç»“æ„ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»å·¦è¾¹æ’å…¥</span></span><br><span class="line">LPUSH mylist <span class="string">&quot;c&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">ç»“æœï¼š[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å³è¾¹æ’å…¥</span></span><br><span class="line">RPUSH mylist <span class="string">&quot;d&quot;</span> <span class="string">&quot;e&quot;</span></span><br><span class="line">ç»“æœï¼š[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>]</span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨å‘½ä»¤-1"><a href="#å¸¸ç”¨å‘½ä»¤-1" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><h5 id="1-æ’å…¥æ“ä½œ"><a href="#1-æ’å…¥æ“ä½œ" class="headerlink" title="1. æ’å…¥æ“ä½œ"></a>1. æ’å…¥æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>LPUSH key value1 value2 ...</code></td><td>ä»å·¦è¾¹æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå€¼</td><td><code>LPUSH list &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></td><td>åˆ—è¡¨é•¿åº¦</td></tr><tr><td><code>RPUSH key value1 value2 ...</code></td><td>ä»å³è¾¹æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå€¼</td><td><code>RPUSH list &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></td><td>åˆ—è¡¨é•¿åº¦</td></tr><tr><td><code>LPUSHX key value</code></td><td>keyå­˜åœ¨æ—¶ä»å·¦è¾¹æ’å…¥</td><td><code>LPUSHX list &quot;0&quot;</code></td><td>åˆ—è¡¨é•¿åº¦</td></tr><tr><td><code>RPUSHX key value</code></td><td>keyå­˜åœ¨æ—¶ä»å³è¾¹æ’å…¥</td><td><code>RPUSHX list &quot;9&quot;</code></td><td>åˆ—è¡¨é•¿åº¦</td></tr><tr><td><code>LINSERT key BEFORE|AFTER pivot value</code></td><td>åœ¨æŒ‡å®šå…ƒç´ å‰&#x2F;åæ’å…¥</td><td><code>LINSERT list BEFORE &quot;b&quot; &quot;new&quot;</code></td><td>åˆ—è¡¨é•¿åº¦</td></tr></tbody></table><h5 id="2-å¼¹å‡ºæ“ä½œ"><a href="#2-å¼¹å‡ºæ“ä½œ" class="headerlink" title="2. å¼¹å‡ºæ“ä½œ"></a>2. å¼¹å‡ºæ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>LPOP key</code></td><td>ä»å·¦è¾¹å¼¹å‡ºä¸€ä¸ªå€¼</td><td><code>LPOP list</code></td><td>å¼¹å‡ºçš„å€¼</td></tr><tr><td><code>RPOP key</code></td><td>ä»å³è¾¹å¼¹å‡ºä¸€ä¸ªå€¼</td><td><code>RPOP list</code></td><td>å¼¹å‡ºçš„å€¼</td></tr><tr><td><code>BLPOP key1 key2 ... timeout</code></td><td>é˜»å¡å¼å·¦è¾¹å¼¹å‡º</td><td><code>BLPOP list 10</code></td><td>[key, value]</td></tr><tr><td><code>BRPOP key1 key2 ... timeout</code></td><td>é˜»å¡å¼å³è¾¹å¼¹å‡º</td><td><code>BRPOP list 10</code></td><td>[key, value]</td></tr><tr><td><code>RPOPLPUSH source destination</code></td><td>ä»sourceå³è¾¹å¼¹å‡ºæ’å…¥destinationå·¦è¾¹</td><td><code>RPOPLPUSH list1 list2</code></td><td>ç§»åŠ¨çš„å€¼</td></tr></tbody></table><blockquote><p><strong>å€¼åœ¨é”®åœ¨ï¼Œå€¼å…‰é”®äº¡</strong>ï¼šå½“åˆ—è¡¨ä¸­æœ€åä¸€ä¸ªå…ƒç´ è¢«å¼¹å‡ºæ—¶ï¼Œè¯¥keyä¼šè‡ªåŠ¨åˆ é™¤</p></blockquote><h5 id="3-æŸ¥è¯¢æ“ä½œ"><a href="#3-æŸ¥è¯¢æ“ä½œ" class="headerlink" title="3. æŸ¥è¯¢æ“ä½œ"></a>3. æŸ¥è¯¢æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>LRANGE key start stop</code></td><td>è·å–æŒ‡å®šèŒƒå›´çš„å…ƒç´ </td><td><code>LRANGE list 0 -1</code></td><td>å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>LINDEX key index</code></td><td>è·å–æŒ‡å®šç´¢å¼•çš„å…ƒç´ </td><td><code>LINDEX list 0</code></td><td>å…ƒç´ å€¼</td></tr><tr><td><code>LLEN key</code></td><td>è·å–åˆ—è¡¨é•¿åº¦</td><td><code>LLEN list</code></td><td>åˆ—è¡¨é•¿åº¦</td></tr></tbody></table><blockquote><p><strong>ç´¢å¼•è¯´æ˜</strong>ï¼š</p><ul><li>0 è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆæœ€å·¦è¾¹ï¼‰</li><li>-1 è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ï¼ˆæœ€å³è¾¹ï¼‰</li><li><code>LRANGE list 0 -1</code> è¡¨ç¤ºè·å–æ‰€æœ‰å…ƒç´ </li></ul></blockquote><h5 id="4-ä¿®æ”¹-åˆ é™¤æ“ä½œ"><a href="#4-ä¿®æ”¹-åˆ é™¤æ“ä½œ" class="headerlink" title="4. ä¿®æ”¹&#x2F;åˆ é™¤æ“ä½œ"></a>4. ä¿®æ”¹&#x2F;åˆ é™¤æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>LSET key index value</code></td><td>ä¿®æ”¹æŒ‡å®šç´¢å¼•çš„å€¼</td><td><code>LSET list 0 &quot;new&quot;</code></td><td>OK</td></tr><tr><td><code>LREM key count value</code></td><td>åˆ é™¤countä¸ªæŒ‡å®šå€¼</td><td><code>LREM list 2 &quot;a&quot;</code></td><td>åˆ é™¤çš„æ•°é‡</td></tr><tr><td><code>LTRIM key start stop</code></td><td>ä¿ç•™æŒ‡å®šèŒƒå›´ï¼Œåˆ é™¤å…¶ä»–</td><td><code>LTRIM list 0 2</code></td><td>OK</td></tr></tbody></table><p><strong>LREMçš„countå‚æ•°</strong>ï¼š</p><ul><li><code>count &gt; 0</code>ï¼šä»å·¦è¾¹åˆ é™¤countä¸ªvalue</li><li><code>count &lt; 0</code>ï¼šä»å³è¾¹åˆ é™¤|count|ä¸ªvalue</li><li><code>count = 0</code>ï¼šåˆ é™¤æ‰€æœ‰value</li></ul><h4 id="æ“ä½œç¤ºä¾‹-1"><a href="#æ“ä½œç¤ºä¾‹-1" class="headerlink" title="æ“ä½œç¤ºä¾‹"></a>æ“ä½œç¤ºä¾‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»å·¦è¾¹æ’å…¥</span></span><br><span class="line">127.0.0.1:6379&gt; LPUSH mylist <span class="string">&quot;c&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;a&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;a&quot;</span></span><br><span class="line">2) <span class="string">&quot;b&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å³è¾¹æ’å…¥</span></span><br><span class="line">127.0.0.1:6379&gt; RPUSH mylist <span class="string">&quot;d&quot;</span> <span class="string">&quot;e&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;a&quot;</span></span><br><span class="line">2) <span class="string">&quot;b&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;d&quot;</span></span><br><span class="line">5) <span class="string">&quot;e&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æŒ‡å®šå…ƒç´ </span></span><br><span class="line">127.0.0.1:6379&gt; LINDEX mylist 0</span><br><span class="line"><span class="string">&quot;a&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LINDEX mylist -1</span><br><span class="line"><span class="string">&quot;e&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–åˆ—è¡¨é•¿åº¦</span></span><br><span class="line">127.0.0.1:6379&gt; LLEN mylist</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å·¦è¾¹å¼¹å‡º</span></span><br><span class="line">127.0.0.1:6379&gt; LPOP mylist</span><br><span class="line"><span class="string">&quot;a&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;b&quot;</span></span><br><span class="line">2) <span class="string">&quot;c&quot;</span></span><br><span class="line">3) <span class="string">&quot;d&quot;</span></span><br><span class="line">4) <span class="string">&quot;e&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æŒ‡å®šå…ƒç´ å‰æ’å…¥</span></span><br><span class="line">127.0.0.1:6379&gt; LINSERT mylist BEFORE <span class="string">&quot;c&quot;</span> <span class="string">&quot;new&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;b&quot;</span></span><br><span class="line">2) <span class="string">&quot;new&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;d&quot;</span></span><br><span class="line">5) <span class="string">&quot;e&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šå€¼</span></span><br><span class="line">127.0.0.1:6379&gt; LREM mylist 1 <span class="string">&quot;new&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æŒ‡å®šç´¢å¼•çš„å€¼</span></span><br><span class="line">127.0.0.1:6379&gt; LSET mylist 0 <span class="string">&quot;B&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;B&quot;</span></span><br><span class="line">2) <span class="string">&quot;c&quot;</span></span><br><span class="line">3) <span class="string">&quot;d&quot;</span></span><br><span class="line">4) <span class="string">&quot;e&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RPOPLPUSH å®ç°é˜Ÿåˆ—è½®è½¬</span></span><br><span class="line">127.0.0.1:6379&gt; RPOPLPUSH mylist mylist</span><br><span class="line"><span class="string">&quot;e&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;B&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;d&quot;</span></span><br></pre></td></tr></table></figure><h4 id="æ•°æ®ç»“æ„-2"><a href="#æ•°æ®ç»“æ„-2" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>Listçš„åº•å±‚å®ç°æ˜¯ <strong>quickListï¼ˆå¿«é€Ÿé“¾è¡¨ï¼‰</strong>ã€‚</p><p><strong>æ¼”è¿›è¿‡ç¨‹</strong>ï¼š</p><table><thead><tr><th>ç‰ˆæœ¬</th><th>æ•°æ®ç»“æ„</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ—©æœŸç‰ˆæœ¬</strong></td><td>ziplist æˆ– linkedlist</td><td>å…ƒç´ å°‘ç”¨ziplistï¼Œå…ƒç´ å¤šç”¨linkedlist</td></tr><tr><td><strong>Redis 3.2+</strong></td><td><strong>quicklist</strong></td><td>ç»“åˆziplistå’Œlinkedlistçš„ä¼˜ç‚¹</td></tr></tbody></table><p><strong>quicklistç»“æ„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">quicklist = ziplist + linkedlist</span><br><span class="line"></span><br><span class="line">[ziplist1] &lt;-&gt; [ziplist2] &lt;-&gt; [ziplist3] &lt;-&gt; [ziplist4]</span><br><span class="line">    â†“              â†“              â†“              â†“</span><br><span class="line"> [a,b,c]       [d,e,f]       [g,h,i]       [j,k,l]</span><br></pre></td></tr></table></figure><p><strong>è®¾è®¡ç†å¿µ</strong>ï¼š</p><ul><li>å°†å¤šä¸ª <strong>ziplist</strong> ä½¿ç”¨<strong>åŒå‘æŒ‡é’ˆ</strong>ä¸²èµ·æ¥</li><li>æ¯ä¸ªziplistå­˜å‚¨ä¸€éƒ¨åˆ†è¿ç»­çš„å…ƒç´ </li><li>æ—¢æ»¡è¶³äº†å¿«é€Ÿçš„æ’å…¥åˆ é™¤æ€§èƒ½ï¼Œåˆé¿å…äº†å¤§é‡æŒ‡é’ˆç©ºé—´æµªè´¹</li></ul><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ol><li><strong>ziplist</strong>ï¼šç´§å‡‘å­˜å‚¨ï¼ŒèŠ‚çœå†…å­˜</li><li><strong>linkedlist</strong>ï¼šåŒå‘é“¾è¡¨ï¼Œæ’å…¥åˆ é™¤å¿«O(1)</li><li><strong>quicklist</strong>ï¼šç»“åˆä¸¤è€…ä¼˜ç‚¹ï¼Œå¹³è¡¡æ€§èƒ½å’Œå†…å­˜</li></ol><p><strong>å¯¹æ¯”æ™®é€šé“¾è¡¨</strong>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šé“¾è¡¨ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰prevå’ŒnextæŒ‡é’ˆ</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> *<span class="title">prev</span>;</span>  <span class="comment">// 8å­—èŠ‚</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> *<span class="title">next</span>;</span>  <span class="comment">// 8å­—èŠ‚</span></span><br><span class="line">    <span class="type">void</span> *value;            <span class="comment">// 8å­—èŠ‚</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å­˜å‚¨ä¸€ä¸ªint(4å­—èŠ‚)éœ€è¦24å­—èŠ‚ï¼Œç©ºé—´æµªè´¹ä¸¥é‡ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// quicklistï¼šå¤šä¸ªå…ƒç´ å…±äº«ä¸€ç»„æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">// å­˜å‚¨12ä¸ªintï¼Œåªéœ€è¦2ä¸ªæŒ‡é’ˆï¼Œç©ºé—´åˆ©ç”¨ç‡å¤§å¹…æå‡</span></span><br></pre></td></tr></table></figure><h3 id="3-4-Setï¼ˆé›†åˆï¼‰"><a href="#3-4-Setï¼ˆé›†åˆï¼‰" class="headerlink" title="3.4 Setï¼ˆé›†åˆï¼‰"></a>3.4 Setï¼ˆé›†åˆï¼‰</h3><h4 id="ç±»å‹ä»‹ç»-3"><a href="#ç±»å‹ä»‹ç»-3" class="headerlink" title="ç±»å‹ä»‹ç»"></a>ç±»å‹ä»‹ç»</h4><p>Setæ˜¯ä¸€ä¸ª<strong>æ— åºã€ä¸é‡å¤</strong>çš„å­—ç¬¦ä¸²é›†åˆã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><strong>è‡ªåŠ¨å»é‡</strong>ï¼šä¸å…è®¸é‡å¤å…ƒç´ </li><li><strong>æ— åºæ€§</strong>ï¼šå…ƒç´ æ²¡æœ‰é¡ºåº</li><li><strong>é«˜æ•ˆæ€§</strong>ï¼šæ·»åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ <strong>O(1)</strong></li><li><strong>åº•å±‚ç»“æ„</strong>ï¼švalueä¸ºnullçš„hashè¡¨</li></ul><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><strong>æ ‡ç­¾ç³»ç»Ÿ</strong>ï¼šä¸€ç¯‡æ–‡ç« çš„æ ‡ç­¾ã€ä¸€ä¸ªç”¨æˆ·çš„å…´è¶£æ ‡ç­¾</li><li><strong>å…±åŒå¥½å‹</strong>ï¼šåˆ©ç”¨äº¤é›†æ“ä½œ</li><li><strong>æŠ½å¥–ç³»ç»Ÿ</strong>ï¼šSPOPéšæœºæŠ½å–ï¼Œè‡ªåŠ¨å»é‡</li><li><strong>ç‚¹èµ&#x2F;æ”¶è—</strong>ï¼šè®°å½•ç‚¹èµç”¨æˆ·IDï¼Œè‡ªåŠ¨å»é‡</li><li><strong>é»‘åå•&#x2F;ç™½åå•</strong>ï¼šå¿«é€Ÿåˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨åå•ä¸­</li></ul><p><strong>å¯¹æ¯”List</strong>ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th>Set</th><th>List</th></tr></thead><tbody><tr><td>é‡å¤</td><td>ä¸å…è®¸é‡å¤</td><td>å…è®¸é‡å¤</td></tr><tr><td>é¡ºåº</td><td>æ— åº</td><td>æœ‰åºï¼ˆæ’å…¥é¡ºåºï¼‰</td></tr><tr><td>æŸ¥æ‰¾æˆå‘˜</td><td>O(1)</td><td>O(n)</td></tr><tr><td>é›†åˆè¿ç®—</td><td>æ”¯æŒï¼ˆäº¤é›†ã€å¹¶é›†ã€å·®é›†ï¼‰</td><td>ä¸æ”¯æŒ</td></tr></tbody></table><h4 id="å¸¸ç”¨å‘½ä»¤-2"><a href="#å¸¸ç”¨å‘½ä»¤-2" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><h5 id="1-åŸºç¡€æ“ä½œ-1"><a href="#1-åŸºç¡€æ“ä½œ-1" class="headerlink" title="1. åŸºç¡€æ“ä½œ"></a>1. åŸºç¡€æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>SADD key member1 member2 ...</code></td><td>æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </td><td><code>SADD tags &quot;Java&quot; &quot;Redis&quot;</code></td><td>æˆåŠŸæ·»åŠ çš„æ•°é‡</td></tr><tr><td><code>SMEMBERS key</code></td><td>è·å–æ‰€æœ‰å…ƒç´ </td><td><code>SMEMBERS tags</code></td><td>å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>SISMEMBER key member</code></td><td>åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</td><td><code>SISMEMBER tags &quot;Java&quot;</code></td><td>1ï¼ˆå­˜åœ¨ï¼‰æˆ–0ï¼ˆä¸å­˜åœ¨ï¼‰</td></tr><tr><td><code>SCARD key</code></td><td>è·å–å…ƒç´ ä¸ªæ•°</td><td><code>SCARD tags</code></td><td>å…ƒç´ æ•°é‡</td></tr><tr><td><code>SREM key member1 member2 ...</code></td><td>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </td><td><code>SREM tags &quot;Java&quot;</code></td><td>æˆåŠŸåˆ é™¤çš„æ•°é‡</td></tr><tr><td><code>SPOP key [count]</code></td><td>éšæœºå¼¹å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </td><td><code>SPOP tags 2</code></td><td>å¼¹å‡ºçš„å…ƒç´ </td></tr><tr><td><code>SRANDMEMBER key [count]</code></td><td>éšæœºè·å–å…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰</td><td><code>SRANDMEMBER tags 3</code></td><td>éšæœºå…ƒç´ åˆ—è¡¨</td></tr></tbody></table><blockquote><p><strong>SADDè‡ªåŠ¨å»é‡</strong>ï¼šå·²å­˜åœ¨çš„å…ƒç´ ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼Œä¸ä¼šé‡å¤æ·»åŠ </p></blockquote><h5 id="2-é›†åˆè¿ç®—"><a href="#2-é›†åˆè¿ç®—" class="headerlink" title="2. é›†åˆè¿ç®—"></a>2. é›†åˆè¿ç®—</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>SINTER key1 key2 ...</code></td><td>äº¤é›†</td><td><code>SINTER set1 set2</code></td><td>äº¤é›†å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>SINTERSTORE dest key1 key2 ...</code></td><td>äº¤é›†å¹¶å­˜å‚¨</td><td><code>SINTERSTORE result set1 set2</code></td><td>äº¤é›†å…ƒç´ æ•°é‡</td></tr><tr><td><code>SUNION key1 key2 ...</code></td><td>å¹¶é›†</td><td><code>SUNION set1 set2</code></td><td>å¹¶é›†å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>SUNIONSTORE dest key1 key2 ...</code></td><td>å¹¶é›†å¹¶å­˜å‚¨</td><td><code>SUNIONSTORE result set1 set2</code></td><td>å¹¶é›†å…ƒç´ æ•°é‡</td></tr><tr><td><code>SDIFF key1 key2 ...</code></td><td>å·®é›†</td><td><code>SDIFF set1 set2</code></td><td>å·®é›†å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>SDIFFSTORE dest key1 key2 ...</code></td><td>å·®é›†å¹¶å­˜å‚¨</td><td><code>SDIFFSTORE result set1 set2</code></td><td>å·®é›†å…ƒç´ æ•°é‡</td></tr><tr><td><code>SMOVE source dest member</code></td><td>ç§»åŠ¨å…ƒç´ </td><td><code>SMOVE set1 set2 &quot;Java&quot;</code></td><td>1ï¼ˆæˆåŠŸï¼‰æˆ–0ï¼ˆå¤±è´¥ï¼‰</td></tr></tbody></table><p><strong>é›†åˆè¿ç®—è¯´æ˜</strong>ï¼š</p><ul><li><strong>äº¤é›†ï¼ˆSINTERï¼‰</strong>ï¼šA âˆ© Bï¼Œä¸¤ä¸ªé›†åˆéƒ½æœ‰çš„å…ƒç´ </li><li><strong>å¹¶é›†ï¼ˆSUNIONï¼‰</strong>ï¼šA âˆª Bï¼Œä¸¤ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ ï¼ˆå»é‡ï¼‰</li><li><strong>å·®é›†ï¼ˆSDIFFï¼‰</strong>ï¼šA - Bï¼Œåœ¨Aä¸­ä½†ä¸åœ¨Bä¸­çš„å…ƒç´ </li></ul><h4 id="æ“ä½œç¤ºä¾‹-2"><a href="#æ“ä½œç¤ºä¾‹-2" class="headerlink" title="æ“ä½œç¤ºä¾‹"></a>æ“ä½œç¤ºä¾‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ å…ƒç´ </span></span><br><span class="line">127.0.0.1:6379&gt; SADD tags <span class="string">&quot;Java&quot;</span> <span class="string">&quot;Redis&quot;</span> <span class="string">&quot;MySQL&quot;</span> <span class="string">&quot;Spring&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS tags</span><br><span class="line">1) <span class="string">&quot;Java&quot;</span></span><br><span class="line">2) <span class="string">&quot;Redis&quot;</span></span><br><span class="line">3) <span class="string">&quot;MySQL&quot;</span></span><br><span class="line">4) <span class="string">&quot;Spring&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER tags <span class="string">&quot;Java&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER tags <span class="string">&quot;Python&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">127.0.0.1:6379&gt; SCARD tags</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># éšæœºè·å–å…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER tags 2</span><br><span class="line">1) <span class="string">&quot;Redis&quot;</span></span><br><span class="line">2) <span class="string">&quot;Java&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éšæœºå¼¹å‡ºå…ƒç´ ï¼ˆåˆ é™¤ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; SPOP tags</span><br><span class="line"><span class="string">&quot;MySQL&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS tags</span><br><span class="line">1) <span class="string">&quot;Java&quot;</span></span><br><span class="line">2) <span class="string">&quot;Redis&quot;</span></span><br><span class="line">3) <span class="string">&quot;Spring&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é›†åˆè¿ç®—ç¤ºä¾‹</span></span><br><span class="line">127.0.0.1:6379&gt; SADD user:1:tags <span class="string">&quot;Java&quot;</span> <span class="string">&quot;Redis&quot;</span> <span class="string">&quot;MySQL&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; SADD user:2:tags <span class="string">&quot;Java&quot;</span> <span class="string">&quot;Python&quot;</span> <span class="string">&quot;Redis&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤é›†ï¼šå…±åŒæ ‡ç­¾</span></span><br><span class="line">127.0.0.1:6379&gt; SINTER user:1:tags user:2:tags</span><br><span class="line">1) <span class="string">&quot;Java&quot;</span></span><br><span class="line">2) <span class="string">&quot;Redis&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¹¶é›†ï¼šæ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">127.0.0.1:6379&gt; SUNION user:1:tags user:2:tags</span><br><span class="line">1) <span class="string">&quot;Java&quot;</span></span><br><span class="line">2) <span class="string">&quot;Redis&quot;</span></span><br><span class="line">3) <span class="string">&quot;MySQL&quot;</span></span><br><span class="line">4) <span class="string">&quot;Python&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å·®é›†ï¼šuser1ç‹¬æœ‰çš„æ ‡ç­¾</span></span><br><span class="line">127.0.0.1:6379&gt; SDIFF user:1:tags user:2:tags</span><br><span class="line">1) <span class="string">&quot;MySQL&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»åŠ¨å…ƒç´ </span></span><br><span class="line">127.0.0.1:6379&gt; SMOVE user:1:tags user:2:tags <span class="string">&quot;MySQL&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><h4 id="å®é™…åº”ç”¨æ¡ˆä¾‹"><a href="#å®é™…åº”ç”¨æ¡ˆä¾‹" class="headerlink" title="å®é™…åº”ç”¨æ¡ˆä¾‹"></a>å®é™…åº”ç”¨æ¡ˆä¾‹</h4><h5 id="æ¡ˆä¾‹1ï¼šå…±åŒå¥½å‹"><a href="#æ¡ˆä¾‹1ï¼šå…±åŒå¥½å‹" class="headerlink" title="æ¡ˆä¾‹1ï¼šå…±åŒå¥½å‹"></a>æ¡ˆä¾‹1ï¼šå…±åŒå¥½å‹</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨æˆ·Açš„å¥½å‹</span></span><br><span class="line">SADD user:A:friends <span class="string">&quot;userB&quot;</span> <span class="string">&quot;userC&quot;</span> <span class="string">&quot;userD&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·Eçš„å¥½å‹</span></span><br><span class="line">SADD user:E:friends <span class="string">&quot;userC&quot;</span> <span class="string">&quot;userD&quot;</span> <span class="string">&quot;userF&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾Aå’ŒEçš„å…±åŒå¥½å‹</span></span><br><span class="line">SINTER user:A:friends user:E:friends</span><br><span class="line"><span class="comment"># ç»“æœï¼š[&quot;userC&quot;, &quot;userD&quot;]</span></span><br></pre></td></tr></table></figure><h5 id="æ¡ˆä¾‹2ï¼šæŠ½å¥–ç³»ç»Ÿ"><a href="#æ¡ˆä¾‹2ï¼šæŠ½å¥–ç³»ç»Ÿ" class="headerlink" title="æ¡ˆä¾‹2ï¼šæŠ½å¥–ç³»ç»Ÿ"></a>æ¡ˆä¾‹2ï¼šæŠ½å¥–ç³»ç»Ÿ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ å‚ä¸æŠ½å¥–çš„ç”¨æˆ·</span></span><br><span class="line">SADD lottery:2024 <span class="string">&quot;user1&quot;</span> <span class="string">&quot;user2&quot;</span> <span class="string">&quot;user3&quot;</span> <span class="string">&quot;user4&quot;</span> <span class="string">&quot;user5&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠ½å–1ä¸ªä¸€ç­‰å¥–</span></span><br><span class="line">SPOP lottery:2024 1</span><br><span class="line"><span class="comment"># ç»“æœï¼š[&quot;user3&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠ½å–2ä¸ªäºŒç­‰å¥–</span></span><br><span class="line">SPOP lottery:2024 2</span><br><span class="line"><span class="comment"># ç»“æœï¼š[&quot;user1&quot;, &quot;user5&quot;]</span></span><br></pre></td></tr></table></figure><h5 id="æ¡ˆä¾‹3ï¼šæ ‡ç­¾ç³»ç»Ÿ"><a href="#æ¡ˆä¾‹3ï¼šæ ‡ç­¾ç³»ç»Ÿ" class="headerlink" title="æ¡ˆä¾‹3ï¼šæ ‡ç­¾ç³»ç»Ÿ"></a>æ¡ˆä¾‹3ï¼šæ ‡ç­¾ç³»ç»Ÿ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»™æ–‡ç« æ·»åŠ æ ‡ç­¾</span></span><br><span class="line">SADD article:1001:tags <span class="string">&quot;Java&quot;</span> <span class="string">&quot;åç«¯&quot;</span> <span class="string">&quot;Redis&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢æŸä¸ªæ ‡ç­¾æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">SISMEMBER article:1001:tags <span class="string">&quot;Java&quot;</span></span><br><span class="line"><span class="comment"># ç»“æœï¼š1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ–‡ç« çš„æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">SMEMBERS article:1001:tags</span><br><span class="line"><span class="comment"># ç»“æœï¼š[&quot;Java&quot;, &quot;åç«¯&quot;, &quot;Redis&quot;]</span></span><br></pre></td></tr></table></figure><h4 id="æ•°æ®ç»“æ„-3"><a href="#æ•°æ®ç»“æ„-3" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>Setçš„åº•å±‚å®ç°æ˜¯ <strong>dictå­—å…¸</strong>ï¼ˆå“ˆå¸Œè¡¨ï¼‰ã€‚</p><p><strong>å®ç°åŸç†</strong>ï¼š</p><ul><li>ç±»ä¼¼Javaä¸­çš„ <code>HashSet</code></li><li>Javaçš„ <code>HashSet</code> å†…éƒ¨ä½¿ç”¨ <code>HashMap</code> å®ç°ï¼Œæ‰€æœ‰valueéƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</li><li>Redisçš„Setä¹Ÿæ˜¯ä½¿ç”¨hashç»“æ„ï¼Œ<strong>æ‰€æœ‰çš„valueéƒ½æŒ‡å‘åŒä¸€ä¸ªå†…éƒ¨å€¼ï¼ˆNULLï¼‰</strong></li></ul><p><strong>ç»“æ„å¯¹æ¯”</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java HashSetå®ç°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HashSet</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;E, Object&gt; map;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">PRESENT</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> map.put(e, PRESENT) == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Redis Setå®ç°ï¼ˆä¼ªä»£ç ï¼‰</span></span><br><span class="line">struct set &#123;</span><br><span class="line">    dict *dict;  <span class="comment">// å“ˆå¸Œè¡¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ·»åŠ å…ƒç´ æ—¶ï¼šdict[member] = NULL</span></span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½ç‰¹ç‚¹</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>æ—¶é—´å¤æ‚åº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>SADD</td><td>O(1)</td><td>å“ˆå¸Œè¡¨ç›´æ¥å®šä½</td></tr><tr><td>SREM</td><td>O(1)</td><td>å“ˆå¸Œè¡¨ç›´æ¥å®šä½</td></tr><tr><td>SISMEMBER</td><td>O(1)</td><td>å“ˆå¸Œè¡¨ç›´æ¥åˆ¤æ–­</td></tr><tr><td>SMEMBERS</td><td>O(n)</td><td>éœ€è¦éå†æ‰€æœ‰å…ƒç´ </td></tr><tr><td>SINTER</td><td>O(n*m)</td><td>nä¸ºæœ€å°é›†åˆå…ƒç´ æ•°ï¼Œmä¸ºé›†åˆä¸ªæ•°</td></tr></tbody></table><p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p><ul><li>å½“Setä¸­åªåŒ…å«<strong>æ•´æ•°å€¼</strong>ä¸”<strong>å…ƒç´ æ•°é‡è¾ƒå°‘</strong>æ—¶ï¼Œä½¿ç”¨ <strong>intset</strong>ï¼ˆæ•´æ•°é›†åˆï¼‰</li><li>å…¶ä»–æƒ…å†µä½¿ç”¨ <strong>hashtable</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># intsetè§¦å‘æ¡ä»¶ï¼ˆå¯åœ¨redis.confä¸­é…ç½®ï¼‰</span></span><br><span class="line">set-max-intset-entries 512  <span class="comment"># å…ƒç´ ä¸ªæ•°ä¸è¶…è¿‡512æ—¶ä½¿ç”¨intset</span></span><br></pre></td></tr></table></figure><h3 id="3-5-ZSetï¼ˆæœ‰åºé›†åˆï¼‰"><a href="#3-5-ZSetï¼ˆæœ‰åºé›†åˆï¼‰" class="headerlink" title="3.5 ZSetï¼ˆæœ‰åºé›†åˆï¼‰"></a>3.5 ZSetï¼ˆæœ‰åºé›†åˆï¼‰</h3><h4 id="ç±»å‹ä»‹ç»-4"><a href="#ç±»å‹ä»‹ç»-4" class="headerlink" title="ç±»å‹ä»‹ç»"></a>ç±»å‹ä»‹ç»</h4><p>ZSetï¼ˆSorted Setï¼‰æ˜¯ä¸€ä¸ª<strong>æœ‰åºã€ä¸é‡å¤</strong>çš„å­—ç¬¦ä¸²é›†åˆï¼Œæ¯ä¸ªæˆå‘˜éƒ½å…³è”ä¸€ä¸ª<strong>åˆ†æ•°ï¼ˆscoreï¼‰</strong>ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><strong>æœ‰åºæ€§</strong>ï¼šæŒ‰ç…§scoreä»ä½åˆ°é«˜æ’åº</li><li><strong>ä¸é‡å¤</strong>ï¼šmemberå”¯ä¸€ï¼Œä½†scoreå¯ä»¥é‡å¤</li><li><strong>åŒé‡ç´¢å¼•</strong>ï¼šæ—¢å¯ä»¥é€šè¿‡memberæŸ¥è¯¢ï¼Œä¹Ÿå¯ä»¥é€šè¿‡scoreèŒƒå›´æŸ¥è¯¢</li><li><strong>é«˜æ•ˆæ€§</strong>ï¼šæ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾éƒ½å¾ˆå¿«</li></ul><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><strong>æ’è¡Œæ¦œ</strong>ï¼šæ¸¸æˆæ’è¡Œã€é”€é‡æ’è¡Œã€çƒ­æœæ¦œ</li><li><strong>å»¶è¿Ÿé˜Ÿåˆ—</strong>ï¼šä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºscore</li><li><strong>ä¼˜å…ˆçº§é˜Ÿåˆ—</strong>ï¼šä¸åŒä¼˜å…ˆçº§çš„ä»»åŠ¡</li><li><strong>è®¿é—®ç»Ÿè®¡</strong>ï¼šæ–‡ç« æµè§ˆé‡ã€ç‚¹å‡»é‡æ’åº</li><li><strong>èŒƒå›´æŸ¥æ‰¾</strong>ï¼šå·¥èµ„èŒƒå›´æŸ¥è¯¢ã€å¹´é¾„èŒƒå›´æŸ¥è¯¢</li></ul><p><strong>å¯¹æ¯”å…¶ä»–é›†åˆ</strong>ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th>Set</th><th>ZSet</th></tr></thead><tbody><tr><td>æ’åº</td><td>æ— åº</td><td>æœ‰åºï¼ˆæŒ‰scoreï¼‰</td></tr><tr><td>é‡å¤</td><td>ä¸å…è®¸</td><td>memberä¸é‡å¤ï¼Œscoreå¯é‡å¤</td></tr><tr><td>ç´¢å¼•</td><td>ä»…member</td><td>member + scoreåŒé‡ç´¢å¼•</td></tr><tr><td>åº”ç”¨</td><td>æ ‡ç­¾ã€å»é‡</td><td>æ’è¡Œæ¦œã€ä¼˜å…ˆçº§é˜Ÿåˆ—</td></tr></tbody></table><p><strong>å­˜å‚¨ç»“æ„ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¸¸æˆæ’è¡Œæ¦œ</span></span><br><span class="line">player_rank</span><br><span class="line">    â”œâ”€ (<span class="string">&quot;Alice&quot;</span>, 1500)    <span class="comment"># member: Alice, score: 1500</span></span><br><span class="line">    â”œâ”€ (<span class="string">&quot;Bob&quot;</span>, 2000)      <span class="comment"># member: Bob, score: 2000</span></span><br><span class="line">    â””â”€ (<span class="string">&quot;Charlie&quot;</span>, 2500)  <span class="comment"># member: Charlie, score: 2500</span></span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨å‘½ä»¤-3"><a href="#å¸¸ç”¨å‘½ä»¤-3" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><h5 id="1-åŸºç¡€æ“ä½œ-2"><a href="#1-åŸºç¡€æ“ä½œ-2" class="headerlink" title="1. åŸºç¡€æ“ä½œ"></a>1. åŸºç¡€æ“ä½œ</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>ZADD key score1 member1 score2 member2 ...</code></td><td>æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </td><td><code>ZADD rank 100 &quot;Alice&quot;</code></td><td>æˆåŠŸæ·»åŠ çš„æ•°é‡</td></tr><tr><td><code>ZCARD key</code></td><td>è·å–å…ƒç´ ä¸ªæ•°</td><td><code>ZCARD rank</code></td><td>å…ƒç´ æ•°é‡</td></tr><tr><td><code>ZSCORE key member</code></td><td>è·å–å…ƒç´ çš„åˆ†æ•°</td><td><code>ZSCORE rank &quot;Alice&quot;</code></td><td>åˆ†æ•°å€¼</td></tr><tr><td><code>ZINCRBY key increment member</code></td><td>ç»™å…ƒç´ çš„åˆ†æ•°å¢åŠ increment</td><td><code>ZINCRBY rank 10 &quot;Alice&quot;</code></td><td>å¢åŠ åçš„åˆ†æ•°</td></tr><tr><td><code>ZREM key member1 member2 ...</code></td><td>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </td><td><code>ZREM rank &quot;Alice&quot;</code></td><td>æˆåŠŸåˆ é™¤çš„æ•°é‡</td></tr><tr><td><code>ZCOUNT key min max</code></td><td>ç»Ÿè®¡åˆ†æ•°åŒºé—´å†…çš„å…ƒç´ ä¸ªæ•°</td><td><code>ZCOUNT rank 0 100</code></td><td>å…ƒç´ æ•°é‡</td></tr></tbody></table><h5 id="2-èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰ç´¢å¼•ï¼‰"><a href="#2-èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰ç´¢å¼•ï¼‰" class="headerlink" title="2. èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰ç´¢å¼•ï¼‰"></a>2. èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰ç´¢å¼•ï¼‰</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>ZRANGE key start stop [WITHSCORES]</code></td><td>æŒ‰ç´¢å¼•è·å–å…ƒç´ ï¼ˆå‡åºï¼‰</td><td><code>ZRANGE rank 0 9 WITHSCORES</code></td><td>å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>ZREVRANGE key start stop [WITHSCORES]</code></td><td>æŒ‰ç´¢å¼•è·å–å…ƒç´ ï¼ˆé™åºï¼‰</td><td><code>ZREVRANGE rank 0 9 WITHSCORES</code></td><td>å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>ZRANK key member</code></td><td>è·å–å…ƒç´ æ’åï¼ˆå‡åºï¼Œä»0å¼€å§‹ï¼‰</td><td><code>ZRANK rank &quot;Alice&quot;</code></td><td>æ’å</td></tr><tr><td><code>ZREVRANK key member</code></td><td>è·å–å…ƒç´ æ’åï¼ˆé™åºï¼Œä»0å¼€å§‹ï¼‰</td><td><code>ZREVRANK rank &quot;Alice&quot;</code></td><td>æ’å</td></tr></tbody></table><blockquote><p><strong>WITHSCORESå‚æ•°</strong>ï¼šåŠ ä¸Šæ­¤å‚æ•°å¯ä»¥åŒæ—¶è¿”å›åˆ†æ•°</p></blockquote><h5 id="3-èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åˆ†æ•°ï¼‰"><a href="#3-èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åˆ†æ•°ï¼‰" class="headerlink" title="3. èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åˆ†æ•°ï¼‰"></a>3. èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åˆ†æ•°ï¼‰</h5><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count]</code></td><td>æŒ‰åˆ†æ•°èŒƒå›´è·å–ï¼ˆå‡åºï¼‰</td><td><code>ZRANGEBYSCORE rank 0 100</code></td><td>å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>ZREVRANGEBYSCORE key max min [WITHSCORES] [LIMIT offset count]</code></td><td>æŒ‰åˆ†æ•°èŒƒå›´è·å–ï¼ˆé™åºï¼‰</td><td><code>ZREVRANGEBYSCORE rank 100 0</code></td><td>å…ƒç´ åˆ—è¡¨</td></tr><tr><td><code>ZREMRANGEBYRANK key start stop</code></td><td>åˆ é™¤æŒ‡å®šæ’åèŒƒå›´çš„å…ƒç´ </td><td><code>ZREMRANGEBYRANK rank 0 2</code></td><td>åˆ é™¤çš„æ•°é‡</td></tr><tr><td><code>ZREMRANGEBYSCORE key min max</code></td><td>åˆ é™¤æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´ </td><td><code>ZREMRANGEBYSCORE rank 0 100</code></td><td>åˆ é™¤çš„æ•°é‡</td></tr></tbody></table><p><strong>åˆ†æ•°èŒƒå›´è¯­æ³•</strong>ï¼š</p><ul><li><code>ZRANGEBYSCORE key 0 100</code>ï¼š0 â‰¤ score â‰¤ 100</li><li><code>ZRANGEBYSCORE key (0 (100</code>ï¼š0 &lt; score &lt; 100ï¼ˆæ‹¬å·è¡¨ç¤ºå¼€åŒºé—´ï¼‰</li><li><code>ZRANGEBYSCORE key -inf +inf</code>ï¼šæ‰€æœ‰å…ƒç´ ï¼ˆ-infè¡¨ç¤ºè´Ÿæ— ç©·ï¼Œ+infè¡¨ç¤ºæ­£æ— ç©·ï¼‰</li></ul><h4 id="æ“ä½œç¤ºä¾‹-3"><a href="#æ“ä½œç¤ºä¾‹-3" class="headerlink" title="æ“ä½œç¤ºä¾‹"></a>æ“ä½œç¤ºä¾‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ æ¸¸æˆç©å®¶åˆ†æ•°</span></span><br><span class="line">127.0.0.1:6379&gt; ZADD game:rank 1500 <span class="string">&quot;Alice&quot;</span> 2000 <span class="string">&quot;Bob&quot;</span> 1800 <span class="string">&quot;Charlie&quot;</span> 2200 <span class="string">&quot;David&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰ç©å®¶ï¼ˆå‡åºï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; ZRANGE game:rank 0 -1 WITHSCORES</span><br><span class="line">1) <span class="string">&quot;Alice&quot;</span></span><br><span class="line">2) <span class="string">&quot;1500&quot;</span></span><br><span class="line">3) <span class="string">&quot;Charlie&quot;</span></span><br><span class="line">4) <span class="string">&quot;1800&quot;</span></span><br><span class="line">5) <span class="string">&quot;Bob&quot;</span></span><br><span class="line">6) <span class="string">&quot;2000&quot;</span></span><br><span class="line">7) <span class="string">&quot;David&quot;</span></span><br><span class="line">8) <span class="string">&quot;2200&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å‰3åï¼ˆé™åºï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; ZREVRANGE game:rank 0 2 WITHSCORES</span><br><span class="line">1) <span class="string">&quot;David&quot;</span></span><br><span class="line">2) <span class="string">&quot;2200&quot;</span></span><br><span class="line">3) <span class="string">&quot;Bob&quot;</span></span><br><span class="line">4) <span class="string">&quot;2000&quot;</span></span><br><span class="line">5) <span class="string">&quot;Charlie&quot;</span></span><br><span class="line">6) <span class="string">&quot;1800&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–Aliceçš„åˆ†æ•°</span></span><br><span class="line">127.0.0.1:6379&gt; ZSCORE game:rank <span class="string">&quot;Alice&quot;</span></span><br><span class="line"><span class="string">&quot;1500&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™AliceåŠ 100åˆ†</span></span><br><span class="line">127.0.0.1:6379&gt; ZINCRBY game:rank 100 <span class="string">&quot;Alice&quot;</span></span><br><span class="line"><span class="string">&quot;1600&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Aliceçš„æ’åï¼ˆå‡åºï¼Œä»0å¼€å§‹ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; ZRANK game:rank <span class="string">&quot;Alice&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Aliceçš„æ’åï¼ˆé™åºï¼Œä»0å¼€å§‹ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; ZREVRANK game:rank <span class="string">&quot;Alice&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹1800-2000åˆ†çš„ç©å®¶</span></span><br><span class="line">127.0.0.1:6379&gt; ZRANGEBYSCORE game:rank 1800 2000 WITHSCORES</span><br><span class="line">1) <span class="string">&quot;Alice&quot;</span></span><br><span class="line">2) <span class="string">&quot;1600&quot;</span></span><br><span class="line">3) <span class="string">&quot;Charlie&quot;</span></span><br><span class="line">4) <span class="string">&quot;1800&quot;</span></span><br><span class="line">5) <span class="string">&quot;Bob&quot;</span></span><br><span class="line">6) <span class="string">&quot;2000&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡1500-2000åˆ†çš„ç©å®¶æ•°é‡</span></span><br><span class="line">127.0.0.1:6379&gt; ZCOUNT game:rank 1500 2000</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åˆ†æ•°ä½äº1600çš„ç©å®¶</span></span><br><span class="line">127.0.0.1:6379&gt; ZREMRANGEBYSCORE game:rank -inf 1600</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å…ƒç´ æ€»æ•°</span></span><br><span class="line">127.0.0.1:6379&gt; ZCARD game:rank</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure><h4 id="å®é™…åº”ç”¨æ¡ˆä¾‹-1"><a href="#å®é™…åº”ç”¨æ¡ˆä¾‹-1" class="headerlink" title="å®é™…åº”ç”¨æ¡ˆä¾‹"></a>å®é™…åº”ç”¨æ¡ˆä¾‹</h4><h5 id="æ¡ˆä¾‹1ï¼šæ–‡ç« è®¿é—®é‡æ’è¡Œæ¦œ"><a href="#æ¡ˆä¾‹1ï¼šæ–‡ç« è®¿é—®é‡æ’è¡Œæ¦œ" class="headerlink" title="æ¡ˆä¾‹1ï¼šæ–‡ç« è®¿é—®é‡æ’è¡Œæ¦œ"></a>æ¡ˆä¾‹1ï¼šæ–‡ç« è®¿é—®é‡æ’è¡Œæ¦œ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–æ–‡ç« è®¿é—®é‡</span></span><br><span class="line">ZADD article:views 100 <span class="string">&quot;article:1001&quot;</span> 230 <span class="string">&quot;article:1002&quot;</span> 85 <span class="string">&quot;article:1003&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ç« è¢«è®¿é—®ï¼Œè®¿é—®é‡+1</span></span><br><span class="line">ZINCRBY article:views 1 <span class="string">&quot;article:1001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–è®¿é—®é‡æœ€é«˜çš„10ç¯‡æ–‡ç« </span></span><br><span class="line">ZREVRANGE article:views 0 9 WITHSCORES</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æŸç¯‡æ–‡ç« çš„è®¿é—®é‡</span></span><br><span class="line">ZSCORE article:views <span class="string">&quot;article:1001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æŸç¯‡æ–‡ç« çš„æ’åï¼ˆç¬¬å‡ åï¼‰</span></span><br><span class="line">ZREVRANK article:views <span class="string">&quot;article:1001&quot;</span></span><br></pre></td></tr></table></figure><h5 id="æ¡ˆä¾‹2ï¼šå»¶è¿Ÿé˜Ÿåˆ—"><a href="#æ¡ˆä¾‹2ï¼šå»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="æ¡ˆä¾‹2ï¼šå»¶è¿Ÿé˜Ÿåˆ—"></a>æ¡ˆä¾‹2ï¼šå»¶è¿Ÿé˜Ÿåˆ—</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ å»¶è¿Ÿä»»åŠ¡ï¼ˆä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºscoreï¼‰</span></span><br><span class="line">ZADD delay:queue 1699999999 <span class="string">&quot;task:1&quot;</span> 1700000100 <span class="string">&quot;task:2&quot;</span> 1700000200 <span class="string">&quot;task:3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰æ—¶é—´æˆ³ä¹‹å‰çš„æ‰€æœ‰ä»»åŠ¡ï¼ˆåˆ°æœŸçš„ä»»åŠ¡ï¼‰</span></span><br><span class="line">ZRANGEBYSCORE delay:queue -inf 1700000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œä»»åŠ¡ååˆ é™¤</span></span><br><span class="line">ZREM delay:queue <span class="string">&quot;task:1&quot;</span></span><br></pre></td></tr></table></figure><h5 id="æ¡ˆä¾‹3ï¼šå·¥èµ„èŒƒå›´æŸ¥è¯¢"><a href="#æ¡ˆä¾‹3ï¼šå·¥èµ„èŒƒå›´æŸ¥è¯¢" class="headerlink" title="æ¡ˆä¾‹3ï¼šå·¥èµ„èŒƒå›´æŸ¥è¯¢"></a>æ¡ˆä¾‹3ï¼šå·¥èµ„èŒƒå›´æŸ¥è¯¢</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ å‘˜å·¥å·¥èµ„ä¿¡æ¯</span></span><br><span class="line">ZADD employee:salary 5000 <span class="string">&quot;emp:1001&quot;</span> 8000 <span class="string">&quot;emp:1002&quot;</span> 12000 <span class="string">&quot;emp:1003&quot;</span> 15000 <span class="string">&quot;emp:1004&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å·¥èµ„åœ¨8000-12000ä¹‹é—´çš„å‘˜å·¥</span></span><br><span class="line">ZRANGEBYSCORE employee:salary 8000 12000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å·¥èµ„è¶…è¿‡10000çš„å‘˜å·¥æ•°é‡</span></span><br><span class="line">ZCOUNT employee:salary 10000 +inf</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å·¥èµ„æœ€é«˜çš„5åå‘˜å·¥</span></span><br><span class="line">ZREVRANGE employee:salary 0 4 WITHSCORES</span><br></pre></td></tr></table></figure><h4 id="æ•°æ®ç»“æ„-4"><a href="#æ•°æ®ç»“æ„-4" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>ZSetçš„åº•å±‚å®ç°ä½¿ç”¨äº†<strong>ä¸¤ä¸ªæ•°æ®ç»“æ„</strong>ï¼š</p><h5 id="1-Hashï¼ˆå“ˆå¸Œè¡¨ï¼‰"><a href="#1-Hashï¼ˆå“ˆå¸Œè¡¨ï¼‰" class="headerlink" title="1. Hashï¼ˆå“ˆå¸Œè¡¨ï¼‰"></a>1. Hashï¼ˆå“ˆå¸Œè¡¨ï¼‰</h5><p><strong>ä½œç”¨</strong>ï¼š</p><ul><li>å…³è” <strong>member</strong> å’Œ <strong>score</strong></li><li>ä¿éšœmemberçš„å”¯ä¸€æ€§</li><li>é€šè¿‡memberå¿«é€Ÿæ‰¾åˆ°scoreï¼š<strong>O(1)</strong></li></ul><h5 id="2-Skip-Listï¼ˆè·³è·ƒè¡¨ï¼‰"><a href="#2-Skip-Listï¼ˆè·³è·ƒè¡¨ï¼‰" class="headerlink" title="2. Skip Listï¼ˆè·³è·ƒè¡¨ï¼‰"></a>2. Skip Listï¼ˆè·³è·ƒè¡¨ï¼‰</h5><p><strong>ä½œç”¨</strong>ï¼š</p><ul><li>æŒ‰ç…§scoreç»™memberæ’åº</li><li>æ”¯æŒæŒ‰scoreèŒƒå›´æŸ¥è¯¢</li><li>æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(log n)</strong></li></ul><p><strong>è·³è·ƒè¡¨åŸç†</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å±‚çº§4:  1 --------------------------------&gt; 50</span><br><span class="line">å±‚çº§3:  1 ----------&gt; 20 -----------------&gt; 50</span><br><span class="line">å±‚çº§2:  1 -----&gt; 10 -&gt; 20 -&gt; 30 ----------&gt; 50</span><br><span class="line">å±‚çº§1:  1 -&gt; 5 -&gt; 10 -&gt; 20 -&gt; 30 -&gt; 40 -&gt; 50  (åŸå§‹é“¾è¡¨)</span><br></pre></td></tr></table></figure><p><strong>è·³è·ƒè¡¨ä¼˜åŠ¿</strong>ï¼š</p><ul><li><strong>æŸ¥æ‰¾æ•ˆç‡</strong>ï¼šæ¥è¿‘äºŒåˆ†æŸ¥æ‰¾ï¼ŒO(log n)</li><li><strong>å®ç°ç®€å•</strong>ï¼šæ¯”çº¢é»‘æ ‘ç®€å•</li><li><strong>åŒºé—´æŸ¥è¯¢</strong>ï¼šå¤©ç„¶æ”¯æŒèŒƒå›´æŸ¥è¯¢</li></ul><p><strong>å¯¹æ¯”å…¶ä»–ç»“æ„</strong>ï¼š</p><table><thead><tr><th>æ•°æ®ç»“æ„</th><th>æ’å…¥&#x2F;åˆ é™¤</th><th>æŸ¥æ‰¾</th><th>èŒƒå›´æŸ¥è¯¢</th><th>å®ç°å¤æ‚åº¦</th></tr></thead><tbody><tr><td><strong>è·³è·ƒè¡¨</strong></td><td>O(log n)</td><td>O(log n)</td><td>âœ… æ”¯æŒ</td><td>ç®€å•</td></tr><tr><td><strong>çº¢é»‘æ ‘</strong></td><td>O(log n)</td><td>O(log n)</td><td>âœ… æ”¯æŒ</td><td>å¤æ‚</td></tr><tr><td><strong>å“ˆå¸Œè¡¨</strong></td><td>O(1)</td><td>O(1)</td><td>âŒ ä¸æ”¯æŒ</td><td>ç®€å•</td></tr><tr><td><strong>æ•°ç»„</strong></td><td>O(n)</td><td>O(n)</td><td>âœ… æ”¯æŒ</td><td>ç®€å•</td></tr></tbody></table><p><strong>ZSet &#x3D; Hash + Skip List</strong>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ZSetç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">zset</span> &#123;</span></span><br><span class="line">    dict *dict;         <span class="comment">// å“ˆå¸Œè¡¨ï¼šmember -&gt; score</span></span><br><span class="line">    zskiplist *zsl;     <span class="comment">// è·³è·ƒè¡¨ï¼šæŒ‰scoreæ’åº</span></span><br><span class="line">&#125; zset;</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼Ÿ</strong></p><ol><li><p><strong>Hash</strong>ï¼šé€šè¿‡memberå¿«é€Ÿè·å–scoreï¼ˆO(1)ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZSCORE key member  <span class="comment"># éœ€è¦å“ˆå¸Œè¡¨</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Skip List</strong>ï¼šæŒ‰scoreæ’åºå’ŒèŒƒå›´æŸ¥è¯¢ï¼ˆO(log n)ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ZRANGE key 0 10           <span class="comment"># éœ€è¦è·³è·ƒè¡¨</span></span><br><span class="line">ZRANGEBYSCORE key 0 100   <span class="comment"># éœ€è¦è·³è·ƒè¡¨</span></span><br></pre></td></tr></table></figure></li></ol><p><strong>æ€§èƒ½æ€»ç»“</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>æ—¶é—´å¤æ‚åº¦</th><th>ä½¿ç”¨çš„ç»“æ„</th></tr></thead><tbody><tr><td>ZADD</td><td>O(log n)</td><td>Hash + Skip List</td></tr><tr><td>ZREM</td><td>O(log n)</td><td>Hash + Skip List</td></tr><tr><td>ZSCORE</td><td>O(1)</td><td>Hash</td></tr><tr><td>ZRANK</td><td>O(log n)</td><td>Skip List</td></tr><tr><td>ZRANGE</td><td>O(log n + m)</td><td>Skip Listï¼ˆmä¸ºè¿”å›å…ƒç´ æ•°ï¼‰</td></tr><tr><td>ZRANGEBYSCORE</td><td>O(log n + m)</td><td>Skip List</td></tr></tbody></table><hr><h2 id="4-Redisé…ç½®æ–‡ä»¶è¯¦è§£"><a href="#4-Redisé…ç½®æ–‡ä»¶è¯¦è§£" class="headerlink" title="4. Redisé…ç½®æ–‡ä»¶è¯¦è§£"></a>4. Redisé…ç½®æ–‡ä»¶è¯¦è§£</h2><p>Redisçš„é…ç½®æ–‡ä»¶ï¼ˆredis.confï¼‰æ˜¯RedisæœåŠ¡å™¨çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œåˆç†é…ç½®å¯ä»¥å¤§å¹…æå‡Redisçš„æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚</p><blockquote><p><strong>é…ç½®æ–‡ä»¶ä½ç½®</strong>ï¼š</p><ul><li>é»˜è®¤è·¯å¾„ï¼š<code>/etc/redis/redis.conf</code></li><li>è‡ªå®šä¹‰è·¯å¾„ï¼š<code>/myredis/redis.conf</code>ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</li><li>å¯åŠ¨æ—¶æŒ‡å®šï¼š<code>redis-server /path/to/redis.conf</code></li></ul></blockquote><h3 id="4-1-Unitsï¼ˆå•ä½ï¼‰"><a href="#4-1-Unitsï¼ˆå•ä½ï¼‰" class="headerlink" title="4.1 Unitsï¼ˆå•ä½ï¼‰"></a>4.1 Unitsï¼ˆå•ä½ï¼‰</h3><p>é…ç½®æ–‡ä»¶å¼€å¤´å®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„åº¦é‡å•ä½ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>åªæ”¯æŒ <strong>bytes</strong>ï¼ˆå­—èŠ‚ï¼‰ï¼Œä¸æ”¯æŒ <strong>bit</strong>ï¼ˆä½ï¼‰</li><li><strong>å¤§å°å†™ä¸æ•æ„Ÿ</strong>ï¼ˆ1GB &#x3D; 1gb &#x3D; 1Gbï¼‰</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å•ä½æ¢ç®—</span></span><br><span class="line">1k =&gt; 1000 bytes</span><br><span class="line">1kb =&gt; 1024 bytes</span><br><span class="line">1m =&gt; 1000000 bytes</span><br><span class="line">1mb =&gt; 1024*1024 bytes</span><br><span class="line">1g =&gt; 1000000000 bytes</span><br><span class="line">1gb =&gt; 1024*1024*1024 bytes</span><br></pre></td></tr></table></figure><h3 id="4-2-INCLUDESï¼ˆåŒ…å«ï¼‰"><a href="#4-2-INCLUDESï¼ˆåŒ…å«ï¼‰" class="headerlink" title="4.2 INCLUDESï¼ˆåŒ…å«ï¼‰"></a>4.2 INCLUDESï¼ˆåŒ…å«ï¼‰</h3><p>æ”¯æŒåŒ…å«å…¶ä»–é…ç½®æ–‡ä»¶ï¼Œç±»ä¼¼äºJSPä¸­çš„includeã€‚</p><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><strong>å¤šå®ä¾‹éƒ¨ç½²</strong>ï¼šæå–å…¬å…±é…ç½®</li><li><strong>é…ç½®æ¨¡å—åŒ–</strong>ï¼šæŒ‰åŠŸèƒ½æ‹†åˆ†é…ç½®æ–‡ä»¶</li><li><strong>ç¯å¢ƒéš”ç¦»</strong>ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒçš„å·®å¼‚åŒ–é…ç½®</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–é…ç½®æ–‡ä»¶</span></span><br><span class="line">include /path/to/common.conf</span><br><span class="line">include /path/to/redis-common.conf</span><br></pre></td></tr></table></figure><h3 id="4-3-NETWORKï¼ˆç½‘ç»œé…ç½®ï¼‰"><a href="#4-3-NETWORKï¼ˆç½‘ç»œé…ç½®ï¼‰" class="headerlink" title="4.3 NETWORKï¼ˆç½‘ç»œé…ç½®ï¼‰"></a>4.3 NETWORKï¼ˆç½‘ç»œé…ç½®ï¼‰</h3><h4 id="å¸¸ç”¨ç½‘ç»œé…ç½®é¡¹"><a href="#å¸¸ç”¨ç½‘ç»œé…ç½®é¡¹" class="headerlink" title="å¸¸ç”¨ç½‘ç»œé…ç½®é¡¹"></a>å¸¸ç”¨ç½‘ç»œé…ç½®é¡¹</h4><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th><th>æ¨èé…ç½®</th></tr></thead><tbody><tr><td><code>bind</code></td><td>ç»‘å®šçš„IPåœ°å€</td><td>127.0.0.1</td><td>ç”Ÿäº§ç¯å¢ƒé…ç½®åº”ç”¨æœåŠ¡å™¨IP</td></tr><tr><td><code>protected-mode</code></td><td>ä¿æŠ¤æ¨¡å¼</td><td>yes</td><td>è¿œç¨‹è®¿é—®è®¾ç½®ä¸ºno</td></tr><tr><td><code>port</code></td><td>ç›‘å¬ç«¯å£</td><td>6379</td><td>ä¿æŒé»˜è®¤æˆ–è‡ªå®šä¹‰</td></tr><tr><td><code>tcp-backlog</code></td><td>TCPè¿æ¥é˜Ÿåˆ—é•¿åº¦</td><td>511</td><td>é«˜å¹¶å‘åœºæ™¯å¢å¤§</td></tr><tr><td><code>timeout</code></td><td>å®¢æˆ·ç«¯ç©ºé—²è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</td><td>0ï¼ˆæ°¸ä¸è¶…æ—¶ï¼‰</td><td>300ï¼ˆ5åˆ†é’Ÿï¼‰</td></tr><tr><td><code>tcp-keepalive</code></td><td>TCPå¿ƒè·³æ£€æµ‹é—´éš”ï¼ˆç§’ï¼‰</td><td>300</td><td>60</td></tr></tbody></table><h4 id="è¯¦ç»†è¯´æ˜"><a href="#è¯¦ç»†è¯´æ˜" class="headerlink" title="è¯¦ç»†è¯´æ˜"></a>è¯¦ç»†è¯´æ˜</h4><h5 id="bindï¼ˆIPç»‘å®šï¼‰"><a href="#bindï¼ˆIPç»‘å®šï¼‰" class="headerlink" title="bindï¼ˆIPç»‘å®šï¼‰"></a>bindï¼ˆIPç»‘å®šï¼‰</h5><p><strong>ä½œç”¨</strong>ï¼šæŒ‡å®šRedisç›‘å¬çš„IPåœ°å€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åªå…è®¸æœ¬æœºè®¿é—®</span></span><br><span class="line"><span class="built_in">bind</span> 127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸æŒ‡å®šIPè®¿é—®</span></span><br><span class="line"><span class="built_in">bind</span> 192.168.1.100</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸å¤šä¸ªIPè®¿é—®</span></span><br><span class="line"><span class="built_in">bind</span> 127.0.0.1 192.168.1.100</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸æ‰€æœ‰IPè®¿é—®ï¼ˆæ³¨é‡Šæ‰bindæˆ–ä¸é…ç½®ï¼‰</span></span><br><span class="line"><span class="comment"># bind 127.0.0.1</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>é»˜è®¤ <code>bind 127.0.0.1</code>ï¼Œåªèƒ½æœ¬æœºè®¿é—®</li><li>ä¸é…ç½®bindï¼Œåˆ™æ— é™åˆ¶æ¥å—ä»»ä½•IPè®¿é—®ï¼ˆ<strong>ä¸å®‰å…¨</strong>ï¼‰</li><li>ç”Ÿäº§ç¯å¢ƒå»ºè®®ç»‘å®šåº”ç”¨æœåŠ¡å™¨çš„IP</li><li>å¦‚æœéœ€è¦è¿œç¨‹è®¿é—®ï¼Œéœ€è¦æ³¨é‡Šæ‰bindé…ç½®</li></ul><h5 id="protected-modeï¼ˆä¿æŠ¤æ¨¡å¼ï¼‰"><a href="#protected-modeï¼ˆä¿æŠ¤æ¨¡å¼ï¼‰" class="headerlink" title="protected-modeï¼ˆä¿æŠ¤æ¨¡å¼ï¼‰"></a>protected-modeï¼ˆä¿æŠ¤æ¨¡å¼ï¼‰</h5><p><strong>ä½œç”¨</strong>ï¼šRedis 3.2ä»¥åçš„å®‰å…¨ä¿æŠ¤åŠŸèƒ½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯ä¿æŠ¤æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">protected-mode <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­ä¿æŠ¤æ¨¡å¼ï¼ˆå…è®¸è¿œç¨‹è®¿é—®ï¼‰</span></span><br><span class="line">protected-mode no</span><br></pre></td></tr></table></figure><p><strong>ä¿æŠ¤é€»è¾‘</strong>ï¼š</p><ul><li>å½“ <code>protected-mode yes</code> æ—¶ï¼Œå¦‚æœ<strong>æ²¡æœ‰bind IP</strong>ä¸”<strong>æ²¡æœ‰è®¾ç½®å¯†ç </strong>ï¼ŒRedisåªå…è®¸æœ¬æœºè®¿é—®</li><li>å¦‚æœéœ€è¦è¿œç¨‹è®¿é—®ï¼Œå¿…é¡»ï¼š<ul><li>è®¾ç½® <code>protected-mode no</code>ï¼Œ<strong>æˆ–</strong></li><li>é…ç½® <code>bind</code> æŒ‡å®šIPï¼Œ<strong>æˆ–</strong></li><li>è®¾ç½®è®¿é—®å¯†ç </li></ul></li></ul><h5 id="portï¼ˆç«¯å£ï¼‰"><a href="#portï¼ˆç«¯å£ï¼‰" class="headerlink" title="portï¼ˆç«¯å£ï¼‰"></a>portï¼ˆç«¯å£ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤ç«¯å£</span></span><br><span class="line">port 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ç«¯å£</span></span><br><span class="line">port 6380</span><br></pre></td></tr></table></figure><h5 id="tcp-backlogï¼ˆTCPè¿æ¥é˜Ÿåˆ—ï¼‰"><a href="#tcp-backlogï¼ˆTCPè¿æ¥é˜Ÿåˆ—ï¼‰" class="headerlink" title="tcp-backlogï¼ˆTCPè¿æ¥é˜Ÿåˆ—ï¼‰"></a>tcp-backlogï¼ˆTCPè¿æ¥é˜Ÿåˆ—ï¼‰</h5><p><strong>ä½œç”¨</strong>ï¼šè®¾ç½®TCPè¿æ¥é˜Ÿåˆ—é•¿åº¦ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp-backlog 511</span><br></pre></td></tr></table></figure><p><strong>è¿æ¥é˜Ÿåˆ—ç»„æˆ</strong>ï¼š</p><ul><li><strong>æœªå®Œæˆä¸‰æ¬¡æ¡æ‰‹é˜Ÿåˆ—</strong>ï¼ˆSYNé˜Ÿåˆ—ï¼‰</li><li><strong>å·²å®Œæˆä¸‰æ¬¡æ¡æ‰‹é˜Ÿåˆ—</strong>ï¼ˆAccepté˜Ÿåˆ—ï¼‰</li><li><strong>æ€»é˜Ÿåˆ— &#x3D; æœªå®Œæˆ + å·²å®Œæˆ</strong></li></ul><p><strong>é«˜å¹¶å‘ä¼˜åŒ–</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ä¿®æ”¹Redisé…ç½®</span></span><br><span class="line">tcp-backlog 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. ä¿®æ”¹Linuxå†…æ ¸å‚æ•°</span></span><br><span class="line"><span class="comment"># /etc/sysctl.conf</span></span><br><span class="line">net.core.somaxconn = 2048</span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ä½¿é…ç½®ç”Ÿæ•ˆ</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„</strong>ï¼šLinuxå†…æ ¸ä¼šå°†backlogå€¼é™åˆ¶ä¸º <code>/proc/sys/net/core/somaxconn</code> çš„å€¼ï¼ˆé»˜è®¤128ï¼‰ï¼Œéœ€è¦åŒæ—¶è°ƒæ•´å†…æ ¸å‚æ•°ã€‚</p></blockquote><h5 id="timeoutï¼ˆå®¢æˆ·ç«¯è¶…æ—¶ï¼‰"><a href="#timeoutï¼ˆå®¢æˆ·ç«¯è¶…æ—¶ï¼‰" class="headerlink" title="timeoutï¼ˆå®¢æˆ·ç«¯è¶…æ—¶ï¼‰"></a>timeoutï¼ˆå®¢æˆ·ç«¯è¶…æ—¶ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0è¡¨ç¤ºæ°¸ä¸è¶…æ—¶</span></span><br><span class="line"><span class="built_in">timeout</span> 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰æ— æ“ä½œè‡ªåŠ¨æ–­å¼€</span></span><br><span class="line"><span class="built_in">timeout</span> 300</span><br></pre></td></tr></table></figure><p><strong>å»ºè®®</strong>ï¼šè®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œé¿å…å¤§é‡ç©ºé—²è¿æ¥å ç”¨èµ„æºã€‚</p><h5 id="tcp-keepaliveï¼ˆå¿ƒè·³æ£€æµ‹ï¼‰"><a href="#tcp-keepaliveï¼ˆå¿ƒè·³æ£€æµ‹ï¼‰" class="headerlink" title="tcp-keepaliveï¼ˆå¿ƒè·³æ£€æµ‹ï¼‰"></a>tcp-keepaliveï¼ˆå¿ƒè·³æ£€æµ‹ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯60ç§’æ£€æµ‹ä¸€æ¬¡å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">tcp-keepalive 60</span><br></pre></td></tr></table></figure><p><strong>ä½œç”¨</strong>ï¼š</p><ul><li>æ£€æµ‹æ­»è¿æ¥ï¼ˆå®¢æˆ·ç«¯å´©æºƒã€ç½‘ç»œæ–­å¼€ç­‰ï¼‰</li><li>åŠæ—¶é‡Šæ”¾æ— æ•ˆè¿æ¥</li><li>0è¡¨ç¤ºä¸æ£€æµ‹ï¼ˆä¸æ¨èï¼‰</li></ul><h3 id="4-4-GENERALï¼ˆé€šç”¨é…ç½®ï¼‰"><a href="#4-4-GENERALï¼ˆé€šç”¨é…ç½®ï¼‰" class="headerlink" title="4.4 GENERALï¼ˆé€šç”¨é…ç½®ï¼‰"></a>4.4 GENERALï¼ˆé€šç”¨é…ç½®ï¼‰</h3><h4 id="å¸¸ç”¨é€šç”¨é…ç½®é¡¹"><a href="#å¸¸ç”¨é€šç”¨é…ç½®é¡¹" class="headerlink" title="å¸¸ç”¨é€šç”¨é…ç½®é¡¹"></a>å¸¸ç”¨é€šç”¨é…ç½®é¡¹</h4><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th><th>æ¨èé…ç½®</th></tr></thead><tbody><tr><td><code>daemonize</code></td><td>æ˜¯å¦åå°è¿è¡Œ</td><td>no</td><td>yes</td></tr><tr><td><code>pidfile</code></td><td>PIDæ–‡ä»¶è·¯å¾„</td><td>&#x2F;var&#x2F;run&#x2F;redis.pid</td><td>è‡ªå®šä¹‰è·¯å¾„</td></tr><tr><td><code>loglevel</code></td><td>æ—¥å¿—çº§åˆ«</td><td>notice</td><td>notice&#x2F;warning</td></tr><tr><td><code>logfile</code></td><td>æ—¥å¿—æ–‡ä»¶è·¯å¾„</td><td>â€œâ€</td><td>&#x2F;var&#x2F;log&#x2F;redis&#x2F;redis.log</td></tr><tr><td><code>databases</code></td><td>æ•°æ®åº“æ•°é‡</td><td>16</td><td>16</td></tr></tbody></table><h4 id="è¯¦ç»†è¯´æ˜-1"><a href="#è¯¦ç»†è¯´æ˜-1" class="headerlink" title="è¯¦ç»†è¯´æ˜"></a>è¯¦ç»†è¯´æ˜</h4><h5 id="daemonizeï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰"><a href="#daemonizeï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰" class="headerlink" title="daemonizeï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰"></a>daemonizeï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‰å°è¿è¡Œï¼ˆè°ƒè¯•ç”¨ï¼‰</span></span><br><span class="line">daemonize no</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå°è¿è¡Œï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</span></span><br><span class="line">daemonize <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><h5 id="pidfileï¼ˆè¿›ç¨‹IDæ–‡ä»¶ï¼‰"><a href="#pidfileï¼ˆè¿›ç¨‹IDæ–‡ä»¶ï¼‰" class="headerlink" title="pidfileï¼ˆè¿›ç¨‹IDæ–‡ä»¶ï¼‰"></a>pidfileï¼ˆè¿›ç¨‹IDæ–‡ä»¶ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­˜æ”¾Redisè¿›ç¨‹ID</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br></pre></td></tr></table></figure><p><strong>å¤šå®ä¾‹éƒ¨ç½²</strong>ï¼šæ¯ä¸ªå®ä¾‹ä½¿ç”¨ä¸åŒçš„pidfileã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®ä¾‹1</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹2</span></span><br><span class="line">pidfile /var/run/redis_6380.pid</span><br></pre></td></tr></table></figure><h5 id="loglevelï¼ˆæ—¥å¿—çº§åˆ«ï¼‰"><a href="#loglevelï¼ˆæ—¥å¿—çº§åˆ«ï¼‰" class="headerlink" title="loglevelï¼ˆæ—¥å¿—çº§åˆ«ï¼‰"></a>loglevelï¼ˆæ—¥å¿—çº§åˆ«ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å››ä¸ªçº§åˆ«ï¼ˆä»è¯¦ç»†åˆ°ç®€ç•¥ï¼‰</span></span><br><span class="line">loglevel debug      <span class="comment"># è°ƒè¯•ä¿¡æ¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰</span></span><br><span class="line">loglevel verbose    <span class="comment"># è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">loglevel notice     <span class="comment"># é€šçŸ¥ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</span></span><br><span class="line">loglevel warning    <span class="comment"># è­¦å‘Šä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</span></span><br></pre></td></tr></table></figure><p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p><ul><li><strong>å¼€å‘&#x2F;æµ‹è¯•</strong>ï¼šdebug æˆ– verbose</li><li><strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šnotice æˆ– warning</li></ul><h5 id="logfileï¼ˆæ—¥å¿—æ–‡ä»¶ï¼‰"><a href="#logfileï¼ˆæ—¥å¿—æ–‡ä»¶ï¼‰" class="headerlink" title="logfileï¼ˆæ—¥å¿—æ–‡ä»¶ï¼‰"></a>logfileï¼ˆæ—¥å¿—æ–‡ä»¶ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ‡å‡†è¾“å‡ºï¼ˆä¸è®°å½•æ–‡ä»¶ï¼‰</span></span><br><span class="line">logfile <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®°å½•åˆ°æ–‡ä»¶</span></span><br><span class="line">logfile /var/log/redis/redis.log</span><br></pre></td></tr></table></figure><h5 id="databasesï¼ˆæ•°æ®åº“æ•°é‡ï¼‰"><a href="#databasesï¼ˆæ•°æ®åº“æ•°é‡ï¼‰" class="headerlink" title="databasesï¼ˆæ•°æ®åº“æ•°é‡ï¼‰"></a>databasesï¼ˆæ•°æ®åº“æ•°é‡ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤16ä¸ªæ•°æ®åº“ï¼ˆç¼–å·0-15ï¼‰</span></span><br><span class="line">databases 16</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“</span></span><br><span class="line">SELECT 0   <span class="comment"># åˆ‡æ¢åˆ°0å·åº“</span></span><br><span class="line">SELECT 8   <span class="comment"># åˆ‡æ¢åˆ°8å·åº“</span></span><br></pre></td></tr></table></figure><h3 id="4-5-SECURITYï¼ˆå®‰å…¨é…ç½®ï¼‰"><a href="#4-5-SECURITYï¼ˆå®‰å…¨é…ç½®ï¼‰" class="headerlink" title="4.5 SECURITYï¼ˆå®‰å…¨é…ç½®ï¼‰"></a>4.5 SECURITYï¼ˆå®‰å…¨é…ç½®ï¼‰</h3><h4 id="å¯†ç è®¾ç½®"><a href="#å¯†ç è®¾ç½®" class="headerlink" title="å¯†ç è®¾ç½®"></a>å¯†ç è®¾ç½®</h4><p><strong>ä¸´æ—¶è®¾ç½®</strong>ï¼ˆé‡å¯åå¤±æ•ˆï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Rediså‘½ä»¤è¡Œä¸­è®¾ç½®</span></span><br><span class="line">127.0.0.1:6379&gt; CONFIG SET requirepass <span class="string">&quot;your_password&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¯†ç </span></span><br><span class="line">127.0.0.1:6379&gt; CONFIG GET requirepass</span><br><span class="line">1) <span class="string">&quot;requirepass&quot;</span></span><br><span class="line">2) <span class="string">&quot;your_password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å¯†ç ç™»å½•</span></span><br><span class="line">127.0.0.1:6379&gt; AUTH your_password</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>æ°¸ä¹…è®¾ç½®</strong>ï¼ˆé…ç½®æ–‡ä»¶ä¸­ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line">requirepass your_strong_password_here</span><br></pre></td></tr></table></figure><p><strong>å®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨å¯†ç </strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šå¯åŠ¨æ—¶æŒ‡å®š</span></span><br><span class="line">redis-cli -a your_password</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šè¿æ¥åè®¤è¯</span></span><br><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; AUTH your_password</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><blockquote><p><strong>å®‰å…¨å»ºè®®</strong>ï¼š</p><ul><li>ä½¿ç”¨å¤æ‚å¯†ç ï¼ˆå­—æ¯+æ•°å­—+ç‰¹æ®Šå­—ç¬¦ï¼‰</li><li>å®šæœŸæ›´æ¢å¯†ç </li><li>ç»“åˆbindå’Œprotected-modeä½¿ç”¨</li></ul></blockquote><h3 id="4-6-LIMITSï¼ˆé™åˆ¶é…ç½®ï¼‰"><a href="#4-6-LIMITSï¼ˆé™åˆ¶é…ç½®ï¼‰" class="headerlink" title="4.6 LIMITSï¼ˆé™åˆ¶é…ç½®ï¼‰"></a>4.6 LIMITSï¼ˆé™åˆ¶é…ç½®ï¼‰</h3><h4 id="å¸¸ç”¨é™åˆ¶é…ç½®é¡¹"><a href="#å¸¸ç”¨é™åˆ¶é…ç½®é¡¹" class="headerlink" title="å¸¸ç”¨é™åˆ¶é…ç½®é¡¹"></a>å¸¸ç”¨é™åˆ¶é…ç½®é¡¹</h4><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th><th>å»ºè®®å€¼</th></tr></thead><tbody><tr><td><code>maxclients</code></td><td>æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°</td><td>10000</td><td>æ ¹æ®å®é™…è°ƒæ•´</td></tr><tr><td><code>maxmemory</code></td><td>æœ€å¤§å†…å­˜ä½¿ç”¨é‡</td><td>0ï¼ˆæ— é™åˆ¶ï¼‰</td><td><strong>å¿…é¡»è®¾ç½®</strong></td></tr><tr><td><code>maxmemory-policy</code></td><td>å†…å­˜æ·˜æ±°ç­–ç•¥</td><td>noeviction</td><td>æ ¹æ®åœºæ™¯é€‰æ‹©</td></tr><tr><td><code>maxmemory-samples</code></td><td>LRUé‡‡æ ·æ•°é‡</td><td>5</td><td>3-7</td></tr></tbody></table><h4 id="è¯¦ç»†è¯´æ˜-2"><a href="#è¯¦ç»†è¯´æ˜-2" class="headerlink" title="è¯¦ç»†è¯´æ˜"></a>è¯¦ç»†è¯´æ˜</h4><h5 id="maxclientsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰"><a href="#maxclientsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰" class="headerlink" title="maxclientsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰"></a>maxclientsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ€å¤šå…è®¸10000ä¸ªå®¢æˆ·ç«¯åŒæ—¶è¿æ¥</span></span><br><span class="line">maxclients 10000</span><br></pre></td></tr></table></figure><p><strong>è¶…å‡ºé™åˆ¶çš„è¡¨ç°</strong>ï¼š</p><ul><li>æ‹’ç»æ–°çš„è¿æ¥è¯·æ±‚</li><li>è¿”å›é”™è¯¯ï¼š<code>&quot;max number of clients reached&quot;</code></li></ul><h5 id="maxmemoryï¼ˆæœ€å¤§å†…å­˜ï¼‰"><a href="#maxmemoryï¼ˆæœ€å¤§å†…å­˜ï¼‰" class="headerlink" title="maxmemoryï¼ˆæœ€å¤§å†…å­˜ï¼‰"></a>maxmemoryï¼ˆæœ€å¤§å†…å­˜ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸é™åˆ¶ï¼ˆå±é™©ï¼ï¼‰</span></span><br><span class="line">maxmemory 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># é™åˆ¶ä¸º1GB</span></span><br><span class="line">maxmemory 1gb</span><br><span class="line"></span><br><span class="line"><span class="comment"># é™åˆ¶ä¸º512MB</span></span><br><span class="line">maxmemory 512mb</span><br></pre></td></tr></table></figure><blockquote><p><strong>é‡è¦æç¤º</strong>ï¼š</p><ul><li><strong>ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½®</strong>ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´å†…å­˜å æ»¡ã€æœåŠ¡å™¨å®•æœº</li><li>å»ºè®®è®¾ç½®ä¸ºç‰©ç†å†…å­˜çš„ <strong>70-80%</strong></li><li>å¦‚æœæ˜¯ä¸»ä»æ¶æ„ï¼Œéœ€è¦é¢„ç•™å†…å­˜ç»™åŒæ­¥ç¼“å†²åŒº</li></ul></blockquote><p><strong>å†…å­˜è¾¾åˆ°ä¸Šé™åçš„è¡Œä¸º</strong>ï¼š</p><ul><li>æ ¹æ® <code>maxmemory-policy</code> ç­–ç•¥ç§»é™¤æ•°æ®</li><li>å¦‚æœæ— æ³•ç§»é™¤æˆ–è®¾ç½®äº† <code>noeviction</code>ï¼Œå†™æ“ä½œï¼ˆå¦‚SETã€LPUSHï¼‰ä¼šè¿”å›é”™è¯¯</li><li>è¯»æ“ä½œï¼ˆå¦‚GETï¼‰ä»ç„¶æ­£å¸¸å“åº”</li></ul><h5 id="maxmemory-policyï¼ˆå†…å­˜æ·˜æ±°ç­–ç•¥ï¼‰"><a href="#maxmemory-policyï¼ˆå†…å­˜æ·˜æ±°ç­–ç•¥ï¼‰" class="headerlink" title="maxmemory-policyï¼ˆå†…å­˜æ·˜æ±°ç­–ç•¥ï¼‰"></a>maxmemory-policyï¼ˆå†…å­˜æ·˜æ±°ç­–ç•¥ï¼‰</h5><p>å½“å†…å­˜è¾¾åˆ°ä¸Šé™æ—¶ï¼ŒRediså¦‚ä½•å¤„ç†æ–°çš„å†™å…¥è¯·æ±‚ï¼Ÿ</p><p><strong>8ç§æ·˜æ±°ç­–ç•¥</strong>ï¼š</p><table><thead><tr><th>ç­–ç•¥</th><th>è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>volatile-lru</code></td><td>å¯¹<strong>è®¾ç½®äº†è¿‡æœŸæ—¶é—´</strong>çš„keyä½¿ç”¨LRUç®—æ³•æ·˜æ±°</td><td>éƒ¨åˆ†keyéœ€è¦æŒä¹…åŒ–</td></tr><tr><td><code>allkeys-lru</code></td><td>å¯¹<strong>æ‰€æœ‰key</strong>ä½¿ç”¨LRUç®—æ³•æ·˜æ±°</td><td><strong>é€šç”¨ç¼“å­˜</strong>ï¼ˆæ¨èï¼‰</td></tr><tr><td><code>volatile-lfu</code></td><td>å¯¹<strong>è®¾ç½®äº†è¿‡æœŸæ—¶é—´</strong>çš„keyä½¿ç”¨LFUç®—æ³•æ·˜æ±°</td><td>Redis 4.0+</td></tr><tr><td><code>allkeys-lfu</code></td><td>å¯¹<strong>æ‰€æœ‰key</strong>ä½¿ç”¨LFUç®—æ³•æ·˜æ±°</td><td>Redis 4.0+</td></tr><tr><td><code>volatile-random</code></td><td>å¯¹<strong>è®¾ç½®äº†è¿‡æœŸæ—¶é—´</strong>çš„keyéšæœºæ·˜æ±°</td><td>æµ‹è¯•ç¯å¢ƒ</td></tr><tr><td><code>allkeys-random</code></td><td>å¯¹<strong>æ‰€æœ‰key</strong>éšæœºæ·˜æ±°</td><td>ä¸æ¨è</td></tr><tr><td><code>volatile-ttl</code></td><td>æ·˜æ±°<strong>TTLæœ€å°</strong>çš„keyï¼ˆå³å°†è¿‡æœŸï¼‰</td><td>åŸºäºè¿‡æœŸæ—¶é—´</td></tr><tr><td><code>noeviction</code></td><td><strong>ä¸æ·˜æ±°</strong>ï¼Œå†™æ“ä½œè¿”å›é”™è¯¯</td><td>ä¸¥æ ¼çš„æ•°æ®æŒä¹…åŒ–</td></tr></tbody></table><p><strong>é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨èï¼šå¯¹æ‰€æœ‰keyä½¿ç”¨LRUç®—æ³•</span></span><br><span class="line">maxmemory-policy allkeys-lru</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªå¯¹å¸¦è¿‡æœŸæ—¶é—´çš„keyä½¿ç”¨LRU</span></span><br><span class="line">maxmemory-policy volatile-lru</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸æ·˜æ±°ï¼Œå†™æ»¡è¿”å›é”™è¯¯</span></span><br><span class="line">maxmemory-policy noeviction</span><br></pre></td></tr></table></figure><p><strong>æ·˜æ±°ç­–ç•¥é€‰æ‹©å»ºè®®</strong>ï¼š</p><ul><li><strong>åœºæ™¯1ï¼šçº¯ç¼“å­˜åœºæ™¯</strong> â†’ <code>allkeys-lru</code></li><li><strong>åœºæ™¯2ï¼šéƒ¨åˆ†æ•°æ®éœ€è¦æŒä¹…åŒ–</strong> â†’ <code>volatile-lru</code></li><li><strong>åœºæ™¯3ï¼šä¸å…è®¸æ•°æ®ä¸¢å¤±</strong> â†’ <code>noeviction</code></li></ul><p><strong>LRU vs LFU</strong>ï¼š</p><ul><li><strong>LRUï¼ˆLeast Recently Usedï¼‰</strong>ï¼šæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œæ·˜æ±°æœ€ä¹…æœªè®¿é—®çš„</li><li><strong>LFUï¼ˆLeast Frequently Usedï¼‰</strong>ï¼šæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼Œæ·˜æ±°è®¿é—®é¢‘ç‡æœ€ä½çš„</li></ul><h5 id="maxmemory-samplesï¼ˆLRUé‡‡æ ·æ•°é‡ï¼‰"><a href="#maxmemory-samplesï¼ˆLRUé‡‡æ ·æ•°é‡ï¼‰" class="headerlink" title="maxmemory-samplesï¼ˆLRUé‡‡æ ·æ•°é‡ï¼‰"></a>maxmemory-samplesï¼ˆLRUé‡‡æ ·æ•°é‡ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤æ£€æŸ¥5ä¸ªkey</span></span><br><span class="line">maxmemory-samples 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># æé«˜ç²¾ç¡®åº¦</span></span><br><span class="line">maxmemory-samples 7</span><br><span class="line"></span><br><span class="line"><span class="comment"># é™ä½æ€§èƒ½æ¶ˆè€—</span></span><br><span class="line">maxmemory-samples 3</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li>LRUå’ŒTTLç®—æ³•éƒ½æ˜¯<strong>ä¼°ç®—å€¼</strong>ï¼Œä¸æ˜¯ç²¾ç¡®ç®—æ³•</li><li>Redisä¼šéšæœºæŠ½å–æŒ‡å®šæ•°é‡çš„keyï¼Œä»ä¸­é€‰æ‹©æœ€é€‚åˆæ·˜æ±°çš„</li><li>é‡‡æ ·æ•°é‡è¶Šå¤§ï¼Œç»“æœè¶Šç²¾ç¡®ï¼Œä½†æ€§èƒ½æ¶ˆè€—è¶Šå¤§</li><li>æ¨èå€¼ï¼š<strong>3-7</strong></li></ul><p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>é‡‡æ ·æ•°é‡</th><th>ç²¾ç¡®åº¦</th><th>æ€§èƒ½æ¶ˆè€—</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>3</td><td>ä½</td><td>ä½</td><td>é«˜å¹¶å‘åœºæ™¯</td></tr><tr><td>5</td><td>ä¸­</td><td>ä¸­</td><td>é€šç”¨åœºæ™¯ï¼ˆé»˜è®¤ï¼‰</td></tr><tr><td>7-10</td><td>é«˜</td><td>é«˜</td><td>å¯¹ç²¾ç¡®åº¦è¦æ±‚é«˜çš„åœºæ™¯</td></tr></tbody></table><h3 id="é…ç½®ç¤ºä¾‹ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰"><a href="#é…ç½®ç¤ºä¾‹ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰" class="headerlink" title="é…ç½®ç¤ºä¾‹ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰"></a>é…ç½®ç¤ºä¾‹ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== ç½‘ç»œé…ç½® ==========</span></span><br><span class="line"><span class="built_in">bind</span> 192.168.1.100 192.168.1.200    <span class="comment"># ç»‘å®šRedisæœåŠ¡å™¨å’Œåº”ç”¨æœåŠ¡å™¨IP</span></span><br><span class="line">protected-mode <span class="built_in">yes</span>                   <span class="comment"># å¼€å¯ä¿æŠ¤æ¨¡å¼</span></span><br><span class="line">port 6379</span><br><span class="line">tcp-backlog 2048</span><br><span class="line"><span class="built_in">timeout</span> 300</span><br><span class="line">tcp-keepalive 60</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== é€šç”¨é…ç½® ==========</span></span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line">loglevel notice</span><br><span class="line">logfile /var/log/redis/redis.log</span><br><span class="line">databases 16</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== å®‰å…¨é…ç½® ==========</span></span><br><span class="line">requirepass your_strong_password_2024</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== é™åˆ¶é…ç½® ==========</span></span><br><span class="line">maxclients 10000</span><br><span class="line">maxmemory 2gb</span><br><span class="line">maxmemory-policy allkeys-lru</span><br><span class="line">maxmemory-samples 5</span><br></pre></td></tr></table></figure><hr><h2 id="5-Rediså‘å¸ƒè®¢é˜…ï¼ˆPub-Subï¼‰"><a href="#5-Rediså‘å¸ƒè®¢é˜…ï¼ˆPub-Subï¼‰" class="headerlink" title="5. Rediså‘å¸ƒè®¢é˜…ï¼ˆPub&#x2F;Subï¼‰"></a>5. Rediså‘å¸ƒè®¢é˜…ï¼ˆPub&#x2F;Subï¼‰</h2><h3 id="5-1-ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…"><a href="#5-1-ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…" class="headerlink" title="5.1 ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…"></a>5.1 ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…</h3><p>Rediså‘å¸ƒè®¢é˜…ï¼ˆPub&#x2F;Subï¼‰æ˜¯ä¸€ç§<strong>æ¶ˆæ¯é€šä¿¡æ¨¡å¼</strong>ã€‚</p><p><strong>æ ¸å¿ƒæ¦‚å¿µ</strong>ï¼š</p><ul><li><strong>å‘é€è€…ï¼ˆPublisherï¼‰</strong>ï¼šå‘å¸ƒæ¶ˆæ¯</li><li><strong>è®¢é˜…è€…ï¼ˆSubscriberï¼‰</strong>ï¼šæ¥æ”¶æ¶ˆæ¯</li><li><strong>é¢‘é“ï¼ˆChannelï¼‰</strong>ï¼šæ¶ˆæ¯ä¼ é€’çš„ç®¡é“</li></ul><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è®¢é˜…<strong>ä»»æ„æ•°é‡</strong>çš„é¢‘é“</li><li>æ”¯æŒ<strong>ä¸€å¯¹å¤š</strong>çš„æ¶ˆæ¯å¹¿æ’­</li><li>æ¶ˆæ¯<strong>ä¸æŒä¹…åŒ–</strong>ï¼Œè®¢é˜…å‰çš„æ¶ˆæ¯æ— æ³•æ¥æ”¶</li></ul><h3 id="5-2-å‘å¸ƒè®¢é˜…æ¨¡å¼"><a href="#5-2-å‘å¸ƒè®¢é˜…æ¨¡å¼" class="headerlink" title="5.2 å‘å¸ƒè®¢é˜…æ¨¡å¼"></a>5.2 å‘å¸ƒè®¢é˜…æ¨¡å¼</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    å‘å¸ƒè€…                       è®¢é˜…è€…</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚Publisherâ”‚                 â”‚Subscriberâ”‚</span><br><span class="line">â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”˜</span><br><span class="line">     â”‚                           â”‚</span><br><span class="line">     â”‚ PUBLISH channel1 hello    â”‚ SUBSCRIBE channel1</span><br><span class="line">     â”‚                           â”‚</span><br><span class="line">     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºchannel1â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">               é¢‘é“</span><br></pre></td></tr></table></figure><h3 id="5-3-å¸¸ç”¨å‘½ä»¤"><a href="#5-3-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="5.3 å¸¸ç”¨å‘½ä»¤"></a>5.3 å¸¸ç”¨å‘½ä»¤</h3><h4 id="è®¢é˜…å‘½ä»¤"><a href="#è®¢é˜…å‘½ä»¤" class="headerlink" title="è®¢é˜…å‘½ä»¤"></a>è®¢é˜…å‘½ä»¤</h4><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>SUBSCRIBE channel [channel ...]</code></td><td>è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“</td><td><code>SUBSCRIBE channel1</code></td></tr><tr><td><code>PSUBSCRIBE pattern [pattern ...]</code></td><td>è®¢é˜…ç¬¦åˆæ¨¡å¼çš„é¢‘é“</td><td><code>PSUBSCRIBE news.*</code></td></tr><tr><td><code>UNSUBSCRIBE [channel ...]</code></td><td>å–æ¶ˆè®¢é˜…é¢‘é“</td><td><code>UNSUBSCRIBE channel1</code></td></tr><tr><td><code>PUNSUBSCRIBE [pattern ...]</code></td><td>å–æ¶ˆè®¢é˜…æ¨¡å¼</td><td><code>PUNSUBSCRIBE news.*</code></td></tr></tbody></table><h4 id="å‘å¸ƒå‘½ä»¤"><a href="#å‘å¸ƒå‘½ä»¤" class="headerlink" title="å‘å¸ƒå‘½ä»¤"></a>å‘å¸ƒå‘½ä»¤</h4><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>PUBLISH channel message</code></td><td>å‘é¢‘é“å‘é€æ¶ˆæ¯</td><td><code>PUBLISH channel1 &quot;hello&quot;</code></td><td>æ¥æ”¶æ¶ˆæ¯çš„è®¢é˜…è€…æ•°é‡</td></tr></tbody></table><h4 id="æŸ¥è¯¢å‘½ä»¤"><a href="#æŸ¥è¯¢å‘½ä»¤" class="headerlink" title="æŸ¥è¯¢å‘½ä»¤"></a>æŸ¥è¯¢å‘½ä»¤</h4><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>PUBSUB CHANNELS [pattern]</code></td><td>æŸ¥çœ‹æ´»è·ƒçš„é¢‘é“</td><td><code>PUBSUB CHANNELS</code></td></tr><tr><td><code>PUBSUB NUMSUB [channel ...]</code></td><td>æŸ¥çœ‹é¢‘é“è®¢é˜…è€…æ•°é‡</td><td><code>PUBSUB NUMSUB channel1</code></td></tr><tr><td><code>PUBSUB NUMPAT</code></td><td>æŸ¥çœ‹æ¨¡å¼è®¢é˜…æ•°é‡</td><td><code>PUBSUB NUMPAT</code></td></tr></tbody></table><h3 id="5-4-ä½¿ç”¨ç¤ºä¾‹"><a href="#5-4-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="5.4 ä½¿ç”¨ç¤ºä¾‹"></a>5.4 ä½¿ç”¨ç¤ºä¾‹</h3><h4 id="åŸºç¡€ç¤ºä¾‹ï¼šå•é¢‘é“é€šä¿¡"><a href="#åŸºç¡€ç¤ºä¾‹ï¼šå•é¢‘é“é€šä¿¡" class="headerlink" title="åŸºç¡€ç¤ºä¾‹ï¼šå•é¢‘é“é€šä¿¡"></a>åŸºç¡€ç¤ºä¾‹ï¼šå•é¢‘é“é€šä¿¡</h4><p><strong>æ­¥éª¤1ï¼šå®¢æˆ·ç«¯1 - è®¢é˜…é¢‘é“</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»ˆç«¯1ï¼šè®¢é˜…channel1</span></span><br><span class="line">127.0.0.1:6379&gt; SUBSCRIBE channel1</span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;channel1&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤2ï¼šå®¢æˆ·ç«¯2 - å‘å¸ƒæ¶ˆæ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»ˆç«¯2ï¼šå‘channel1å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">127.0.0.1:6379&gt; PUBLISH channel1 <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># è¿”å›1è¡¨ç¤ºæœ‰1ä¸ªè®¢é˜…è€…æ”¶åˆ°æ¶ˆæ¯</span></span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤3ï¼šå®¢æˆ·ç«¯1 - æ¥æ”¶æ¶ˆæ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»ˆç«¯1ï¼šæ”¶åˆ°æ¶ˆæ¯</span></span><br><span class="line">1) <span class="string">&quot;message&quot;</span></span><br><span class="line">2) <span class="string">&quot;channel1&quot;</span></span><br><span class="line">3) <span class="string">&quot;hello&quot;</span></span><br></pre></td></tr></table></figure><h4 id="è¿›é˜¶ç¤ºä¾‹ï¼šå¤šé¢‘é“è®¢é˜…"><a href="#è¿›é˜¶ç¤ºä¾‹ï¼šå¤šé¢‘é“è®¢é˜…" class="headerlink" title="è¿›é˜¶ç¤ºä¾‹ï¼šå¤šé¢‘é“è®¢é˜…"></a>è¿›é˜¶ç¤ºä¾‹ï¼šå¤šé¢‘é“è®¢é˜…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¢é˜…å¤šä¸ªé¢‘é“</span></span><br><span class="line">127.0.0.1:6379&gt; SUBSCRIBE channel1 channel2 channel3</span><br><span class="line">Reading messages...</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;channel1&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;channel2&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 2</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;channel3&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure><h4 id="æ¨¡å¼åŒ¹é…ç¤ºä¾‹"><a href="#æ¨¡å¼åŒ¹é…ç¤ºä¾‹" class="headerlink" title="æ¨¡å¼åŒ¹é…ç¤ºä¾‹"></a>æ¨¡å¼åŒ¹é…ç¤ºä¾‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¢é˜…æ‰€æœ‰ä»¥newså¼€å¤´çš„é¢‘é“</span></span><br><span class="line">127.0.0.1:6379&gt; PSUBSCRIBE news.*</span><br><span class="line">Reading messages...</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å¦ä¸€ä¸ªå®¢æˆ·ç«¯å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">127.0.0.1:6379&gt; PUBLISH news.sports <span class="string">&quot;NBA Finals&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PUBLISH news.tech <span class="string">&quot;AI Breakthrough&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¢é˜…è€…ä¼šæ”¶åˆ°æ‰€æœ‰åŒ¹é…çš„æ¶ˆæ¯</span></span><br><span class="line">1) <span class="string">&quot;pmessage&quot;</span></span><br><span class="line">2) <span class="string">&quot;news.*&quot;</span></span><br><span class="line">3) <span class="string">&quot;news.sports&quot;</span></span><br><span class="line">4) <span class="string">&quot;NBA Finals&quot;</span></span><br><span class="line"></span><br><span class="line">1) <span class="string">&quot;pmessage&quot;</span></span><br><span class="line">2) <span class="string">&quot;news.*&quot;</span></span><br><span class="line">3) <span class="string">&quot;news.tech&quot;</span></span><br><span class="line">4) <span class="string">&quot;AI Breakthrough&quot;</span></span><br></pre></td></tr></table></figure><h3 id="5-5-åº”ç”¨åœºæ™¯"><a href="#5-5-åº”ç”¨åœºæ™¯" class="headerlink" title="5.5 åº”ç”¨åœºæ™¯"></a>5.5 åº”ç”¨åœºæ™¯</h3><h4 id="1-å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ"><a href="#1-å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ" class="headerlink" title="1. å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ"></a>1. å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># èŠå¤©å®¤åœºæ™¯</span></span><br><span class="line"><span class="comment"># ç”¨æˆ·åŠ å…¥èŠå¤©å®¤</span></span><br><span class="line">SUBSCRIBE chatroom:1001</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·å‘é€æ¶ˆæ¯</span></span><br><span class="line">PUBLISH chatroom:1001 <span class="string">&quot;å¼ ä¸‰: å¤§å®¶å¥½ï¼&quot;</span></span><br><span class="line">PUBLISH chatroom:1001 <span class="string">&quot;æå››: ä½ å¥½ï¼&quot;</span></span><br></pre></td></tr></table></figure><h4 id="2-å®æ—¶é€šçŸ¥"><a href="#2-å®æ—¶é€šçŸ¥" class="headerlink" title="2. å®æ—¶é€šçŸ¥"></a>2. å®æ—¶é€šçŸ¥</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¢å•çŠ¶æ€é€šçŸ¥</span></span><br><span class="line"><span class="comment"># ç”¨æˆ·è®¢é˜…è‡ªå·±çš„è®¢å•é€šçŸ¥</span></span><br><span class="line">SUBSCRIBE order:user123</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç³»ç»Ÿå‘é€è®¢å•çŠ¶æ€å˜æ›´</span></span><br><span class="line">PUBLISH order:user123 <span class="string">&quot;æ‚¨çš„è®¢å•å·²å‘è´§&quot;</span></span><br><span class="line">PUBLISH order:user123 <span class="string">&quot;æ‚¨çš„è®¢å•å·²ç­¾æ”¶&quot;</span></span><br></pre></td></tr></table></figure><h4 id="3-æ—¥å¿—ç›‘æ§"><a href="#3-æ—¥å¿—ç›‘æ§" class="headerlink" title="3. æ—¥å¿—ç›‘æ§"></a>3. æ—¥å¿—ç›‘æ§</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¢é˜…æ‰€æœ‰é”™è¯¯æ—¥å¿—</span></span><br><span class="line">PSUBSCRIBE log.error.*</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸åŒæœåŠ¡å‘å¸ƒé”™è¯¯æ—¥å¿—</span></span><br><span class="line">PUBLISH log.error.api <span class="string">&quot;APIæœåŠ¡å¼‚å¸¸&quot;</span></span><br><span class="line">PUBLISH log.error.db <span class="string">&quot;æ•°æ®åº“è¿æ¥å¤±è´¥&quot;</span></span><br></pre></td></tr></table></figure><h3 id="5-6-æ³¨æ„äº‹é¡¹"><a href="#5-6-æ³¨æ„äº‹é¡¹" class="headerlink" title="5.6 æ³¨æ„äº‹é¡¹"></a>5.6 æ³¨æ„äº‹é¡¹</h3><h4 id="é‡è¦ç‰¹æ€§"><a href="#é‡è¦ç‰¹æ€§" class="headerlink" title="é‡è¦ç‰¹æ€§"></a>é‡è¦ç‰¹æ€§</h4><blockquote><p><strong>âš ï¸ æ¶ˆæ¯ä¸æŒä¹…åŒ–</strong>ï¼š</p><ul><li>å‘å¸ƒçš„æ¶ˆæ¯<strong>ä¸ä¼šè¢«ä¿å­˜</strong></li><li>è®¢é˜…è€…<strong>åªèƒ½æ¥æ”¶è®¢é˜…åå‘å¸ƒçš„æ¶ˆæ¯</strong></li><li>å¦‚æœè®¢é˜…è€…ä¸åœ¨çº¿ï¼Œæ¶ˆæ¯ä¼š<strong>ä¸¢å¤±</strong></li></ul></blockquote><p><strong>ç¤ºä¾‹è¯´æ˜</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. å…ˆå‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">PUBLISH channel1 <span class="string">&quot;ç¬¬ä¸€æ¡æ¶ˆæ¯&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åè®¢é˜…é¢‘é“</span></span><br><span class="line">SUBSCRIBE channel1</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœï¼šæ— æ³•æ”¶åˆ°&quot;ç¬¬ä¸€æ¡æ¶ˆæ¯&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å†æ¬¡å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">PUBLISH channel1 <span class="string">&quot;ç¬¬äºŒæ¡æ¶ˆæ¯&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœï¼šå¯ä»¥æ”¶åˆ°&quot;ç¬¬äºŒæ¡æ¶ˆæ¯&quot;</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨å»ºè®®"><a href="#ä½¿ç”¨å»ºè®®" class="headerlink" title="ä½¿ç”¨å»ºè®®"></a>ä½¿ç”¨å»ºè®®</h4><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>âœ… å®æ—¶æ€§å¼ºï¼Œå»¶è¿Ÿä½</li><li>âœ… å®ç°ç®€å•ï¼Œä½¿ç”¨æ–¹ä¾¿</li><li>âœ… æ”¯æŒå¤šæ’­ï¼ˆä¸€å¯¹å¤šï¼‰</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>âŒ æ¶ˆæ¯ä¸æŒä¹…åŒ–ï¼Œå¯èƒ½ä¸¢å¤±</li><li>âŒ è®¢é˜…è€…å¿…é¡»åœ¨çº¿æ‰èƒ½æ¥æ”¶</li><li>âŒ æ²¡æœ‰æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</li></ul><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>âœ… å®æ—¶èŠå¤©ã€å¼¹å¹•</li><li>âœ… å®æ—¶é€šçŸ¥ã€æ¨é€</li><li>âœ… å®æ—¶ç›‘æ§ã€æ—¥å¿—</li></ul><p><strong>ä¸é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>âŒ éœ€è¦æ¶ˆæ¯æŒä¹…åŒ–</li><li>âŒ éœ€è¦æ¶ˆæ¯ç¡®è®¤</li><li>âŒ è®¢é˜…è€…å¯èƒ½ç¦»çº¿</li></ul><p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>å¦‚æœéœ€è¦æ¶ˆæ¯æŒä¹…åŒ–å’Œç¡®è®¤ï¼Œå»ºè®®ä½¿ç”¨ï¼š<ul><li><strong>Redis Stream</strong>ï¼ˆRedis 5.0+ï¼‰</li><li><strong>RabbitMQ</strong>ã€<strong>Kafka</strong> ç­‰ä¸“ä¸šæ¶ˆæ¯é˜Ÿåˆ—</li></ul></li></ul><h3 id="5-7-å¯¹æ¯”å…¶ä»–æ¶ˆæ¯æœºåˆ¶"><a href="#5-7-å¯¹æ¯”å…¶ä»–æ¶ˆæ¯æœºåˆ¶" class="headerlink" title="5.7 å¯¹æ¯”å…¶ä»–æ¶ˆæ¯æœºåˆ¶"></a>5.7 å¯¹æ¯”å…¶ä»–æ¶ˆæ¯æœºåˆ¶</h3><table><thead><tr><th>ç‰¹æ€§</th><th>Pub&#x2F;Sub</th><th>Stream</th><th>Listï¼ˆLPUSH&#x2F;RPOPï¼‰</th></tr></thead><tbody><tr><td>æ¶ˆæ¯æŒä¹…åŒ–</td><td>âŒ å¦</td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td></tr><tr><td>æ¶ˆæ¯ç¡®è®¤</td><td>âŒ æ— </td><td>âœ… æœ‰</td><td>âš ï¸ æ‰‹åŠ¨</td></tr><tr><td>å¤šæ¶ˆè´¹è€…</td><td>âœ… æ”¯æŒ</td><td>âœ… æ”¯æŒ</td><td>âš ï¸ ç«äº‰æ¶ˆè´¹</td></tr><tr><td>æ¶ˆæ¯é‡æ’­</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td><td>âŒ ä¸æ”¯æŒ</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å®æ—¶é€šçŸ¥</td><td>æ¶ˆæ¯é˜Ÿåˆ—</td><td>ç®€å•é˜Ÿåˆ—</td></tr></tbody></table><h3 id="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"><a href="#å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰" class="headerlink" title="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"></a>å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPubSub;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisSubscriber</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºè®¢é˜…ç›‘å¬å™¨</span></span><br><span class="line">        <span class="type">JedisPubSub</span> <span class="variable">listener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPubSub</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String channel, String message)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ”¶åˆ°æ¶ˆæ¯ - é¢‘é“: &quot;</span> + channel + <span class="string">&quot;, æ¶ˆæ¯: &quot;</span> + message);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSubscribe</span><span class="params">(String channel, <span class="type">int</span> subscribedChannels)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è®¢é˜…é¢‘é“: &quot;</span> + channel);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¢é˜…é¢‘é“ï¼ˆé˜»å¡ï¼‰</span></span><br><span class="line">        jedis.subscribe(listener, <span class="string">&quot;channel1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisPublisher</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">subscribers</span> <span class="operator">=</span> jedis.publish(<span class="string">&quot;channel1&quot;</span>, <span class="string">&quot;Hello Redis!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€ç»™ &quot;</span> + subscribers + <span class="string">&quot; ä¸ªè®¢é˜…è€…&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-Redisé«˜çº§æ•°æ®ç±»å‹"><a href="#6-Redisé«˜çº§æ•°æ®ç±»å‹" class="headerlink" title="6. Redisé«˜çº§æ•°æ®ç±»å‹"></a>6. Redisé«˜çº§æ•°æ®ç±»å‹</h2><h3 id="6-1-Bitmapï¼ˆä½å›¾ï¼‰"><a href="#6-1-Bitmapï¼ˆä½å›¾ï¼‰" class="headerlink" title="6.1 Bitmapï¼ˆä½å›¾ï¼‰"></a>6.1 Bitmapï¼ˆä½å›¾ï¼‰</h3><h4 id="ä»€ä¹ˆæ˜¯Bitmap"><a href="#ä»€ä¹ˆæ˜¯Bitmap" class="headerlink" title="ä»€ä¹ˆæ˜¯Bitmap"></a>ä»€ä¹ˆæ˜¯Bitmap</h4><p><strong>Bitmapï¼ˆä½å›¾ï¼‰</strong> æ˜¯Redisæä¾›çš„ä¸€ç§ç‰¹æ®Šæ•°æ®ç»“æ„ï¼Œç”¨äºé«˜æ•ˆåœ°è¿›è¡Œä½æ“ä½œã€‚</p><p><strong>è®¡ç®—æœºåŸºç¡€çŸ¥è¯†</strong>ï¼š</p><ul><li>ç°ä»£è®¡ç®—æœºç”¨<strong>äºŒè¿›åˆ¶ï¼ˆä½ï¼‰</strong> ä½œä¸ºä¿¡æ¯çš„åŸºç¡€å•ä½</li><li>1ä¸ªå­—èŠ‚ï¼ˆByteï¼‰&#x3D; 8ä½ï¼ˆbitï¼‰</li><li>ä¾‹å¦‚å­—ç¬¦ä¸² <code>&quot;abc&quot;</code> ç”±3ä¸ªå­—èŠ‚ç»„æˆï¼š<ul><li><code>&#39;a&#39;</code> â†’ ASCIIç  <code>97</code> â†’ äºŒè¿›åˆ¶ <code>01100001</code></li><li><code>&#39;b&#39;</code> â†’ ASCIIç  <code>98</code> â†’ äºŒè¿›åˆ¶ <code>01100010</code></li><li><code>&#39;c&#39;</code> â†’ ASCIIç  <code>99</code> â†’ äºŒè¿›åˆ¶ <code>01100011</code></li></ul></li></ul><p><img src="/images/redis/bitmaps.png" alt="BitmapäºŒè¿›åˆ¶å­˜å‚¨"></p><p><strong>Bitmapçš„æœ¬è´¨</strong>ï¼š</p><ol><li><p><strong>Bitmapæœ¬èº«ä¸æ˜¯ä¸€ç§ç‹¬ç«‹çš„æ•°æ®ç±»å‹</strong></p><ul><li>å®é™…ä¸Šå®ƒå°±æ˜¯Stringç±»å‹ï¼ˆkey-valueï¼‰</li><li>ä½†å¯ä»¥å¯¹å­—ç¬¦ä¸²çš„<strong>ä½</strong>è¿›è¡Œæ“ä½œ</li></ul></li><li><p><strong>Bitmapæä¾›äº†ç‹¬ç«‹çš„å‘½ä»¤é›†</strong></p><ul><li>å¯ä»¥æŠŠBitmapæƒ³è±¡æˆä¸€ä¸ª<strong>ä»¥ä½ä¸ºå•ä½çš„æ•°ç»„</strong></li><li>æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨ <code>0</code> æˆ– <code>1</code></li><li>æ•°ç»„çš„ä¸‹æ ‡åœ¨Bitmapä¸­å«åš<strong>åç§»é‡ï¼ˆoffsetï¼‰</strong></li></ul></li></ol><p><strong>Bitmapç»“æ„ç¤ºæ„å›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åç§»é‡:  0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15</span><br><span class="line">ä½å€¼:   [0][1][0][0][1][1][0][0][1][0][0][1][0][0][1][1]</span><br></pre></td></tr></table></figure><p><img src="/images/redis/bitmaps2.png" alt="Bitmapç»“æ„"></p><p><strong>ä¼˜åŠ¿</strong>ï¼šåˆç†ä½¿ç”¨ä½æ“ä½œå¯ä»¥<strong>æœ‰æ•ˆæé«˜å†…å­˜ä½¿ç”¨ç‡å’Œå¼€å‘æ•ˆç‡</strong>ã€‚</p><h4 id="Bitmapå¸¸ç”¨å‘½ä»¤"><a href="#Bitmapå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Bitmapå¸¸ç”¨å‘½ä»¤"></a>Bitmapå¸¸ç”¨å‘½ä»¤</h4><h5 id="1-SETBIT-è®¾ç½®ä½å€¼"><a href="#1-SETBIT-è®¾ç½®ä½å€¼" class="headerlink" title="1. SETBIT - è®¾ç½®ä½å€¼"></a>1. SETBIT - è®¾ç½®ä½å€¼</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SETBIT key offset value</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>å–å€¼</th></tr></thead><tbody><tr><td><code>key</code></td><td>é”®å</td><td>å­—ç¬¦ä¸²</td></tr><tr><td><code>offset</code></td><td>åç§»é‡ï¼ˆä»0å¼€å§‹ï¼‰</td><td>éè´Ÿæ•´æ•°</td></tr><tr><td><code>value</code></td><td>ä½å€¼</td><td>0 æˆ– 1</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šåŸå§‹ä½çš„å€¼ï¼ˆ0æˆ–1ï¼‰</p><p><strong>åº”ç”¨åœºæ™¯ï¼šç”¨æˆ·è®¿é—®ç»Ÿè®¡</strong></p><p>æ¯ä¸ªç‹¬ç«‹ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡ç½‘ç«™å­˜æ”¾åœ¨Bitmapä¸­ï¼š</p><ul><li>è®¿é—®çš„ç”¨æˆ·è®°ä¸º <code>1</code></li><li>æœªè®¿é—®çš„ç”¨æˆ·è®°ä¸º <code>0</code></li><li>ç”¨åç§»é‡ä½œä¸ºç”¨æˆ·çš„ID</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><p>å‡è®¾ç°åœ¨æœ‰20ä¸ªç”¨æˆ·ï¼Œuseridä¸º <code>1, 6, 11, 15, 19</code> çš„ç”¨æˆ·è®¿é—®äº†ç½‘ç«™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># unique:users:20201106 ä»£è¡¨2020-11-06è¿™å¤©çš„ç‹¬ç«‹è®¿é—®ç”¨æˆ·</span></span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201106 1 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201106 6 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201106 11 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201106 15 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201106 19 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><p><strong>BitmapçŠ¶æ€å¦‚ä¸‹</strong>ï¼š</p><p><img src="/images/redis/bitmaps%E5%AE%9E%E4%BE%8B.png" alt="Bitmapç”¨æˆ·è®¿é—®ç¤ºä¾‹"></p><p><strong>âš ï¸ æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ol><li><p><strong>ç”¨æˆ·IDä¼˜åŒ–</strong>ï¼š</p><ul><li>å¾ˆå¤šåº”ç”¨çš„ç”¨æˆ·IDä»¥æŒ‡å®šæ•°å­—å¼€å¤´ï¼ˆä¾‹å¦‚10000ï¼‰</li><li>ç›´æ¥ä½¿ç”¨ç”¨æˆ·IDä½œä¸ºåç§»é‡ä¼šé€ æˆç©ºé—´æµªè´¹</li><li><strong>æ¨èåšæ³•</strong>ï¼šæ¯æ¬¡åšSETBITæ—¶å°†ç”¨æˆ·IDå‡å»èµ·å§‹æ•°å­—</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾ç”¨æˆ·IDä»10000å¼€å§‹</span></span><br><span class="line">SETBIT unique:<span class="built_in">users</span>:20201106 $((<span class="number">10001</span> - <span class="number">10000</span>)) 1  <span class="comment"># ç”¨æˆ·10001</span></span><br><span class="line">SETBIT unique:<span class="built_in">users</span>:20201106 $((<span class="number">10086</span> - <span class="number">10000</span>)) 1  <span class="comment"># ç”¨æˆ·10086</span></span><br></pre></td></tr></table></figure></li><li><p><strong>åˆå§‹åŒ–æ€§èƒ½</strong>ï¼š</p><ul><li>åœ¨ç¬¬ä¸€æ¬¡åˆå§‹åŒ–Bitmapæ—¶ï¼Œå¦‚æœåç§»é‡éå¸¸å¤§ï¼ˆå¦‚åƒä¸‡çº§ï¼‰</li><li>æ•´ä¸ªåˆå§‹åŒ–è¿‡ç¨‹æ‰§è¡Œä¼šæ¯”è¾ƒæ…¢</li><li>å¯èƒ½ä¼šé€ æˆRedisçš„<strong>é˜»å¡</strong></li><li>å»ºè®®åˆ†æ‰¹åˆå§‹åŒ–æˆ–ä½¿ç”¨ç®¡é“ï¼ˆPipelineï¼‰</li></ul></li></ol><h5 id="2-GETBIT-è·å–ä½å€¼"><a href="#2-GETBIT-è·å–ä½å€¼" class="headerlink" title="2. GETBIT - è·å–ä½å€¼"></a>2. GETBIT - è·å–ä½å€¼</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GETBIT key offset</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>å–å€¼</th></tr></thead><tbody><tr><td><code>key</code></td><td>é”®å</td><td>å­—ç¬¦ä¸²</td></tr><tr><td><code>offset</code></td><td>åç§»é‡ï¼ˆä»0å¼€å§‹ï¼‰</td><td>éè´Ÿæ•´æ•°</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šä½å€¼ï¼ˆ0æˆ–1ï¼‰ï¼Œå¦‚æœoffsetè¶…å‡ºèŒƒå›´åˆ™è¿”å›0</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢userid=1çš„ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡</span></span><br><span class="line">127.0.0.1:6379&gt; GETBIT unique:<span class="built_in">users</span>:20201106 1</span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># è¿”å›1è¡¨ç¤ºè®¿é—®è¿‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢userid=8çš„ç”¨æˆ·æ˜¯å¦è®¿é—®è¿‡</span></span><br><span class="line">127.0.0.1:6379&gt; GETBIT unique:<span class="built_in">users</span>:20201106 8</span><br><span class="line">(<span class="built_in">integer</span>) 0    <span class="comment"># è¿”å›0è¡¨ç¤ºæœªè®¿é—®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ä¸å­˜åœ¨çš„åç§»é‡</span></span><br><span class="line">127.0.0.1:6379&gt; GETBIT unique:<span class="built_in">users</span>:20201106 100</span><br><span class="line">(<span class="built_in">integer</span>) 0    <span class="comment"># è¶…å‡ºèŒƒå›´ä¹Ÿè¿”å›0</span></span><br></pre></td></tr></table></figure><h5 id="3-BITCOUNT-ç»Ÿè®¡ä½å€¼ä¸º1çš„æ•°é‡"><a href="#3-BITCOUNT-ç»Ÿè®¡ä½å€¼ä¸º1çš„æ•°é‡" class="headerlink" title="3. BITCOUNT - ç»Ÿè®¡ä½å€¼ä¸º1çš„æ•°é‡"></a>3. BITCOUNT - ç»Ÿè®¡ä½å€¼ä¸º1çš„æ•°é‡</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BITCOUNT key [start end]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>å–å€¼</th><th>æ˜¯å¦å¿…éœ€</th></tr></thead><tbody><tr><td><code>key</code></td><td>é”®å</td><td>å­—ç¬¦ä¸²</td><td>å¿…éœ€</td></tr><tr><td><code>start</code></td><td>èµ·å§‹å­—èŠ‚ç´¢å¼•</td><td>æ•´æ•°ï¼ˆå¯ä¸ºè´Ÿæ•°ï¼‰</td><td>å¯é€‰</td></tr><tr><td><code>end</code></td><td>ç»“æŸå­—èŠ‚ç´¢å¼•</td><td>æ•´æ•°ï¼ˆå¯ä¸ºè´Ÿæ•°ï¼‰</td><td>å¯é€‰</td></tr></tbody></table><p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼š</p><ul><li>ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­ä½å€¼ä¸º <code>1</code> çš„bitæ•°é‡</li><li>ä¸æŒ‡å®š<code>start</code>å’Œ<code>end</code>æ—¶ï¼Œç»Ÿè®¡æ•´ä¸ªå­—ç¬¦ä¸²</li><li><code>start</code>å’Œ<code>end</code>æ˜¯<strong>å­—èŠ‚ç´¢å¼•</strong>ï¼ˆä¸æ˜¯ä½ç´¢å¼•ï¼‰ï¼Œä»0å¼€å§‹</li><li>æ”¯æŒè´Ÿæ•°ç´¢å¼•ï¼š<code>-1</code>è¡¨ç¤ºæœ€åä¸€ä¸ªå­—èŠ‚ï¼Œ<code>-2</code>è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚</li></ul><p><strong>è¿”å›å€¼</strong>ï¼šä½å€¼ä¸º1çš„æ•°é‡</p><p><strong>ç¤ºä¾‹1ï¼šç»Ÿè®¡å…¨éƒ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—2020-11-06è¿™å¤©çš„ç‹¬ç«‹è®¿é—®ç”¨æˆ·æ•°é‡</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT unique:<span class="built_in">users</span>:20201106</span><br><span class="line">(<span class="built_in">integer</span>) 5    <span class="comment"># æœ‰5ä¸ªç”¨æˆ·è®¿é—®è¿‡ï¼ˆuserid=1,6,11,15,19ï¼‰</span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹2ï¼šæŒ‰å­—èŠ‚èŒƒå›´ç»Ÿè®¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾æœ‰ä¸€ä¸ªkey K1ï¼Œå†…å®¹ä¸ºï¼š</span></span><br><span class="line"><span class="comment"># K1 = [01000001 01000000 00000000 00100001]</span></span><br><span class="line"><span class="comment">#      [ å­—èŠ‚0 ][ å­—èŠ‚1 ][ å­—èŠ‚2 ][ å­—èŠ‚3 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡å­—èŠ‚1å’Œå­—èŠ‚2ï¼ˆå³ 01000000 00000000ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT K1 1 2</span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># åªæœ‰1ä¸ªbitä¸º1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡å­—èŠ‚1åˆ°å­—èŠ‚3ï¼ˆå³ 01000000 00000000 00100001ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT K1 1 3</span><br><span class="line">(<span class="built_in">integer</span>) 3    <span class="comment"># æœ‰3ä¸ªbitä¸º1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡å­—èŠ‚0åˆ°å€’æ•°ç¬¬2ä¸ªå­—èŠ‚ï¼ˆå³ 01000001 01000000 00000000ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT K1 0 -2</span><br><span class="line">(<span class="built_in">integer</span>) 3    <span class="comment"># æœ‰3ä¸ªbitä¸º1</span></span><br></pre></td></tr></table></figure><p><strong>âš ï¸ é‡è¦æé†’</strong>ï¼š</p><ul><li><code>SETBIT</code> æ“ä½œçš„æ˜¯<strong>bitä½ç½®</strong>ï¼ˆåç§»é‡ï¼‰</li><li><code>BITCOUNT</code> çš„ <code>start/end</code> å‚æ•°æ˜¯<strong>byteä½ç½®</strong>ï¼ˆå­—èŠ‚ç´¢å¼•ï¼‰</li></ul><p><strong>å®é™…åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»Ÿè®¡ç¬¬1ä¸ªå­—èŠ‚åˆ°ç¬¬3ä¸ªå­—èŠ‚ä¹‹é—´çš„ç‹¬ç«‹è®¿é—®ç”¨æˆ·æ•°</span></span><br><span class="line"><span class="comment"># å¯¹åº”çš„ç”¨æˆ·idæ˜¯ 11, 15, 19</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT unique:<span class="built_in">users</span>:20201106 1 3</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure><h5 id="4-BITOP-ä½è¿ç®—"><a href="#4-BITOP-ä½è¿ç®—" class="headerlink" title="4. BITOP - ä½è¿ç®—"></a>4. BITOP - ä½è¿ç®—</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BITOP operation destkey key [key ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>å–å€¼</th></tr></thead><tbody><tr><td><code>operation</code></td><td>ä½è¿ç®—æ“ä½œ</td><td>ANDï¼ˆäº¤é›†ï¼‰ã€ORï¼ˆå¹¶é›†ï¼‰ã€NOTï¼ˆéï¼‰ã€XORï¼ˆå¼‚æˆ–ï¼‰</td></tr><tr><td><code>destkey</code></td><td>ç»“æœä¿å­˜çš„ç›®æ ‡é”®</td><td>å­—ç¬¦ä¸²</td></tr><tr><td><code>key</code></td><td>å‚ä¸è¿ç®—çš„é”®</td><td>ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²</td></tr></tbody></table><p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼šå¯¹å¤šä¸ªBitmapè¿›è¡Œä½è¿ç®—ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°<code>destkey</code>ä¸­ã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šä¿å­˜åˆ°<code>destkey</code>çš„å­—ç¬¦ä¸²é•¿åº¦</p><p><strong>æ”¯æŒçš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è¯´æ˜</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>AND</code></td><td>äº¤é›†</td><td>æ‰¾å‡ºåŒæ—¶æ»¡è¶³å¤šä¸ªæ¡ä»¶çš„å…ƒç´ </td></tr><tr><td><code>OR</code></td><td>å¹¶é›†</td><td>æ‰¾å‡ºæ»¡è¶³ä»»æ„æ¡ä»¶çš„å…ƒç´ </td></tr><tr><td><code>NOT</code></td><td>é</td><td>åè½¬æ‰€æœ‰ä½ï¼ˆåªèƒ½æœ‰ä¸€ä¸ªæºkeyï¼‰</td></tr><tr><td><code>XOR</code></td><td>å¼‚æˆ–</td><td>æ‰¾å‡ºåªæ»¡è¶³å…¶ä¸­ä¸€ä¸ªæ¡ä»¶çš„å…ƒç´ </td></tr></tbody></table><p><strong>åº”ç”¨åœºæ™¯ç¤ºä¾‹</strong>ï¼š</p><p><strong>åœºæ™¯1ï¼šè®¡ç®—ä¸¤å¤©éƒ½è®¿é—®è¿‡ç½‘ç«™çš„ç”¨æˆ·ï¼ˆANDäº¤é›†ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2020-11-04è®¿é—®çš„ç”¨æˆ·ï¼šuserid=1,2,5,9</span></span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201104 1 1</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201104 2 1</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201104 5 1</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201104 9 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2020-11-03è®¿é—®çš„ç”¨æˆ·ï¼šuserid=0,1,4,9</span></span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201103 0 1</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201103 1 1</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201103 4 1</span><br><span class="line">127.0.0.1:6379&gt; SETBIT unique:<span class="built_in">users</span>:20201103 9 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ä¸¤å¤©éƒ½è®¿é—®è¿‡çš„ç”¨æˆ·ï¼ˆäº¤é›†ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; BITOP AND unique:<span class="built_in">users</span>:and:20201104_03 unique:<span class="built_in">users</span>:20201103 unique:<span class="built_in">users</span>:20201104</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç»“æœ</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT unique:<span class="built_in">users</span>:and:20201104_03</span><br><span class="line">(<span class="built_in">integer</span>) 2    <span class="comment"># ç”¨æˆ·1å’Œ9ä¸¤å¤©éƒ½è®¿é—®è¿‡</span></span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯2ï¼šè®¡ç®—ä»»æ„ä¸€å¤©è®¿é—®è¿‡ç½‘ç«™çš„ç”¨æˆ·ï¼ˆORå¹¶é›†ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—è‡³å°‘è®¿é—®è¿‡ä¸€å¤©çš„ç”¨æˆ·ï¼ˆå¹¶é›†ï¼‰- å¯ç”¨äºç»Ÿè®¡æœˆæ´»</span></span><br><span class="line">127.0.0.1:6379&gt; BITOP OR unique:<span class="built_in">users</span>:or:20201104_03 unique:<span class="built_in">users</span>:20201103 unique:<span class="built_in">users</span>:20201104</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç»“æœ</span></span><br><span class="line">127.0.0.1:6379&gt; BITCOUNT unique:<span class="built_in">users</span>:or:20201104_03</span><br><span class="line">(<span class="built_in">integer</span>) 6    <span class="comment"># ç”¨æˆ·0,1,2,4,5,9è‡³å°‘è®¿é—®è¿‡ä¸€å¤©</span></span><br></pre></td></tr></table></figure><p><img src="/images/redis/bitmapAnd%E7%A4%BA%E4%BE%8B.png" alt="Bitmapä½è¿ç®—ç¤ºä¾‹"></p><p><strong>åœºæ™¯3ï¼šè®¡ç®—æœªè®¿é—®è¿‡çš„ç”¨æˆ·ï¼ˆNOTï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åè½¬æ‰€æœ‰ä½ï¼Œæ‰¾å‡ºæœªè®¿é—®çš„ç”¨æˆ·</span></span><br><span class="line">127.0.0.1:6379&gt; BITOP NOT unique:<span class="built_in">users</span>:not:20201104 unique:<span class="built_in">users</span>:20201104</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure><h4 id="Bitmapä¸Setå¯¹æ¯”"><a href="#Bitmapä¸Setå¯¹æ¯”" class="headerlink" title="Bitmapä¸Setå¯¹æ¯”"></a>Bitmapä¸Setå¯¹æ¯”</h4><h5 id="åœºæ™¯1ï¼šå¤§é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapä¼˜åŠ¿æ˜æ˜¾ï¼‰"><a href="#åœºæ™¯1ï¼šå¤§é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapä¼˜åŠ¿æ˜æ˜¾ï¼‰" class="headerlink" title="åœºæ™¯1ï¼šå¤§é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapä¼˜åŠ¿æ˜æ˜¾ï¼‰"></a>åœºæ™¯1ï¼šå¤§é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapä¼˜åŠ¿æ˜æ˜¾ï¼‰</h5><p><strong>å‡è®¾</strong>ï¼š</p><ul><li>ç½‘ç«™æ€»ç”¨æˆ·æ•°ï¼š<strong>1äº¿</strong></li><li>æ¯å¤©ç‹¬ç«‹è®¿é—®ç”¨æˆ·ï¼š<strong>5åƒä¸‡</strong></li></ul><p><strong>å­˜å‚¨å¯¹æ¯”è¡¨</strong>ï¼š</p><table><thead><tr><th>æ•°æ®ç±»å‹</th><th>æ¯ä¸ªuseridå ç”¨ç©ºé—´</th><th>éœ€è¦å­˜å‚¨çš„ç”¨æˆ·é‡</th><th>å…¨éƒ¨å†…å­˜é‡</th></tr></thead><tbody><tr><td><strong>Seté›†åˆ</strong></td><td>64ä½ï¼ˆ8å­—èŠ‚ï¼‰</td><td>50,000,000</td><td>64ä½ Ã— 50,000,000 &#x3D; <strong>400MB</strong></td></tr><tr><td><strong>Bitmap</strong></td><td>1ä½</td><td>100,000,000</td><td>1ä½ Ã— 100,000,000 &#x3D; <strong>12.5MB</strong></td></tr></tbody></table><p><strong>èŠ‚çœç©ºé—´</strong>ï¼š400MB - 12.5MB &#x3D; <strong>387.5MB</strong>ï¼ˆèŠ‚çœ96.88%ï¼‰</p><p><strong>é•¿æœŸå­˜å‚¨å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>æ•°æ®ç±»å‹</th><th>ä¸€å¤©</th><th>ä¸€ä¸ªæœˆï¼ˆ30å¤©ï¼‰</th><th>ä¸€å¹´ï¼ˆ365å¤©ï¼‰</th></tr></thead><tbody><tr><td><strong>Seté›†åˆ</strong></td><td>400MB</td><td>12GB</td><td>144GB</td></tr><tr><td><strong>Bitmap</strong></td><td>12.5MB</td><td>375MB</td><td>4.5GB</td></tr></tbody></table><blockquote><p>âœ… <strong>ç»“è®º</strong>ï¼šåœ¨å¤§é‡æ´»è·ƒç”¨æˆ·åœºæ™¯ä¸‹ï¼ŒBitmapèƒ½èŠ‚çœ<strong>å¤§é‡å†…å­˜ç©ºé—´</strong>ï¼Œå°¤å…¶æ˜¯éšç€æ—¶é—´æ¨ç§»ï¼Œä¼˜åŠ¿éå¸¸æ˜æ˜¾ã€‚</p></blockquote><h5 id="åœºæ™¯2ï¼šå°‘é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapåŠ£åŠ¿æ˜æ˜¾ï¼‰"><a href="#åœºæ™¯2ï¼šå°‘é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapåŠ£åŠ¿æ˜æ˜¾ï¼‰" class="headerlink" title="åœºæ™¯2ï¼šå°‘é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapåŠ£åŠ¿æ˜æ˜¾ï¼‰"></a>åœºæ™¯2ï¼šå°‘é‡æ´»è·ƒç”¨æˆ·ï¼ˆBitmapåŠ£åŠ¿æ˜æ˜¾ï¼‰</h5><p><strong>å‡è®¾</strong>ï¼š</p><ul><li>ç½‘ç«™æ€»ç”¨æˆ·æ•°ï¼š<strong>1äº¿</strong></li><li>æ¯å¤©ç‹¬ç«‹è®¿é—®ç”¨æˆ·ï¼š<strong>10ä¸‡</strong>ï¼ˆå¤§é‡åƒµå°¸ç”¨æˆ·ï¼‰</li></ul><p><strong>å­˜å‚¨å¯¹æ¯”è¡¨</strong>ï¼š</p><table><thead><tr><th>æ•°æ®ç±»å‹</th><th>æ¯ä¸ªuseridå ç”¨ç©ºé—´</th><th>éœ€è¦å­˜å‚¨çš„ç”¨æˆ·é‡</th><th>å…¨éƒ¨å†…å­˜é‡</th></tr></thead><tbody><tr><td><strong>Seté›†åˆ</strong></td><td>64ä½ï¼ˆ8å­—èŠ‚ï¼‰</td><td>100,000</td><td>64ä½ Ã— 100,000 &#x3D; <strong>800KB</strong></td></tr><tr><td><strong>Bitmap</strong></td><td>1ä½</td><td>100,000,000</td><td>1ä½ Ã— 100,000,000 &#x3D; <strong>12.5MB</strong></td></tr></tbody></table><p><strong>ç©ºé—´æµªè´¹</strong>ï¼š12.5MB - 800KB &#x3D; <strong>11.7MB</strong>ï¼ˆBitmapå¤šå ç”¨15.6å€ç©ºé—´ï¼‰</p><blockquote><p>âŒ <strong>ç»“è®º</strong>ï¼šåœ¨å°‘é‡æ´»è·ƒç”¨æˆ·åœºæ™¯ä¸‹ï¼Œä½¿ç”¨Bitmap<strong>ä¸åˆé€‚</strong>ï¼Œå› ä¸ºå¤§éƒ¨åˆ†ä½éƒ½æ˜¯0ï¼Œé€ æˆç©ºé—´æµªè´¹ã€‚</p></blockquote><h4 id="ä½¿ç”¨å»ºè®®-1"><a href="#ä½¿ç”¨å»ºè®®-1" class="headerlink" title="ä½¿ç”¨å»ºè®®"></a>ä½¿ç”¨å»ºè®®</h4><p><strong>âœ… Bitmapé€‚ç”¨åœºæ™¯</strong>ï¼š</p><ol><li><p><strong>å¤§é‡ç”¨æˆ·ï¼Œé«˜æ´»è·ƒåº¦</strong>ï¼ˆæ´»è·ƒç‡ &gt; 10%ï¼‰</p><ul><li>ç”¨æˆ·ç­¾åˆ°ç»Ÿè®¡</li><li>æ—¥æ´»&#x2F;æœˆæ´»ç»Ÿè®¡</li><li>åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡</li></ul></li><li><p><strong>äºŒå€¼çŠ¶æ€æ ‡è®°</strong></p><ul><li>æ˜¯å¦å®Œæˆä»»åŠ¡ï¼ˆ0&#x2F;1ï¼‰</li><li>æ˜¯å¦å·²è¯»æ¶ˆæ¯ï¼ˆ0&#x2F;1ï¼‰</li><li>æƒé™æ§åˆ¶ï¼ˆæœ‰&#x2F;æ— ï¼‰</li></ul></li><li><p><strong>éœ€è¦ä½è¿ç®—</strong></p><ul><li>å¤šæ¡ä»¶äº¤é›†&#x2F;å¹¶é›†æŸ¥è¯¢</li><li>è¿ç»­ç­¾åˆ°ç»Ÿè®¡</li><li>ç”¨æˆ·ç”»åƒæ ‡ç­¾</li></ul></li></ol><p><strong>âŒ Bitmapä¸é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ol><li><p><strong>ç”¨æˆ·é‡å¤§ï¼Œæ´»è·ƒåº¦ä½</strong>ï¼ˆæ´»è·ƒç‡ &lt; 1%ï¼‰</p><ul><li>å»ºè®®ä½¿ç”¨Setæˆ–Hash</li></ul></li><li><p><strong>éœ€è¦å­˜å‚¨å¤šä¸ªçŠ¶æ€</strong>ï¼ˆä¸åªæ˜¯0&#x2F;1ï¼‰</p><ul><li>å»ºè®®ä½¿ç”¨Hashæˆ–String</li></ul></li><li><p><strong>ç”¨æˆ·IDä¸è¿ç»­æˆ–éæ•°å­—</strong></p><ul><li>å»ºè®®ä½¿ç”¨Hashæ˜ å°„</li></ul></li></ol><p><strong>æ€§èƒ½å¯¹æ¯”æ€»ç»“</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>Set</th><th>Bitmap</th></tr></thead><tbody><tr><td>å†…å­˜å ç”¨ï¼ˆé«˜æ´»è·ƒï¼‰</td><td>å¤§</td><td>å°</td></tr><tr><td>å†…å­˜å ç”¨ï¼ˆä½æ´»è·ƒï¼‰</td><td>å°</td><td>å¤§</td></tr><tr><td>æŸ¥è¯¢é€Ÿåº¦</td><td>O(1)</td><td>O(1)</td></tr><tr><td>ç»Ÿè®¡é€Ÿåº¦</td><td>O(N)</td><td>O(N&#x2F;8)</td></tr><tr><td>é›†åˆè¿ç®—</td><td>æ”¯æŒ</td><td>æ”¯æŒï¼ˆæ›´å¿«ï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å°‘é‡æ´»è·ƒç”¨æˆ·</td><td>å¤§é‡æ´»è·ƒç”¨æˆ·</td></tr></tbody></table><h4 id="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰-1"><a href="#å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰-1" class="headerlink" title="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"></a>å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BitmapExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;unique:users:20201106&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. è®°å½•ç”¨æˆ·è®¿é—®</span></span><br><span class="line">        jedis.setbit(key, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key, <span class="number">6</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key, <span class="number">11</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key, <span class="number">15</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key, <span class="number">19</span>, <span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦è®¿é—®</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">visited</span> <span class="operator">=</span> jedis.getbit(key, <span class="number">1</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”¨æˆ·1æ˜¯å¦è®¿é—®: &quot;</span> + visited);  <span class="comment">// true</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. ç»Ÿè®¡è®¿é—®ç”¨æˆ·æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> jedis.bitcount(key);</span><br><span class="line">        System.out.println(<span class="string">&quot;è®¿é—®ç”¨æˆ·æ•°: &quot;</span> + count);  <span class="comment">// 5</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. å¤šå¤©è®¿é—®äº¤é›†ï¼ˆè¿ç»­è®¿é—®ç”¨æˆ·ï¼‰</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">key1</span> <span class="operator">=</span> <span class="string">&quot;unique:users:20201104&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key2</span> <span class="operator">=</span> <span class="string">&quot;unique:users:20201105&quot;</span>;</span><br><span class="line">        jedis.setbit(key1, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key1, <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key2, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">        jedis.setbit(key2, <span class="number">3</span>, <span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">destKey</span> <span class="operator">=</span> <span class="string">&quot;unique:users:continuous&quot;</span>;</span><br><span class="line">        jedis.bitop(BitOP.AND, destKey, key1, key2);</span><br><span class="line">        <span class="type">long</span> <span class="variable">continuousUsers</span> <span class="operator">=</span> jedis.bitcount(destKey);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿ç»­è®¿é—®ç”¨æˆ·æ•°: &quot;</span> + continuousUsers);  <span class="comment">// 1</span></span><br><span class="line">        </span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-2-HyperLogLogï¼ˆåŸºæ•°ç»Ÿè®¡ï¼‰"><a href="#6-2-HyperLogLogï¼ˆåŸºæ•°ç»Ÿè®¡ï¼‰" class="headerlink" title="6.2 HyperLogLogï¼ˆåŸºæ•°ç»Ÿè®¡ï¼‰"></a>6.2 HyperLogLogï¼ˆåŸºæ•°ç»Ÿè®¡ï¼‰</h3><h4 id="ä»€ä¹ˆæ˜¯HyperLogLog"><a href="#ä»€ä¹ˆæ˜¯HyperLogLog" class="headerlink" title="ä»€ä¹ˆæ˜¯HyperLogLog"></a>ä»€ä¹ˆæ˜¯HyperLogLog</h4><p><strong>HyperLogLogï¼ˆHLLï¼‰</strong> æ˜¯Redisæä¾›çš„ä¸€ç§<strong>åŸºæ•°ç»Ÿè®¡ç®—æ³•</strong>ï¼Œç”¨äºè§£å†³å¤§æ•°æ®é‡ä¸‹çš„å»é‡è®¡æ•°é—®é¢˜ã€‚</p><h4 id="ä¸šåŠ¡åœºæ™¯ï¼šç»Ÿè®¡éœ€æ±‚çš„æŒ‘æˆ˜"><a href="#ä¸šåŠ¡åœºæ™¯ï¼šç»Ÿè®¡éœ€æ±‚çš„æŒ‘æˆ˜" class="headerlink" title="ä¸šåŠ¡åœºæ™¯ï¼šç»Ÿè®¡éœ€æ±‚çš„æŒ‘æˆ˜"></a>ä¸šåŠ¡åœºæ™¯ï¼šç»Ÿè®¡éœ€æ±‚çš„æŒ‘æˆ˜</h4><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°å„ç§ç»Ÿè®¡éœ€æ±‚ï¼š</p><table><thead><tr><th>ç»Ÿè®¡ç±»å‹</th><th>è¯´æ˜</th><th>å®ç°æ–¹å¼</th><th>éš¾åº¦</th></tr></thead><tbody><tr><td><strong>PV</strong>ï¼ˆPageViewï¼‰</td><td>é¡µé¢è®¿é—®é‡ï¼ˆå¯é‡å¤è®¡æ•°ï¼‰</td><td><code>INCR</code>ã€<code>INCRBY</code></td><td>â­ ç®€å•</td></tr><tr><td><strong>UV</strong>ï¼ˆUniqueVisitorï¼‰</td><td>ç‹¬ç«‹è®¿å®¢æ•°ï¼ˆéœ€å»é‡ï¼‰</td><td>HyperLogLog &#x2F; Set</td><td>â­â­â­ å¤æ‚</td></tr><tr><td><strong>ç‹¬ç«‹IPæ•°</strong></td><td>ä¸åŒIPè®¿é—®æ•°ï¼ˆéœ€å»é‡ï¼‰</td><td>HyperLogLog &#x2F; Set</td><td>â­â­â­ å¤æ‚</td></tr><tr><td><strong>æœç´¢è®°å½•æ•°</strong></td><td>ä¸åŒæœç´¢å…³é”®è¯æ•°ï¼ˆéœ€å»é‡ï¼‰</td><td>HyperLogLog &#x2F; Set</td><td>â­â­â­ å¤æ‚</td></tr></tbody></table><p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼šè¿™äº›éœ€è¦<strong>å»é‡å’Œè®¡æ•°</strong>çš„é—®é¢˜ç§°ä¸º<strong>åŸºæ•°é—®é¢˜ï¼ˆCardinality Problemï¼‰</strong>ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ</h4><p><strong>åŸºæ•°ï¼ˆCardinalityï¼‰</strong> &#x3D; é›†åˆä¸­ä¸é‡å¤å…ƒç´ çš„ä¸ªæ•°</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŸå§‹æ•°æ®é›†ï¼š&#123;1, 3, 5, 7, 5, 7, 8&#125;</span><br><span class="line">åŸºæ•°é›†åˆï¼š  &#123;1, 3, 5, 7, 8&#125;</span><br><span class="line">åŸºæ•°ï¼š      5ï¼ˆä¸é‡å¤å…ƒç´ ä¸ªæ•°ï¼‰</span><br></pre></td></tr></table></figure><p><strong>åŸºæ•°ä¼°è®¡</strong>ï¼šåœ¨<strong>è¯¯å·®å¯æ¥å—</strong>çš„èŒƒå›´å†…ï¼Œ<strong>å¿«é€Ÿè®¡ç®—</strong>åŸºæ•°ã€‚</p><h4 id="ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆçš„é—®é¢˜"><a href="#ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆçš„é—®é¢˜" class="headerlink" title="ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆçš„é—®é¢˜"></a>ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆçš„é—®é¢˜</h4><h5 id="æ–¹æ¡ˆå¯¹æ¯”"><a href="#æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="æ–¹æ¡ˆå¯¹æ¯”"></a>æ–¹æ¡ˆå¯¹æ¯”</h5><table><thead><tr><th>æ–¹æ¡ˆ</th><th>å®ç°æ–¹å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>MySQL</strong></td><td><code>SELECT COUNT(DISTINCT user_id)</code></td><td>ç»“æœç²¾ç¡®</td><td>âŒ æ€§èƒ½å·®<br>âŒ æ•°æ®é‡å¤§æ—¶æ…¢</td></tr><tr><td><strong>Redis Set</strong></td><td><code>SADD</code> + <code>SCARD</code></td><td>ç»“æœç²¾ç¡®<br>æŸ¥è¯¢å¿«</td><td>âŒ å†…å­˜å ç”¨å¤§<br>âŒ å…ƒç´ è¶Šå¤šè¶Šå å†…å­˜</td></tr><tr><td><strong>Redis Hash</strong></td><td><code>HSET</code> + <code>HLEN</code></td><td>ç»“æœç²¾ç¡®<br>æŸ¥è¯¢å¿«</td><td>âŒ å†…å­˜å ç”¨å¤§</td></tr><tr><td><strong>Bitmap</strong></td><td><code>SETBIT</code> + <code>BITCOUNT</code></td><td>å†…å­˜å ç”¨å°</td><td>âŒ ä»…é€‚ç”¨äºæ•°å€¼ID<br>âŒ ç¨€ç–æ•°æ®æµªè´¹ç©ºé—´</td></tr></tbody></table><p><strong>æ ¸å¿ƒçŸ›ç›¾</strong>ï¼š</p><ul><li>âœ… ç²¾ç¡®ç»Ÿè®¡ <strong>vs</strong> âŒ å†…å­˜å ç”¨è¿‡å¤§</li><li>éšç€æ•°æ®é‡å¢åŠ ï¼Œå†…å­˜å ç”¨çº¿æ€§å¢é•¿ï¼Œå¯¹äºè¶…å¤§æ•°æ®é›†<strong>ä¸åˆ‡å®é™…</strong></li></ul><p><strong>è§£å†³æ€è·¯</strong>ï¼šèƒ½å¦<strong>é™ä½ä¸€å®šç²¾åº¦</strong>æ¥<strong>å¹³è¡¡å­˜å‚¨ç©ºé—´</strong>ï¼Ÿ</p><h4 id="HyperLogLogçš„ä¼˜åŠ¿"><a href="#HyperLogLogçš„ä¼˜åŠ¿" class="headerlink" title="HyperLogLogçš„ä¼˜åŠ¿"></a>HyperLogLogçš„ä¼˜åŠ¿</h4><p>Redisæ¨å‡ºäº†<strong>HyperLogLogç®—æ³•</strong>ï¼Œå®Œç¾è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å›ºå®šå†…å­˜</strong></td><td>æ¯ä¸ªHLLé”®åªéœ€ <strong>12KB</strong> å†…å­˜</td></tr><tr><td><strong>æµ·é‡æ•°æ®</strong></td><td>å¯ç»Ÿè®¡æ¥è¿‘ <strong>2â¶â´</strong>ï¼ˆçº¦1800ä¸‡äº¿ï¼‰ä¸ªä¸åŒå…ƒç´ </td></tr><tr><td><strong>è¯¯å·®ç‡ä½</strong></td><td>æ ‡å‡†è¯¯å·®ç‡ <strong>0.81%</strong></td></tr><tr><td><strong>ä¸å­˜å‚¨å…ƒç´ </strong></td><td>åªè®¡ç®—åŸºæ•°ï¼Œä¸ä¿å­˜å…ƒç´ æœ¬èº«</td></tr></tbody></table><p><strong>å¯¹æ¯”ä¼˜åŠ¿</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ä¼ ç»ŸSetæ–¹æ¡ˆï¼š</span><br><span class="line">- 1äº¿ç”¨æˆ·UV â†’ éœ€è¦çº¦ 800MB å†…å­˜ï¼ˆæ¯ä¸ªå…ƒç´ 8å­—èŠ‚ï¼‰</span><br><span class="line">- å…ƒç´ è¶Šå¤šï¼Œå†…å­˜è¶Šå¤§ï¼ˆçº¿æ€§å¢é•¿ï¼‰</span><br><span class="line"></span><br><span class="line">HyperLogLogæ–¹æ¡ˆï¼š</span><br><span class="line">- 1äº¿ç”¨æˆ·UV â†’ åªéœ€ 12KB å†…å­˜</span><br><span class="line">- 10äº¿ç”¨æˆ·UV â†’ è¿˜æ˜¯ 12KB å†…å­˜</span><br><span class="line">- 100äº¿ç”¨æˆ·UV â†’ ä¾ç„¶ 12KB å†…å­˜ï¼ˆå›ºå®šä¸å˜ï¼‰</span><br></pre></td></tr></table></figure><p><strong>æƒè¡¡å–èˆ</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>Set</th><th>HyperLogLog</th></tr></thead><tbody><tr><td>å†…å­˜å ç”¨</td><td>å¤§ï¼ˆéšæ•°æ®é‡å¢é•¿ï¼‰</td><td>å°ï¼ˆå›ºå®š12KBï¼‰</td></tr><tr><td>ç»Ÿè®¡ç»“æœ</td><td>100%ç²¾ç¡®</td><td>çº¦99.19%ç²¾ç¡®ï¼ˆ0.81%è¯¯å·®ï¼‰</td></tr><tr><td>è¿”å›å…ƒç´ </td><td>âœ… å¯ä»¥ï¼ˆSMEMBERSï¼‰</td><td>âŒ ä¸èƒ½</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å°æ•°æ®é›†</td><td>å¤§æ•°æ®é›†</td></tr></tbody></table><blockquote><p><strong>âš ï¸ é‡è¦é™åˆ¶</strong>ï¼š</p><ul><li>HyperLogLog <strong>åªæ ¹æ®è¾“å…¥å…ƒç´ è®¡ç®—åŸºæ•°</strong></li><li><strong>ä¸ä¼šå­˜å‚¨è¾“å…¥å…ƒç´ æœ¬èº«</strong></li><li>ä¸èƒ½åƒSeté‚£æ ·è¿”å›å…·ä½“å…ƒç´ </li><li>åªèƒ½å›ç­”â€æœ‰å¤šå°‘ä¸ªä¸åŒçš„å…ƒç´ â€ï¼Œä¸èƒ½å›ç­”â€éƒ½æ˜¯å“ªäº›å…ƒç´ â€</li></ul></blockquote><h4 id="HyperLogLogå¸¸ç”¨å‘½ä»¤"><a href="#HyperLogLogå¸¸ç”¨å‘½ä»¤" class="headerlink" title="HyperLogLogå¸¸ç”¨å‘½ä»¤"></a>HyperLogLogå¸¸ç”¨å‘½ä»¤</h4><h5 id="1-PFADD-æ·»åŠ å…ƒç´ "><a href="#1-PFADD-æ·»åŠ å…ƒç´ " class="headerlink" title="1. PFADD - æ·»åŠ å…ƒç´ "></a>1. PFADD - æ·»åŠ å…ƒç´ </h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PFADD key element [element ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th></tr></thead><tbody><tr><td><code>key</code></td><td>HyperLogLogé”®å</td><td>å­—ç¬¦ä¸²</td></tr><tr><td><code>element</code></td><td>è¦æ·»åŠ çš„å…ƒç´ </td><td>å­—ç¬¦ä¸²ï¼ˆå¯å¤šä¸ªï¼‰</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼š</p><ul><li><code>1</code>ï¼šæ·»åŠ ååŸºæ•°ä¼°è®¡å€¼å‘ç”Ÿäº†å˜åŒ–</li><li><code>0</code>ï¼šæ·»åŠ ååŸºæ•°ä¼°è®¡å€¼æ²¡æœ‰å˜åŒ–ï¼ˆå¯èƒ½æ˜¯é‡å¤å…ƒç´ ï¼‰</li></ul><p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼šå°†æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šçš„HyperLogLogæ•°æ®ç»“æ„ä¸­ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»Ÿè®¡2024-11-14çš„ç½‘ç«™UV</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241114 <span class="string">&quot;user1&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># åŸºæ•°å˜åŒ–ï¼Œè¿”å›1</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241114 <span class="string">&quot;user2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># åŸºæ•°å˜åŒ–ï¼Œè¿”å›1</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241114 <span class="string">&quot;user1&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 0    <span class="comment"># é‡å¤å…ƒç´ ï¼ŒåŸºæ•°æœªå˜åŒ–ï¼Œè¿”å›0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¹é‡æ·»åŠ </span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241114 <span class="string">&quot;user3&quot;</span> <span class="string">&quot;user4&quot;</span> <span class="string">&quot;user5&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># åŸºæ•°å˜åŒ–ï¼Œè¿”å›1</span></span><br></pre></td></tr></table></figure><h5 id="2-PFCOUNT-è®¡ç®—åŸºæ•°"><a href="#2-PFCOUNT-è®¡ç®—åŸºæ•°" class="headerlink" title="2. PFCOUNT - è®¡ç®—åŸºæ•°"></a>2. PFCOUNT - è®¡ç®—åŸºæ•°</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PFCOUNT key [key ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th></tr></thead><tbody><tr><td><code>key</code></td><td>HyperLogLogé”®å</td><td>å­—ç¬¦ä¸²ï¼ˆå¯å¤šä¸ªï¼‰</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šåŸºæ•°çš„ä¼°è®¡å€¼ï¼ˆæ•´æ•°ï¼‰</p><p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼š</p><ul><li>å•ä¸ªkeyï¼šè¿”å›è¯¥HLLçš„åŸºæ•°ä¼°è®¡å€¼</li><li>å¤šä¸ªkeyï¼šè¿”å›å¤šä¸ªHLLçš„<strong>å¹¶é›†</strong>åŸºæ•°ä¼°è®¡å€¼</li></ul><p><strong>ç¤ºä¾‹1ï¼šå•ä¸ªHLLç»Ÿè®¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢2024-11-14çš„UV</span></span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT uv:20241114</span><br><span class="line">(<span class="built_in">integer</span>) 5    <span class="comment"># æœ‰5ä¸ªä¸åŒçš„è®¿å®¢</span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹2ï¼šå¤šä¸ªHLLåˆå¹¶ç»Ÿè®¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»Ÿè®¡ä¸€å‘¨çš„UVï¼ˆå–å¹¶é›†ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241111 <span class="string">&quot;user1&quot;</span> <span class="string">&quot;user2&quot;</span> <span class="string">&quot;user3&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241112 <span class="string">&quot;user2&quot;</span> <span class="string">&quot;user3&quot;</span> <span class="string">&quot;user4&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241113 <span class="string">&quot;user3&quot;</span> <span class="string">&quot;user4&quot;</span> <span class="string">&quot;user5&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ä¸‰å¤©çš„æ€»UVï¼ˆè‡ªåŠ¨å»é‡ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT uv:20241111 uv:20241112 uv:20241113</span><br><span class="line">(<span class="built_in">integer</span>) 5    <span class="comment"># user1, user2, user3, user4, user5</span></span><br></pre></td></tr></table></figure><h5 id="3-PFMERGE-åˆå¹¶HLL"><a href="#3-PFMERGE-åˆå¹¶HLL" class="headerlink" title="3. PFMERGE - åˆå¹¶HLL"></a>3. PFMERGE - åˆå¹¶HLL</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PFMERGE destkey sourcekey [sourcekey ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th></tr></thead><tbody><tr><td><code>destkey</code></td><td>ç›®æ ‡HLLé”®åï¼ˆåˆå¹¶ç»“æœï¼‰</td><td>å­—ç¬¦ä¸²</td></tr><tr><td><code>sourcekey</code></td><td>æºHLLé”®å</td><td>å­—ç¬¦ä¸²ï¼ˆå¯å¤šä¸ªï¼‰</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼š<code>OK</code></p><p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªHLLåˆå¹¶åçš„ç»“æœå­˜å‚¨åœ¨å¦ä¸€ä¸ªHLLä¸­ã€‚</p><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>æ¯å¤©çš„UVåˆå¹¶è®¡ç®—ä¸€å‘¨çš„UV</li><li>æ¯å¤©çš„æ´»è·ƒç”¨æˆ·åˆå¹¶è®¡ç®—æœˆæ´»ï¼ˆMAUï¼‰</li><li>æ¯å°æ—¶çš„ç‹¬ç«‹IPåˆå¹¶è®¡ç®—æ—¥ç‹¬ç«‹IP</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯å¤©è®°å½•UV</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241107 <span class="string">&quot;user1&quot;</span> <span class="string">&quot;user2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241108 <span class="string">&quot;user2&quot;</span> <span class="string">&quot;user3&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241109 <span class="string">&quot;user3&quot;</span> <span class="string">&quot;user4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241110 <span class="string">&quot;user4&quot;</span> <span class="string">&quot;user5&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241111 <span class="string">&quot;user5&quot;</span> <span class="string">&quot;user6&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241112 <span class="string">&quot;user6&quot;</span> <span class="string">&quot;user7&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; PFADD uv:20241113 <span class="string">&quot;user7&quot;</span> <span class="string">&quot;user8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶è®¡ç®—ä¸€å‘¨çš„UV</span></span><br><span class="line">127.0.0.1:6379&gt; PFMERGE uv:week45 uv:20241107 uv:20241108 uv:20241109 uv:20241110 uv:20241111 uv:20241112 uv:20241113</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ä¸€å‘¨çš„æ€»UV</span></span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT uv:week45</span><br><span class="line">(<span class="built_in">integer</span>) 8    <span class="comment"># 8ä¸ªä¸åŒçš„ç”¨æˆ·è®¿é—®è¿‡</span></span><br></pre></td></tr></table></figure><h4 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h4><h5 id="1-ç½‘ç«™UVç»Ÿè®¡"><a href="#1-ç½‘ç«™UVç»Ÿè®¡" class="headerlink" title="1. ç½‘ç«™UVç»Ÿè®¡"></a>1. ç½‘ç«™UVç»Ÿè®¡</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯æ¬¡ç”¨æˆ·è®¿é—®é¡µé¢æ—¶</span></span><br><span class="line">PFADD uv:20241114 <span class="string">&quot;user_id_123&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®æ—¶æŸ¥è¯¢ä»Šæ—¥UV</span></span><br><span class="line">PFCOUNT uv:20241114</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢æœ¬å‘¨UV</span></span><br><span class="line">PFCOUNT uv:20241108 uv:20241109 uv:20241110 uv:20241111 uv:20241112 uv:20241113 uv:20241114</span><br></pre></td></tr></table></figure><h5 id="2-ç‹¬ç«‹IPç»Ÿè®¡"><a href="#2-ç‹¬ç«‹IPç»Ÿè®¡" class="headerlink" title="2. ç‹¬ç«‹IPç»Ÿè®¡"></a>2. ç‹¬ç«‹IPç»Ÿè®¡</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®°å½•è®¿é—®IP</span></span><br><span class="line">PFADD ip:20241114 <span class="string">&quot;192.168.1.1&quot;</span></span><br><span class="line">PFADD ip:20241114 <span class="string">&quot;192.168.1.2&quot;</span></span><br><span class="line">PFADD ip:20241114 <span class="string">&quot;192.168.1.1&quot;</span>  <span class="comment"># é‡å¤IPè‡ªåŠ¨å»é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ç‹¬ç«‹IPæ•°</span></span><br><span class="line">PFCOUNT ip:20241114</span><br></pre></td></tr></table></figure><h5 id="3-æœç´¢å…³é”®è¯ç»Ÿè®¡"><a href="#3-æœç´¢å…³é”®è¯ç»Ÿè®¡" class="headerlink" title="3. æœç´¢å…³é”®è¯ç»Ÿè®¡"></a>3. æœç´¢å…³é”®è¯ç»Ÿè®¡</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®°å½•æœç´¢å…³é”®è¯</span></span><br><span class="line">PFADD search:20241114 <span class="string">&quot;Redisæ•™ç¨‹&quot;</span></span><br><span class="line">PFADD search:20241114 <span class="string">&quot;Javaé¢è¯•&quot;</span></span><br><span class="line">PFADD search:20241114 <span class="string">&quot;Redisæ•™ç¨‹&quot;</span>  <span class="comment"># é‡å¤å…³é”®è¯è‡ªåŠ¨å»é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ä¸åŒæœç´¢å…³é”®è¯æ•°é‡</span></span><br><span class="line">PFCOUNT search:20241114</span><br></pre></td></tr></table></figure><h5 id="4-APPæ—¥æ´»-æœˆæ´»ç»Ÿè®¡"><a href="#4-APPæ—¥æ´»-æœˆæ´»ç»Ÿè®¡" class="headerlink" title="4. APPæ—¥æ´»&#x2F;æœˆæ´»ç»Ÿè®¡"></a>4. APPæ—¥æ´»&#x2F;æœˆæ´»ç»Ÿè®¡</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯æ—¥æ´»è·ƒç”¨æˆ·</span></span><br><span class="line">PFADD dau:20241114 <span class="string">&quot;user_1001&quot;</span> <span class="string">&quot;user_1002&quot;</span> <span class="string">&quot;user_1003&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ—¥æ´»ï¼ˆDAUï¼‰</span></span><br><span class="line">PFCOUNT dau:20241114</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶è®¡ç®—æœˆæ´»ï¼ˆMAUï¼‰</span></span><br><span class="line">PFMERGE mau:202411 dau:20241101 dau:20241102 ... dau:20241130</span><br><span class="line">PFCOUNT mau:202411</span><br></pre></td></tr></table></figure><h4 id="HyperLogLog-vs-å…¶ä»–æ–¹æ¡ˆ"><a href="#HyperLogLog-vs-å…¶ä»–æ–¹æ¡ˆ" class="headerlink" title="HyperLogLog vs å…¶ä»–æ–¹æ¡ˆ"></a>HyperLogLog vs å…¶ä»–æ–¹æ¡ˆ</h4><h5 id="å†…å­˜å ç”¨å¯¹æ¯”ï¼ˆ1äº¿ç”¨æˆ·UVç»Ÿè®¡ï¼‰"><a href="#å†…å­˜å ç”¨å¯¹æ¯”ï¼ˆ1äº¿ç”¨æˆ·UVç»Ÿè®¡ï¼‰" class="headerlink" title="å†…å­˜å ç”¨å¯¹æ¯”ï¼ˆ1äº¿ç”¨æˆ·UVç»Ÿè®¡ï¼‰"></a>å†…å­˜å ç”¨å¯¹æ¯”ï¼ˆ1äº¿ç”¨æˆ·UVç»Ÿè®¡ï¼‰</h5><table><thead><tr><th>æ–¹æ¡ˆ</th><th>å†…å­˜å ç”¨</th><th>ç²¾ç¡®åº¦</th><th>æŸ¥è¯¢é€Ÿåº¦</th></tr></thead><tbody><tr><td><strong>MySQL</strong></td><td>çº¦4GBï¼ˆ40äº¿å­—èŠ‚ï¼‰</td><td>100%</td><td>æ…¢ï¼ˆç§’çº§ï¼‰</td></tr><tr><td><strong>Redis Set</strong></td><td>çº¦800MB</td><td>100%</td><td>å¿«ï¼ˆæ¯«ç§’çº§ï¼‰</td></tr><tr><td><strong>Redis Bitmap</strong></td><td>çº¦12MB</td><td>100%</td><td>å¿«ï¼ˆæ¯«ç§’çº§ï¼‰</td></tr><tr><td><strong>Redis HyperLogLog</strong></td><td><strong>12KB</strong></td><td>99.19%</td><td>å¿«ï¼ˆæ¯«ç§’çº§ï¼‰</td></tr></tbody></table><p><strong>å†…å­˜èŠ‚çœæ¯”ä¾‹</strong>ï¼š</p><ul><li>vs Setï¼š800MB &#x2F; 12KB &#x3D; <strong>66,666å€</strong></li><li>vs Bitmapï¼š12MB &#x2F; 12KB &#x3D; <strong>1,000å€</strong></li></ul><h5 id="é€‚ç”¨åœºæ™¯å¯¹æ¯”"><a href="#é€‚ç”¨åœºæ™¯å¯¹æ¯”" class="headerlink" title="é€‚ç”¨åœºæ™¯å¯¹æ¯”"></a>é€‚ç”¨åœºæ™¯å¯¹æ¯”</h5><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>æ•°æ®é‡å°ï¼ˆ&lt; 1ä¸‡ï¼‰</td><td>Set</td><td>å†…å­˜å ç”¨å¯æ¥å—ï¼Œç²¾ç¡®ç»Ÿè®¡</td></tr><tr><td>éœ€è¦è¿”å›å…·ä½“å…ƒç´ </td><td>Set</td><td>HyperLogLogä¸å­˜å‚¨å…ƒç´ </td></tr><tr><td>éœ€è¦100%ç²¾ç¡®</td><td>Set &#x2F; Bitmap</td><td>HyperLogLogæœ‰0.81%è¯¯å·®</td></tr><tr><td>æ•°æ®é‡å¤§ï¼ˆ&gt; ç™¾ä¸‡ï¼‰</td><td><strong>HyperLogLog</strong></td><td>å†…å­˜å ç”¨å›ºå®šï¼Œæ€§èƒ½ä¼˜å¼‚</td></tr><tr><td>å¯æ¥å—å°è¯¯å·®</td><td><strong>HyperLogLog</strong></td><td>æ€§ä»·æ¯”æœ€é«˜</td></tr><tr><td>UV&#x2F;DAU&#x2F;MAUç»Ÿè®¡</td><td><strong>HyperLogLog</strong></td><td>ä¸“ä¸ºæ­¤åœºæ™¯è®¾è®¡</td></tr></tbody></table><h4 id="ä½¿ç”¨å»ºè®®-2"><a href="#ä½¿ç”¨å»ºè®®-2" class="headerlink" title="ä½¿ç”¨å»ºè®®"></a>ä½¿ç”¨å»ºè®®</h4><p><strong>âœ… HyperLogLogé€‚ç”¨åœºæ™¯</strong>ï¼š</p><ol><li><p><strong>å¤§æ•°æ®é‡å»é‡ç»Ÿè®¡</strong>ï¼ˆç™¾ä¸‡çº§ä»¥ä¸Šï¼‰</p><ul><li>ç½‘ç«™UVç»Ÿè®¡</li><li>APPæ—¥æ´»&#x2F;æœˆæ´»ï¼ˆDAU&#x2F;MAUï¼‰</li><li>ç‹¬ç«‹IPè®¿é—®ç»Ÿè®¡</li></ul></li><li><p><strong>å¯æ¥å—å°è¯¯å·®</strong>ï¼ˆ0.81%è¯¯å·®ï¼‰</p><ul><li>99.19%çš„ç²¾ç¡®åº¦å·²è¶³å¤Ÿ</li><li>å¦‚ï¼š1äº¿UVï¼Œè¯¯å·®çº¦81ä¸‡</li></ul></li><li><p><strong>ä¸éœ€è¦è·å–å…·ä½“å…ƒç´ </strong></p><ul><li>åªéœ€è¦â€æœ‰å¤šå°‘ä¸ªâ€</li><li>ä¸éœ€è¦â€éƒ½æ˜¯å“ªäº›â€</li></ul></li><li><p><strong>å†…å­˜èµ„æºå—é™</strong></p><ul><li>å›ºå®š12KBå†…å­˜</li><li>ä¸å—æ•°æ®é‡å½±å“</li></ul></li></ol><p><strong>âŒ HyperLogLogä¸é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ol><li><p><strong>éœ€è¦100%ç²¾ç¡®</strong></p><ul><li>é‡‘èè®¡ç®—ã€äº¤æ˜“ç»Ÿè®¡</li><li>å»ºè®®ä½¿ç”¨Set</li></ul></li><li><p><strong>éœ€è¦è¿”å›å…·ä½“å…ƒç´ </strong></p><ul><li>è·å–æ‰€æœ‰è®¿é—®ç”¨æˆ·åˆ—è¡¨</li><li>å»ºè®®ä½¿ç”¨Set</li></ul></li><li><p><strong>æ•°æ®é‡å¾ˆå°</strong>ï¼ˆ&lt; 1ä¸‡ï¼‰</p><ul><li>Setçš„å†…å­˜å ç”¨å¯æ¥å—</li><li>ä¸éœ€è¦ç‰ºç‰²ç²¾ç¡®åº¦</li></ul></li><li><p><strong>éœ€è¦åˆ é™¤æŒ‡å®šå…ƒç´ </strong></p><ul><li>HyperLogLogä¸æ”¯æŒåˆ é™¤</li><li>å»ºè®®ä½¿ç”¨Set</li></ul></li></ol><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><blockquote><p><strong>âš ï¸ è¯¯å·®è¯´æ˜</strong>ï¼š</p><ul><li>æ ‡å‡†è¯¯å·®ç‡ï¼š<strong>0.81%</strong></li><li>å‡†ç¡®ç‡ï¼š<strong>99.19%</strong></li><li>ç¤ºä¾‹ï¼šçœŸå®UV &#x3D; 1,000,000ï¼ŒHLLç»Ÿè®¡ &#x3D; 1,000,000 Â± 8,100</li></ul></blockquote><blockquote><p><strong>âš ï¸ å…ƒç´ ä¸å¯å–å‡º</strong>ï¼š</p><ul><li>HyperLogLogåªè®¡ç®—åŸºæ•°ï¼Œä¸å­˜å‚¨å…ƒç´ </li><li>æ— æ³•ä½¿ç”¨ç±»ä¼¼<code>SMEMBERS</code>çš„å‘½ä»¤è·å–æ‰€æœ‰å…ƒç´ </li><li>æ— æ³•åˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨</li></ul></blockquote><blockquote><p><strong>âš ï¸ å†…å­˜å›ºå®šä½†ä¸å¯å‹ç¼©</strong>ï¼š</p><ul><li>å³ä½¿åªæœ‰1ä¸ªå…ƒç´ ï¼Œä¹Ÿå ç”¨12KB</li><li>å°æ•°æ®é‡æ—¶ä¸å¦‚SetèŠ‚çœç©ºé—´</li></ul></blockquote><blockquote><p><strong>âš ï¸ æ— æ³•åˆ é™¤å•ä¸ªå…ƒç´ </strong>ï¼š</p><ul><li>åªèƒ½åˆ é™¤æ•´ä¸ªHLL</li><li>ä¸æ”¯æŒç±»ä¼¼<code>SREM</code>çš„æ“ä½œ</li></ul></blockquote><h4 id="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰-2"><a href="#å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰-2" class="headerlink" title="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"></a>å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HyperLogLogExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;uv:20241114&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. æ¨¡æ‹Ÿç”¨æˆ·è®¿é—®ï¼ˆæ·»åŠ å…ƒç´ ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            jedis.pfadd(key, <span class="string">&quot;user_&quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ·»åŠ ä¸€äº›é‡å¤ç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            jedis.pfadd(key, <span class="string">&quot;user_&quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. ç»Ÿè®¡UVï¼ˆåº”è¯¥æ¥è¿‘10000ï¼Œæœ‰å°è¯¯å·®ï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">uv</span> <span class="operator">=</span> jedis.pfcount(key);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»Šæ—¥UV: &quot;</span> + uv);  <span class="comment">// çº¦10000ï¼ˆè¯¯å·®Â±81ï¼‰</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. å¤šå¤©UVç»Ÿè®¡</span></span><br><span class="line">        jedis.pfadd(<span class="string">&quot;uv:20241112&quot;</span>, <span class="string">&quot;user_1&quot;</span>, <span class="string">&quot;user_2&quot;</span>, <span class="string">&quot;user_3&quot;</span>);</span><br><span class="line">        jedis.pfadd(<span class="string">&quot;uv:20241113&quot;</span>, <span class="string">&quot;user_2&quot;</span>, <span class="string">&quot;user_3&quot;</span>, <span class="string">&quot;user_4&quot;</span>);</span><br><span class="line">        jedis.pfadd(<span class="string">&quot;uv:20241114&quot;</span>, <span class="string">&quot;user_3&quot;</span>, <span class="string">&quot;user_4&quot;</span>, <span class="string">&quot;user_5&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®—ä¸‰å¤©çš„æ€»UVï¼ˆè‡ªåŠ¨å»é‡ï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">totalUv</span> <span class="operator">=</span> jedis.pfcount(<span class="string">&quot;uv:20241112&quot;</span>, <span class="string">&quot;uv:20241113&quot;</span>, <span class="string">&quot;uv:20241114&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‰å¤©æ€»UV: &quot;</span> + totalUv);  <span class="comment">// 5</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. åˆå¹¶è®¡ç®—å‘¨UV</span></span><br><span class="line">        jedis.pfmerge(<span class="string">&quot;uv:week46&quot;</span>, <span class="string">&quot;uv:20241112&quot;</span>, <span class="string">&quot;uv:20241113&quot;</span>, <span class="string">&quot;uv:20241114&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">weekUv</span> <span class="operator">=</span> jedis.pfcount(<span class="string">&quot;uv:week46&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ¬å‘¨UV: &quot;</span> + weekUv);  <span class="comment">// 5</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5. è®¡ç®—æœˆæ´»ï¼ˆMAUï¼‰</span></span><br><span class="line">        <span class="comment">// å‡è®¾æ¯å¤©éƒ½æœ‰è®°å½•</span></span><br><span class="line">        String[] dailyKeys = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">30</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">day</span> <span class="operator">=</span> <span class="number">1</span>; day &lt;= <span class="number">30</span>; day++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">dailyKey</span> <span class="operator">=</span> String.format(<span class="string">&quot;dau:202411%02d&quot;</span>, day);</span><br><span class="line">            dailyKeys[day - <span class="number">1</span>] = dailyKey;</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿæ¯å¤©100ä¸ªæ´»è·ƒç”¨æˆ·</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">uid</span> <span class="operator">=</span> <span class="number">1</span>; uid &lt;= <span class="number">100</span>; uid++) &#123;</span><br><span class="line">                jedis.pfadd(dailyKey, <span class="string">&quot;user_&quot;</span> + uid);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå¹¶è®¡ç®—MAU</span></span><br><span class="line">        jedis.pfmerge(<span class="string">&quot;mau:202411&quot;</span>, dailyKeys);</span><br><span class="line">        <span class="type">long</span> <span class="variable">mau</span> <span class="operator">=</span> jedis.pfcount(<span class="string">&quot;mau:202411&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;11æœˆMAU: &quot;</span> + mau);  <span class="comment">// çº¦100</span></span><br><span class="line">        </span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å®æˆ˜æ¡ˆä¾‹ï¼šå¤§å‹ç½‘ç«™UVç»Ÿè®¡ç³»ç»Ÿ"><a href="#å®æˆ˜æ¡ˆä¾‹ï¼šå¤§å‹ç½‘ç«™UVç»Ÿè®¡ç³»ç»Ÿ" class="headerlink" title="å®æˆ˜æ¡ˆä¾‹ï¼šå¤§å‹ç½‘ç«™UVç»Ÿè®¡ç³»ç»Ÿ"></a>å®æˆ˜æ¡ˆä¾‹ï¼šå¤§å‹ç½‘ç«™UVç»Ÿè®¡ç³»ç»Ÿ</h4><p><strong>éœ€æ±‚</strong>ï¼šç»Ÿè®¡æ—¥UVã€å‘¨UVã€æœˆUVï¼Œæ•°æ®é‡ï¼šæ—¥å‡5000ä¸‡UV</p><p><strong>æ–¹æ¡ˆå¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>å†…å­˜å ç”¨</th><th>æˆæœ¬ï¼ˆæ¯æœˆï¼‰</th><th>ç²¾ç¡®åº¦</th></tr></thead><tbody><tr><td>Redis Set</td><td>400MB Ã— 30å¤© &#x3D; 12GB</td><td>é«˜</td><td>100%</td></tr><tr><td>HyperLogLog</td><td>12KB Ã— 30å¤© &#x3D; 360KB</td><td>æä½</td><td>99.19%</td></tr></tbody></table><p><strong>å®ç°æ¶æ„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·è®¿é—®</span><br><span class="line">    â†“</span><br><span class="line">WebæœåŠ¡å™¨</span><br><span class="line">    â†“</span><br><span class="line">PFADD uv:20241114 user_id_123</span><br><span class="line">    â†“</span><br><span class="line">Redis HyperLogLog</span><br><span class="line">    â†“</span><br><span class="line">å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å°æ—¶/æ¯å¤©ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">PFMERGEè®¡ç®—å‘¨UVã€æœˆUV</span><br><span class="line">    â†“</span><br><span class="line">æ•°æ®å¯è§†åŒ–å¤§å±</span><br></pre></td></tr></table></figure><p><strong>ä»£ç å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UVç»Ÿè®¡æœåŠ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UVStatService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Jedis jedis;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è®°å½•ç”¨æˆ·è®¿é—®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recordVisit</span><span class="params">(String userId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">today</span> <span class="operator">=</span> LocalDate.now().format(DateTimeFormatter.BASIC_ISO_DATE);</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;uv:&quot;</span> + today;</span><br><span class="line">        jedis.pfadd(key, userId);</span><br><span class="line">        <span class="comment">// è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆä¿ç•™90å¤©ï¼‰</span></span><br><span class="line">        jedis.expire(key, <span class="number">90</span> * <span class="number">24</span> * <span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–ä»Šæ—¥UV</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getTodayUV</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">today</span> <span class="operator">=</span> LocalDate.now().format(DateTimeFormatter.BASIC_ISO_DATE);</span><br><span class="line">        <span class="keyword">return</span> jedis.pfcount(<span class="string">&quot;uv:&quot;</span> + today);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–æœ¬å‘¨UV</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getWeekUV</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; keys = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">date</span> <span class="operator">=</span> LocalDate.now().minusDays(i)</span><br><span class="line">                .format(DateTimeFormatter.BASIC_ISO_DATE);</span><br><span class="line">            keys.add(<span class="string">&quot;uv:&quot;</span> + date);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> jedis.pfcount(keys.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">0</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–æœ¬æœˆUV</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getMonthUV</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">monthKey</span> <span class="operator">=</span> <span class="string">&quot;uv:month:&quot;</span> + LocalDate.now().format(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyyMM&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ˜¯å¦å·²è®¡ç®—</span></span><br><span class="line">        <span class="keyword">if</span> (!jedis.exists(monthKey)) &#123;</span><br><span class="line">            <span class="comment">// åˆå¹¶æœ¬æœˆæ‰€æœ‰å¤©çš„æ•°æ®</span></span><br><span class="line">            List&lt;String&gt; keys = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="type">LocalDate</span> <span class="variable">firstDay</span> <span class="operator">=</span> LocalDate.now().withDayOfMonth(<span class="number">1</span>);</span><br><span class="line">            <span class="type">LocalDate</span> <span class="variable">today</span> <span class="operator">=</span> LocalDate.now();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (<span class="type">LocalDate</span> <span class="variable">date</span> <span class="operator">=</span> firstDay; !date.isAfter(today); date = date.plusDays(<span class="number">1</span>)) &#123;</span><br><span class="line">                keys.add(<span class="string">&quot;uv:&quot;</span> + date.format(DateTimeFormatter.BASIC_ISO_DATE));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!keys.isEmpty()) &#123;</span><br><span class="line">                jedis.pfmerge(monthKey, keys.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">0</span>]));</span><br><span class="line">                jedis.expire(monthKey, <span class="number">90</span> * <span class="number">24</span> * <span class="number">3600</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> jedis.pfcount(monthKey);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½æµ‹è¯•ç»“æœ</strong>ï¼š</p><table><thead><tr><th>æŒ‡æ ‡</th><th>æ•°å€¼</th></tr></thead><tbody><tr><td>æ—¥å‡è®¿é—®é‡</td><td>5000ä¸‡</td></tr><tr><td>æ¯æ—¥å†…å­˜å ç”¨</td><td>12KB</td></tr><tr><td>æ¯æœˆå†…å­˜å ç”¨</td><td>360KB</td></tr><tr><td>æŸ¥è¯¢å“åº”æ—¶é—´</td><td>&lt; 1ms</td></tr><tr><td>ç»Ÿè®¡è¯¯å·®</td><td>&lt; 0.81%</td></tr><tr><td>æˆæœ¬èŠ‚çœ</td><td>99.99%</td></tr></tbody></table><h3 id="6-3-GEOï¼ˆåœ°ç†ä½ç½®ï¼‰"><a href="#6-3-GEOï¼ˆåœ°ç†ä½ç½®ï¼‰" class="headerlink" title="6.3 GEOï¼ˆåœ°ç†ä½ç½®ï¼‰"></a>6.3 GEOï¼ˆåœ°ç†ä½ç½®ï¼‰</h3><h4 id="ä»€ä¹ˆæ˜¯GEO"><a href="#ä»€ä¹ˆæ˜¯GEO" class="headerlink" title="ä»€ä¹ˆæ˜¯GEO"></a>ä»€ä¹ˆæ˜¯GEO</h4><p><strong>GEOï¼ˆGeographicï¼‰</strong> æ˜¯Redis 3.2ç‰ˆæœ¬æ–°å¢çš„åœ°ç†ä½ç½®æ•°æ®ç±»å‹ï¼Œç”¨äºå­˜å‚¨å’ŒæŸ¥è¯¢åœ°ç†ç©ºé—´ä¿¡æ¯ã€‚</p><p><strong>æ ¸å¿ƒæ¦‚å¿µ</strong>ï¼š</p><ul><li>GEO &#x3D; <strong>Geographic</strong>ï¼ˆåœ°ç†ä¿¡æ¯ï¼‰çš„ç¼©å†™</li><li>å­˜å‚¨å…ƒç´ çš„<strong>äºŒç»´åæ ‡</strong>ï¼ˆç»åº¦longitudeã€çº¬åº¦latitudeï¼‰</li><li>åœ¨åœ°å›¾ä¸Šè¡¨ç°ä¸º<strong>ç»çº¬åº¦åæ ‡</strong></li><li>åŸºäº<strong>æœ‰åºé›†åˆï¼ˆZSetï¼‰</strong> å®ç°</li></ul><p><strong>åŠŸèƒ½ç‰¹æ€§</strong>ï¼š</p><ul><li>âœ… ç»çº¬åº¦è®¾ç½®</li><li>âœ… åæ ‡æŸ¥è¯¢</li><li>âœ… èŒƒå›´æŸ¥è¯¢ï¼ˆåŠå¾„å†…å…ƒç´ ï¼‰</li><li>âœ… è·ç¦»è®¡ç®—</li><li>âœ… ç»çº¬åº¦Hashï¼ˆGeoHashç¼–ç ï¼‰</li></ul><p><strong>åº•å±‚å®ç°</strong>ï¼š</p><ul><li>GEOæœ¬è´¨ä¸Šæ˜¯<strong>ZSetï¼ˆæœ‰åºé›†åˆï¼‰</strong></li><li>ä½¿ç”¨<strong>GeoHashç®—æ³•</strong>å°†ç»çº¬åº¦ç¼–ç ä¸º52ä½æ•´æ•°ä½œä¸ºscore</li><li>å¯ä»¥ä½¿ç”¨ZSetçš„å‘½ä»¤æ“ä½œGEOæ•°æ®ï¼ˆå¦‚ZREMåˆ é™¤ï¼‰</li></ul><h4 id="GEOåæ ‡ç³»ç»Ÿè¯´æ˜"><a href="#GEOåæ ‡ç³»ç»Ÿè¯´æ˜" class="headerlink" title="GEOåæ ‡ç³»ç»Ÿè¯´æ˜"></a>GEOåæ ‡ç³»ç»Ÿè¯´æ˜</h4><p><strong>åœ°çƒåæ ‡èŒƒå›´</strong>ï¼š</p><table><thead><tr><th>ç»´åº¦</th><th>æœ€å°å€¼</th><th>æœ€å¤§å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç»åº¦</strong>ï¼ˆLongitudeï¼‰</td><td>-180Â°</td><td>+180Â°</td><td>ä¸œç»ä¸ºæ­£ï¼Œè¥¿ç»ä¸ºè´Ÿ</td></tr><tr><td><strong>çº¬åº¦</strong>ï¼ˆLatitudeï¼‰</td><td>-85.05112878Â°</td><td>+85.05112878Â°</td><td>åŒ—çº¬ä¸ºæ­£ï¼Œå—çº¬ä¸ºè´Ÿ</td></tr></tbody></table><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ <strong>ä¸¤ææ— æ³•ç›´æ¥æ·»åŠ </strong>ï¼ˆçº¬åº¦Â±85.05112878Â°ä»¥å¤–ï¼‰</li><li>âš ï¸ åæ ‡è¶…å‡ºèŒƒå›´ä¼šè¿”å›é”™è¯¯</li><li>âš ï¸ å·²æ·»åŠ çš„æ•°æ®æ— æ³•å†æ¬¡æ·»åŠ ï¼ˆä¼šè¢«å¿½ç•¥ï¼‰</li></ul><p><strong>å¸¸è§åŸå¸‚åæ ‡å‚è€ƒ</strong>ï¼š</p><table><thead><tr><th>åŸå¸‚</th><th>ç»åº¦</th><th>çº¬åº¦</th></tr></thead><tbody><tr><td>åŒ—äº¬</td><td>116.38</td><td>39.90</td></tr><tr><td>ä¸Šæµ·</td><td>121.47</td><td>31.23</td></tr><tr><td>æ·±åœ³</td><td>114.05</td><td>22.52</td></tr><tr><td>é‡åº†</td><td>106.50</td><td>29.53</td></tr><tr><td>å¹¿å·</td><td>113.26</td><td>23.13</td></tr></tbody></table><h4 id="GEOå¸¸ç”¨å‘½ä»¤"><a href="#GEOå¸¸ç”¨å‘½ä»¤" class="headerlink" title="GEOå¸¸ç”¨å‘½ä»¤"></a>GEOå¸¸ç”¨å‘½ä»¤</h4><h5 id="1-GEOADD-æ·»åŠ åœ°ç†ä½ç½®"><a href="#1-GEOADD-æ·»åŠ åœ°ç†ä½ç½®" class="headerlink" title="1. GEOADD - æ·»åŠ åœ°ç†ä½ç½®"></a>1. GEOADD - æ·»åŠ åœ°ç†ä½ç½®</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOADD key longitude latitude member [longitude latitude member ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>å¿…éœ€</th></tr></thead><tbody><tr><td><code>key</code></td><td>GEOé›†åˆé”®å</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr><tr><td><code>longitude</code></td><td>ç»åº¦</td><td>æµ®ç‚¹æ•°</td><td>âœ…</td></tr><tr><td><code>latitude</code></td><td>çº¬åº¦</td><td>æµ®ç‚¹æ•°</td><td>âœ…</td></tr><tr><td><code>member</code></td><td>ä½ç½®åç§°</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šæˆåŠŸæ·»åŠ çš„ä½ç½®æ•°é‡ï¼ˆæ•´æ•°ï¼‰</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ å•ä¸ªåŸå¸‚</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD china:city 121.47 31.23 shanghai</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¹é‡æ·»åŠ å¤šä¸ªåŸå¸‚</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD china:city 106.50 29.53 chongqing 114.05 22.52 shenzhen 116.38 39.90 beijing</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ›´å¤šåŸå¸‚</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD china:city 113.26 23.13 guangzhou 120.16 30.29 hangzhou</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ é‡è¦æç¤º</strong>ï¼š</p><ol><li><p><strong>ä¸¤ææ— æ³•æ·»åŠ </strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°è¯•æ·»åŠ åŒ—æç‚¹ï¼ˆä¼šå¤±è´¥ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD locations 0 90 north_pole</span><br><span class="line">(error) ERR invalid longitude,latitude pair 0.000000,90.000000</span><br></pre></td></tr></table></figure></li><li><p><strong>åæ ‡èŒƒå›´é™åˆ¶</strong>ï¼š</p><ul><li>ç»åº¦ï¼š-180Â° ~ +180Â°</li><li>çº¬åº¦ï¼š-85.05112878Â° ~ +85.05112878Â°</li></ul></li><li><p><strong>é‡å¤æ·»åŠ å¤„ç†</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–æ¬¡æ·»åŠ </span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD china:city 121.47 31.23 shanghai</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡æ·»åŠ ç›¸åŒåŸå¸‚ï¼ˆè¿”å›0ï¼Œä¸ä¼šé‡å¤æ·»åŠ ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD china:city 121.47 31.23 shanghai</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure></li><li><p><strong>æ‰¹é‡å¯¼å…¥å»ºè®®</strong>ï¼š</p><ul><li>å¯¹äºå¤§é‡åŸå¸‚æ•°æ®ï¼ˆå¦‚å…¨å›½æ•°æ®ï¼‰</li><li>å»ºè®®ä¸‹è½½åŸå¸‚æ•°æ®æ–‡ä»¶</li><li>é€šè¿‡Java&#x2F;Pythonç¨‹åºä¸€æ¬¡æ€§æ‰¹é‡å¯¼å…¥</li><li>é¿å…æ‰‹åŠ¨é€ä¸ªæ·»åŠ </li></ul></li></ol><h5 id="2-GEOPOS-è·å–åæ ‡"><a href="#2-GEOPOS-è·å–åæ ‡" class="headerlink" title="2. GEOPOS - è·å–åæ ‡"></a>2. GEOPOS - è·å–åæ ‡</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOPOS key member [member ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>å¿…éœ€</th></tr></thead><tbody><tr><td><code>key</code></td><td>GEOé›†åˆé”®å</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr><tr><td><code>member</code></td><td>ä½ç½®åç§°</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šç»çº¬åº¦æ•°ç»„ï¼Œæ ¼å¼ä¸º <code>[[ç»åº¦, çº¬åº¦], [ç»åº¦, çº¬åº¦], ...]</code></p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢å•ä¸ªåŸå¸‚åæ ‡</span></span><br><span class="line">127.0.0.1:6379&gt; GEOPOS china:city shanghai</span><br><span class="line">1) 1) <span class="string">&quot;121.47000163793563843&quot;</span></span><br><span class="line">   2) <span class="string">&quot;31.22999903975783553&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å¤šä¸ªåŸå¸‚åæ ‡</span></span><br><span class="line">127.0.0.1:6379&gt; GEOPOS china:city beijing shanghai shenzhen</span><br><span class="line">1) 1) <span class="string">&quot;116.37999743223190308&quot;</span></span><br><span class="line">   2) <span class="string">&quot;39.90000009167092543&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;121.47000163793563843&quot;</span></span><br><span class="line">   2) <span class="string">&quot;31.22999903975783553&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;114.04999762773513794&quot;</span></span><br><span class="line">   2) <span class="string">&quot;22.51999957959539794&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ä¸å­˜åœ¨çš„åŸå¸‚ï¼ˆè¿”å›nilï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEOPOS china:city nanjing</span><br><span class="line">1) (nil)</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><ul><li>è¿”å›çš„åæ ‡å¯èƒ½ä¸è¾“å…¥æ—¶æœ‰ç»†å¾®å·®å¼‚ï¼ˆç²¾åº¦æŸå¤±ï¼‰</li><li>ä¸å­˜åœ¨çš„memberè¿”å›<code>(nil)</code></li></ul><h5 id="3-GEODIST-è®¡ç®—è·ç¦»"><a href="#3-GEODIST-è®¡ç®—è·ç¦»" class="headerlink" title="3. GEODIST - è®¡ç®—è·ç¦»"></a>3. GEODIST - è®¡ç®—è·ç¦»</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEODIST key member1 member2 [unit]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>key</code></td><td>GEOé›†åˆé”®å</td><td>å­—ç¬¦ä¸²</td><td>-</td></tr><tr><td><code>member1</code></td><td>ç¬¬ä¸€ä¸ªä½ç½®</td><td>å­—ç¬¦ä¸²</td><td>-</td></tr><tr><td><code>member2</code></td><td>ç¬¬äºŒä¸ªä½ç½®</td><td>å­—ç¬¦ä¸²</td><td>-</td></tr><tr><td><code>unit</code></td><td>è·ç¦»å•ä½</td><td>m&#x2F;km&#x2F;mi&#x2F;ft</td><td>mï¼ˆç±³ï¼‰</td></tr></tbody></table><p><strong>è·ç¦»å•ä½</strong>ï¼š</p><table><thead><tr><th>å•ä½</th><th>è¯´æ˜</th><th>æ¢ç®—</th></tr></thead><tbody><tr><td><code>m</code></td><td>ç±³ï¼ˆmeterï¼‰</td><td>é»˜è®¤å•ä½</td></tr><tr><td><code>km</code></td><td>åƒç±³&#x2F;å…¬é‡Œï¼ˆkilometerï¼‰</td><td>1km &#x3D; 1000m</td></tr><tr><td><code>mi</code></td><td>è‹±é‡Œï¼ˆmileï¼‰</td><td>1mi â‰ˆ 1.609km</td></tr><tr><td><code>ft</code></td><td>è‹±å°ºï¼ˆfootï¼‰</td><td>1ft â‰ˆ 0.3048m</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šä¸¤åœ°ä¹‹é—´çš„<strong>ç›´çº¿è·ç¦»</strong>ï¼ˆæµ®ç‚¹æ•°ï¼‰ï¼Œå¦‚æœä»»ä¸€ä½ç½®ä¸å­˜åœ¨åˆ™è¿”å›<code>(nil)</code></p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—åŒ—äº¬åˆ°ä¸Šæµ·çš„è·ç¦»ï¼ˆé»˜è®¤ç±³ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST china:city beijing shanghai</span><br><span class="line"><span class="string">&quot;1067597.9668&quot;</span>    <span class="comment"># çº¦1068å…¬é‡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—åŒ—äº¬åˆ°ä¸Šæµ·çš„è·ç¦»ï¼ˆåƒç±³ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST china:city beijing shanghai km</span><br><span class="line"><span class="string">&quot;1067.5980&quot;</span>       <span class="comment"># 1067.6å…¬é‡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ·±åœ³åˆ°å¹¿å·çš„è·ç¦»ï¼ˆåƒç±³ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST china:city shenzhen guangzhou km</span><br><span class="line"><span class="string">&quot;104.6034&quot;</span>        <span class="comment"># çº¦105å…¬é‡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ä¸å­˜åœ¨çš„åŸå¸‚ï¼ˆè¿”å›nilï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST china:city beijing nanjing</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><ul><li>è®¡ç®—çš„æ˜¯<strong>ç›´çº¿è·ç¦»</strong>ï¼ˆå¤§åœ†è·ç¦»ï¼‰ï¼Œä¸æ˜¯å®é™…é“è·¯è·ç¦»</li><li>ç»“æœç²¾åº¦è¾ƒé«˜ï¼Œé€‚åˆå¤§å¤šæ•°åº”ç”¨åœºæ™¯</li></ul><h5 id="4-GEORADIUS-åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åæ ‡ï¼‰"><a href="#4-GEORADIUS-åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åæ ‡ï¼‰" class="headerlink" title="4. GEORADIUS - åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åæ ‡ï¼‰"></a>4. GEORADIUS - åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰åæ ‡ï¼‰</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEORADIUS key longitude latitude radius unit [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>å¿…éœ€</th></tr></thead><tbody><tr><td><code>key</code></td><td>GEOé›†åˆé”®å</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr><tr><td><code>longitude</code></td><td>ä¸­å¿ƒç‚¹ç»åº¦</td><td>æµ®ç‚¹æ•°</td><td>âœ…</td></tr><tr><td><code>latitude</code></td><td>ä¸­å¿ƒç‚¹çº¬åº¦</td><td>æµ®ç‚¹æ•°</td><td>âœ…</td></tr><tr><td><code>radius</code></td><td>åŠå¾„</td><td>æ•°å­—</td><td>âœ…</td></tr><tr><td><code>unit</code></td><td>è·ç¦»å•ä½</td><td>m&#x2F;km&#x2F;mi&#x2F;ft</td><td>âœ…</td></tr></tbody></table><p><strong>å¯é€‰å‚æ•°</strong>ï¼š</p><table><thead><tr><th>å¯é€‰å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>WITHCOORD</code></td><td>è¿”å›ä½ç½®çš„ç»çº¬åº¦</td></tr><tr><td><code>WITHDIST</code></td><td>è¿”å›ä½ç½®ä¸ä¸­å¿ƒç‚¹çš„è·ç¦»</td></tr><tr><td><code>WITHHASH</code></td><td>è¿”å›ä½ç½®çš„GeoHashå€¼</td></tr><tr><td><code>COUNT count</code></td><td>é™åˆ¶è¿”å›ç»“æœæ•°é‡</td></tr><tr><td><code>ASC</code></td><td>æŒ‰è·ç¦»ä»è¿‘åˆ°è¿œæ’åº</td></tr><tr><td><code>DESC</code></td><td>æŒ‰è·ç¦»ä»è¿œåˆ°è¿‘æ’åº</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šç¬¦åˆæ¡ä»¶çš„ä½ç½®åˆ—è¡¨</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢ä»¥æŒ‡å®šç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ1000å…¬é‡ŒèŒƒå›´å†…çš„åŸå¸‚</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUS china:city 110 30 1000 km</span><br><span class="line">1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">2) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">3) <span class="string">&quot;guangzhou&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å¹¶è¿”å›è·ç¦»ï¼ˆæŒ‰è·ç¦»å‡åºï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUS china:city 110 30 1000 km WITHDIST ASC</span><br><span class="line">1) 1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">   2) <span class="string">&quot;341.9374&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;guangzhou&quot;</span></span><br><span class="line">   2) <span class="string">&quot;810.0662&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">   2) <span class="string">&quot;914.4949&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å¹¶è¿”å›åæ ‡å’Œè·ç¦»ï¼Œé™åˆ¶3ä¸ªç»“æœ</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUS china:city 110 30 1500 km WITHCOORD WITHDIST COUNT 3 ASC</span><br><span class="line">1) 1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">   2) <span class="string">&quot;341.9374&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;106.49999767541885376&quot;</span></span><br><span class="line">      2) <span class="string">&quot;29.52999957900659211&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;guangzhou&quot;</span></span><br><span class="line">   2) <span class="string">&quot;810.0662&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;113.25999975204467773&quot;</span></span><br><span class="line">      2) <span class="string">&quot;23.12999968251882199&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">   2) <span class="string">&quot;914.4949&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;114.04999762773513794&quot;</span></span><br><span class="line">      2) <span class="string">&quot;22.51999957959539794&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å¹¶è¿”å›GeoHash</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUS china:city 110 30 1000 km WITHHASH</span><br><span class="line">1) 1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">   2) (<span class="built_in">integer</span>) 4026042091628149</span><br><span class="line">2) 1) <span class="string">&quot;guangzhou&quot;</span></span><br><span class="line">   2) (<span class="built_in">integer</span>) 4046433733682118</span><br><span class="line">3) 1) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">   2) (<span class="built_in">integer</span>) 4046432193082709</span><br></pre></td></tr></table></figure><h5 id="5-GEORADIUSBYMEMBER-åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰æˆå‘˜ï¼‰"><a href="#5-GEORADIUSBYMEMBER-åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰æˆå‘˜ï¼‰" class="headerlink" title="5. GEORADIUSBYMEMBER - åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰æˆå‘˜ï¼‰"></a>5. GEORADIUSBYMEMBER - åŠå¾„èŒƒå›´æŸ¥è¯¢ï¼ˆæŒ‰æˆå‘˜ï¼‰</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEORADIUSBYMEMBER key member radius unit [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>å¿…éœ€</th></tr></thead><tbody><tr><td><code>key</code></td><td>GEOé›†åˆé”®å</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr><tr><td><code>member</code></td><td>ä¸­å¿ƒä½ç½®åç§°</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr><tr><td><code>radius</code></td><td>åŠå¾„</td><td>æ•°å­—</td><td>âœ…</td></tr><tr><td><code>unit</code></td><td>è·ç¦»å•ä½</td><td>m&#x2F;km&#x2F;mi&#x2F;ft</td><td>âœ…</td></tr></tbody></table><p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼šä¸<code>GEORADIUS</code>ç±»ä¼¼ï¼Œä½†ä½¿ç”¨å·²å­˜åœ¨çš„æˆå‘˜ä½œä¸ºä¸­å¿ƒç‚¹ï¼Œè€Œä¸æ˜¯æŒ‡å®šç»çº¬åº¦ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢ä»¥åŒ—äº¬ä¸ºä¸­å¿ƒï¼Œ1500å…¬é‡ŒèŒƒå›´å†…çš„åŸå¸‚</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city beijing 1500 km</span><br><span class="line">1) <span class="string">&quot;beijing&quot;</span></span><br><span class="line">2) <span class="string">&quot;shanghai&quot;</span></span><br><span class="line">3) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ä»¥ä¸Šæµ·ä¸ºä¸­å¿ƒï¼Œ500å…¬é‡ŒèŒƒå›´å†…çš„åŸå¸‚ï¼Œè¿”å›è·ç¦»</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city shanghai 500 km WITHDIST ASC</span><br><span class="line">1) 1) <span class="string">&quot;shanghai&quot;</span></span><br><span class="line">   2) <span class="string">&quot;0.0000&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">   2) <span class="string">&quot;166.6359&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ä»¥æ·±åœ³ä¸ºä¸­å¿ƒï¼Œ200å…¬é‡ŒèŒƒå›´å†…çš„åŸå¸‚ï¼Œè¿”å›åæ ‡å’Œè·ç¦»</span></span><br><span class="line">127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city shenzhen 200 km WITHCOORD WITHDIST</span><br><span class="line">1) 1) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">   2) <span class="string">&quot;0.0000&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;114.04999762773513794&quot;</span></span><br><span class="line">      2) <span class="string">&quot;22.51999957959539794&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;guangzhou&quot;</span></span><br><span class="line">   2) <span class="string">&quot;104.6034&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;113.25999975204467773&quot;</span></span><br><span class="line">      2) <span class="string">&quot;23.12999968251882199&quot;</span></span><br></pre></td></tr></table></figure><h5 id="6-GEOHASH-è·å–GeoHashå€¼"><a href="#6-GEOHASH-è·å–GeoHashå€¼" class="headerlink" title="6. GEOHASH - è·å–GeoHashå€¼"></a>6. GEOHASH - è·å–GeoHashå€¼</h5><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOHASH key member [member ...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>å¿…éœ€</th></tr></thead><tbody><tr><td><code>key</code></td><td>GEOé›†åˆé”®å</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr><tr><td><code>member</code></td><td>ä½ç½®åç§°</td><td>å­—ç¬¦ä¸²</td><td>âœ…</td></tr></tbody></table><p><strong>è¿”å›å€¼</strong>ï¼šGeoHashå­—ç¬¦ä¸²ï¼ˆ11ä½Base32ç¼–ç ï¼‰</p><p><strong>GeoHashè¯´æ˜</strong>ï¼š</p><ul><li>GeoHashæ˜¯ä¸€ç§åœ°ç†ä½ç½®ç¼–ç ç®—æ³•</li><li>å°†äºŒç»´ç»çº¬åº¦è½¬æ¢ä¸ºä¸€ç»´å­—ç¬¦ä¸²</li><li>å­—ç¬¦ä¸²è¶Šé•¿ï¼Œç²¾åº¦è¶Šé«˜</li><li>å‰ç¼€ç›¸åŒçš„GeoHashè¡¨ç¤ºä½ç½®æ¥è¿‘</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å•ä¸ªåŸå¸‚çš„GeoHash</span></span><br><span class="line">127.0.0.1:6379&gt; GEOHASH china:city beijing</span><br><span class="line">1) <span class="string">&quot;wx4g0b7xrt0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å¤šä¸ªåŸå¸‚çš„GeoHash</span></span><br><span class="line">127.0.0.1:6379&gt; GEOHASH china:city beijing shanghai shenzhen</span><br><span class="line">1) <span class="string">&quot;wx4g0b7xrt0&quot;</span></span><br><span class="line">2) <span class="string">&quot;wtw3sj5zbj0&quot;</span></span><br><span class="line">3) <span class="string">&quot;ws10578st80&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†æGeoHashï¼ˆå‰ç¼€ç›¸åŒè¡¨ç¤ºä½ç½®æ¥è¿‘ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GEOHASH china:city shenzhen guangzhou</span><br><span class="line">1) <span class="string">&quot;ws10578st80&quot;</span></span><br><span class="line">2) <span class="string">&quot;ws0e9cb3v60&quot;</span></span><br><span class="line"><span class="comment"># æ·±åœ³å’Œå¹¿å·çš„GeoHashéƒ½ä»¥&quot;ws&quot;å¼€å¤´ï¼Œè¡¨ç¤ºä½ç½®è¾ƒè¿‘</span></span><br></pre></td></tr></table></figure><h4 id="åº”ç”¨åœºæ™¯-1"><a href="#åº”ç”¨åœºæ™¯-1" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h4><h5 id="1-é™„è¿‘çš„äºº-åº—é“º-è®¾æ–½"><a href="#1-é™„è¿‘çš„äºº-åº—é“º-è®¾æ–½" class="headerlink" title="1. é™„è¿‘çš„äºº&#x2F;åº—é“º&#x2F;è®¾æ–½"></a>1. é™„è¿‘çš„äºº&#x2F;åº—é“º&#x2F;è®¾æ–½</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šæŸ¥æ‰¾æˆ‘é™„è¿‘1å…¬é‡Œå†…çš„é¤å…</span></span><br><span class="line"><span class="comment"># å‡è®¾æˆ‘çš„ä½ç½®ï¼šç»åº¦113.93ï¼Œçº¬åº¦22.54</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢é™„è¿‘çš„é¤å…</span></span><br><span class="line">GEORADIUS restaurants 113.93 22.54 1 km WITHDIST ASC</span><br></pre></td></tr></table></figure><h5 id="2-å¤–å–é…é€èŒƒå›´"><a href="#2-å¤–å–é…é€èŒƒå›´" class="headerlink" title="2. å¤–å–é…é€èŒƒå›´"></a>2. å¤–å–é…é€èŒƒå›´</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šæŸ¥æ‰¾æŸé¤å…3å…¬é‡Œé…é€èŒƒå›´å†…çš„ç”¨æˆ·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ é¤å…ä½ç½®</span></span><br><span class="line">GEOADD restaurants 113.93 22.54 <span class="string">&quot;éº¦å½“åŠ³Â·æ·±åœ³åº—&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢é…é€èŒƒå›´å†…çš„ç”¨æˆ·</span></span><br><span class="line">GEORADIUSBYMEMBER restaurants <span class="string">&quot;éº¦å½“åŠ³Â·æ·±åœ³åº—&quot;</span> 3 km</span><br></pre></td></tr></table></figure><h5 id="3-æ‰“è½¦è·ç¦»è®¡ç®—"><a href="#3-æ‰“è½¦è·ç¦»è®¡ç®—" class="headerlink" title="3. æ‰“è½¦è·ç¦»è®¡ç®—"></a>3. æ‰“è½¦è·ç¦»è®¡ç®—</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šè®¡ç®—ä¹˜å®¢å’Œå¸æœºä¹‹é—´çš„è·ç¦»</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ä½ç½®</span></span><br><span class="line">GEOADD taxi:locations 113.93 22.54 passenger123</span><br><span class="line">GEOADD taxi:locations 113.95 22.56 driver456</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—è·ç¦»</span></span><br><span class="line">GEODIST taxi:locations passenger123 driver456 km</span><br></pre></td></tr></table></figure><h5 id="4-å…±äº«å•è½¦åˆ†å¸ƒ"><a href="#4-å…±äº«å•è½¦åˆ†å¸ƒ" class="headerlink" title="4. å…±äº«å•è½¦åˆ†å¸ƒ"></a>4. å…±äº«å•è½¦åˆ†å¸ƒ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šæŸ¥æ‰¾é™„è¿‘500ç±³å†…çš„å…±äº«å•è½¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å•è½¦ä½ç½®</span></span><br><span class="line">GEOADD bikes 113.93 22.54 bike001</span><br><span class="line">GEOADD bikes 113.94 22.55 bike002</span><br><span class="line">GEOADD bikes 113.92 22.53 bike003</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢é™„è¿‘çš„å•è½¦</span></span><br><span class="line">GEORADIUS bikes 113.93 22.54 0.5 km WITHDIST</span><br></pre></td></tr></table></figure><h5 id="5-ç‰©æµé…é€ä¼˜åŒ–"><a href="#5-ç‰©æµé…é€ä¼˜åŒ–" class="headerlink" title="5. ç‰©æµé…é€ä¼˜åŒ–"></a>5. ç‰©æµé…é€ä¼˜åŒ–</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šæŸ¥æ‰¾è·ç¦»é…é€ä¸­å¿ƒæœ€è¿‘çš„10ä¸ªè®¢å•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ è®¢å•ä½ç½®</span></span><br><span class="line">GEOADD orders 113.93 22.54 order001</span><br><span class="line">GEOADD orders 113.95 22.56 order002</span><br><span class="line"><span class="comment"># ... æ›´å¤šè®¢å•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢æœ€è¿‘çš„10ä¸ªè®¢å•</span></span><br><span class="line">GEORADIUSBYMEMBER orders warehouse001 50 km COUNT 10 ASC</span><br></pre></td></tr></table></figure><h4 id="GEOåº•å±‚åŸç†"><a href="#GEOåº•å±‚åŸç†" class="headerlink" title="GEOåº•å±‚åŸç†"></a>GEOåº•å±‚åŸç†</h4><p><strong>æ•°æ®ç»“æ„</strong>ï¼š</p><ul><li>GEOåº•å±‚ä½¿ç”¨<strong>ZSetï¼ˆæœ‰åºé›†åˆï¼‰</strong> å­˜å‚¨</li><li>ä½¿ç”¨<strong>GeoHashç®—æ³•</strong>å°†ç»çº¬åº¦ç¼–ç ä¸º52ä½æ•´æ•°</li><li>æ•´æ•°ä½œä¸ºZSetçš„scoreï¼Œä½ç½®åç§°ä½œä¸ºmember</li></ul><p><strong>GeoHashç¼–ç è¿‡ç¨‹</strong>ï¼š</p><ol><li><strong>äº¤å‰ç¼–ç </strong>ï¼šå°†ç»åº¦å’Œçº¬åº¦çš„äºŒè¿›åˆ¶äº¤å‰ç»„åˆ</li><li><strong>Base32ç¼–ç </strong>ï¼šå°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºBase32å­—ç¬¦ä¸²</li><li><strong>ç²¾åº¦æ§åˆ¶</strong>ï¼šå­—ç¬¦ä¸²è¶Šé•¿ï¼Œç²¾åº¦è¶Šé«˜</li></ol><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŒ—äº¬åæ ‡ï¼š(116.38, 39.90)</span><br><span class="line">â†“ GeoHashç¼–ç </span><br><span class="line">wx4g0b7xrt0</span><br></pre></td></tr></table></figure><p><strong>ç›¸äº’æ“ä½œ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GEOæ•°æ®å¯ä»¥ç”¨ZSetå‘½ä»¤æ“ä½œ</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰åŸå¸‚ï¼ˆZSETå‘½ä»¤ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; ZRANGE china:city 0 -1</span><br><span class="line">1) <span class="string">&quot;chongqing&quot;</span></span><br><span class="line">2) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">3) <span class="string">&quot;guangzhou&quot;</span></span><br><span class="line">4) <span class="string">&quot;shanghai&quot;</span></span><br><span class="line">5) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">6) <span class="string">&quot;beijing&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åŸå¸‚ï¼ˆZSETå‘½ä»¤ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; ZREM china:city hangzhou</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®é‡</span></span><br><span class="line">127.0.0.1:6379&gt; ZCARD china:city</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br></pre></td></tr></table></figure><h4 id="æ³¨æ„äº‹é¡¹-1"><a href="#æ³¨æ„äº‹é¡¹-1" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><blockquote><p><strong>âš ï¸ åæ ‡èŒƒå›´é™åˆ¶</strong>ï¼š</p><ul><li>ç»åº¦ï¼š-180Â° ~ +180Â°</li><li>çº¬åº¦ï¼š-85.05112878Â° ~ +85.05112878Â°</li><li>ä¸¤æï¼ˆÂ±90Â°çº¬åº¦ï¼‰æ— æ³•æ·»åŠ </li></ul></blockquote><blockquote><p><strong>âš ï¸ ç²¾åº¦æŸå¤±</strong>ï¼š</p><ul><li>GeoHashç®—æ³•ä¼šæœ‰ç²¾åº¦æŸå¤±</li><li>è¿”å›çš„åæ ‡å¯èƒ½ä¸è¾“å…¥ç•¥æœ‰å·®å¼‚</li><li>å¯¹äºå¤§å¤šæ•°åº”ç”¨åœºæ™¯ï¼Œç²¾åº¦è¶³å¤Ÿ</li></ul></blockquote><blockquote><p><strong>âš ï¸ è·ç¦»è®¡ç®—</strong>ï¼š</p><ul><li>è®¡ç®—çš„æ˜¯<strong>ç›´çº¿è·ç¦»</strong>ï¼ˆå¤§åœ†è·ç¦»ï¼‰</li><li>ä¸æ˜¯å®é™…é“è·¯è·ç¦»</li><li>å®é™…è·¯ç¨‹é€šå¸¸æ¯”ç›´çº¿è·ç¦»é•¿20%-50%</li></ul></blockquote><blockquote><p><strong>âš ï¸ æ€§èƒ½è€ƒè™‘</strong>ï¼š</p><ul><li><code>GEORADIUS</code>å‘½ä»¤æ—¶é—´å¤æ‚åº¦ï¼šO(N+log(M))</li><li>Næ˜¯åŠå¾„å†…çš„å…ƒç´ æ•°é‡ï¼ŒMæ˜¯æ€»å…ƒç´ æ•°é‡</li><li>å¤§èŒƒå›´æŸ¥è¯¢æˆ–æµ·é‡æ•°æ®æ—¶å¯èƒ½è¾ƒæ…¢</li><li>å»ºè®®ä½¿ç”¨<code>COUNT</code>é™åˆ¶è¿”å›æ•°é‡</li></ul></blockquote><blockquote><p><strong>âš ï¸ Redis 6.2ç‰ˆæœ¬æ›´æ–°</strong>ï¼š</p><ul><li><code>GEORADIUS</code>å’Œ<code>GEORADIUSBYMEMBER</code>åœ¨Redis 6.2ä¸­æ ‡è®°ä¸ºè¿‡æ—¶</li><li>æ¨èä½¿ç”¨æ–°å‘½ä»¤ï¼š<ul><li><code>GEOSEARCH</code>ï¼šæ›¿ä»£GEORADIUS&#x2F;GEORADIUSBYMEMBER</li><li><code>GEOSEARCHSTORE</code>ï¼šå­˜å‚¨æŸ¥è¯¢ç»“æœ</li></ul></li></ul></blockquote><h4 id="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰-3"><a href="#å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰-3" class="headerlink" title="å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"></a>å®æˆ˜ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.GeoCoordinate;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.GeoRadiusResponse;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.GeoUnit;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.params.GeoRadiusParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GeoExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;china:city&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. æ·»åŠ åŸå¸‚ä½ç½®</span></span><br><span class="line">        Map&lt;String, GeoCoordinate&gt; cities = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        cities.put(<span class="string">&quot;beijing&quot;</span>, <span class="keyword">new</span> <span class="title class_">GeoCoordinate</span>(<span class="number">116.38</span>, <span class="number">39.90</span>));</span><br><span class="line">        cities.put(<span class="string">&quot;shanghai&quot;</span>, <span class="keyword">new</span> <span class="title class_">GeoCoordinate</span>(<span class="number">121.47</span>, <span class="number">31.23</span>));</span><br><span class="line">        cities.put(<span class="string">&quot;shenzhen&quot;</span>, <span class="keyword">new</span> <span class="title class_">GeoCoordinate</span>(<span class="number">114.05</span>, <span class="number">22.52</span>));</span><br><span class="line">        cities.put(<span class="string">&quot;guangzhou&quot;</span>, <span class="keyword">new</span> <span class="title class_">GeoCoordinate</span>(<span class="number">113.26</span>, <span class="number">23.13</span>));</span><br><span class="line">        cities.put(<span class="string">&quot;chongqing&quot;</span>, <span class="keyword">new</span> <span class="title class_">GeoCoordinate</span>(<span class="number">106.50</span>, <span class="number">29.53</span>));</span><br><span class="line">        </span><br><span class="line">        jedis.geoadd(key, cities);</span><br><span class="line">        System.out.println(<span class="string">&quot;åŸå¸‚æ·»åŠ å®Œæˆ&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. è·å–åŸå¸‚åæ ‡</span></span><br><span class="line">        List&lt;GeoCoordinate&gt; coords = jedis.geopos(key, <span class="string">&quot;beijing&quot;</span>, <span class="string">&quot;shanghai&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åŒ—äº¬åæ ‡: &quot;</span> + coords.get(<span class="number">0</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šæµ·åæ ‡: &quot;</span> + coords.get(<span class="number">1</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. è®¡ç®—åŸå¸‚é—´è·ç¦»</span></span><br><span class="line">        <span class="type">Double</span> <span class="variable">distance</span> <span class="operator">=</span> jedis.geodist(key, <span class="string">&quot;beijing&quot;</span>, <span class="string">&quot;shanghai&quot;</span>, GeoUnit.KM);</span><br><span class="line">        System.out.println(<span class="string">&quot;åŒ—äº¬åˆ°ä¸Šæµ·è·ç¦»: &quot;</span> + distance + <span class="string">&quot; km&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. æŸ¥è¯¢é™„è¿‘çš„åŸå¸‚ï¼ˆä»¥æŒ‡å®šåæ ‡ä¸ºä¸­å¿ƒï¼‰</span></span><br><span class="line">        <span class="type">GeoRadiusParam</span> <span class="variable">param</span> <span class="operator">=</span> GeoRadiusParam.geoRadiusParam()</span><br><span class="line">            .withCoord()        <span class="comment">// è¿”å›åæ ‡</span></span><br><span class="line">            .withDist()         <span class="comment">// è¿”å›è·ç¦»</span></span><br><span class="line">            .sortAscending()    <span class="comment">// æŒ‰è·ç¦»å‡åº</span></span><br><span class="line">            .count(<span class="number">3</span>);          <span class="comment">// é™åˆ¶3ä¸ªç»“æœ</span></span><br><span class="line">        </span><br><span class="line">        List&lt;GeoRadiusResponse&gt; results = jedis.georadius(</span><br><span class="line">            key, <span class="number">110</span>, <span class="number">30</span>, <span class="number">1000</span>, GeoUnit.KM, param</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;\nä»¥(110, 30)ä¸ºä¸­å¿ƒï¼Œ1000kmèŒƒå›´å†…çš„åŸå¸‚ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (GeoRadiusResponse result : results) &#123;</span><br><span class="line">            System.out.println(String.format(</span><br><span class="line">                <span class="string">&quot;åŸå¸‚: %s, è·ç¦»: %.2f km, åæ ‡: (%.2f, %.2f)&quot;</span>,</span><br><span class="line">                result.getMemberByString(),</span><br><span class="line">                result.getDistance(),</span><br><span class="line">                result.getCoordinate().getLongitude(),</span><br><span class="line">                result.getCoordinate().getLatitude()</span><br><span class="line">            ));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5. æŸ¥è¯¢é™„è¿‘çš„åŸå¸‚ï¼ˆä»¥å·²æœ‰åŸå¸‚ä¸ºä¸­å¿ƒï¼‰</span></span><br><span class="line">        List&lt;GeoRadiusResponse&gt; nearbyShanghai = jedis.georadiusByMember(</span><br><span class="line">            key, <span class="string">&quot;shanghai&quot;</span>, <span class="number">500</span>, GeoUnit.KM, param</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;\nä»¥ä¸Šæµ·ä¸ºä¸­å¿ƒï¼Œ500kmèŒƒå›´å†…çš„åŸå¸‚ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (GeoRadiusResponse result : nearbyShanghai) &#123;</span><br><span class="line">            System.out.println(String.format(</span><br><span class="line">                <span class="string">&quot;åŸå¸‚: %s, è·ç¦»: %.2f km&quot;</span>,</span><br><span class="line">                result.getMemberByString(),</span><br><span class="line">                result.getDistance()</span><br><span class="line">            ));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 6. è·å–GeoHash</span></span><br><span class="line">        List&lt;String&gt; geoHashes = jedis.geohash(key, <span class="string">&quot;beijing&quot;</span>, <span class="string">&quot;shanghai&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\nåŒ—äº¬GeoHash: &quot;</span> + geoHashes.get(<span class="number">0</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šæµ·GeoHash: &quot;</span> + geoHashes.get(<span class="number">1</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 7. é™„è¿‘çš„äººåŠŸèƒ½å®ç°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">locationKey</span> <span class="operator">=</span> <span class="string">&quot;user:locations&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç”¨æˆ·ä¸ŠæŠ¥ä½ç½®</span></span><br><span class="line">        jedis.geoadd(locationKey, <span class="number">113.93</span>, <span class="number">22.54</span>, <span class="string">&quot;user001&quot;</span>);</span><br><span class="line">        jedis.geoadd(locationKey, <span class="number">113.95</span>, <span class="number">22.55</span>, <span class="string">&quot;user002&quot;</span>);</span><br><span class="line">        jedis.geoadd(locationKey, <span class="number">113.92</span>, <span class="number">22.53</span>, <span class="string">&quot;user003&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æŸ¥æ‰¾user001é™„è¿‘1å…¬é‡Œå†…çš„äºº</span></span><br><span class="line">        List&lt;GeoRadiusResponse&gt; nearbyUsers = jedis.georadiusByMember(</span><br><span class="line">            locationKey, <span class="string">&quot;user001&quot;</span>, <span class="number">1</span>, GeoUnit.KM,</span><br><span class="line">            GeoRadiusParam.geoRadiusParam().withDist().sortAscending()</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;\nuser001é™„è¿‘1kmå†…çš„ç”¨æˆ·ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (GeoRadiusResponse user : nearbyUsers) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!user.getMemberByString().equals(<span class="string">&quot;user001&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(String.format(</span><br><span class="line">                    <span class="string">&quot;ç”¨æˆ·: %s, è·ç¦»: %.2f km&quot;</span>,</span><br><span class="line">                    user.getMemberByString(),</span><br><span class="line">                    user.getDistance()</span><br><span class="line">                ));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å®æˆ˜æ¡ˆä¾‹ï¼šå¤–å–é…é€ç³»ç»Ÿ"><a href="#å®æˆ˜æ¡ˆä¾‹ï¼šå¤–å–é…é€ç³»ç»Ÿ" class="headerlink" title="å®æˆ˜æ¡ˆä¾‹ï¼šå¤–å–é…é€ç³»ç»Ÿ"></a>å®æˆ˜æ¡ˆä¾‹ï¼šå¤–å–é…é€ç³»ç»Ÿ</h4><p><strong>éœ€æ±‚</strong>ï¼šå®ç°å¤–å–å¹³å°çš„é…é€èŒƒå›´æŸ¥è¯¢å’Œéª‘æ‰‹åˆ†é…</p><p><strong>ç³»ç»Ÿè®¾è®¡</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·ä¸‹å•</span><br><span class="line">    â†“</span><br><span class="line">æŸ¥è¯¢é…é€èŒƒå›´å†…çš„é¤å…</span><br><span class="line">    â†“</span><br><span class="line">è®¡ç®—é¤å…åˆ°ç”¨æˆ·çš„è·ç¦»</span><br><span class="line">    â†“</span><br><span class="line">æŸ¥æ‰¾é™„è¿‘çš„éª‘æ‰‹</span><br><span class="line">    â†“</span><br><span class="line">åˆ†é…æœ€è¿‘çš„éª‘æ‰‹</span><br><span class="line">    â†“</span><br><span class="line">å®æ—¶æ›´æ–°éª‘æ‰‹ä½ç½®</span><br></pre></td></tr></table></figure><p><strong>ä»£ç å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeliveryService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Jedis jedis;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RESTAURANT_KEY</span> <span class="operator">=</span> <span class="string">&quot;restaurants&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RIDER_KEY</span> <span class="operator">=</span> <span class="string">&quot;riders&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ORDER_KEY</span> <span class="operator">=</span> <span class="string">&quot;orders&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. æ·»åŠ é¤å…ä½ç½®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addRestaurant</span><span class="params">(String restaurantId, <span class="type">double</span> longitude, <span class="type">double</span> latitude)</span> &#123;</span><br><span class="line">        jedis.geoadd(RESTAURANT_KEY, longitude, latitude, restaurantId);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æŸ¥æ‰¾ç”¨æˆ·é™„è¿‘çš„é¤å…ï¼ˆ5å…¬é‡Œå†…ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;RestaurantInfo&gt; <span class="title function_">findNearbyRestaurants</span><span class="params">(<span class="type">double</span> userLng, <span class="type">double</span> userLat)</span> &#123;</span><br><span class="line">        List&lt;GeoRadiusResponse&gt; results = jedis.georadius(</span><br><span class="line">            RESTAURANT_KEY, userLng, userLat, <span class="number">5</span>, GeoUnit.KM,</span><br><span class="line">            GeoRadiusParam.geoRadiusParam()</span><br><span class="line">                .withCoord()</span><br><span class="line">                .withDist()</span><br><span class="line">                .sortAscending()</span><br><span class="line">                .count(<span class="number">20</span>)</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        List&lt;RestaurantInfo&gt; restaurants = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (GeoRadiusResponse result : results) &#123;</span><br><span class="line">            <span class="type">RestaurantInfo</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestaurantInfo</span>();</span><br><span class="line">            info.setId(result.getMemberByString());</span><br><span class="line">            info.setDistance(result.getDistance());</span><br><span class="line">            info.setLongitude(result.getCoordinate().getLongitude());</span><br><span class="line">            info.setLatitude(result.getCoordinate().getLatitude());</span><br><span class="line">            restaurants.add(info);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> restaurants;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. è®¡ç®—é…é€è·ç¦»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calculateDeliveryDistance</span><span class="params">(String restaurantId, <span class="type">double</span> userLng, <span class="type">double</span> userLat)</span> &#123;</span><br><span class="line">        <span class="comment">// å…ˆå°†ç”¨æˆ·ä½ç½®ä¸´æ—¶æ·»åŠ </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">tempUserId</span> <span class="operator">=</span> <span class="string">&quot;temp_&quot;</span> + System.currentTimeMillis();</span><br><span class="line">        jedis.geoadd(RESTAURANT_KEY, userLng, userLat, tempUserId);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®—è·ç¦»</span></span><br><span class="line">        <span class="type">Double</span> <span class="variable">distance</span> <span class="operator">=</span> jedis.geodist(RESTAURANT_KEY, restaurantId, tempUserId, GeoUnit.KM);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ é™¤ä¸´æ—¶ä½ç½®</span></span><br><span class="line">        jedis.zrem(RESTAURANT_KEY, tempUserId);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> distance != <span class="literal">null</span> ? distance : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4. æ›´æ–°éª‘æ‰‹ä½ç½®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateRiderLocation</span><span class="params">(String riderId, <span class="type">double</span> longitude, <span class="type">double</span> latitude)</span> &#123;</span><br><span class="line">        jedis.geoadd(RIDER_KEY, longitude, latitude, riderId);</span><br><span class="line">        <span class="comment">// è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ5åˆ†é’Ÿæœªæ›´æ–°åˆ™è®¤ä¸ºç¦»çº¿ï¼‰</span></span><br><span class="line">        jedis.expire(RIDER_KEY, <span class="number">300</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 5. æŸ¥æ‰¾é¤å…é™„è¿‘çš„éª‘æ‰‹</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;RiderInfo&gt; <span class="title function_">findNearbyRiders</span><span class="params">(String restaurantId, <span class="type">double</span> maxDistance)</span> &#123;</span><br><span class="line">        List&lt;GeoRadiusResponse&gt; results = jedis.georadiusByMember(</span><br><span class="line">            RIDER_KEY, restaurantId, maxDistance, GeoUnit.KM,</span><br><span class="line">            GeoRadiusParam.geoRadiusParam()</span><br><span class="line">                .withCoord()</span><br><span class="line">                .withDist()</span><br><span class="line">                .sortAscending()</span><br><span class="line">                .count(<span class="number">10</span>)</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        List&lt;RiderInfo&gt; riders = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (GeoRadiusResponse result : results) &#123;</span><br><span class="line">            <span class="type">RiderInfo</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RiderInfo</span>();</span><br><span class="line">            info.setId(result.getMemberByString());</span><br><span class="line">            info.setDistance(result.getDistance());</span><br><span class="line">            info.setLongitude(result.getCoordinate().getLongitude());</span><br><span class="line">            info.setLatitude(result.getCoordinate().getLatitude());</span><br><span class="line">            riders.add(info);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> riders;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 6. åˆ†é…è®¢å•ç»™æœ€è¿‘çš„éª‘æ‰‹</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">assignOrderToNearestRider</span><span class="params">(String orderId, String restaurantId)</span> &#123;</span><br><span class="line">        List&lt;RiderInfo&gt; riders = findNearbyRiders(restaurantId, <span class="number">5.0</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (riders.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// æ²¡æœ‰å¯ç”¨éª‘æ‰‹</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é€‰æ‹©æœ€è¿‘çš„éª‘æ‰‹</span></span><br><span class="line">        <span class="type">RiderInfo</span> <span class="variable">nearestRider</span> <span class="operator">=</span> riders.get(<span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®°å½•è®¢å•åˆ†é…</span></span><br><span class="line">        jedis.hset(<span class="string">&quot;order:&quot;</span> + orderId, <span class="string">&quot;riderId&quot;</span>, nearestRider.getId());</span><br><span class="line">        jedis.hset(<span class="string">&quot;order:&quot;</span> + orderId, <span class="string">&quot;distance&quot;</span>, String.valueOf(nearestRider.getDistance()));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> nearestRider.getId();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°æ®æ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestaurantInfo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> distance;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> longitude;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> latitude;</span><br><span class="line">    <span class="comment">// getters and setters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RiderInfo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> distance;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> longitude;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> latitude;</span><br><span class="line">    <span class="comment">// getters and setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeliverySystemDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">DeliveryService</span> <span class="variable">service</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeliveryService</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ·»åŠ é¤å…</span></span><br><span class="line">        service.addRestaurant(<span class="string">&quot;restaurant001&quot;</span>, <span class="number">113.93</span>, <span class="number">22.54</span>);</span><br><span class="line">        service.addRestaurant(<span class="string">&quot;restaurant002&quot;</span>, <span class="number">113.95</span>, <span class="number">22.56</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç”¨æˆ·ä¸‹å•ï¼ŒæŸ¥æ‰¾é™„è¿‘é¤å…</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">userLng</span> <span class="operator">=</span> <span class="number">113.94</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">userLat</span> <span class="operator">=</span> <span class="number">22.55</span>;</span><br><span class="line">        List&lt;RestaurantInfo&gt; restaurants = service.findNearbyRestaurants(userLng, userLat);</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;é™„è¿‘çš„é¤å…ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (RestaurantInfo restaurant : restaurants) &#123;</span><br><span class="line">            System.out.println(String.format(</span><br><span class="line">                <span class="string">&quot;é¤å…ID: %s, è·ç¦»: %.2f km&quot;</span>,</span><br><span class="line">                restaurant.getId(),</span><br><span class="line">                restaurant.getDistance()</span><br><span class="line">            ));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// éª‘æ‰‹ä¸Šçº¿ï¼Œä¸ŠæŠ¥ä½ç½®</span></span><br><span class="line">        service.updateRiderLocation(<span class="string">&quot;rider001&quot;</span>, <span class="number">113.92</span>, <span class="number">22.53</span>);</span><br><span class="line">        service.updateRiderLocation(<span class="string">&quot;rider002&quot;</span>, <span class="number">113.96</span>, <span class="number">22.57</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ†é…è®¢å•ç»™æœ€è¿‘çš„éª‘æ‰‹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">assignedRider</span> <span class="operator">=</span> service.assignOrderToNearestRider(<span class="string">&quot;order001&quot;</span>, <span class="string">&quot;restaurant001&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;è®¢å•å·²åˆ†é…ç»™éª‘æ‰‹: &quot;</span> + assignedRider);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½ä¼˜åŒ–å»ºè®®</strong>ï¼š</p><ol><li><p><strong>é™åˆ¶æŸ¥è¯¢èŒƒå›´</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>COUNT</code>é™åˆ¶è¿”å›æ•°é‡</li><li>åˆç†è®¾ç½®æŸ¥è¯¢åŠå¾„ï¼ˆä¸è¦è¿‡å¤§ï¼‰</li></ul></li><li><p><strong>å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®</strong>ï¼š</p><ul><li>ç¦»çº¿ç”¨æˆ·&#x2F;éª‘æ‰‹çš„ä½ç½®</li><li>ä½¿ç”¨TTLè‡ªåŠ¨è¿‡æœŸ</li></ul></li><li><p><strong>åˆ†ç‰‡å­˜å‚¨</strong>ï¼š</p><ul><li>æŒ‰åŸå¸‚&#x2F;åŒºåŸŸåˆ†ç‰‡</li><li>é¿å…å•ä¸ªGEOé›†åˆè¿‡å¤§</li></ul></li><li><p><strong>ç¼“å­˜çƒ­ç‚¹æ•°æ®</strong>ï¼š</p><ul><li>çƒ­é—¨é¤å…&#x2F;åœ°ç‚¹</li><li>é«˜é¢‘æŸ¥è¯¢ç»“æœ</li></ul></li></ol><h2 id="7-Redisäº‹åŠ¡ä¸é”æœºåˆ¶"><a href="#7-Redisäº‹åŠ¡ä¸é”æœºåˆ¶" class="headerlink" title="7. Redisäº‹åŠ¡ä¸é”æœºåˆ¶"></a>7. Redisäº‹åŠ¡ä¸é”æœºåˆ¶</h2><h3 id="7-1-ä»€ä¹ˆæ˜¯Redisäº‹åŠ¡"><a href="#7-1-ä»€ä¹ˆæ˜¯Redisäº‹åŠ¡" class="headerlink" title="7.1 ä»€ä¹ˆæ˜¯Redisäº‹åŠ¡"></a>7.1 ä»€ä¹ˆæ˜¯Redisäº‹åŠ¡</h3><h4 id="äº‹åŠ¡å®šä¹‰"><a href="#äº‹åŠ¡å®šä¹‰" class="headerlink" title="äº‹åŠ¡å®šä¹‰"></a>äº‹åŠ¡å®šä¹‰</h4><p><strong>Redisäº‹åŠ¡</strong>æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼Œå®ƒå°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…æˆä¸€ä¸ªæ•´ä½“ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚</p><p><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼š</p><ul><li>âœ… <strong>å‘½ä»¤åºåˆ—åŒ–</strong>ï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºæ‰§è¡Œ</li><li>âœ… <strong>éš”ç¦»æ‰§è¡Œ</strong>ï¼šäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘½ä»¤æ‰“æ–­</li><li>âœ… <strong>ä¸²è”å‘½ä»¤</strong>ï¼šä¸»è¦ä½œç”¨æ˜¯ä¸²è”å¤šä¸ªå‘½ä»¤ï¼Œé˜²æ­¢å…¶ä»–å‘½ä»¤æ’é˜Ÿ</li><li>âš ï¸ <strong>éå®Œå…¨åŸå­æ€§</strong>ï¼šä¸åŒäºä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡ï¼ŒRedisäº‹åŠ¡ä¸ä¿è¯å®Œå…¨åŸå­æ€§</li></ul><p><strong>äº‹åŠ¡ vs å•ä¸ªå‘½ä»¤</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>å•ä¸ªå‘½ä»¤</th><th>äº‹åŠ¡</th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œæ–¹å¼</strong></td><td>ç«‹å³æ‰§è¡Œ</td><td>å»¶è¿Ÿåˆ°EXECæ—¶æ‰¹é‡æ‰§è¡Œ</td></tr><tr><td><strong>åŸå­æ€§</strong></td><td>å•ä¸ªå‘½ä»¤åŸå­æ€§</td><td>éƒ¨åˆ†åŸå­æ€§ï¼ˆæ— å›æ»šï¼‰</td></tr><tr><td><strong>éš”ç¦»æ€§</strong></td><td>å•çº¿ç¨‹ä¿è¯</td><td>æ‰¹é‡æ“ä½œéš”ç¦»</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>æ¯æ¬¡ç½‘ç»œå¾€è¿”</td><td>å‡å°‘ç½‘ç»œå¾€è¿”</td></tr></tbody></table><h4 id="äº‹åŠ¡çš„åº”ç”¨åœºæ™¯"><a href="#äº‹åŠ¡çš„åº”ç”¨åœºæ™¯" class="headerlink" title="äº‹åŠ¡çš„åº”ç”¨åœºæ™¯"></a>äº‹åŠ¡çš„åº”ç”¨åœºæ™¯</h4><p><strong>1. æ‰¹é‡æ“ä½œ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šåŒæ—¶æ›´æ–°å¤šä¸ªå•†å“åº“å­˜</span></span><br><span class="line">MULTI</span><br><span class="line">DECR product:1001:stock</span><br><span class="line">DECR product:1002:stock</span><br><span class="line">DECR product:1003:stock</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure><p><strong>2. é¿å…ç«æ€æ¡ä»¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šè½¬è´¦æ“ä½œï¼ˆæ‰£æ¬¾+åŠ æ¬¾ï¼‰</span></span><br><span class="line">MULTI</span><br><span class="line">DECRBY account:A 100</span><br><span class="line">INCRBY account:B 100</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure><p><strong>3. ç§’æ€åœºæ™¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœºæ™¯ï¼šå•†å“ç§’æ€ï¼Œé˜²æ­¢è¶…å–</span></span><br><span class="line">WATCH product:stock</span><br><span class="line">GET product:stock</span><br><span class="line">MULTI</span><br><span class="line">DECR product:stock</span><br><span class="line">SADD product:buyers user123</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure><h3 id="7-2-Redisäº‹åŠ¡å‘½ä»¤"><a href="#7-2-Redisäº‹åŠ¡å‘½ä»¤" class="headerlink" title="7.2 Redisäº‹åŠ¡å‘½ä»¤"></a>7.2 Redisäº‹åŠ¡å‘½ä»¤</h3><h4 id="7-2-1-MULTI-å¼€å¯äº‹åŠ¡"><a href="#7-2-1-MULTI-å¼€å¯äº‹åŠ¡" class="headerlink" title="7.2.1 MULTI - å¼€å¯äº‹åŠ¡"></a>7.2.1 MULTI - å¼€å¯äº‹åŠ¡</h4><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br></pre></td></tr></table></figure><p><strong>åŠŸèƒ½</strong>ï¼šæ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹ï¼Œåç»­å‘½ä»¤ä¼šè¿›å…¥é˜Ÿåˆ—ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šæ€»æ˜¯è¿”å› <code>OK</code></p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET key1 value1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; SET key2 value2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; GET key1</span><br><span class="line">QUEUED</span><br></pre></td></tr></table></figure><p><strong>çŠ¶æ€è¯´æ˜</strong>ï¼š</p><ul><li>æ‰§è¡Œ<code>MULTI</code>åï¼ŒRedisè¿›å…¥<strong>äº‹åŠ¡æ¨¡å¼</strong></li><li>åç»­å‘½ä»¤ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¿”å›<code>QUEUED</code></li><li>å‘½ä»¤ä¾æ¬¡è¿›å…¥<strong>å‘½ä»¤é˜Ÿåˆ—</strong>ï¼Œç­‰å¾…<code>EXEC</code>æ‰§è¡Œ</li></ul><h4 id="7-2-2-EXEC-æ‰§è¡Œäº‹åŠ¡"><a href="#7-2-2-EXEC-æ‰§è¡Œäº‹åŠ¡" class="headerlink" title="7.2.2 EXEC - æ‰§è¡Œäº‹åŠ¡"></a>7.2.2 EXEC - æ‰§è¡Œäº‹åŠ¡</h4><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC</span><br></pre></td></tr></table></figure><p><strong>åŠŸèƒ½</strong>ï¼šæ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šäº‹åŠ¡ä¸­æ¯ä¸ªå‘½ä»¤çš„æ‰§è¡Œç»“æœï¼ˆæ•°ç»„ï¼‰</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET key1 value1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; GET key1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCR counter</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK                  <span class="comment"># SET key1 value1çš„ç»“æœ</span></span><br><span class="line">2) <span class="string">&quot;value1&quot;</span>            <span class="comment"># GET key1çš„ç»“æœ</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1         <span class="comment"># INCR counterçš„ç»“æœ</span></span><br></pre></td></tr></table></figure><h4 id="7-2-3-DISCARD-å–æ¶ˆäº‹åŠ¡"><a href="#7-2-3-DISCARD-å–æ¶ˆäº‹åŠ¡" class="headerlink" title="7.2.3 DISCARD - å–æ¶ˆäº‹åŠ¡"></a>7.2.3 DISCARD - å–æ¶ˆäº‹åŠ¡</h4><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DISCARD</span><br></pre></td></tr></table></figure><p><strong>åŠŸèƒ½</strong>ï¼šå–æ¶ˆäº‹åŠ¡ï¼Œæ¸…ç©ºå‘½ä»¤é˜Ÿåˆ—ï¼Œé€€å‡ºäº‹åŠ¡æ¨¡å¼ã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šæ€»æ˜¯è¿”å› <code>OK</code></p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET key1 value1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; SET key2 value2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; DISCARD</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; GET key1</span><br><span class="line">(nil)    <span class="comment"># äº‹åŠ¡è¢«å–æ¶ˆï¼Œkey1æœªè¢«è®¾ç½®</span></span><br></pre></td></tr></table></figure><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>ä¸šåŠ¡é€»è¾‘åˆ¤æ–­åï¼Œå†³å®šä¸æ‰§è¡Œäº‹åŠ¡</li><li>å‘ç°å‘½ä»¤é”™è¯¯ï¼Œä¸»åŠ¨å–æ¶ˆ</li><li>å¼‚å¸¸æƒ…å†µä¸‹çš„å›æ»šæ“ä½œ</li></ul><h4 id="7-2-4-WATCH-ç›‘è§†é”®"><a href="#7-2-4-WATCH-ç›‘è§†é”®" class="headerlink" title="7.2.4 WATCH - ç›‘è§†é”®"></a>7.2.4 WATCH - ç›‘è§†é”®</h4><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WATCH key [key ...]</span><br></pre></td></tr></table></figure><p><strong>åŠŸèƒ½</strong>ï¼šç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªkeyï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œå‰è¿™äº›keyè¢«æ”¹åŠ¨ï¼Œäº‹åŠ¡å°†è¢«æ‰“æ–­ï¼ˆè¿”å›nilï¼‰ã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šæ€»æ˜¯è¿”å› <code>OK</code></p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ç«¯1</span></span><br><span class="line">127.0.0.1:6379&gt; SET balance 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; WATCH balance</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECRBY balance 50</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤æ—¶å®¢æˆ·ç«¯2ä¿®æ”¹äº†balance</span></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯2: SET balance 200</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯1ç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">(nil)    <span class="comment"># äº‹åŠ¡è¢«æ‰“æ–­ï¼Œå› ä¸ºbalanceè¢«ä¿®æ”¹äº†</span></span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œåŸç†</strong>ï¼ˆä¹è§‚é”ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. WATCH balance       â†’ è®°å½•balanceçš„ç‰ˆæœ¬å·</span><br><span class="line">2. MULTI              â†’ å¼€å¯äº‹åŠ¡</span><br><span class="line">3. DECRBY balance 50  â†’ å‘½ä»¤å…¥é˜Ÿ</span><br><span class="line">4. [å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹]    â†’ balanceç‰ˆæœ¬å·æ”¹å˜</span><br><span class="line">5. EXEC               â†’ æ£€æŸ¥ç‰ˆæœ¬å·ï¼Œå‘ç°ä¸ä¸€è‡´ï¼Œäº‹åŠ¡å¤±è´¥</span><br></pre></td></tr></table></figure><h4 id="7-2-5-UNWATCH-å–æ¶ˆç›‘è§†"><a href="#7-2-5-UNWATCH-å–æ¶ˆç›‘è§†" class="headerlink" title="7.2.5 UNWATCH - å–æ¶ˆç›‘è§†"></a>7.2.5 UNWATCH - å–æ¶ˆç›‘è§†</h4><p><strong>å‘½ä»¤æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNWATCH</span><br></pre></td></tr></table></figure><p><strong>åŠŸèƒ½</strong>ï¼šå–æ¶ˆWATCHå‘½ä»¤å¯¹æ‰€æœ‰keyçš„ç›‘è§†ã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šæ€»æ˜¯è¿”å› <code>OK</code></p><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>æ‰§è¡Œ<code>EXEC</code>æˆ–<code>DISCARD</code>åï¼Œä¼š<strong>è‡ªåŠ¨å–æ¶ˆç›‘è§†</strong></li><li>é€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨<code>UNWATCH</code></li><li>ä»…åœ¨éœ€è¦æå‰è§£é™¤ç›‘è§†æ—¶ä½¿ç”¨</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; WATCH key1 key2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; UNWATCH</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET key1 value1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK    <span class="comment"># å³ä½¿key1ä¹‹å‰è¢«ç›‘è§†ï¼ŒUNWATCHåä¸å†ç›‘è§†ï¼Œäº‹åŠ¡æˆåŠŸæ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><h3 id="7-3-Redisäº‹åŠ¡æ‰§è¡Œæµç¨‹"><a href="#7-3-Redisäº‹åŠ¡æ‰§è¡Œæµç¨‹" class="headerlink" title="7.3 Redisäº‹åŠ¡æ‰§è¡Œæµç¨‹"></a>7.3 Redisäº‹åŠ¡æ‰§è¡Œæµç¨‹</h3><h4 id="7-3-1-äº‹åŠ¡æ‰§è¡Œçš„ä¸‰ä¸ªé˜¶æ®µ"><a href="#7-3-1-äº‹åŠ¡æ‰§è¡Œçš„ä¸‰ä¸ªé˜¶æ®µ" class="headerlink" title="7.3.1 äº‹åŠ¡æ‰§è¡Œçš„ä¸‰ä¸ªé˜¶æ®µ"></a>7.3.1 äº‹åŠ¡æ‰§è¡Œçš„ä¸‰ä¸ªé˜¶æ®µ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[1. å¼€å¯é˜¶æ®µ]</span><br><span class="line">    â†“ MULTI</span><br><span class="line">[2. ç»„é˜Ÿé˜¶æ®µ]</span><br><span class="line">    â†“ å‘½ä»¤å…¥é˜Ÿï¼ˆQUEUEDï¼‰</span><br><span class="line">    â†“ å‘½ä»¤å…¥é˜Ÿï¼ˆQUEUEDï¼‰</span><br><span class="line">    â†“ å‘½ä»¤å…¥é˜Ÿï¼ˆQUEUEDï¼‰</span><br><span class="line">[3. æ‰§è¡Œé˜¶æ®µ]</span><br><span class="line">    â†“ EXEC</span><br><span class="line">[è¿”å›ç»“æœ]</span><br></pre></td></tr></table></figure><p><strong>æµç¨‹å›¾</strong>ï¼š</p><p><img src="/images/redis/redis%E4%BA%8B%E5%8A%A1%E4%BB%8B%E7%BB%8D%E5%9B%BE.png" alt="Redisäº‹åŠ¡æµç¨‹"></p><h4 id="7-3-2-äº‹åŠ¡æ‰§è¡Œæ¡ˆä¾‹"><a href="#7-3-2-äº‹åŠ¡æ‰§è¡Œæ¡ˆä¾‹" class="headerlink" title="7.3.2 äº‹åŠ¡æ‰§è¡Œæ¡ˆä¾‹"></a>7.3.2 äº‹åŠ¡æ‰§è¡Œæ¡ˆä¾‹</h4><h5 id="æ¡ˆä¾‹1ï¼šç»„é˜ŸæˆåŠŸï¼Œæäº¤æˆåŠŸ-âœ…"><a href="#æ¡ˆä¾‹1ï¼šç»„é˜ŸæˆåŠŸï¼Œæäº¤æˆåŠŸ-âœ…" class="headerlink" title="æ¡ˆä¾‹1ï¼šç»„é˜ŸæˆåŠŸï¼Œæäº¤æˆåŠŸ âœ…"></a>æ¡ˆä¾‹1ï¼šç»„é˜ŸæˆåŠŸï¼Œæäº¤æˆåŠŸ âœ…</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET name <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; SET age 25</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCR age</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; GET name</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK              <span class="comment"># SET name</span></span><br><span class="line">2) OK              <span class="comment"># SET age</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 26    <span class="comment"># INCR age</span></span><br><span class="line">4) <span class="string">&quot;å¼ ä¸‰&quot;</span>           <span class="comment"># GET name</span></span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong>ï¼šâœ… æ‰€æœ‰å‘½ä»¤æˆåŠŸæ‰§è¡Œ</p><p><img src="/images/redis/%E6%8F%90%E4%BA%A4%E6%88%90%E5%8A%9F.png" alt="ç»„é˜ŸæˆåŠŸæäº¤æˆåŠŸ"></p><h5 id="æ¡ˆä¾‹2ï¼šç»„é˜Ÿé˜¶æ®µæŠ¥é”™ï¼Œæäº¤å¤±è´¥-âŒ"><a href="#æ¡ˆä¾‹2ï¼šç»„é˜Ÿé˜¶æ®µæŠ¥é”™ï¼Œæäº¤å¤±è´¥-âŒ" class="headerlink" title="æ¡ˆä¾‹2ï¼šç»„é˜Ÿé˜¶æ®µæŠ¥é”™ï¼Œæäº¤å¤±è´¥ âŒ"></a>æ¡ˆä¾‹2ï¼šç»„é˜Ÿé˜¶æ®µæŠ¥é”™ï¼Œæäº¤å¤±è´¥ âŒ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET key1 value1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; SETXX key2 value2    <span class="comment"># é”™è¯¯çš„å‘½ä»¤ï¼ˆä¸å­˜åœ¨SETXXï¼‰</span></span><br><span class="line">(error) ERR unknown <span class="built_in">command</span> <span class="string">&#x27;SETXX&#x27;</span></span><br><span class="line">127.0.0.1:6379&gt; SET key3 value3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">(error) EXECABORT Transaction discarded because of previous errors.</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong>ï¼šâŒ <strong>æ•´ä¸ªäº‹åŠ¡è¢«å–æ¶ˆ</strong>ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šæ‰§è¡Œï¼ˆåŒ…æ‹¬æ­£ç¡®çš„å‘½ä»¤ï¼‰</p><p><strong>åŸå› </strong>ï¼šç»„é˜Ÿé˜¶æ®µå‘ç°<strong>è¯­æ³•é”™è¯¯</strong>ï¼ˆå‘½ä»¤ä¸å­˜åœ¨ï¼‰ï¼ŒRedisç›´æ¥æ”¾å¼ƒæ•´ä¸ªäº‹åŠ¡</p><p><img src="/images/redis/%E6%8F%90%E4%BA%A4%E5%A4%B1%E8%B4%A5.png" alt="ç»„é˜Ÿé˜¶æ®µæŠ¥é”™"></p><h5 id="æ¡ˆä¾‹3ï¼šç»„é˜ŸæˆåŠŸï¼Œæ‰§è¡Œé˜¶æ®µéƒ¨åˆ†å¤±è´¥-âš ï¸"><a href="#æ¡ˆä¾‹3ï¼šç»„é˜ŸæˆåŠŸï¼Œæ‰§è¡Œé˜¶æ®µéƒ¨åˆ†å¤±è´¥-âš ï¸" class="headerlink" title="æ¡ˆä¾‹3ï¼šç»„é˜ŸæˆåŠŸï¼Œæ‰§è¡Œé˜¶æ®µéƒ¨åˆ†å¤±è´¥ âš ï¸"></a>æ¡ˆä¾‹3ï¼šç»„é˜ŸæˆåŠŸï¼Œæ‰§è¡Œé˜¶æ®µéƒ¨åˆ†å¤±è´¥ âš ï¸</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET balance 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET name <span class="string">&quot;æå››&quot;</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCR balance</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCR name    <span class="comment"># å¯¹å­—ç¬¦ä¸²æ‰§è¡ŒINCRï¼ˆç±»å‹é”™è¯¯ï¼‰</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; SET age 30</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK                                                    <span class="comment"># SET name æˆåŠŸ âœ…</span></span><br><span class="line">2) (<span class="built_in">integer</span>) 101                                        <span class="comment"># INCR balance æˆåŠŸ âœ…</span></span><br><span class="line">3) (error) ERR value is not an <span class="built_in">integer</span> or out of range  <span class="comment"># INCR name å¤±è´¥ âŒ</span></span><br><span class="line">4) OK                                                    <span class="comment"># SET age æˆåŠŸ âœ…</span></span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong>ï¼šâš ï¸ <strong>éƒ¨åˆ†æˆåŠŸï¼Œéƒ¨åˆ†å¤±è´¥</strong></p><ul><li>æ­£ç¡®çš„å‘½ä»¤ï¼šæ­£å¸¸æ‰§è¡Œ âœ…</li><li>é”™è¯¯çš„å‘½ä»¤ï¼šæ‰§è¡Œå¤±è´¥ âŒ</li><li><strong>ä¸ä¼šå›æ»š</strong>ï¼šå…¶ä»–å‘½ä»¤ä¸å—å½±å“</li></ul><p><strong>åŸå› </strong>ï¼šç»„é˜Ÿé˜¶æ®µè¯­æ³•æ­£ç¡®ï¼Œä½†æ‰§è¡Œé˜¶æ®µå‘ç”Ÿ<strong>è¿è¡Œæ—¶é”™è¯¯</strong>ï¼ˆç±»å‹é”™è¯¯ï¼‰</p><p><img src="/images/redis/%E6%9C%89%E6%88%90%E5%8A%9F%E6%9C%89%E5%A4%B1%E8%B4%A5.png" alt="éƒ¨åˆ†æˆåŠŸéƒ¨åˆ†å¤±è´¥"></p><h3 id="7-4-äº‹åŠ¡é”™è¯¯å¤„ç†"><a href="#7-4-äº‹åŠ¡é”™è¯¯å¤„ç†" class="headerlink" title="7.4 äº‹åŠ¡é”™è¯¯å¤„ç†"></a>7.4 äº‹åŠ¡é”™è¯¯å¤„ç†</h3><h4 id="ä¸¤ç§é”™è¯¯ç±»å‹"><a href="#ä¸¤ç§é”™è¯¯ç±»å‹" class="headerlink" title="ä¸¤ç§é”™è¯¯ç±»å‹"></a>ä¸¤ç§é”™è¯¯ç±»å‹</h4><table><thead><tr><th>é”™è¯¯ç±»å‹</th><th>å‘ç”Ÿé˜¶æ®µ</th><th>é”™è¯¯ç¤ºä¾‹</th><th>å¤„ç†æ–¹å¼</th></tr></thead><tbody><tr><td><strong>è¯­æ³•é”™è¯¯</strong><br>(Syntax Error)</td><td><strong>ç»„é˜Ÿé˜¶æ®µ</strong></td><td>å‘½ä»¤ä¸å­˜åœ¨ã€å‚æ•°æ•°é‡é”™è¯¯</td><td>âŒ <strong>æ•´ä¸ªäº‹åŠ¡å–æ¶ˆ</strong><br>æ‰€æœ‰å‘½ä»¤éƒ½ä¸æ‰§è¡Œ</td></tr><tr><td><strong>è¿è¡Œæ—¶é”™è¯¯</strong><br>(Runtime Error)</td><td><strong>æ‰§è¡Œé˜¶æ®µ</strong></td><td>ç±»å‹é”™è¯¯ã€èŒƒå›´é”™è¯¯</td><td>âš ï¸ <strong>é”™è¯¯å‘½ä»¤ä¸æ‰§è¡Œ</strong><br>å…¶ä»–å‘½ä»¤æ­£å¸¸æ‰§è¡Œ<br><strong>ä¸ä¼šå›æ»š</strong></td></tr></tbody></table><h4 id="é”™è¯¯å¤„ç†è¯¦è§£"><a href="#é”™è¯¯å¤„ç†è¯¦è§£" class="headerlink" title="é”™è¯¯å¤„ç†è¯¦è§£"></a>é”™è¯¯å¤„ç†è¯¦è§£</h4><p><strong>1. ç»„é˜Ÿé˜¶æ®µé”™è¯¯ï¼ˆSyntax Errorï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br><span class="line">SET key1 value1        <span class="comment"># âœ… æ­£ç¡®</span></span><br><span class="line">UNKNOWN_COMMAND        <span class="comment"># âŒ è¯­æ³•é”™è¯¯ï¼ˆå‘½ä»¤ä¸å­˜åœ¨ï¼‰</span></span><br><span class="line">SET key2 value2        <span class="comment"># âœ… æ­£ç¡®</span></span><br><span class="line">EXEC                   <span class="comment"># âŒ æ•´ä¸ªäº‹åŠ¡è¢«å–æ¶ˆ</span></span><br></pre></td></tr></table></figure><p><strong>å¤„ç†æ–¹å¼</strong>ï¼š</p><ul><li>Redisæ£€æµ‹åˆ°<strong>è¯­æ³•é”™è¯¯</strong></li><li>æ ‡è®°äº‹åŠ¡ä¸º<strong>å¤±è´¥çŠ¶æ€</strong></li><li>æ‰§è¡Œ<code>EXEC</code>æ—¶ï¼Œè¿”å›é”™è¯¯ï¼Œ<strong>æ‰€æœ‰å‘½ä»¤éƒ½ä¸æ‰§è¡Œ</strong></li></ul><p><strong>2. æ‰§è¡Œé˜¶æ®µé”™è¯¯ï¼ˆRuntime Errorï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SET name <span class="string">&quot;å¼ ä¸‰&quot;</span>         <span class="comment"># nameæ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line">MULTI</span><br><span class="line">INCR counter          <span class="comment"># âœ… æˆåŠŸï¼ˆcounterä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸º0å†åŠ 1ï¼‰</span></span><br><span class="line">INCR name             <span class="comment"># âŒ å¤±è´¥ï¼ˆnameæ˜¯å­—ç¬¦ä¸²ï¼Œä¸èƒ½INCRï¼‰</span></span><br><span class="line">SET age 25            <span class="comment"># âœ… æˆåŠŸï¼ˆä¸å—INCR nameå½±å“ï¼‰</span></span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure><p><strong>å¤„ç†æ–¹å¼</strong>ï¼š</p><ul><li>é”™è¯¯å‘½ä»¤ï¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œ<strong>ä¸æ‰§è¡Œ</strong></li><li>å…¶ä»–å‘½ä»¤ï¼š<strong>æ­£å¸¸æ‰§è¡Œ</strong></li><li><strong>ä¸ä¼šå›æ»š</strong>ï¼šå·²æ‰§è¡Œçš„å‘½ä»¤ä¸ä¼šæ’¤é”€</li></ul><h4 id="Redisäº‹åŠ¡-vs-ä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡"><a href="#Redisäº‹åŠ¡-vs-ä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡" class="headerlink" title="Redisäº‹åŠ¡ vs ä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡"></a>Redisäº‹åŠ¡ vs ä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡</h4><table><thead><tr><th>ç‰¹æ€§</th><th>Redisäº‹åŠ¡</th><th>ä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡ï¼ˆå¦‚MySQLï¼‰</th></tr></thead><tbody><tr><td><strong>åŸå­æ€§</strong></td><td>âš ï¸ <strong>éƒ¨åˆ†åŸå­æ€§</strong><br>è¯­æ³•é”™è¯¯ï¼šå…¨éƒ¨å–æ¶ˆ<br>è¿è¡Œæ—¶é”™è¯¯ï¼šä¸å›æ»š</td><td>âœ… <strong>å®Œå…¨åŸå­æ€§</strong><br>è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»š</td></tr><tr><td><strong>å›æ»šæœºåˆ¶</strong></td><td>âŒ <strong>ä¸æ”¯æŒå›æ»š</strong></td><td>âœ… <strong>æ”¯æŒå›æ»š</strong>ï¼ˆROLLBACKï¼‰</td></tr><tr><td><strong>éš”ç¦»çº§åˆ«</strong></td><td>âœ… ä¸²è¡ŒåŒ–æ‰§è¡Œ</td><td>âœ… å¯é…ç½®éš”ç¦»çº§åˆ«</td></tr><tr><td><strong>ä¸€è‡´æ€§</strong></td><td>âš ï¸ å¼€å‘è€…ä¿è¯</td><td>âœ… æ•°æ®åº“ä¿è¯</td></tr><tr><td><strong>æŒä¹…æ€§</strong></td><td>âš ï¸ å–å†³äºæŒä¹…åŒ–é…ç½®</td><td>âœ… äº‹åŠ¡æäº¤åæŒä¹…åŒ–</td></tr></tbody></table><p><strong>ä¸ºä»€ä¹ˆRedisä¸æ”¯æŒå›æ»šï¼Ÿ</strong></p><ol><li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šå›æ»šæœºåˆ¶ä¼šæ˜¾è‘—é™ä½æ€§èƒ½</li><li><strong>è®¾è®¡å“²å­¦</strong>ï¼šRedisè¿½æ±‚ç®€å•å’Œé«˜æ€§èƒ½</li><li><strong>é”™è¯¯é¢„é˜²</strong>ï¼šè¿è¡Œæ—¶é”™è¯¯é€šå¸¸æ˜¯ç¨‹åºbugï¼Œåº”è¯¥åœ¨æµ‹è¯•é˜¶æ®µå‘ç°</li><li><strong>å•çº¿ç¨‹æ¨¡å‹</strong>ï¼šå•çº¿ç¨‹æ‰§è¡Œï¼Œä¸éœ€è¦å¤æ‚çš„äº‹åŠ¡ç®¡ç†</li></ol><h3 id="7-5-äº‹åŠ¡å†²çªé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#7-5-äº‹åŠ¡å†²çªé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="7.5 äº‹åŠ¡å†²çªé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a>7.5 äº‹åŠ¡å†²çªé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3><h4 id="7-5-1-äº‹åŠ¡å†²çªåœºæ™¯"><a href="#7-5-1-äº‹åŠ¡å†²çªåœºæ™¯" class="headerlink" title="7.5.1 äº‹åŠ¡å†²çªåœºæ™¯"></a>7.5.1 äº‹åŠ¡å†²çªåœºæ™¯</h4><p><strong>åœºæ™¯æè¿°</strong>ï¼šåŒåä¸€ç§’æ€ï¼Œå¤šä¸ªç”¨æˆ·åŒæ—¶æŠ¢è´­åŒä¸€å•†å“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åˆå§‹åº“å­˜ï¼š1000</span><br><span class="line">ç”¨æˆ·Aï¼šè´­ä¹°10ä»¶ï¼ˆå‡åº“å­˜10ï¼‰</span><br><span class="line">ç”¨æˆ·Bï¼šè´­ä¹°5ä»¶ï¼ˆå‡åº“å­˜5ï¼‰</span><br><span class="line">ç”¨æˆ·Cï¼šè´­ä¹°8ä»¶ï¼ˆå‡åº“å­˜8ï¼‰</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>å¹¶å‘é—®é¢˜</strong>ï¼š</p><p><img src="/images/redis/%E6%8A%A2%E8%B4%AD%E4%BE%8B%E5%AD%90.png" alt="äº‹åŠ¡å†²çªç¤ºä¾‹"></p><p><strong>é—®é¢˜åˆ†æ</strong>ï¼š</p><table><thead><tr><th>æ—¶é—´ç‚¹</th><th>ç”¨æˆ·A</th><th>ç”¨æˆ·B</th><th>åº“å­˜</th></tr></thead><tbody><tr><td>T1</td><td>è¯»å–åº“å­˜ï¼š100</td><td>-</td><td>100</td></tr><tr><td>T2</td><td>-</td><td>è¯»å–åº“å­˜ï¼š100</td><td>100</td></tr><tr><td>T3</td><td>è®¡ç®—ï¼š100-10&#x3D;90</td><td>-</td><td>100</td></tr><tr><td>T4</td><td>-</td><td>è®¡ç®—ï¼š100-5&#x3D;95</td><td>100</td></tr><tr><td>T5</td><td>å†™å…¥ï¼š90</td><td>-</td><td>90</td></tr><tr><td>T6</td><td>-</td><td>å†™å…¥ï¼š95</td><td>95ï¼ˆé”™è¯¯ï¼ï¼‰</td></tr></tbody></table><p><strong>ç»“æœ</strong>ï¼šâŒ ç”¨æˆ·Açš„æ‰£å‡è¢«è¦†ç›–ï¼Œå®é™…åº”è¯¥æ˜¯85ï¼Œä½†ç»“æœæ˜¯95ï¼ˆ<strong>ä¸¢å¤±æ›´æ–°</strong>ï¼‰</p><h4 id="7-5-2-æ‚²è§‚é”ï¼ˆPessimistic-Lockï¼‰"><a href="#7-5-2-æ‚²è§‚é”ï¼ˆPessimistic-Lockï¼‰" class="headerlink" title="7.5.2 æ‚²è§‚é”ï¼ˆPessimistic Lockï¼‰"></a>7.5.2 æ‚²è§‚é”ï¼ˆPessimistic Lockï¼‰</h4><p><strong>å®šä¹‰</strong>ï¼šè®¤ä¸ºæ•°æ®å¾ˆå¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼Œå› æ­¤åœ¨æ“ä½œæ•°æ®å‰å…ˆåŠ é”ã€‚</p><p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š<strong>å…ˆåŠ é”ï¼Œå†æ“ä½œ</strong></p><p><strong>å·¥ä½œæµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·Aè¯·æ±‚                ç”¨æˆ·Bè¯·æ±‚</span><br><span class="line">   â†“                       â†“</span><br><span class="line">è·å–é” âœ…                è·å–é” âŒï¼ˆç­‰å¾…ï¼‰</span><br><span class="line">   â†“                       |</span><br><span class="line">è¯»å–æ•°æ®                    |ï¼ˆé˜»å¡ï¼‰</span><br><span class="line">   â†“                       |</span><br><span class="line">ä¿®æ”¹æ•°æ®                    |</span><br><span class="line">   â†“                       |</span><br><span class="line">å†™å…¥æ•°æ®                    |</span><br><span class="line">   â†“                       |</span><br><span class="line">é‡Šæ”¾é”                      â†“</span><br><span class="line">   â†“                   è·å–é” âœ…</span><br><span class="line">ç»“æŸ                        â†“</span><br><span class="line">                        è¯»å–æ•°æ®</span><br><span class="line">                           â†“</span><br><span class="line">                        ä¿®æ”¹æ•°æ®</span><br><span class="line">                           â†“</span><br><span class="line">                        å†™å…¥æ•°æ®</span><br><span class="line">                           â†“</span><br><span class="line">                        é‡Šæ”¾é”</span><br><span class="line">                           â†“</span><br><span class="line">                        ç»“æŸ</span><br></pre></td></tr></table></figure><p><img src="/images/redis/%E6%82%B2%E8%A7%82%E9%94%81.png" alt="æ‚²è§‚é”æœºåˆ¶"></p><p><strong>ä¼ ç»Ÿæ•°æ®åº“å®ç°</strong>ï¼ˆMySQLï¼‰ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åŠ é”æŸ¥è¯¢ï¼ˆFOR UPDATEï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> stock <span class="keyword">FROM</span> product <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹åº“å­˜</span></span><br><span class="line"><span class="keyword">UPDATE</span> product <span class="keyword">SET</span> stock <span class="operator">=</span> stock <span class="operator">-</span> <span class="number">1</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æäº¤äº‹åŠ¡ï¼ˆé‡Šæ”¾é”ï¼‰</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>âœ… <strong>å¼ºä¸€è‡´æ€§</strong>ï¼šä¿è¯æ•°æ®ç»å¯¹æ­£ç¡®</li><li>âœ… <strong>é€‚åˆå†™å¤šè¯»å°‘</strong>ï¼šé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>âŒ <strong>æ€§èƒ½ä½</strong>ï¼šåŠ é”ã€ç­‰å¾…ã€é‡Šæ”¾é”çš„å¼€é”€å¤§</li><li>âŒ <strong>å¹¶å‘åº¦ä½</strong>ï¼šåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ“ä½œ</li><li>âŒ <strong>å¯èƒ½æ­»é”</strong>ï¼šå¤šä¸ªé”ç›¸äº’ç­‰å¾…</li></ul><h4 id="7-5-3-ä¹è§‚é”ï¼ˆOptimistic-Lockï¼‰"><a href="#7-5-3-ä¹è§‚é”ï¼ˆOptimistic-Lockï¼‰" class="headerlink" title="7.5.3 ä¹è§‚é”ï¼ˆOptimistic Lockï¼‰"></a>7.5.3 ä¹è§‚é”ï¼ˆOptimistic Lockï¼‰</h4><p><strong>å®šä¹‰</strong>ï¼šè®¤ä¸ºæ•°æ®å†²çªæ¦‚ç‡è¾ƒä½ï¼Œæ“ä½œæ—¶ä¸åŠ é”ï¼Œåªåœ¨æ›´æ–°æ—¶æ£€æŸ¥æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹ã€‚</p><p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š<strong>å…ˆæ“ä½œï¼Œæäº¤æ—¶æ£€æŸ¥</strong>ï¼ˆCheck-And-Setæœºåˆ¶ï¼‰</p><p><strong>å·¥ä½œæµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·A                         ç”¨æˆ·B</span><br><span class="line">   â†“                           â†“</span><br><span class="line">è¯»å–æ•°æ®ï¼ˆversion=1ï¼‰         è¯»å–æ•°æ®ï¼ˆversion=1ï¼‰</span><br><span class="line">   â†“                           â†“</span><br><span class="line">ä¿®æ”¹æ•°æ®                      ä¿®æ”¹æ•°æ®</span><br><span class="line">   â†“                           â†“</span><br><span class="line">æäº¤ï¼šæ£€æŸ¥version=1? âœ…       æäº¤ï¼šæ£€æŸ¥version=1? âŒ</span><br><span class="line">   â†“                           â†“</span><br><span class="line">versionæ”¹ä¸º2ï¼Œæäº¤æˆåŠŸ âœ…     versionå·²å˜ä¸º2ï¼Œæäº¤å¤±è´¥ âŒ</span><br><span class="line">   â†“                           â†“</span><br><span class="line">ç»“æŸ                        é‡è¯•ï¼ˆé‡æ–°è¯»å–version=2ï¼‰</span><br></pre></td></tr></table></figure><p><img src="/images/redis/%E4%B9%90%E8%A7%82%E9%94%81.png" alt="ä¹è§‚é”æœºåˆ¶"></p><p><strong>å®ç°æ–¹å¼1ï¼šç‰ˆæœ¬å·æœºåˆ¶</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¯»å–æ•°æ®å’Œç‰ˆæœ¬å·</span></span><br><span class="line"><span class="keyword">SELECT</span> stock, version <span class="keyword">FROM</span> product <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line"><span class="comment">-- stock=100, version=1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ›´æ–°æ—¶æ£€æŸ¥ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="keyword">UPDATE</span> product </span><br><span class="line"><span class="keyword">SET</span> stock <span class="operator">=</span> <span class="number">99</span>, version <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span> <span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- å¦‚æœversionä¸æ˜¯1ï¼ˆè¢«å…¶ä»–äººæ”¹è¿‡ï¼‰ï¼Œæ›´æ–°å¤±è´¥</span></span><br></pre></td></tr></table></figure><p><strong>å®ç°æ–¹å¼2ï¼šæ—¶é—´æˆ³æœºåˆ¶</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¯»å–æ•°æ®å’Œæ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="keyword">SELECT</span> stock, update_time <span class="keyword">FROM</span> product <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line"><span class="comment">-- stock=100, update_time=&#x27;2025-11-17 10:00:00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ›´æ–°æ—¶æ£€æŸ¥æ—¶é—´æˆ³</span></span><br><span class="line"><span class="keyword">UPDATE</span> product </span><br><span class="line"><span class="keyword">SET</span> stock <span class="operator">=</span> <span class="number">99</span>, update_time <span class="operator">=</span> NOW() </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span> <span class="keyword">AND</span> update_time <span class="operator">=</span> <span class="string">&#x27;2025-11-17 10:00:00&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>Redisä¸­çš„ä¹è§‚é”ï¼šWATCHæœºåˆ¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨æˆ·A</span></span><br><span class="line">127.0.0.1:6379&gt; WATCH stock</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; GET stock</span><br><span class="line"><span class="string">&quot;100&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECR stock</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) (<span class="built_in">integer</span>) 99    <span class="comment"># æˆåŠŸ âœ…</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·Bï¼ˆåŒæ—¶æ“ä½œï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; WATCH stock</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; GET stock</span><br><span class="line"><span class="string">&quot;100&quot;</span>    <span class="comment"># è¯»å–æ—¶stockè¿˜æ˜¯100</span></span><br><span class="line"><span class="comment"># ï¼ˆæ­¤æ—¶ç”¨æˆ·Aå·²ç»æŠŠstockæ”¹ä¸º99ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECR stock</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">(nil)    <span class="comment"># å¤±è´¥ âŒï¼Œå› ä¸ºstockè¢«ä¿®æ”¹äº†</span></span><br></pre></td></tr></table></figure><p><img src="/images/redis/watch%E6%9C%BA%E5%88%B6.png" alt="WATCHæœºåˆ¶"></p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>âœ… <strong>é«˜æ€§èƒ½</strong>ï¼šæ— é”æ“ä½œï¼Œæ— é˜»å¡</li><li>âœ… <strong>é«˜å¹¶å‘</strong>ï¼šå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶è¯»å–</li><li>âœ… <strong>æ— æ­»é”</strong>ï¼šä¸ä¼šå‡ºç°æ­»é”é—®é¢˜</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>âŒ <strong>å¯èƒ½å¤±è´¥</strong>ï¼šé«˜å¹¶å‘æ—¶å†²çªå¤šï¼Œéœ€è¦é‡è¯•</li><li>âŒ <strong>ABAé—®é¢˜</strong>ï¼šå€¼ä»Aå˜åˆ°Bå†å˜å›Aï¼Œä¹è§‚é”æ£€æµ‹ä¸åˆ°</li></ul><h4 id="7-5-4-æ‚²è§‚é”-vs-ä¹è§‚é”"><a href="#7-5-4-æ‚²è§‚é”-vs-ä¹è§‚é”" class="headerlink" title="7.5.4 æ‚²è§‚é” vs ä¹è§‚é”"></a>7.5.4 æ‚²è§‚é” vs ä¹è§‚é”</h4><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>æ‚²è§‚é”</th><th>ä¹è§‚é”</th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒæ€æƒ³</strong></td><td>å…ˆåŠ é”ï¼Œå†æ“ä½œ</td><td>å…ˆæ“ä½œï¼Œæäº¤æ—¶æ£€æŸ¥</td></tr><tr><td><strong>å†²çªé¢„æœŸ</strong></td><td>è®¤ä¸ºå†²çªå¾ˆå¯èƒ½å‘ç”Ÿ</td><td>è®¤ä¸ºå†²çªæ¦‚ç‡è¾ƒä½</td></tr><tr><td><strong>åŠ é”æ—¶æœº</strong></td><td>è¯»å–æ•°æ®å‰</td><td>ä¸åŠ é”ï¼ˆæäº¤æ—¶æ£€æŸ¥ï¼‰</td></tr><tr><td><strong>å¹¶å‘æ€§èƒ½</strong></td><td>âŒ ä½ï¼ˆä¸²è¡Œæ‰§è¡Œï¼‰</td><td>âœ… é«˜ï¼ˆå¹¶å‘è¯»å–ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å†™å¤šè¯»å°‘ã€å†²çªé¢‘ç¹</td><td>è¯»å¤šå†™å°‘ã€å†²çªè¾ƒå°‘</td></tr><tr><td><strong>å…¸å‹å®ç°</strong></td><td>æ•°æ®åº“è¡Œé”ã€è¡¨é”</td><td>ç‰ˆæœ¬å·ã€WATCH</td></tr><tr><td><strong>Rediså®ç°</strong></td><td>SETNX + EXPIREï¼ˆåˆ†å¸ƒå¼é”ï¼‰</td><td>WATCH + MULTI + EXEC</td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>è¯»å¤šå†™å°‘</strong>ï¼ˆå¦‚ç¼“å­˜ï¼‰</td><td>âœ… ä¹è§‚é”</td></tr><tr><td><strong>å†™å¤šè¯»å°‘</strong>ï¼ˆå¦‚ç§’æ€ï¼‰</td><td>âš ï¸ ä¹è§‚é” + é™æµ + é˜Ÿåˆ—</td></tr><tr><td><strong>é«˜å¹¶å‘ç§’æ€</strong></td><td>âœ… <strong>Luaè„šæœ¬</strong>ï¼ˆåŸå­æ€§æœ€å¼ºï¼‰</td></tr><tr><td><strong>åˆ†å¸ƒå¼é”åœºæ™¯</strong></td><td>âœ… æ‚²è§‚é”ï¼ˆSETNXï¼‰</td></tr></tbody></table><h3 id="7-6-Redisäº‹åŠ¡ä¸‰å¤§ç‰¹æ€§"><a href="#7-6-Redisäº‹åŠ¡ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="7.6 Redisäº‹åŠ¡ä¸‰å¤§ç‰¹æ€§"></a>7.6 Redisäº‹åŠ¡ä¸‰å¤§ç‰¹æ€§</h3><h4 id="7-6-1-å•ç‹¬çš„éš”ç¦»æ“ä½œ"><a href="#7-6-1-å•ç‹¬çš„éš”ç¦»æ“ä½œ" class="headerlink" title="7.6.1 å•ç‹¬çš„éš”ç¦»æ“ä½œ"></a>7.6.1 å•ç‹¬çš„éš”ç¦»æ“ä½œ</h4><p><strong>ç‰¹æ€§è¯´æ˜</strong>ï¼š</p><ul><li>âœ… äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¼š<strong>åºåˆ—åŒ–</strong>ã€<strong>æŒ‰é¡ºåº</strong>æ‰§è¡Œ</li><li>âœ… äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œ<strong>ä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘½ä»¤æ‰“æ–­</strong></li><li>âœ… Rediså•çº¿ç¨‹æ¨¡å‹ä¿è¯äº†ä¸²è¡ŒåŒ–æ‰§è¡Œ</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ç«¯A</span></span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET key1 value1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCR counter</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; GET key1</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤æ—¶å®¢æˆ·ç«¯Bæ‰§è¡Œå‘½ä»¤ï¼ˆä¼šç­‰å¾…ï¼‰</span></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯B: SET key2 value2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯Aç»§ç»­</span></span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK</span><br><span class="line">2) (<span class="built_in">integer</span>) 1</span><br><span class="line">3) <span class="string">&quot;value1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯Açš„äº‹åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå®¢æˆ·ç«¯Bçš„å‘½ä»¤æ‰ä¼šæ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><p><strong>åº•å±‚åŸç†</strong>ï¼š</p><ul><li>Redisæ˜¯<strong>å•çº¿ç¨‹</strong>æ¨¡å‹</li><li>äº‹åŠ¡ä¸­çš„å‘½ä»¤ä¼š<strong>ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§</strong>åœ°æ‰§è¡Œ</li><li>å‘½ä»¤æ‰§è¡ŒæœŸé—´ï¼Œ<strong>ä¸ä¼šåˆ‡æ¢åˆ°å…¶ä»–å®¢æˆ·ç«¯</strong></li></ul><h4 id="7-6-2-æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ"><a href="#7-6-2-æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ" class="headerlink" title="7.6.2 æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ"></a>7.6.2 æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</h4><p><strong>ç‰¹æ€§è¯´æ˜</strong>ï¼š</p><ul><li>âš ï¸ Redisäº‹åŠ¡<strong>æ²¡æœ‰ä¼ ç»Ÿæ•°æ®åº“çš„éš”ç¦»çº§åˆ«æ¦‚å¿µ</strong></li><li>âš ï¸ é˜Ÿåˆ—ä¸­çš„å‘½ä»¤åœ¨<strong>æäº¤å‰éƒ½ä¸ä¼šå®é™…æ‰§è¡Œ</strong></li><li>âš ï¸ ä¸å­˜åœ¨<strong>è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»</strong>ç­‰é—®é¢˜</li></ul><p><strong>å¯¹æ¯”ä¼ ç»Ÿæ•°æ®åº“</strong>ï¼š</p><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»</th><th>å¹»è¯»</th><th>Redis</th></tr></thead><tbody><tr><td><strong>Read Uncommitted</strong></td><td>âŒ å¯èƒ½</td><td>âŒ å¯èƒ½</td><td>âŒ å¯èƒ½</td><td>-</td></tr><tr><td><strong>Read Committed</strong></td><td>âœ… ä¸ä¼š</td><td>âŒ å¯èƒ½</td><td>âŒ å¯èƒ½</td><td>-</td></tr><tr><td><strong>Repeatable Read</strong></td><td>âœ… ä¸ä¼š</td><td>âœ… ä¸ä¼š</td><td>âŒ å¯èƒ½</td><td>-</td></tr><tr><td><strong>Serializable</strong></td><td>âœ… ä¸ä¼š</td><td>âœ… ä¸ä¼š</td><td>âœ… ä¸ä¼š</td><td>âœ… ç±»ä¼¼</td></tr></tbody></table><p><strong>Redisçš„â€éš”ç¦»çº§åˆ«â€</strong>ï¼š</p><ul><li>Redisäº‹åŠ¡ç±»ä¼¼äº<strong>Serializableï¼ˆä¸²è¡ŒåŒ–ï¼‰</strong></li><li>å‘½ä»¤åœ¨<code>EXEC</code>å‰ä¸ä¼šæ‰§è¡Œï¼Œå› æ­¤<strong>ä¸ä¼šæœ‰è„è¯»</strong></li><li>å•çº¿ç¨‹æ¨¡å‹ä¿è¯äº†<strong>ä¸²è¡Œæ‰§è¡Œ</strong></li></ul><p><strong>æ³¨æ„</strong>ï¼š</p><ul><li><code>WATCH</code>ç›‘è§†çš„keyåœ¨äº‹åŠ¡å¤–è¢«ä¿®æ”¹ï¼Œäº‹åŠ¡ä¼šå¤±è´¥</li><li>è¿™ä¸æ˜¯â€ä¸å¯é‡å¤è¯»â€ï¼Œè€Œæ˜¯<strong>ä¹è§‚é”æœºåˆ¶</strong></li></ul><h4 id="7-6-3-ä¸ä¿è¯åŸå­æ€§"><a href="#7-6-3-ä¸ä¿è¯åŸå­æ€§" class="headerlink" title="7.6.3 ä¸ä¿è¯åŸå­æ€§"></a>7.6.3 ä¸ä¿è¯åŸå­æ€§</h4><p><strong>ç‰¹æ€§è¯´æ˜</strong>ï¼š</p><ul><li>âŒ Redisäº‹åŠ¡<strong>ä¸ä¿è¯å®Œå…¨åŸå­æ€§</strong></li><li>âŒ å¦‚æœæœ‰å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œ<strong>ä¸ä¼šå›æ»š</strong></li><li>âš ï¸ å¤±è´¥çš„å‘½ä»¤ä¸æ‰§è¡Œï¼Œå…¶ä»–å‘½ä»¤ç»§ç»­æ‰§è¡Œ</li></ul><p><strong>å¯¹æ¯”ä¼ ç»Ÿæ•°æ®åº“</strong>ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»Ÿæ•°æ®åº“äº‹åŠ¡</th><th>Redisäº‹åŠ¡</th></tr></thead><tbody><tr><td><strong>åŸå­æ€§</strong></td><td>âœ… è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»š</td><td>âš ï¸ éƒ¨åˆ†æˆåŠŸï¼Œéƒ¨åˆ†å¤±è´¥<br><strong>ä¸æ”¯æŒå›æ»š</strong></td></tr><tr><td><strong>å¤±è´¥å¤„ç†</strong></td><td>âœ… ROLLBACKå›æ»š</td><td>âŒ å¤±è´¥å‘½ä»¤ä¸æ‰§è¡Œ<br>æˆåŠŸå‘½ä»¤å·²ç”Ÿæ•ˆ</td></tr><tr><td><strong>é”™è¯¯ç±»å‹</strong></td><td>ç»Ÿä¸€å›æ»š</td><td>è¯­æ³•é”™è¯¯ï¼šå…¨éƒ¨å–æ¶ˆ<br>è¿è¡Œæ—¶é”™è¯¯ï¼šä¸å›æ»š</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼ˆä¸ä¿è¯åŸå­æ€§ï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET balance 1000</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET name <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECRBY balance 500    <span class="comment"># âœ… æ­£ç¡®å‘½ä»¤</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCR name             <span class="comment"># âŒ é”™è¯¯å‘½ä»¤ï¼ˆnameæ˜¯å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCRBY balance 300    <span class="comment"># âœ… æ­£ç¡®å‘½ä»¤</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) (<span class="built_in">integer</span>) 500                                        <span class="comment"># âœ… æˆåŠŸ</span></span><br><span class="line">2) (error) ERR value is not an <span class="built_in">integer</span> or out of range  <span class="comment"># âŒ å¤±è´¥</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 800                                        <span class="comment"># âœ… æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; GET balance</span><br><span class="line"><span class="string">&quot;800&quot;</span>    <span class="comment"># balanceå·²è¢«ä¿®æ”¹ï¼Œä¸ä¼šå›æ»šåˆ°1000</span></span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆä¸æ”¯æŒå›æ»šï¼Ÿ</strong></p><ol><li><p><strong>æ€§èƒ½ä¼˜å…ˆ</strong>ï¼š</p><ul><li>å›æ»šæœºåˆ¶éœ€è¦è®°å½•æ“ä½œæ—¥å¿—</li><li>ä¼šå¤§å¹…é™ä½æ€§èƒ½</li></ul></li><li><p><strong>è®¾è®¡å“²å­¦</strong>ï¼š</p><ul><li>Redisè¿½æ±‚<strong>ç®€å•ã€é«˜æ•ˆ</strong></li><li>ä¸åƒä¼ ç»Ÿæ•°æ®åº“é‚£æ ·å¤æ‚</li></ul></li><li><p><strong>é”™è¯¯é¢„é˜²</strong>ï¼š</p><ul><li>è¿è¡Œæ—¶é”™è¯¯ï¼ˆå¦‚ç±»å‹é”™è¯¯ï¼‰é€šå¸¸æ˜¯<strong>ç¨‹åºbug</strong></li><li>åº”è¯¥åœ¨<strong>æµ‹è¯•é˜¶æ®µå‘ç°</strong>ï¼Œè€Œä¸æ˜¯ä¾èµ–å›æ»š</li></ul></li><li><p><strong>å•çº¿ç¨‹æ¨¡å‹</strong>ï¼š</p><ul><li>ä¸å­˜åœ¨å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜</li><li>ä¸éœ€è¦å¤æ‚çš„äº‹åŠ¡ç®¡ç†</li></ul></li></ol><p><strong>å¼€å‘å»ºè®®</strong>ï¼š</p><ul><li>âœ… åœ¨åº”ç”¨å±‚åšå¥½<strong>æ•°æ®éªŒè¯</strong></li><li>âœ… ç¡®ä¿äº‹åŠ¡ä¸­çš„å‘½ä»¤<strong>éƒ½æ˜¯åˆæ³•çš„</strong></li><li>âœ… å¯¹äºéœ€è¦ä¸¥æ ¼åŸå­æ€§çš„åœºæ™¯ï¼Œä½¿ç”¨<strong>Luaè„šæœ¬</strong></li></ul><h3 id="7-7-å®æˆ˜æ¡ˆä¾‹ï¼šRedisç§’æ€ç³»ç»Ÿ"><a href="#7-7-å®æˆ˜æ¡ˆä¾‹ï¼šRedisç§’æ€ç³»ç»Ÿ" class="headerlink" title="7.7 å®æˆ˜æ¡ˆä¾‹ï¼šRedisç§’æ€ç³»ç»Ÿ"></a>7.7 å®æˆ˜æ¡ˆä¾‹ï¼šRedisç§’æ€ç³»ç»Ÿ</h3><h4 id="7-7-1-ç§’æ€åœºæ™¯åˆ†æ"><a href="#7-7-1-ç§’æ€åœºæ™¯åˆ†æ" class="headerlink" title="7.7.1 ç§’æ€åœºæ™¯åˆ†æ"></a>7.7.1 ç§’æ€åœºæ™¯åˆ†æ</h4><p><strong>ä¸šåŠ¡éœ€æ±‚</strong>ï¼š</p><ul><li>å•†å“åº“å­˜æœ‰é™ï¼ˆå¦‚100ä»¶ï¼‰</li><li>å¤§é‡ç”¨æˆ·åŒæ—¶æŠ¢è´­ï¼ˆå¦‚10000äººï¼‰</li><li>æ¯ä¸ªç”¨æˆ·åªèƒ½è´­ä¹°ä¸€æ¬¡</li><li>åº“å­˜ä¸èƒ½è¶…å–</li></ul><p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p><ol><li><strong>è¶…å–é—®é¢˜</strong>ï¼šå¹¶å‘æ‰£å‡åº“å­˜ï¼Œå¯èƒ½å¯¼è‡´åº“å­˜ä¸ºè´Ÿ</li><li><strong>é‡å¤è´­ä¹°</strong>ï¼šåŒä¸€ç”¨æˆ·å¤šæ¬¡è´­ä¹°</li><li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šé«˜å¹¶å‘ä¸‹çš„å“åº”é€Ÿåº¦</li></ol><p><img src="/images/redis/%E7%A7%92%E6%9D%80%E6%A1%88%E4%BE%8B.png" alt="ç§’æ€æ¡ˆä¾‹"></p><h4 id="7-7-2-æ–¹æ¡ˆ1ï¼šåŸºç¡€äº‹åŠ¡æ–¹æ¡ˆï¼ˆæœ‰è¶…å–é—®é¢˜ï¼‰"><a href="#7-7-2-æ–¹æ¡ˆ1ï¼šåŸºç¡€äº‹åŠ¡æ–¹æ¡ˆï¼ˆæœ‰è¶…å–é—®é¢˜ï¼‰" class="headerlink" title="7.7.2 æ–¹æ¡ˆ1ï¼šåŸºç¡€äº‹åŠ¡æ–¹æ¡ˆï¼ˆæœ‰è¶…å–é—®é¢˜ï¼‰"></a>7.7.2 æ–¹æ¡ˆ1ï¼šåŸºç¡€äº‹åŠ¡æ–¹æ¡ˆï¼ˆæœ‰è¶…å–é—®é¢˜ï¼‰</h4><p><strong>å®ç°æ€è·¯</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">seckill</span><span class="params">(String userId, String productId)</span> &#123;</span><br><span class="line">    <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">String</span> <span class="variable">stockKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:qt&quot;</span>;     <span class="comment">// åº“å­˜key</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">userKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:usr&quot;</span>;      <span class="comment">// ç”¨æˆ·é›†åˆkey</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. æ£€æŸ¥åº“å­˜</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">stock</span> <span class="operator">=</span> jedis.get(stockKey);</span><br><span class="line">    <span class="keyword">if</span> (stock == <span class="literal">null</span> || Integer.parseInt(stock) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç§’æ€å·²ç»“æŸ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²è´­ä¹°</span></span><br><span class="line">    <span class="keyword">if</span> (jedis.sismember(userKey, userId)) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‚¨å·²å‚åŠ è¿‡ç§’æ€&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. å‡åº“å­˜ï¼Œè®°å½•ç”¨æˆ·</span></span><br><span class="line">    jedis.decr(stockKey);</span><br><span class="line">    jedis.sadd(userKey, userId);</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">&quot;ç§’æ€æˆåŠŸ&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜åˆ†æ</strong>ï¼šâŒ <strong>å­˜åœ¨è¶…å–é£é™©</strong></p><table><thead><tr><th>æ—¶é—´</th><th>çº¿ç¨‹A</th><th>çº¿ç¨‹B</th><th>åº“å­˜</th></tr></thead><tbody><tr><td>T1</td><td>è¯»å–åº“å­˜ï¼š1</td><td>-</td><td>1</td></tr><tr><td>T2</td><td>-</td><td>è¯»å–åº“å­˜ï¼š1</td><td>1</td></tr><tr><td>T3</td><td>åˆ¤æ–­ï¼š1 &gt; 0 âœ…</td><td>-</td><td>1</td></tr><tr><td>T4</td><td>-</td><td>åˆ¤æ–­ï¼š1 &gt; 0 âœ…</td><td>1</td></tr><tr><td>T5</td><td>æ‰£å‡åº“å­˜ï¼š0</td><td>-</td><td>0</td></tr><tr><td>T6</td><td>-</td><td>æ‰£å‡åº“å­˜ï¼š-1</td><td>-1ï¼ˆè¶…å–ï¼ï¼‰</td></tr></tbody></table><h4 id="7-7-3-æ–¹æ¡ˆ2ï¼šä¹è§‚é”æ–¹æ¡ˆï¼ˆWATCHï¼‰"><a href="#7-7-3-æ–¹æ¡ˆ2ï¼šä¹è§‚é”æ–¹æ¡ˆï¼ˆWATCHï¼‰" class="headerlink" title="7.7.3 æ–¹æ¡ˆ2ï¼šä¹è§‚é”æ–¹æ¡ˆï¼ˆWATCHï¼‰"></a>7.7.3 æ–¹æ¡ˆ2ï¼šä¹è§‚é”æ–¹æ¡ˆï¼ˆWATCHï¼‰</h4><p><strong>å®ç°æ€è·¯</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">seckillWithWatch</span><span class="params">(String userId, String productId)</span> &#123;</span><br><span class="line">    <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">String</span> <span class="variable">stockKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:qt&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">userKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:usr&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤šé‡è¯•3æ¬¡ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// 1. ç›‘è§†åº“å­˜keyï¼ˆä¹è§‚é”ï¼‰</span></span><br><span class="line">        jedis.watch(stockKey);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æ£€æŸ¥åº“å­˜</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">stock</span> <span class="operator">=</span> jedis.get(stockKey);</span><br><span class="line">        <span class="keyword">if</span> (stock == <span class="literal">null</span> || Integer.parseInt(stock) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            jedis.unwatch();</span><br><span class="line">            System.out.println(<span class="string">&quot;ç§’æ€å·²ç»“æŸ&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²è´­ä¹°</span></span><br><span class="line">        <span class="keyword">if</span> (jedis.sismember(userKey, userId)) &#123;</span><br><span class="line">            jedis.unwatch();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‚¨å·²å‚åŠ è¿‡ç§’æ€&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. å¼€å¯äº‹åŠ¡</span></span><br><span class="line">        <span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">        tx.decr(stockKey);           <span class="comment">// å‡åº“å­˜</span></span><br><span class="line">        tx.sadd(userKey, userId);    <span class="comment">// è®°å½•ç”¨æˆ·</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5. æäº¤äº‹åŠ¡</span></span><br><span class="line">        List&lt;Object&gt; result = tx.exec();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 6. åˆ¤æ–­äº‹åŠ¡æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (result != <span class="literal">null</span> &amp;&amp; !result.isEmpty()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç§’æ€æˆåŠŸ&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 7. äº‹åŠ¡å¤±è´¥ï¼Œé‡è¯•</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æŠ¢è´­å¤±è´¥ï¼Œæ­£åœ¨é‡è¯•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">&quot;æŠ¢è´­å¤±è´¥ï¼Œè¯·ç¨åå†è¯•&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/redis/%E8%B6%85%E5%8D%96%E9%97%AE%E9%A2%98.png" alt="ä¹è§‚é”è§£å†³è¶…å–"></p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>âœ… è§£å†³äº†è¶…å–é—®é¢˜</li><li>âœ… é«˜å¹¶å‘ä¸‹æ€§èƒ½è¾ƒå¥½</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>âŒ é«˜å¹¶å‘æ—¶<strong>å†²çªç‡é«˜</strong>ï¼Œå¤§é‡ç”¨æˆ·å¤±è´¥</li><li>âŒ éœ€è¦é‡è¯•æœºåˆ¶ï¼Œ<strong>ç”¨æˆ·ä½“éªŒå·®</strong></li><li>âŒ æç«¯æƒ…å†µä¸‹å¯èƒ½<strong>æ— æ³•ç§’æ€æˆåŠŸ</strong></li></ul><h4 id="7-7-4-æ–¹æ¡ˆ3ï¼šLuaè„šæœ¬æ–¹æ¡ˆï¼ˆæœ€ä¼˜ï¼‰"><a href="#7-7-4-æ–¹æ¡ˆ3ï¼šLuaè„šæœ¬æ–¹æ¡ˆï¼ˆæœ€ä¼˜ï¼‰" class="headerlink" title="7.7.4 æ–¹æ¡ˆ3ï¼šLuaè„šæœ¬æ–¹æ¡ˆï¼ˆæœ€ä¼˜ï¼‰"></a>7.7.4 æ–¹æ¡ˆ3ï¼šLuaè„šæœ¬æ–¹æ¡ˆï¼ˆæœ€ä¼˜ï¼‰</h4><p><strong>Luaè„šæœ¬ä»‹ç»</strong>ï¼š</p><p><strong>ä»€ä¹ˆæ˜¯Luaï¼Ÿ</strong></p><ul><li>Luaæ˜¯ä¸€ä¸ª<strong>å°å·§çš„è„šæœ¬è¯­è¨€</strong></li><li>å®Œæ•´çš„Luaè§£é‡Šå™¨ä»…<strong>200KB</strong></li><li>å¯ä»¥è¢«C&#x2F;C++è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨C&#x2F;C++å‡½æ•°</li><li>å¹¿æ³›ç”¨äº<strong>åµŒå…¥å¼è„šæœ¬</strong>ï¼ˆæ¸¸æˆã€åº”ç”¨é…ç½®ç­‰ï¼‰</li></ul><p><strong>åº”ç”¨æ¡ˆä¾‹</strong>ï¼š</p><ul><li>ğŸ® é­”å…½äº‰éœ¸åœ°å›¾</li><li>ğŸ® é­”å…½ä¸–ç•Œæ’ä»¶</li><li>ğŸ® åšå¾·ä¹‹é—¨</li><li>ğŸ® æ„¤æ€’çš„å°é¸Ÿ</li></ul><p><strong>Luaè„šæœ¬åœ¨Redisä¸­çš„ä¼˜åŠ¿</strong>ï¼š</p><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>åŸå­æ€§</strong></td><td>Luaè„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œ<strong>ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’é˜Ÿ</strong></td></tr><tr><td><strong>å‡å°‘ç½‘ç»œå¼€é”€</strong></td><td>å¤šä¸ªRediså‘½ä»¤æ‰“åŒ…æˆä¸€ä¸ªè„šæœ¬ï¼Œ<strong>å‡å°‘ç½‘ç»œå¾€è¿”</strong></td></tr><tr><td><strong>å¯å¤ç”¨</strong></td><td>è„šæœ¬å¯ä»¥é¢„å…ˆç¼–å†™ï¼Œå¤šæ¬¡è°ƒç”¨</td></tr><tr><td><strong>æœåŠ¡å™¨ç«¯æ‰§è¡Œ</strong></td><td>è„šæœ¬åœ¨RedisæœåŠ¡å™¨æ‰§è¡Œï¼Œ<strong>å‡å°‘å®¢æˆ·ç«¯å‹åŠ›</strong></td></tr></tbody></table><p><strong>ç‰ˆæœ¬è¦æ±‚</strong>ï¼šRedis 2.6+</p><h4 id="Luaè„šæœ¬ä¸ºä»€ä¹ˆèƒ½ä¿è¯åŸå­æ€§ï¼Ÿ"><a href="#Luaè„šæœ¬ä¸ºä»€ä¹ˆèƒ½ä¿è¯åŸå­æ€§ï¼Ÿ" class="headerlink" title="Luaè„šæœ¬ä¸ºä»€ä¹ˆèƒ½ä¿è¯åŸå­æ€§ï¼Ÿ"></a>Luaè„šæœ¬ä¸ºä»€ä¹ˆèƒ½ä¿è¯åŸå­æ€§ï¼Ÿ</h4><p><strong>æ ¸å¿ƒåŸç†ï¼šRediså•çº¿ç¨‹æ¨¡å‹ + è„šæœ¬æ‰§è¡Œæœºåˆ¶</strong></p><p><strong>1. Rediså•çº¿ç¨‹äº‹ä»¶å¾ªç¯</strong></p><p>Redisé‡‡ç”¨<strong>å•çº¿ç¨‹äº‹ä»¶å¾ªç¯æ¨¡å‹</strong>ï¼ˆä¸»çº¿ç¨‹ï¼‰ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­é¡ºåºæ‰§è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯Aè¯·æ±‚ â†’ å‘½ä»¤é˜Ÿåˆ— â†’ Redisä¸»çº¿ç¨‹ï¼ˆå•çº¿ç¨‹ï¼‰â†’ æ‰§è¡Œå‘½ä»¤ â†’ è¿”å›ç»“æœ</span><br><span class="line">å®¢æˆ·ç«¯Bè¯·æ±‚ â†’ å‘½ä»¤é˜Ÿåˆ— â†’ Redisä¸»çº¿ç¨‹ï¼ˆå•çº¿ç¨‹ï¼‰â†’ æ‰§è¡Œå‘½ä»¤ â†’ è¿”å›ç»“æœ</span><br><span class="line">å®¢æˆ·ç«¯Cè¯·æ±‚ â†’ å‘½ä»¤é˜Ÿåˆ— â†’ Redisä¸»çº¿ç¨‹ï¼ˆå•çº¿ç¨‹ï¼‰â†’ æ‰§è¡Œå‘½ä»¤ â†’ è¿”å›ç»“æœ</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li>âœ… åŒä¸€æ—¶åˆ»<strong>åªæœ‰ä¸€ä¸ªå‘½ä»¤åœ¨æ‰§è¡Œ</strong></li><li>âœ… å‘½ä»¤ä¹‹é—´<strong>ä¸ä¼šå¹¶å‘æ‰§è¡Œ</strong></li><li>âœ… ä¸å­˜åœ¨<strong>çº¿ç¨‹åˆ‡æ¢</strong>å’Œ<strong>ç«æ€æ¡ä»¶</strong></li></ul><p><strong>2. Luaè„šæœ¬çš„æ‰§è¡Œæœºåˆ¶</strong></p><p>å½“Redisæ‰§è¡ŒLuaè„šæœ¬æ—¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[å®¢æˆ·ç«¯å‘é€Luaè„šæœ¬]</span><br><span class="line">    â†“</span><br><span class="line">[Redisæ¥æ”¶è„šæœ¬]</span><br><span class="line">    â†“</span><br><span class="line">[Redisè§£æè„šæœ¬]</span><br><span class="line">    â†“</span><br><span class="line">[Rediså°†æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªä»»åŠ¡æ”¾å…¥å‘½ä»¤é˜Ÿåˆ—]</span><br><span class="line">    â†“</span><br><span class="line">[Redisä¸»çº¿ç¨‹ä»é˜Ÿåˆ—å–å‡ºè„šæœ¬ä»»åŠ¡]</span><br><span class="line">    â†“</span><br><span class="line">[Redisæ‰§è¡Œè„šæœ¬ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼ˆè¿ç»­æ‰§è¡Œï¼Œä¸ä¸­æ–­ï¼‰]</span><br><span class="line">    â†“</span><br><span class="line">[è¿”å›è„šæœ¬æ‰§è¡Œç»“æœ]</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‰¹æ€§</strong>ï¼š</p><ol><li><p><strong>è„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“</strong>ï¼š</p><ul><li>Luaè„šæœ¬è¢«Redisè§†ä¸º<strong>ä¸€ä¸ªå®Œæ•´çš„å‘½ä»¤å•å…ƒ</strong></li><li>è„šæœ¬ä¸­çš„æ‰€æœ‰Rediså‘½ä»¤ä¼š<strong>è¿ç»­æ‰§è¡Œ</strong>ï¼Œä¸­é—´ä¸ä¼šæ’å…¥å…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤</li></ul></li><li><p><strong>æ‰§è¡ŒæœŸé—´ä¸å“åº”å…¶ä»–è¯·æ±‚</strong>ï¼š</p><ul><li>è„šæœ¬æ‰§è¡ŒæœŸé—´ï¼ŒRedisä¸»çº¿ç¨‹<strong>ä¸ä¼šå¤„ç†å…¶ä»–å‘½ä»¤</strong></li><li>ç›´åˆ°è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šå¤„ç†ä¸‹ä¸€ä¸ªå‘½ä»¤</li></ul></li><li><p><strong>è„šæœ¬å†…éƒ¨å‘½ä»¤çš„åŸå­æ€§</strong>ï¼š</p><ul><li>è„šæœ¬å†…çš„å¤šä¸ª<code>redis.call()</code>å‘½ä»¤ä¼š<strong>è¿ç»­æ‰§è¡Œ</strong></li><li>ä¸ä¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è¢«å…¶ä»–å‘½ä»¤æ‰“æ–­</li></ul></li></ol><p><strong>3. å¯¹æ¯”ï¼šMULTI&#x2F;EXEC vs Luaè„šæœ¬</strong></p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>MULTI&#x2F;EXECäº‹åŠ¡</th><th>Luaè„šæœ¬</th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œæ–¹å¼</strong></td><td>å‘½ä»¤å…ˆå…¥é˜Ÿï¼ŒEXECæ—¶æ‰¹é‡æ‰§è¡Œ</td><td>è„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“ç«‹å³æ‰§è¡Œ</td></tr><tr><td><strong>åŸå­æ€§ä¿è¯</strong></td><td>âš ï¸ éƒ¨åˆ†åŸå­æ€§ï¼ˆæ‰§è¡Œé˜¶æ®µå¯èƒ½éƒ¨åˆ†å¤±è´¥ï¼‰</td><td>âœ… <strong>å®Œå…¨åŸå­æ€§</strong>ï¼ˆè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼‰</td></tr><tr><td><strong>æ¡ä»¶åˆ¤æ–­</strong></td><td>âŒ ä¸æ”¯æŒï¼ˆæ— æ³•æ ¹æ®ä¸­é—´ç»“æœå†³å®šï¼‰</td><td>âœ… æ”¯æŒï¼ˆif&#x2F;else&#x2F;å¾ªç¯ï¼‰</td></tr><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>å»¶è¿Ÿæ‰§è¡Œï¼ˆEXECæ—¶ï¼‰</td><td>ç«‹å³æ‰§è¡Œ</td></tr><tr><td><strong>å¹¶å‘æ§åˆ¶</strong></td><td>éœ€è¦WATCHï¼ˆä¹è§‚é”ï¼‰</td><td>å•çº¿ç¨‹è‡ªç„¶ä¿è¯</td></tr><tr><td><strong>ä¸­é—´ç»“æœ</strong></td><td>âŒ æ— æ³•è·å–</td><td>âœ… å¯ä»¥è·å–å’Œä½¿ç”¨</td></tr></tbody></table><p><strong>4. æ‰§è¡Œæµç¨‹å¯¹æ¯”</strong></p><p><strong>MULTI&#x2F;EXECæ‰§è¡Œæµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´çº¿ï¼š</span><br><span class="line">T1: å®¢æˆ·ç«¯Aå‘é€ MULTI</span><br><span class="line">T2: å®¢æˆ·ç«¯Aå‘é€ SET key1 value1 â†’ QUEUEDï¼ˆå…¥é˜Ÿï¼‰</span><br><span class="line">T3: å®¢æˆ·ç«¯Bå‘é€ SET key2 value2 â†’ ç«‹å³æ‰§è¡Œ âœ…ï¼ˆå¯ä»¥æ’é˜Ÿï¼ï¼‰</span><br><span class="line">T4: å®¢æˆ·ç«¯Aå‘é€ SET key3 value3 â†’ QUEUEDï¼ˆå…¥é˜Ÿï¼‰</span><br><span class="line">T5: å®¢æˆ·ç«¯Aå‘é€ EXEC â†’ æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„å‘½ä»¤</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šå®¢æˆ·ç«¯Bçš„å‘½ä»¤å¯ä»¥åœ¨å®¢æˆ·ç«¯Açš„äº‹åŠ¡ç»„é˜Ÿé˜¶æ®µæ‰§è¡Œï¼Œ<strong>å¯èƒ½å½±å“äº‹åŠ¡çš„ä¸€è‡´æ€§</strong>ã€‚</p><p><strong>Luaè„šæœ¬æ‰§è¡Œæµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´çº¿ï¼š</span><br><span class="line">T1: å®¢æˆ·ç«¯Aå‘é€ Luaè„šæœ¬ï¼ˆåŒ…å«å¤šä¸ªredis.callï¼‰</span><br><span class="line">T2: Rediså¼€å§‹æ‰§è¡Œè„šæœ¬</span><br><span class="line">T3: è„šæœ¬å†…éƒ¨æ‰§è¡Œ redis.call(&quot;SET&quot;, &quot;key1&quot;, &quot;value1&quot;)</span><br><span class="line">T4: è„šæœ¬å†…éƒ¨æ‰§è¡Œ redis.call(&quot;SET&quot;, &quot;key2&quot;, &quot;value2&quot;)</span><br><span class="line">T5: è„šæœ¬å†…éƒ¨æ‰§è¡Œ redis.call(&quot;SET&quot;, &quot;key3&quot;, &quot;value3&quot;)</span><br><span class="line">T6: è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›ç»“æœ</span><br><span class="line">T7: å®¢æˆ·ç«¯Bå‘é€ SET key4 value4 â†’ ç°åœ¨æ‰æ‰§è¡Œ âœ…</span><br></pre></td></tr></table></figure><p><strong>å…³é”®</strong>ï¼šå®¢æˆ·ç«¯Bçš„å‘½ä»¤å¿…é¡»<strong>ç­‰å¾…è„šæœ¬æ‰§è¡Œå®Œæ¯•</strong>ï¼Œæ— æ³•åœ¨è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­æ’é˜Ÿã€‚</p><p><strong>5. å®é™…éªŒè¯ç¤ºä¾‹</strong></p><p><strong>åœºæ™¯ï¼šä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶æ“ä½œåŒä¸€ä¸ªkey</strong></p><p><strong>ä½¿ç”¨MULTI&#x2F;EXECï¼ˆå¯èƒ½æœ‰é—®é¢˜ï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ç«¯A</span></span><br><span class="line">127.0.0.1:6379&gt; WATCH balance</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; GET balance</span><br><span class="line"><span class="string">&quot;100&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECRBY balance 50</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤æ—¶å®¢æˆ·ç«¯Bå¯ä»¥ä¿®æ”¹balance</span></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯B: SET balance 200</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">(nil)    <span class="comment"># äº‹åŠ¡å¤±è´¥ï¼Œå› ä¸ºbalanceè¢«ä¿®æ”¹äº†</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨Luaè„šæœ¬ï¼ˆå®Œå…¨åŸå­ï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ç«¯A</span></span><br><span class="line">127.0.0.1:6379&gt; EVAL <span class="string">&quot;local balance = redis.call(&#x27;get&#x27;, KEYS[1]); if tonumber(balance) &gt;= 50 then redis.call(&#x27;decrby&#x27;, KEYS[1], 50); return 1; else return 0; end;&quot;</span> 1 balance</span><br><span class="line">(<span class="built_in">integer</span>) 1    <span class="comment"># æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å³ä½¿å®¢æˆ·ç«¯BåŒæ—¶å‘é€å‘½ä»¤ï¼Œä¹Ÿå¿…é¡»ç­‰å¾…è„šæœ¬æ‰§è¡Œå®Œæ¯•</span></span><br><span class="line"><span class="comment"># è„šæœ¬æ‰§è¡ŒæœŸé—´ï¼Œbalanceä¸ä¼šè¢«å…¶ä»–å‘½ä»¤ä¿®æ”¹</span></span><br></pre></td></tr></table></figure><p><strong>6. åº•å±‚å®ç°åŸç†</strong></p><p><strong>Redisæºç å±‚é¢çš„ä¿è¯</strong>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Rediså¤„ç†Luaè„šæœ¬çš„ä¼ªä»£ç </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">processLuaScript</span><span class="params">(lua_script)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. å°†è„šæœ¬æ”¾å…¥å‘½ä»¤é˜Ÿåˆ—</span></span><br><span class="line">    addToCommandQueue(lua_script);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. ä¸»çº¿ç¨‹ä»é˜Ÿåˆ—å–å‡ºè„šæœ¬</span></span><br><span class="line">    script = getFromCommandQueue();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. æ‰§è¡Œè„šæœ¬ï¼ˆå…³é”®ï¼šè¿™æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼‰</span></span><br><span class="line">    <span class="comment">// è„šæœ¬æ‰§è¡ŒæœŸé—´ï¼Œä¸»çº¿ç¨‹ä¸ä¼šå¤„ç†å…¶ä»–å‘½ä»¤</span></span><br><span class="line">    result = executeLuaScript(script);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4. è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…³é”®æœºåˆ¶</strong>ï¼š</p><ol><li><p><strong>è„šæœ¬æ‰§è¡Œé”</strong>ï¼š</p><ul><li>Redisåœ¨æ‰§è¡ŒLuaè„šæœ¬æ—¶ï¼Œä¼š<strong>é”å®šä¸»çº¿ç¨‹</strong></li><li>ç¡®ä¿è„šæœ¬æ‰§è¡ŒæœŸé—´ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ‰“æ–­</li></ul></li><li><p><strong>å‘½ä»¤é˜Ÿåˆ—é¡ºåº</strong>ï¼š</p><ul><li>æ‰€æœ‰å‘½ä»¤ï¼ˆåŒ…æ‹¬Luaè„šæœ¬ï¼‰éƒ½è¿›å…¥<strong>åŒä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ—</strong></li><li>é˜Ÿåˆ—ä¿è¯**FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰**é¡ºåº</li><li>è„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä¸ä¼šè¢«æ‹†åˆ†</li></ul></li><li><p><strong>å•çº¿ç¨‹æ‰§è¡Œ</strong>ï¼š</p><ul><li>Redisä¸»çº¿ç¨‹æ˜¯<strong>å•çº¿ç¨‹</strong>çš„</li><li>åŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡</li><li>è„šæœ¬æ‰§è¡Œæ—¶ï¼Œå…¶ä»–ä»»åŠ¡å¿…é¡»ç­‰å¾…</li></ul></li></ol><p><strong>7. æ³¨æ„äº‹é¡¹</strong></p><p><strong>âš ï¸ è„šæœ¬æ‰§è¡Œæ—¶é—´é™åˆ¶</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redisé»˜è®¤è„šæœ¬æ‰§è¡Œè¶…æ—¶æ—¶é—´ï¼š5ç§’</span></span><br><span class="line"><span class="comment"># å¦‚æœè„šæœ¬æ‰§è¡Œè¶…è¿‡5ç§’ï¼ŒRedisä¼šä¸­æ–­è„šæœ¬æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥é€šè¿‡é…ç½®ä¿®æ”¹</span></span><br><span class="line">lua-time-limit 5000  <span class="comment"># å•ä½ï¼šæ¯«ç§’</span></span><br></pre></td></tr></table></figure><p><strong>âš ï¸ è„šæœ¬é˜»å¡é—®é¢˜</strong>ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- âŒ é”™è¯¯ï¼šè„šæœ¬ä¸­åŒ…å«é˜»å¡æ“ä½œ</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">    redis.call(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;key&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- è¿™ä¼šå¯¼è‡´Redisä¸»çº¿ç¨‹è¢«é˜»å¡ï¼Œæ— æ³•å¤„ç†å…¶ä»–è¯·æ±‚</span></span><br></pre></td></tr></table></figure><p><strong>âš ï¸ è„šæœ¬ä¸­çš„é”™è¯¯å¤„ç†</strong>ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- âœ… å¥½çš„åšæ³•ï¼šè„šæœ¬å†…éƒ¨å¤„ç†é”™è¯¯</span></span><br><span class="line"><span class="keyword">local</span> result = redis.call(<span class="string">&quot;get&quot;</span>, KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> result == <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>  <span class="comment">-- è¿”å›é”™è¯¯ç </span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">tonumber</span>(result)</span><br></pre></td></tr></table></figure><h4 id="Luaè„šæœ¬ä¼šå‡ºç°éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥å—ï¼Ÿ"><a href="#Luaè„šæœ¬ä¼šå‡ºç°éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥å—ï¼Ÿ" class="headerlink" title="Luaè„šæœ¬ä¼šå‡ºç°éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥å—ï¼Ÿ"></a>Luaè„šæœ¬ä¼šå‡ºç°éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥å—ï¼Ÿ</h4><p><strong>ç­”æ¡ˆï¼šå–å†³äºä½ ä½¿ç”¨çš„å‡½æ•°ï¼</strong></p><p><strong>å…³é”®åŒºåˆ«ï¼š<code>redis.call()</code> vs <code>redis.pcall()</code></strong></p><table><thead><tr><th>å‡½æ•°</th><th>é”™è¯¯å¤„ç†</th><th>è¡Œä¸º</th></tr></thead><tbody><tr><td><strong><code>redis.call()</code></strong></td><td>âŒ <strong>æŠ›å‡ºé”™è¯¯</strong></td><td>å‘½ä»¤å¤±è´¥æ—¶ï¼Œ<strong>ç«‹å³ä¸­æ–­è„šæœ¬æ‰§è¡Œ</strong>ï¼Œæ•´ä¸ªè„šæœ¬å¤±è´¥</td></tr><tr><td><strong><code>redis.pcall()</code></strong></td><td>âœ… <strong>æ•è·é”™è¯¯</strong></td><td>å‘½ä»¤å¤±è´¥æ—¶ï¼Œ<strong>è¿”å›é”™è¯¯å¯¹è±¡</strong>ï¼Œè„šæœ¬ç»§ç»­æ‰§è¡Œ</td></tr></tbody></table><p><strong>1. ä½¿ç”¨ <code>redis.call()</code> - å…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç¤ºä¾‹è„šæœ¬</span></span><br><span class="line"><span class="keyword">local</span> result1 = redis.call(<span class="string">&quot;set&quot;</span>, <span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>)  <span class="comment">-- âœ… æˆåŠŸ</span></span><br><span class="line"><span class="keyword">local</span> result2 = redis.call(<span class="string">&quot;incr&quot;</span>, <span class="string">&quot;key2&quot;</span>)            <span class="comment">-- âœ… æˆåŠŸï¼ˆkey2ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸º0å†åŠ 1ï¼‰</span></span><br><span class="line"><span class="keyword">local</span> result3 = redis.call(<span class="string">&quot;incr&quot;</span>, <span class="string">&quot;key1&quot;</span>)           <span class="comment">-- âŒ å¤±è´¥ï¼ˆkey1æ˜¯å­—ç¬¦ä¸²ï¼Œä¸èƒ½INCRï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¦‚æœresult3å¤±è´¥ï¼Œæ•´ä¸ªè„šæœ¬ä¼šä¸­æ–­ï¼Œkey1å’Œkey2çš„ä¿®æ”¹éƒ½ä¸ä¼šç”Ÿæ•ˆ</span></span><br></pre></td></tr></table></figure><p><strong>å®é™…æµ‹è¯•</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆè®¾ç½®key1ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">127.0.0.1:6379&gt; SET key1 <span class="string">&quot;value1&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œè„šæœ¬ï¼ˆä½¿ç”¨redis.callï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; EVAL <span class="string">&quot;redis.call(&#x27;set&#x27;, &#x27;key1&#x27;, &#x27;value1&#x27;); redis.call(&#x27;incr&#x27;, &#x27;key2&#x27;); redis.call(&#x27;incr&#x27;, &#x27;key1&#x27;);&quot;</span> 0</span><br><span class="line">(error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥ç»“æœ</span></span><br><span class="line">127.0.0.1:6379&gt; GET key1</span><br><span class="line"><span class="string">&quot;value1&quot;</span>    <span class="comment"># âŒ ç¬¬ä¸€ä¸ªSETæ²¡æœ‰ç”Ÿæ•ˆï¼ˆå› ä¸ºè„šæœ¬å¤±è´¥ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; GET key2</span><br><span class="line">(nil)       <span class="comment"># âŒ key2ä¹Ÿæ²¡æœ‰åˆ›å»ºï¼ˆå› ä¸ºè„šæœ¬å¤±è´¥ï¼‰</span></span><br></pre></td></tr></table></figure><p><strong>ç»“è®º</strong>ï¼šä½¿ç”¨<code>redis.call()</code>æ—¶ï¼Œ<strong>ä»»ä½•å‘½ä»¤å¤±è´¥éƒ½ä¼šå¯¼è‡´æ•´ä¸ªè„šæœ¬å¤±è´¥</strong>ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šç”Ÿæ•ˆï¼ˆå…¨éƒ¨å›æ»šï¼‰ã€‚</p><p><strong>2. ä½¿ç”¨ <code>redis.pcall()</code> - å¯èƒ½å‡ºç°éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç¤ºä¾‹è„šæœ¬</span></span><br><span class="line"><span class="keyword">local</span> result1 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;set&quot;</span>, <span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>)  <span class="comment">-- âœ… æˆåŠŸ</span></span><br><span class="line"><span class="keyword">local</span> result2 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;incr&quot;</span>, <span class="string">&quot;key2&quot;</span>)            <span class="comment">-- âœ… æˆåŠŸ</span></span><br><span class="line"><span class="keyword">local</span> result3 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;incr&quot;</span>, <span class="string">&quot;key1&quot;</span>)            <span class="comment">-- âŒ å¤±è´¥ï¼Œä½†è¿”å›é”™è¯¯å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- result3ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼Œä½†è„šæœ¬ä¼šç»§ç»­æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(result3) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> result3.err <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- å¤„ç†é”™è¯¯</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p><strong>å®é™…æµ‹è¯•</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆè®¾ç½®key1ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">127.0.0.1:6379&gt; SET key1 <span class="string">&quot;value1&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œè„šæœ¬ï¼ˆä½¿ç”¨redis.pcallï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; EVAL <span class="string">&quot;redis.pcall(&#x27;set&#x27;, &#x27;key1&#x27;, &#x27;newvalue&#x27;); redis.pcall(&#x27;incr&#x27;, &#x27;key2&#x27;); local result = redis.pcall(&#x27;incr&#x27;, &#x27;key1&#x27;); return result;&quot;</span> 0</span><br><span class="line">(error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥ç»“æœ</span></span><br><span class="line">127.0.0.1:6379&gt; GET key1</span><br><span class="line"><span class="string">&quot;newvalue&quot;</span>  <span class="comment"># âœ… ç¬¬ä¸€ä¸ªSETæˆåŠŸäº†ï¼</span></span><br><span class="line">127.0.0.1:6379&gt; GET key2</span><br><span class="line"><span class="string">&quot;1&quot;</span>         <span class="comment"># âœ… key2ä¹Ÿåˆ›å»ºå¹¶è‡ªå¢äº†ï¼</span></span><br></pre></td></tr></table></figure><p><strong>ç»“è®º</strong>ï¼šä½¿ç”¨<code>redis.pcall()</code>æ—¶ï¼Œ<strong>å¤±è´¥çš„å‘½ä»¤ä¸ä¼šä¸­æ–­è„šæœ¬</strong>ï¼Œå·²æ‰§è¡Œçš„å‘½ä»¤ä¼šç”Ÿæ•ˆï¼ˆéƒ¨åˆ†æˆåŠŸï¼‰ã€‚</p><p><strong>3. å®Œæ•´çš„é”™è¯¯å¤„ç†ç¤ºä¾‹</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è½¬è´¦è„šæœ¬ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰</span></span><br><span class="line"><span class="keyword">local</span> balance1 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;get&quot;</span>, KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">local</span> balance2 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;get&quot;</span>, KEYS[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ£€æŸ¥é”™è¯¯</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(balance1) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> balance1.err <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;è´¦æˆ·1ä¸å­˜åœ¨&quot;</span>&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(balance2) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> balance2.err <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;è´¦æˆ·2ä¸å­˜åœ¨&quot;</span>&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- è½¬æ¢ä¸ºæ•°å­—</span></span><br><span class="line"><span class="keyword">local</span> bal1 = <span class="built_in">tonumber</span>(balance1) <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">local</span> bal2 = <span class="built_in">tonumber</span>(balance2) <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ£€æŸ¥ä½™é¢</span></span><br><span class="line"><span class="keyword">if</span> bal1 &lt; <span class="built_in">tonumber</span>(ARGV[<span class="number">1</span>]) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;ä½™é¢ä¸è¶³&quot;</span>&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‰§è¡Œè½¬è´¦</span></span><br><span class="line"><span class="keyword">local</span> result1 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;decrby&quot;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">local</span> result2 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;incrby&quot;</span>, KEYS[<span class="number">2</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ£€æŸ¥è½¬è´¦ç»“æœ</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(result1) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> result1.err <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;æ‰£æ¬¾å¤±è´¥: &quot;</span> .. result1.err&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(result2) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> result2.err <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- æ‰£æ¬¾æˆåŠŸä½†åŠ æ¬¾å¤±è´¥ï¼Œéœ€è¦å›æ»š</span></span><br><span class="line">    redis.<span class="built_in">pcall</span>(<span class="string">&quot;incrby&quot;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">1</span>])  <span class="comment">-- å›æ»š</span></span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;åŠ æ¬¾å¤±è´¥: &quot;</span> .. result2.err&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;ok = <span class="string">&quot;è½¬è´¦æˆåŠŸ&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p><strong>4. å¯¹æ¯”æ€»ç»“</strong></p><table><thead><tr><th>åœºæ™¯</th><th>redis.call()</th><th>redis.pcall()</th></tr></thead><tbody><tr><td><strong>å‘½ä»¤æˆåŠŸ</strong></td><td>âœ… æ­£å¸¸æ‰§è¡Œ</td><td>âœ… æ­£å¸¸æ‰§è¡Œ</td></tr><tr><td><strong>å‘½ä»¤å¤±è´¥</strong></td><td>âŒ <strong>è„šæœ¬ä¸­æ–­</strong>ï¼Œæ‰€æœ‰å‘½ä»¤å›æ»š</td><td>âš ï¸ <strong>è¿”å›é”™è¯¯å¯¹è±¡</strong>ï¼Œå·²æ‰§è¡Œå‘½ä»¤ç”Ÿæ•ˆ</td></tr><tr><td><strong>åŸå­æ€§</strong></td><td>âœ… <strong>å®Œå…¨åŸå­æ€§</strong>ï¼ˆå…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥ï¼‰</td><td>âš ï¸ <strong>éƒ¨åˆ†åŸå­æ€§</strong>ï¼ˆå¯èƒ½å‡ºç°éƒ¨åˆ†æˆåŠŸï¼‰</td></tr><tr><td><strong>é”™è¯¯å¤„ç†</strong></td><td>éœ€è¦try-catchï¼ˆLua 5.1+ï¼‰</td><td>å¯ä»¥æ£€æŸ¥è¿”å›å€¼</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>éœ€è¦ä¸¥æ ¼åŸå­æ€§çš„åœºæ™¯</td><td>éœ€è¦å®¹é”™å¤„ç†çš„åœºæ™¯</td></tr></tbody></table><p><strong>5. æœ€ä½³å®è·µå»ºè®®</strong></p><p><strong>âœ… æ¨èåšæ³•1ï¼šä½¿ç”¨ <code>redis.call()</code> + é”™è¯¯æ£€æŸ¥</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç§’æ€è„šæœ¬ï¼ˆæ¨èï¼‰</span></span><br><span class="line"><span class="keyword">local</span> stock = redis.call(<span class="string">&quot;get&quot;</span>, KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> stock == <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>  <span class="comment">-- åº“å­˜ä¸å­˜åœ¨</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">tonumber</span>(stock) &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>  <span class="comment">-- åº“å­˜ä¸è¶³</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¦‚æœè¿™é‡Œå¤±è´¥ï¼Œæ•´ä¸ªè„šæœ¬ä¼šå›æ»šï¼ˆç¬¦åˆä¸šåŠ¡é€»è¾‘ï¼‰</span></span><br><span class="line">redis.call(<span class="string">&quot;decr&quot;</span>, KEYS[<span class="number">1</span>])</span><br><span class="line">redis.call(<span class="string">&quot;sadd&quot;</span>, KEYS[<span class="number">2</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>âœ… æ¨èåšæ³•2ï¼šä½¿ç”¨ <code>redis.pcall()</code> + æ‰‹åŠ¨å›æ»š</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è½¬è´¦è„šæœ¬ï¼ˆéœ€è¦å®¹é”™ï¼‰</span></span><br><span class="line"><span class="keyword">local</span> result1 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;decrby&quot;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(result1) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> result1.err <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;æ‰£æ¬¾å¤±è´¥&quot;</span>&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> result2 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;incrby&quot;</span>, KEYS[<span class="number">2</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span>(result2) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> result2.err <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- åŠ æ¬¾å¤±è´¥ï¼Œå›æ»šæ‰£æ¬¾</span></span><br><span class="line">    redis.<span class="built_in">pcall</span>(<span class="string">&quot;incrby&quot;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> &#123;err = <span class="string">&quot;åŠ æ¬¾å¤±è´¥ï¼Œå·²å›æ»š&quot;</span>&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;ok = <span class="string">&quot;è½¬è´¦æˆåŠŸ&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p><strong>âŒ ä¸æ¨èåšæ³•ï¼šæ··ç”¨ <code>redis.call()</code> å’Œ <code>redis.pcall()</code></strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- âŒ ä¸æ¨èï¼šæ··ç”¨ä¼šå¯¼è‡´è¡Œä¸ºä¸ä¸€è‡´</span></span><br><span class="line"><span class="keyword">local</span> result1 = redis.call(<span class="string">&quot;set&quot;</span>, <span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>)  <span class="comment">-- å¤±è´¥ä¼šä¸­æ–­</span></span><br><span class="line"><span class="keyword">local</span> result2 = redis.<span class="built_in">pcall</span>(<span class="string">&quot;incr&quot;</span>, <span class="string">&quot;key2&quot;</span>)          <span class="comment">-- å¤±è´¥ä¸ä¼šä¸­æ–­</span></span><br><span class="line"><span class="comment">-- è¡Œä¸ºä¸ä¸€è‡´ï¼Œéš¾ä»¥é¢„æµ‹</span></span><br></pre></td></tr></table></figure><p><strong>6. å®é™…åº”ç”¨åœºæ™¯é€‰æ‹©</strong></p><table><thead><tr><th>åœºæ™¯</th><th>æ¨èå‡½æ•°</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>ç§’æ€&#x2F;æŠ¢è´­</strong></td><td><code>redis.call()</code></td><td>éœ€è¦ä¸¥æ ¼åŸå­æ€§ï¼Œå¤±è´¥åº”è¯¥å…¨éƒ¨å›æ»š</td></tr><tr><td><strong>è½¬è´¦&#x2F;æ”¯ä»˜</strong></td><td><code>redis.pcall()</code> + å›æ»š</td><td>éœ€è¦å®¹é”™ï¼Œå¤±è´¥æ—¶éœ€è¦æ‰‹åŠ¨å›æ»š</td></tr><tr><td><strong>æ‰¹é‡æ“ä½œ</strong></td><td><code>redis.call()</code></td><td>è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</td></tr><tr><td><strong>æ•°æ®è¿ç§»</strong></td><td><code>redis.pcall()</code></td><td>éƒ¨åˆ†å¤±è´¥ä¸å½±å“æ•´ä½“è¿›åº¦</td></tr></tbody></table><p><strong>7. æ€»ç»“</strong></p><p><strong>Luaè„šæœ¬çš„åŸå­æ€§ä¿è¯</strong>ï¼š</p><ol><li><strong>è„šæœ¬æ‰§è¡Œä¸è¢«ä¸­æ–­</strong>ï¼šâœ… è„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’é˜Ÿ</li><li><strong>å‘½ä»¤æ‰§è¡Œçš„åŸå­æ€§</strong>ï¼š<ul><li>ä½¿ç”¨<code>redis.call()</code>ï¼šâœ… <strong>å®Œå…¨åŸå­æ€§</strong>ï¼ˆå…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥ï¼‰</li><li>ä½¿ç”¨<code>redis.pcall()</code>ï¼šâš ï¸ <strong>éƒ¨åˆ†åŸå­æ€§</strong>ï¼ˆå¯èƒ½å‡ºç°éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥ï¼‰</li></ul></li></ol><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li><code>redis.call()</code>ï¼š<strong>ä¸¥æ ¼åŸå­æ€§</strong>ï¼Œé€‚åˆéœ€è¦â€è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥â€çš„åœºæ™¯</li><li><code>redis.pcall()</code>ï¼š<strong>å®¹é”™å¤„ç†</strong>ï¼Œé€‚åˆéœ€è¦å¤„ç†éƒ¨åˆ†å¤±è´¥ã€æ‰‹åŠ¨å›æ»šçš„åœºæ™¯</li><li><strong>é€‰æ‹©å»ºè®®</strong>ï¼šå¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä½¿ç”¨<code>redis.call()</code>ï¼Œéœ€è¦å®¹é”™æ—¶ä½¿ç”¨<code>redis.pcall()</code> + æ‰‹åŠ¨å›æ»š</li></ul><p><strong>8. æ€§èƒ½è€ƒè™‘</strong></p><p><strong>Luaè„šæœ¬ vs MULTI&#x2F;EXECæ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>MULTI&#x2F;EXEC</th><th>Luaè„šæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç½‘ç»œå¾€è¿”</strong></td><td>Næ¬¡ï¼ˆNä¸ªå‘½ä»¤ï¼‰</td><td>1æ¬¡</td><td>Luaè„šæœ¬å‡å°‘ç½‘ç»œå¼€é”€</td></tr><tr><td><strong>æ‰§è¡Œé€Ÿåº¦</strong></td><td>è¾ƒå¿«</td><td>æœ€å¿«</td><td>Luaè„šæœ¬æœåŠ¡å™¨ç«¯æ‰§è¡Œ</td></tr><tr><td><strong>åŸå­æ€§</strong></td><td>éƒ¨åˆ†</td><td>å®Œå…¨ï¼ˆä½¿ç”¨redis.call()ï¼‰</td><td>Luaè„šæœ¬ä¿è¯æ›´å¼º</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç®€å•æ‰¹é‡æ“ä½œ</td><td>å¤æ‚é€»è¾‘</td><td>æ ¹æ®éœ€æ±‚é€‰æ‹©</td></tr></tbody></table><p><strong>æ€»ç»“</strong>ï¼š</p><p>Luaè„šæœ¬èƒ½ä¿è¯åŸå­æ€§çš„<strong>æ ¹æœ¬åŸå› </strong>ï¼š</p><ol><li>âœ… <strong>Rediså•çº¿ç¨‹æ¨¡å‹</strong>ï¼šåŒä¸€æ—¶åˆ»åªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡</li><li>âœ… <strong>è„šæœ¬ä½œä¸ºæ•´ä½“</strong>ï¼šè„šæœ¬è¢«è§†ä¸ºä¸€ä¸ªå®Œæ•´çš„å‘½ä»¤å•å…ƒ</li><li>âœ… <strong>æ‰§è¡ŒæœŸé—´ä¸ä¸­æ–­</strong>ï¼šè„šæœ¬æ‰§è¡ŒæœŸé—´ä¸ä¼šå¤„ç†å…¶ä»–å‘½ä»¤</li><li>âœ… <strong>é˜Ÿåˆ—é¡ºåºä¿è¯</strong>ï¼šå‘½ä»¤é˜Ÿåˆ—ä¿è¯FIFOé¡ºåº</li></ol><p>å› æ­¤ï¼ŒLuaè„šæœ¬åœ¨Redisä¸­å…·æœ‰<strong>æœ€å¼ºçš„åŸå­æ€§ä¿è¯</strong>ï¼Œæ˜¯å¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘å’Œé«˜å¹¶å‘åœºæ™¯çš„<strong>æœ€ä½³é€‰æ‹©</strong>ï¼</p><p><strong>ç§’æ€Luaè„šæœ¬</strong>ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç§’æ€è„šæœ¬ï¼šseckill.lua</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">-- KEYS[1]: ç”¨æˆ·ID</span></span><br><span class="line"><span class="comment">-- KEYS[2]: å•†å“ID</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‹¼æ¥key</span></span><br><span class="line"><span class="keyword">local</span> userid = KEYS[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">local</span> prodid = KEYS[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">local</span> qtkey = <span class="string">&quot;sk:&quot;</span> .. prodid .. <span class="string">&quot;:qt&quot;</span>       <span class="comment">-- åº“å­˜key</span></span><br><span class="line"><span class="keyword">local</span> usersKey = <span class="string">&quot;sk:&quot;</span> .. prodid .. <span class="string">&quot;:usr&quot;</span>   <span class="comment">-- ç”¨æˆ·é›†åˆkey</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å‚ä¸</span></span><br><span class="line"><span class="keyword">local</span> userExists = redis.call(<span class="string">&quot;sismember&quot;</span>, usersKey, userid)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">tonumber</span>(userExists) == <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>    <span class="comment">-- è¿”å›2ï¼šç”¨æˆ·å·²å‚ä¸</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. æ£€æŸ¥åº“å­˜</span></span><br><span class="line"><span class="keyword">local</span> num = redis.call(<span class="string">&quot;get&quot;</span>, qtkey)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">tonumber</span>(num) &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>    <span class="comment">-- è¿”å›0ï¼šåº“å­˜ä¸è¶³</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æ‰£å‡åº“å­˜ï¼Œè®°å½•ç”¨æˆ·</span></span><br><span class="line">redis.call(<span class="string">&quot;decr&quot;</span>, qtkey)</span><br><span class="line">redis.call(<span class="string">&quot;sadd&quot;</span>, usersKey, userid)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>    <span class="comment">-- è¿”å›1ï¼šç§’æ€æˆåŠŸ</span></span><br></pre></td></tr></table></figure><p><strong>Javaè°ƒç”¨Luaè„šæœ¬</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SeckillWithLua</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Luaè„šæœ¬å†…å®¹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SECKILL_SCRIPT</span> <span class="operator">=</span> </span><br><span class="line">        <span class="string">&quot;local userid = KEYS[1]; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;local prodid = KEYS[2]; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;local qtkey = &#x27;sk:&#x27; .. prodid .. &#x27;:qt&#x27;; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;local usersKey = &#x27;sk:&#x27; .. prodid .. &#x27;:usr&#x27;; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;local userExists = redis.call(&#x27;sismember&#x27;, usersKey, userid); &quot;</span> +</span><br><span class="line">        <span class="string">&quot;if tonumber(userExists) == 1 then &quot;</span> +</span><br><span class="line">        <span class="string">&quot;    return 2; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;end; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;local num = redis.call(&#x27;get&#x27;, qtkey); &quot;</span> +</span><br><span class="line">        <span class="string">&quot;if tonumber(num) &lt;= 0 then &quot;</span> +</span><br><span class="line">        <span class="string">&quot;    return 0; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;else &quot;</span> +</span><br><span class="line">        <span class="string">&quot;    redis.call(&#x27;decr&#x27;, qtkey); &quot;</span> +</span><br><span class="line">        <span class="string">&quot;    redis.call(&#x27;sadd&#x27;, usersKey, userid); &quot;</span> +</span><br><span class="line">        <span class="string">&quot;end; &quot;</span> +</span><br><span class="line">        <span class="string">&quot;return 1;&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œç§’æ€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">doSeckill</span><span class="params">(String userId, String productId)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡ŒLuaè„šæœ¬</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> jedis.eval(</span><br><span class="line">                SECKILL_SCRIPT,</span><br><span class="line">                <span class="number">2</span>,  <span class="comment">// keyæ•°é‡</span></span><br><span class="line">                userId,</span><br><span class="line">                productId</span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// è§£æè¿”å›å€¼</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">resultCode</span> <span class="operator">=</span> String.valueOf(result);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">switch</span> (resultCode) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;0&quot;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;ç§’æ€å·²ç»“æŸ&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;ç§’æ€æˆåŠŸï¼&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;æ‚¨å·²å‚åŠ è¿‡ç§’æ€&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;ç§’æ€å¼‚å¸¸&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            jedis.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–ç§’æ€å•†å“</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initSeckill</span><span class="params">(String productId, <span class="type">int</span> stock)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">stockKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:qt&quot;</span>;</span><br><span class="line">        jedis.set(stockKey, String.valueOf(stock));</span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢ç§’æ€ç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">getSeckillResult</span><span class="params">(String productId)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">stockKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:qt&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userKey</span> <span class="operator">=</span> <span class="string">&quot;sk:&quot;</span> + productId + <span class="string">&quot;:usr&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;remainStock&quot;</span>, jedis.get(stockKey));</span><br><span class="line">        result.put(<span class="string">&quot;successUsers&quot;</span>, jedis.smembers(userKey));</span><br><span class="line">        result.put(<span class="string">&quot;successCount&quot;</span>, jedis.scard(userKey));</span><br><span class="line">        </span><br><span class="line">        jedis.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SeckillTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">SeckillWithLua</span> <span class="variable">seckill</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SeckillWithLua</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. åˆå§‹åŒ–å•†å“åº“å­˜</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">productId</span> <span class="operator">=</span> <span class="string">&quot;iphone15&quot;</span>;</span><br><span class="line">        seckill.initSeckill(productId, <span class="number">100</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆå§‹åŒ–åº“å­˜ï¼š100ä»¶&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æ¨¡æ‹Ÿ1000ä¸ªç”¨æˆ·å¹¶å‘æŠ¢è´­</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">threadCount</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">latch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(threadCount);</span><br><span class="line">        </span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; threadCount; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> <span class="string">&quot;user&quot;</span> + i;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                seckill.doSeckill(userId, productId);</span><br><span class="line">                latch.countDown();</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        latch.await();  <span class="comment">// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. æŸ¥è¯¢ç§’æ€ç»“æœ</span></span><br><span class="line">        Map&lt;String, Object&gt; result = seckill.getSeckillResult(productId);</span><br><span class="line">        System.out.println(<span class="string">&quot;==================== ç§’æ€ç»“æœ ====================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å‰©ä½™åº“å­˜: &quot;</span> + result.get(<span class="string">&quot;remainStock&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆåŠŸäººæ•°: &quot;</span> + result.get(<span class="string">&quot;successCount&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;è€—æ—¶: &quot;</span> + (endTime - startTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;===============================================&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç»“æœ</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åˆå§‹åŒ–åº“å­˜ï¼š100ä»¶</span><br><span class="line">ç§’æ€æˆåŠŸï¼</span><br><span class="line">ç§’æ€æˆåŠŸï¼</span><br><span class="line">ç§’æ€å·²ç»“æŸ</span><br><span class="line">æ‚¨å·²å‚åŠ è¿‡ç§’æ€</span><br><span class="line">...</span><br><span class="line">==================== ç§’æ€ç»“æœ ====================</span><br><span class="line">å‰©ä½™åº“å­˜: 0</span><br><span class="line">æˆåŠŸäººæ•°: 100</span><br><span class="line">è€—æ—¶: 156ms</span><br><span class="line">===============================================</span><br></pre></td></tr></table></figure><h4 id="7-7-5-ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”"><a href="#7-7-5-ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="7.7.5 ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”"></a>7.7.5 ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”</h4><table><thead><tr><th>æ–¹æ¡ˆ</th><th>è¶…å–é—®é¢˜</th><th>æ€§èƒ½</th><th>å¹¶å‘èƒ½åŠ›</th><th>å®ç°å¤æ‚åº¦</th><th>æ¨èæŒ‡æ•°</th></tr></thead><tbody><tr><td><strong>åŸºç¡€äº‹åŠ¡</strong></td><td>âŒ å­˜åœ¨</td><td>â­â­â­â­</td><td>â­â­</td><td>â­ ç®€å•</td><td>â­</td></tr><tr><td><strong>ä¹è§‚é”ï¼ˆWATCHï¼‰</strong></td><td>âœ… è§£å†³</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­ ä¸­ç­‰</td><td>â­â­â­</td></tr><tr><td><strong>Luaè„šæœ¬</strong></td><td>âœ… è§£å†³</td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>â­â­â­ è¾ƒé«˜</td><td>â­â­â­â­â­</td></tr></tbody></table><p><strong>æ€§èƒ½æµ‹è¯•å¯¹æ¯”</strong>ï¼ˆ10000å¹¶å‘ï¼Œ100åº“å­˜ï¼‰ï¼š</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>è€—æ—¶</th><th>æˆåŠŸç‡</th><th>è¶…å–æƒ…å†µ</th></tr></thead><tbody><tr><td>åŸºç¡€äº‹åŠ¡</td><td>~50ms</td><td>100%</td><td>âŒ åº“å­˜-15ï¼ˆè¶…å–15ä»¶ï¼‰</td></tr><tr><td>ä¹è§‚é”</td><td>~800ms</td><td>1%</td><td>âœ… æ— è¶…å–</td></tr><tr><td>Luaè„šæœ¬</td><td>~150ms</td><td>1%</td><td>âœ… æ— è¶…å–</td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p><ul><li>ğŸ† <strong>ç”Ÿäº§ç¯å¢ƒæ¨è</strong>ï¼šLuaè„šæœ¬æ–¹æ¡ˆ</li><li>ğŸ¯ <strong>å­¦ä¹ æ¨è</strong>ï¼šä¹è§‚é”æ–¹æ¡ˆï¼ˆç†è§£åŸç†ï¼‰</li><li>âŒ <strong>ä¸æ¨è</strong>ï¼šåŸºç¡€äº‹åŠ¡æ–¹æ¡ˆï¼ˆä»…ç”¨äºæ¼”ç¤ºï¼‰</li></ul><h3 id="7-8-Redisäº‹åŠ¡æœ€ä½³å®è·µ"><a href="#7-8-Redisäº‹åŠ¡æœ€ä½³å®è·µ" class="headerlink" title="7.8 Redisäº‹åŠ¡æœ€ä½³å®è·µ"></a>7.8 Redisäº‹åŠ¡æœ€ä½³å®è·µ</h3><h4 id="7-8-1-ä½•æ—¶ä½¿ç”¨äº‹åŠ¡"><a href="#7-8-1-ä½•æ—¶ä½¿ç”¨äº‹åŠ¡" class="headerlink" title="7.8.1 ä½•æ—¶ä½¿ç”¨äº‹åŠ¡"></a>7.8.1 ä½•æ—¶ä½¿ç”¨äº‹åŠ¡</h4><p><strong>âœ… é€‚åˆä½¿ç”¨äº‹åŠ¡çš„åœºæ™¯</strong>ï¼š</p><ol><li><p><strong>æ‰¹é‡æ“ä½œ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰¹é‡è®¾ç½®å¤šä¸ªkey</span></span><br><span class="line">MULTI</span><br><span class="line">SET user:1001 <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">SET user:1002 <span class="string">&quot;æå››&quot;</span></span><br><span class="line">SET user:1003 <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></li><li><p><strong>ç›¸å…³è”çš„å¤šä¸ªæ“ä½œ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½¬è´¦ï¼šAè´¦æˆ·å‡100ï¼ŒBè´¦æˆ·åŠ 100</span></span><br><span class="line">MULTI</span><br><span class="line">DECRBY account:A 100</span><br><span class="line">INCRBY account:B 100</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></li><li><p><strong>éœ€è¦åŸå­æ€§çš„æ“ä½œ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å•†å“ç§’æ€ï¼šå‡åº“å­˜+è®°å½•ç”¨æˆ·</span></span><br><span class="line">WATCH stock</span><br><span class="line">MULTI</span><br><span class="line">DECR stock</span><br><span class="line">SADD buyers user123</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></li></ol><p><strong>âŒ ä¸é€‚åˆä½¿ç”¨äº‹åŠ¡çš„åœºæ™¯</strong>ï¼š</p><ol><li><p><strong>å•ä¸ªç®€å•å‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸éœ€è¦äº‹åŠ¡</span></span><br><span class="line">SET key value</span><br><span class="line"></span><br><span class="line"><span class="comment"># è€Œä¸æ˜¯</span></span><br><span class="line">MULTI</span><br><span class="line">SET key value</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></li><li><p><strong>éœ€è¦æ ¹æ®ä¸­é—´ç»“æœå†³å®šåç»­æ“ä½œ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># äº‹åŠ¡ä¸­æ— æ³•è·å–ä¸­é—´ç»“æœ</span></span><br><span class="line">MULTI</span><br><span class="line">GET balance</span><br><span class="line"><span class="comment"># âŒ æ— æ³•æ ¹æ®balanceçš„å€¼å†³å®šæ˜¯å¦æ‰§è¡Œä¸‹ä¸€æ­¥</span></span><br><span class="line">DECRBY balance 100</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></li><li><p><strong>éœ€è¦å¼ºä¸€è‡´æ€§å’Œå›æ»š</strong>ï¼š</p><ul><li>Redisäº‹åŠ¡ä¸æ”¯æŒå›æ»š</li><li>è€ƒè™‘ä½¿ç”¨Luaè„šæœ¬æˆ–ä¼ ç»Ÿæ•°æ®åº“</li></ul></li></ol><h4 id="7-8-2-äº‹åŠ¡ä¼˜åŒ–å»ºè®®"><a href="#7-8-2-äº‹åŠ¡ä¼˜åŒ–å»ºè®®" class="headerlink" title="7.8.2 äº‹åŠ¡ä¼˜åŒ–å»ºè®®"></a>7.8.2 äº‹åŠ¡ä¼˜åŒ–å»ºè®®</h4><p><strong>1. ä½¿ç”¨WATCHé¿å…å¹¶å‘å†²çª</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨WATCH</span></span><br><span class="line">jedis.watch(<span class="string">&quot;balance&quot;</span>);</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">tx.decrby(<span class="string">&quot;balance&quot;</span>, <span class="number">100</span>);</span><br><span class="line">tx.exec();</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ ä¸å¥½çš„åšæ³•ï¼šä¸ä½¿ç”¨WATCH</span></span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">tx.decrby(<span class="string">&quot;balance&quot;</span>, <span class="number">100</span>);</span><br><span class="line">tx.exec();</span><br></pre></td></tr></table></figure><p><strong>2. å‡å°‘äº‹åŠ¡ä¸­çš„å‘½ä»¤æ•°é‡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># âœ… å¥½çš„åšæ³•ï¼šåªåŒ…å«å¿…è¦çš„å‘½ä»¤</span></span><br><span class="line">MULTI</span><br><span class="line">DECR stock</span><br><span class="line">SADD buyers user123</span><br><span class="line">EXEC</span><br><span class="line"></span><br><span class="line"><span class="comment"># âŒ ä¸å¥½çš„åšæ³•ï¼šåŒ…å«è¿‡å¤šå‘½ä»¤</span></span><br><span class="line">MULTI</span><br><span class="line">GET key1</span><br><span class="line">GET key2</span><br><span class="line">GET key3</span><br><span class="line"><span class="comment"># ... æ›´å¤šå‘½ä»¤</span></span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure><p><strong>3. ä½¿ç”¨Luaè„šæœ¬æ›¿ä»£å¤æ‚äº‹åŠ¡</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- âœ… å¥½çš„åšæ³•ï¼šå¤æ‚é€»è¾‘ç”¨Luaè„šæœ¬</span></span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;stock&quot;</span>) &gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    redis.call(<span class="string">&quot;decr&quot;</span>, <span class="string">&quot;stock&quot;</span>)</span><br><span class="line">    redis.call(<span class="string">&quot;sadd&quot;</span>, <span class="string">&quot;buyers&quot;</span>, KEYS[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p><strong>4. æ·»åŠ é‡è¯•æœºåˆ¶</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… å¥½çš„åšæ³•ï¼šæ·»åŠ é‡è¯•</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">    jedis.watch(<span class="string">&quot;stock&quot;</span>);</span><br><span class="line">    <span class="comment">// ... äº‹åŠ¡æ“ä½œ</span></span><br><span class="line">    List&lt;Object&gt; result = tx.exec();</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¤±è´¥ï¼Œé‡è¯•</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><h4 id="7-8-3-å¸¸è§é”™è¯¯"><a href="#7-8-3-å¸¸è§é”™è¯¯" class="headerlink" title="7.8.3 å¸¸è§é”™è¯¯"></a>7.8.3 å¸¸è§é”™è¯¯</h4><p><strong>é”™è¯¯1ï¼šåœ¨äº‹åŠ¡ä¸­è·å–ä¸­é—´ç»“æœ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šæ— æ³•åœ¨äº‹åŠ¡ä¸­è·å–ç»“æœ</span></span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">Response&lt;String&gt; balance = tx.get(<span class="string">&quot;balance&quot;</span>);</span><br><span class="line"><span class="comment">// balance.get()ä¼šæŠ›å‡ºå¼‚å¸¸ï¼äº‹åŠ¡æœªæ‰§è¡Œï¼Œæ— æ³•è·å–ç»“æœ</span></span><br><span class="line">tx.exec();</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šå…ˆè·å–ï¼Œå†äº‹åŠ¡</span></span><br><span class="line"><span class="type">String</span> <span class="variable">balance</span> <span class="operator">=</span> jedis.get(<span class="string">&quot;balance&quot;</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">balanceInt</span> <span class="operator">=</span> Integer.parseInt(balance);</span><br><span class="line"><span class="keyword">if</span> (balanceInt &gt;= <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">    tx.decrby(<span class="string">&quot;balance&quot;</span>, <span class="number">100</span>);</span><br><span class="line">    tx.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é”™è¯¯2ï¼šå¿˜è®°è°ƒç”¨EXEC</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šå¿˜è®°EXEC</span></span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">tx.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line"><span class="comment">// å¿˜è®°è°ƒç”¨tx.exec()ï¼Œå‘½ä»¤ä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šè°ƒç”¨EXEC</span></span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">tx.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">tx.exec();</span><br></pre></td></tr></table></figure><p><strong>é”™è¯¯3ï¼šWATCHåä¸æ£€æŸ¥EXECç»“æœ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šä¸æ£€æŸ¥ç»“æœ</span></span><br><span class="line">jedis.watch(<span class="string">&quot;key&quot;</span>);</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">tx.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">tx.exec();  <span class="comment">// å¯èƒ½è¿”å›nullï¼ˆè¢«ä¿®æ”¹ï¼‰ï¼Œä½†æ²¡æœ‰æ£€æŸ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šæ£€æŸ¥ç»“æœ</span></span><br><span class="line">jedis.watch(<span class="string">&quot;key&quot;</span>);</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> jedis.multi();</span><br><span class="line">tx.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">List&lt;Object&gt; result = tx.exec();</span><br><span class="line"><span class="keyword">if</span> (result == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// äº‹åŠ¡å¤±è´¥ï¼Œå¤„ç†é‡è¯•é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-9-æ€»ç»“"><a href="#7-9-æ€»ç»“" class="headerlink" title="7.9 æ€»ç»“"></a>7.9 æ€»ç»“</h3><h4 id="Redisäº‹åŠ¡æ ¸å¿ƒè¦ç‚¹"><a href="#Redisäº‹åŠ¡æ ¸å¿ƒè¦ç‚¹" class="headerlink" title="Redisäº‹åŠ¡æ ¸å¿ƒè¦ç‚¹"></a>Redisäº‹åŠ¡æ ¸å¿ƒè¦ç‚¹</h4><table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å‘½ä»¤</strong></td><td>MULTIã€EXECã€DISCARDã€WATCHã€UNWATCH</td></tr><tr><td><strong>æ‰§è¡Œæµç¨‹</strong></td><td>å¼€å¯ â†’ ç»„é˜Ÿ â†’ æ‰§è¡Œ</td></tr><tr><td><strong>éš”ç¦»æ€§</strong></td><td>âœ… å•ç‹¬éš”ç¦»ï¼Œä¸ä¼šè¢«æ‰“æ–­</td></tr><tr><td><strong>åŸå­æ€§</strong></td><td>âš ï¸ éƒ¨åˆ†åŸå­æ€§ï¼Œä¸æ”¯æŒå›æ»š</td></tr><tr><td><strong>ä¸€è‡´æ€§</strong></td><td>âš ï¸ å¼€å‘è€…ä¿è¯</td></tr><tr><td><strong>å¹¶å‘æ§åˆ¶</strong></td><td>WATCHï¼ˆä¹è§‚é”ï¼‰</td></tr><tr><td><strong>æœ€ä½³æ–¹æ¡ˆ</strong></td><td>Luaè„šæœ¬ï¼ˆåŸå­æ€§æœ€å¼ºï¼‰</td></tr></tbody></table><h4 id="äº‹åŠ¡-vs-Luaè„šæœ¬"><a href="#äº‹åŠ¡-vs-Luaè„šæœ¬" class="headerlink" title="äº‹åŠ¡ vs Luaè„šæœ¬"></a>äº‹åŠ¡ vs Luaè„šæœ¬</h4><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>Redisäº‹åŠ¡</th><th>Luaè„šæœ¬</th></tr></thead><tbody><tr><td><strong>åŸå­æ€§</strong></td><td>âš ï¸ éƒ¨åˆ†åŸå­æ€§ï¼ˆä¸å›æ»šï¼‰</td><td>âœ… å®Œå…¨åŸå­æ€§</td></tr><tr><td><strong>å¤æ‚é€»è¾‘</strong></td><td>âŒ ä¸æ”¯æŒæ¡ä»¶åˆ¤æ–­</td><td>âœ… æ”¯æŒif&#x2F;else&#x2F;å¾ªç¯</td></tr><tr><td><strong>ä¸­é—´ç»“æœ</strong></td><td>âŒ æ— æ³•è·å–</td><td>âœ… å¯ä»¥è·å–å’Œä½¿ç”¨</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>â­â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td><strong>å®ç°å¤æ‚åº¦</strong></td><td>â­â­ ç®€å•</td><td>â­â­â­ è¾ƒé«˜</td></tr><tr><td><strong>æ¨èåœºæ™¯</strong></td><td>ç®€å•æ‰¹é‡æ“ä½œ</td><td>å¤æ‚ä¸šåŠ¡é€»è¾‘</td></tr></tbody></table><h4 id="å­¦ä¹ å»ºè®®"><a href="#å­¦ä¹ å»ºè®®" class="headerlink" title="å­¦ä¹ å»ºè®®"></a>å­¦ä¹ å»ºè®®</h4><ol><li><strong>ç†è§£åŸç†</strong>ï¼šæŒæ¡MULTI&#x2F;EXEC&#x2F;WATCHçš„å·¥ä½œæœºåˆ¶</li><li><strong>å®è·µæ¼”ç»ƒ</strong>ï¼šè‡ªå·±ç¼–å†™ç§’æ€æ¡ˆä¾‹ï¼Œç†è§£å¹¶å‘é—®é¢˜</li><li><strong>å­¦ä¹ Lua</strong>ï¼šæŒæ¡Luaè„šæœ¬ï¼Œç”¨äºå¤æ‚åœºæ™¯</li><li><strong>æ€§èƒ½æµ‹è¯•</strong>ï¼šå¯¹æ¯”ä¸åŒæ–¹æ¡ˆçš„æ€§èƒ½å·®å¼‚</li><li><strong>ç”Ÿäº§å®è·µ</strong>ï¼šåœ¨é¡¹ç›®ä¸­åˆç†é€‰æ‹©äº‹åŠ¡æˆ–Luaè„šæœ¬</li></ol><h2 id="8-RedisæŒä¹…åŒ–"><a href="#8-RedisæŒä¹…åŒ–" class="headerlink" title="8. RedisæŒä¹…åŒ–"></a>8. RedisæŒä¹…åŒ–</h2><h3 id="8-1-ä»€ä¹ˆæ˜¯æŒä¹…åŒ–"><a href="#8-1-ä»€ä¹ˆæ˜¯æŒä¹…åŒ–" class="headerlink" title="8.1 ä»€ä¹ˆæ˜¯æŒä¹…åŒ–"></a>8.1 ä»€ä¹ˆæ˜¯æŒä¹…åŒ–</h3><p><strong>æŒä¹…åŒ–å®šä¹‰</strong>ï¼š</p><ul><li>Redisæ˜¯<strong>å†…å­˜æ•°æ®åº“</strong>ï¼Œæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­</li><li>æœåŠ¡å™¨é‡å¯æˆ–å®•æœºï¼Œå†…å­˜ä¸­çš„æ•°æ®ä¼š<strong>ä¸¢å¤±</strong></li><li><strong>æŒä¹…åŒ–</strong>å°±æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®<strong>ä¿å­˜åˆ°ç£ç›˜</strong>ï¼Œä»¥ä¾¿åœ¨Redisé‡å¯åèƒ½å¤Ÿæ¢å¤æ•°æ®</li></ul><p><strong>æŒä¹…åŒ–çš„å¿…è¦æ€§</strong>ï¼š</p><ul><li>âœ… <strong>æ•°æ®å®‰å…¨</strong>ï¼šé˜²æ­¢æ•°æ®ä¸¢å¤±</li><li>âœ… <strong>ç¾éš¾æ¢å¤</strong>ï¼šæœåŠ¡å™¨æ•…éšœåèƒ½å¤Ÿæ¢å¤æ•°æ®</li><li>âœ… <strong>æ•°æ®å¤‡ä»½</strong>ï¼šå¯ä»¥å®šæœŸå¤‡ä»½æ•°æ®</li></ul><p><strong>RedisæŒä¹…åŒ–æ–¹å¼</strong>ï¼š</p><table><thead><tr><th>æŒä¹…åŒ–æ–¹å¼</th><th>è¯´æ˜</th><th>ç‰ˆæœ¬è¦æ±‚</th></tr></thead><tbody><tr><td><strong>RDB</strong></td><td>å¿«ç…§æ–¹å¼ï¼Œå®šæœŸä¿å­˜æ•°æ®å¿«ç…§</td><td>Redis 1.0+</td></tr><tr><td><strong>AOF</strong></td><td>æ—¥å¿—æ–¹å¼ï¼Œè®°å½•æ¯ä¸ªå†™æ“ä½œ</td><td>Redis 1.1+</td></tr><tr><td><strong>æ··åˆæŒä¹…åŒ–</strong></td><td>RDB + AOFï¼Œç»“åˆä¸¤è€…ä¼˜åŠ¿</td><td>Redis 4.0+</td></tr></tbody></table><h3 id="8-2-RDBæŒä¹…åŒ–"><a href="#8-2-RDBæŒä¹…åŒ–" class="headerlink" title="8.2 RDBæŒä¹…åŒ–"></a>8.2 RDBæŒä¹…åŒ–</h3><h4 id="8-2-1-ä»€ä¹ˆæ˜¯RDB"><a href="#8-2-1-ä»€ä¹ˆæ˜¯RDB" class="headerlink" title="8.2.1 ä»€ä¹ˆæ˜¯RDB"></a>8.2.1 ä»€ä¹ˆæ˜¯RDB</h4><p><strong>RDBï¼ˆRedis Databaseï¼‰</strong>ï¼š</p><ul><li><strong>å…¨ç§°</strong>ï¼šRedis Database Backup file</li><li><strong>åŸç†</strong>ï¼šåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…ï¼Œå°†å†…å­˜ä¸­çš„**æ•°æ®é›†å¿«ç…§ï¼ˆSnapshotï¼‰**å†™å…¥ç£ç›˜</li><li><strong>æ¢å¤æ–¹å¼</strong>ï¼šå°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œ</li></ul><p><strong>RDBæ–‡ä»¶</strong>ï¼š</p><ul><li><strong>é»˜è®¤æ–‡ä»¶å</strong>ï¼š<code>dump.rdb</code></li><li><strong>æ–‡ä»¶æ ¼å¼</strong>ï¼šäºŒè¿›åˆ¶å‹ç¼©æ–‡ä»¶</li><li><strong>å­˜å‚¨ä½ç½®</strong>ï¼šRediså·¥ä½œç›®å½•ï¼ˆå¯é€šè¿‡<code>dir</code>é…ç½®ï¼‰</li></ul><h4 id="8-2-2-RDBæŒä¹…åŒ–æµç¨‹"><a href="#8-2-2-RDBæŒä¹…åŒ–æµç¨‹" class="headerlink" title="8.2.2 RDBæŒä¹…åŒ–æµç¨‹"></a>8.2.2 RDBæŒä¹…åŒ–æµç¨‹</h4><p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[è§¦å‘RDBæŒä¹…åŒ–]</span><br><span class="line">    â†“</span><br><span class="line">[Redisä¸»è¿›ç¨‹forkå­è¿›ç¨‹]</span><br><span class="line">    â†“</span><br><span class="line">[å­è¿›ç¨‹å°†æ•°æ®å†™å…¥ä¸´æ—¶æ–‡ä»¶]</span><br><span class="line">    â†“</span><br><span class="line">[æŒä¹…åŒ–å®Œæˆï¼Œç”¨ä¸´æ—¶æ–‡ä»¶æ›¿æ¢æ—§æ–‡ä»¶]</span><br><span class="line">    â†“</span><br><span class="line">[ä¸»è¿›ç¨‹ç»§ç»­å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚]</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‰¹ç‚¹</strong>ï¼š</p><ul><li>âœ… <strong>å¼‚æ­¥æ‰§è¡Œ</strong>ï¼šä¸»è¿›ç¨‹ä¸è¿›è¡ŒIOæ“ä½œï¼Œç¡®ä¿é«˜æ€§èƒ½</li><li>âœ… <strong>ä¸é˜»å¡</strong>ï¼šæŒä¹…åŒ–æœŸé—´å¯ä»¥å“åº”å®¢æˆ·ç«¯è¯·æ±‚</li><li>âœ… <strong>åŸå­æ€§</strong>ï¼šä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§</li></ul><p><strong>æµç¨‹å›¾</strong>ï¼š</p><p><img src="/images/redis/RDB%E5%B0%8F%E6%80%BB%E7%BB%93.png" alt="RDBæŒä¹…åŒ–æµç¨‹"></p><h4 id="8-2-3-Forkæœºåˆ¶è¯¦è§£"><a href="#8-2-3-Forkæœºåˆ¶è¯¦è§£" class="headerlink" title="8.2.3 Forkæœºåˆ¶è¯¦è§£"></a>8.2.3 Forkæœºåˆ¶è¯¦è§£</h4><p><strong>ä»€ä¹ˆæ˜¯Forkï¼Ÿ</strong></p><p>Forkæ˜¯Linux&#x2F;Unixç³»ç»Ÿä¸­çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äº<strong>å¤åˆ¶ä¸€ä¸ªä¸å½“å‰è¿›ç¨‹å®Œå…¨ç›¸åŒçš„å­è¿›ç¨‹</strong>ã€‚</p><p><strong>Forkçš„ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ–°è¿›ç¨‹çš„æ‰€æœ‰æ•°æ®ï¼ˆå˜é‡ã€ç¯å¢ƒå˜é‡ã€ç¨‹åºè®¡æ•°å™¨ç­‰ï¼‰éƒ½å’ŒåŸè¿›ç¨‹ä¸€è‡´</li><li>æ˜¯ä¸€ä¸ª<strong>å…¨æ–°çš„è¿›ç¨‹</strong>ï¼Œå¹¶ä½œä¸ºåŸè¿›ç¨‹çš„<strong>å­è¿›ç¨‹</strong></li><li>çˆ¶å­è¿›ç¨‹<strong>ç‹¬ç«‹è¿è¡Œ</strong>ï¼Œäº’ä¸å½±å“</li></ul><p><strong>å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼ˆCopy-On-Writeï¼ŒCOWï¼‰</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">çˆ¶è¿›ç¨‹å†…å­˜ç©ºé—´</span><br><span class="line">    â†“</span><br><span class="line">Forkå­è¿›ç¨‹</span><br><span class="line">    â†“</span><br><span class="line">çˆ¶å­è¿›ç¨‹å…±äº«åŒä¸€æ®µç‰©ç†å†…å­˜ï¼ˆåˆå§‹çŠ¶æ€ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">å½“çˆ¶è¿›ç¨‹æˆ–å­è¿›ç¨‹ä¿®æ”¹æ•°æ®æ—¶</span><br><span class="line">    â†“</span><br><span class="line">Linuxå†…æ ¸å°†ä¿®æ”¹çš„é¡µé¢å¤åˆ¶ä¸€ä»½ç»™ä¿®æ”¹çš„è¿›ç¨‹</span><br><span class="line">    â†“</span><br><span class="line">çˆ¶å­è¿›ç¨‹å„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´</span><br></pre></td></tr></table></figure><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… <strong>èŠ‚çœå†…å­˜</strong>ï¼šåˆå§‹æ—¶çˆ¶å­è¿›ç¨‹å…±äº«å†…å­˜</li><li>âœ… <strong>æé«˜æ€§èƒ½</strong>ï¼šåªæœ‰ä¿®æ”¹æ—¶æ‰å¤åˆ¶ï¼Œå‡å°‘å†…å­˜æ‹·è´</li><li>âœ… <strong>å¿«é€Ÿåˆ›å»º</strong>ï¼šforkæ“ä½œéå¸¸å¿«</li></ul><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ Forkæ—¶ï¼Œå†…å­˜ä¸­çš„æ•°æ®è¢«å…‹éš†äº†ä¸€ä»½ï¼Œå¤§è‡´<strong>2å€çš„è†¨èƒ€æ€§</strong>éœ€è¦è€ƒè™‘</li><li>âš ï¸ å¦‚æœæ•°æ®åºå¤§ï¼Œforkæ“ä½œè¿˜æ˜¯æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½</li><li>âš ï¸ å†™æ—¶å¤åˆ¶æŠ€æœ¯è™½ç„¶ä¼˜åŒ–äº†å†…å­˜ä½¿ç”¨ï¼Œä½†å¤§é‡æ•°æ®ä¿®æ”¹æ—¶ä»ä¼šæœ‰æ€§èƒ½å½±å“</li></ul><h4 id="8-2-4-RDBè§¦å‘æ–¹å¼"><a href="#8-2-4-RDBè§¦å‘æ–¹å¼" class="headerlink" title="8.2.4 RDBè§¦å‘æ–¹å¼"></a>8.2.4 RDBè§¦å‘æ–¹å¼</h4><p><strong>1. è‡ªåŠ¨è§¦å‘ï¼ˆé…ç½®æ–‡ä»¶ï¼‰</strong></p><p><strong>é…ç½®æ ¼å¼</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">save &lt;seconds&gt; &lt;changes&gt;</span><br></pre></td></tr></table></figure><p><strong>é»˜è®¤é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">save 900 1      <span class="comment"># 900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…è‡³å°‘1ä¸ªkeyå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">save 300 10     <span class="comment"># 300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…è‡³å°‘10ä¸ªkeyå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">save 60 10000   <span class="comment"># 60ç§’ï¼ˆ1åˆ†é’Ÿï¼‰å†…è‡³å°‘10000ä¸ªkeyå‘ç”Ÿå˜åŒ–</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®è¯´æ˜</strong>ï¼š</p><ul><li>æ»¡è¶³<strong>ä»»æ„ä¸€ä¸ªæ¡ä»¶</strong>å°±ä¼šè§¦å‘RDBæŒä¹…åŒ–</li><li>å¤šä¸ªæ¡ä»¶ä¹‹é—´æ˜¯**æˆ–ï¼ˆORï¼‰**å…³ç³»</li><li>å¯ä»¥é…ç½®å¤šä¸ªsaveè§„åˆ™</li></ul><p><strong>ç¤ºä¾‹é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line">save 3600 1     <span class="comment"># 1å°æ—¶å†…è‡³å°‘1ä¸ªkeyå˜åŒ–</span></span><br><span class="line">save 1800 100   <span class="comment"># 30åˆ†é’Ÿå†…è‡³å°‘100ä¸ªkeyå˜åŒ–</span></span><br><span class="line">save 300 1000   <span class="comment"># 5åˆ†é’Ÿå†…è‡³å°‘1000ä¸ªkeyå˜åŒ–</span></span><br></pre></td></tr></table></figure><p><strong>ç¦ç”¨è‡ªåŠ¨è§¦å‘</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹æ³•1ï¼šæ³¨é‡Šæ‰æ‰€æœ‰saveé…ç½®</span></span><br><span class="line"><span class="comment"># save 900 1</span></span><br><span class="line"><span class="comment"># save 300 10</span></span><br><span class="line"><span class="comment"># save 60 10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2ï¼šè®¾ç½®ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">save <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>2. æ‰‹åŠ¨è§¦å‘</strong></p><p><strong>SAVEå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SAVE</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>âŒ <strong>é˜»å¡å¼</strong>ï¼šæ‰§è¡ŒSAVEæ—¶ï¼ŒRedis<strong>é˜»å¡æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚</strong></li><li>âŒ <strong>ä¸æ¨è</strong>ï¼šç”Ÿäº§ç¯å¢ƒä¸å»ºè®®ä½¿ç”¨</li><li>âœ… <strong>åŒæ­¥æ‰§è¡Œ</strong>ï¼šå‘½ä»¤æ‰§è¡Œå®Œæ¯•æ‰è¿”å›</li></ul><p><strong>BGSAVEå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; BGSAVE</span><br><span class="line">Background saving started by pid 12345</span><br></pre></td></tr></table></figure><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>âœ… <strong>éé˜»å¡</strong>ï¼šåå°å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡å®¢æˆ·ç«¯è¯·æ±‚</li><li>âœ… <strong>æ¨èä½¿ç”¨</strong>ï¼šç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨</li><li>âœ… <strong>è¿”å›è¿›ç¨‹ID</strong>ï¼šå¯ä»¥æŸ¥çœ‹æŒä¹…åŒ–è¿›ç¨‹</li></ul><p><strong>æŸ¥çœ‹æŒä¹…åŒ–çŠ¶æ€</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æœ€åä¸€æ¬¡æˆåŠŸæ‰§è¡Œå¿«ç…§çš„æ—¶é—´</span></span><br><span class="line">127.0.0.1:6379&gt; LASTSAVE</span><br><span class="line">(<span class="built_in">integer</span>) 1699123456</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŒä¹…åŒ–æ˜¯å¦æ­£åœ¨è¿›è¡Œ</span></span><br><span class="line">127.0.0.1:6379&gt; INFO persistence</span><br><span class="line"><span class="comment"># Persistence</span></span><br><span class="line">rdb_changes_since_last_save:0</span><br><span class="line">rdb_bgsave_in_progress:0    <span class="comment"># 0è¡¨ç¤ºæ²¡æœ‰è¿›è¡Œï¼Œ1è¡¨ç¤ºæ­£åœ¨è¿›è¡Œ</span></span><br><span class="line">rdb_last_save_time:1699123456</span><br><span class="line">rdb_last_bgsave_status:ok</span><br></pre></td></tr></table></figure><p><strong>3. ç‰¹æ®Šè§¦å‘</strong></p><p><strong>FLUSHALLå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; FLUSHALL</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><ul><li>âš ï¸ æ‰§è¡Œ<code>FLUSHALL</code>å‘½ä»¤ä¼š<strong>æ¸…ç©ºæ‰€æœ‰æ•°æ®</strong></li><li>âš ï¸ åŒæ—¶ä¼š<strong>è§¦å‘RDBæŒä¹…åŒ–</strong>ï¼Œä½†ç”Ÿæˆçš„<code>dump.rdb</code>æ–‡ä»¶æ˜¯<strong>ç©ºçš„</strong></li><li>âš ï¸ è¿™ä¸ªæ–‡ä»¶<strong>æ— æ„ä¹‰</strong>ï¼Œä¸è¦ç”¨äºæ¢å¤</li></ul><p><strong>SHUTDOWNå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SHUTDOWN</span><br></pre></td></tr></table></figure><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ‰§è¡Œ<code>SHUTDOWN</code>æ—¶ä¼š<strong>è‡ªåŠ¨æ‰§è¡ŒSAVE</strong>ï¼ˆå¦‚æœé…ç½®äº†RDBï¼‰</li><li>ç¡®ä¿æ•°æ®åœ¨å…³é—­å‰è¢«ä¿å­˜</li></ul><h4 id="8-2-5-RDBé…ç½®è¯¦è§£"><a href="#8-2-5-RDBé…ç½®è¯¦è§£" class="headerlink" title="8.2.5 RDBé…ç½®è¯¦è§£"></a>8.2.5 RDBé…ç½®è¯¦è§£</h4><p><strong>1. æ–‡ä»¶é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RDBæ–‡ä»¶å</span></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># RDBæ–‡ä»¶ä¿å­˜è·¯å¾„</span></span><br><span class="line"><span class="built_in">dir</span> /var/lib/redis/</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºRediså¯åŠ¨ç›®å½•ï¼‰</span></span><br><span class="line"><span class="built_in">dir</span> ./</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å½“å‰é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; CONFIG GET <span class="built_in">dir</span></span><br><span class="line">1) <span class="string">&quot;dir&quot;</span></span><br><span class="line">2) <span class="string">&quot;/var/lib/redis&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; CONFIG GET dbfilename</span><br><span class="line">1) <span class="string">&quot;dbfilename&quot;</span></span><br><span class="line">2) <span class="string">&quot;dump.rdb&quot;</span></span><br></pre></td></tr></table></figure><p><strong>2. å‹ç¼©é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¯å¦å‹ç¼©RDBæ–‡ä»¶</span></span><br><span class="line">rdbcompression <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li><code>yes</code>ï¼šä½¿ç”¨<strong>LZFç®—æ³•</strong>å‹ç¼©RDBæ–‡ä»¶</li><li><code>no</code>ï¼šä¸å‹ç¼©ï¼Œæ–‡ä»¶æ›´å¤§ä½†CPUæ¶ˆè€—æ›´å°‘</li><li><strong>æ¨è</strong>ï¼š<code>yes</code>ï¼ˆå‹ç¼©å¯ä»¥æ˜¾è‘—å‡å°‘æ–‡ä»¶å¤§å°ï¼‰</li></ul><p><strong>å‹ç¼©æ•ˆæœ</strong>ï¼š</p><ul><li>å‹ç¼©å‰ï¼š100MB</li><li>å‹ç¼©åï¼šçº¦20-30MBï¼ˆå–å†³äºæ•°æ®ç‰¹å¾ï¼‰</li><li><strong>å‹ç¼©æ¯”</strong>ï¼šé€šå¸¸ä¸º3:1åˆ°5:1</li></ul><p><strong>3. å®Œæ•´æ€§æ ¡éªŒ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¯å¦åœ¨RDBæ–‡ä»¶æœ«å°¾æ·»åŠ CRC64æ ¡éªŒå’Œ</span></span><br><span class="line">rdbchecksum <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li><code>yes</code>ï¼šä½¿ç”¨<strong>CRC64ç®—æ³•</strong>è¿›è¡Œæ•°æ®æ ¡éªŒ</li><li><code>no</code>ï¼šä¸æ ¡éªŒï¼Œæ€§èƒ½æå‡çº¦10%ï¼Œä½†æ•°æ®å®Œæ•´æ€§æ— æ³•ä¿è¯</li><li><strong>æ¨è</strong>ï¼š<code>yes</code>ï¼ˆç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼‰</li></ul><p><strong>4. é”™è¯¯å¤„ç†</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“bgsaveå‡ºé”™æ—¶ï¼Œæ˜¯å¦åœæ­¢å†™å…¥</span></span><br><span class="line">stop-writes-on-bgsave-error <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li><code>yes</code>ï¼šå½“RDBæŒä¹…åŒ–å¤±è´¥æ—¶ï¼Œ<strong>åœæ­¢æ¥å—å†™æ“ä½œ</strong></li><li><code>no</code>ï¼šå³ä½¿RDBå¤±è´¥ï¼Œä¹Ÿç»§ç»­æ¥å—å†™æ“ä½œ</li><li><strong>æ¨è</strong>ï¼š<code>yes</code>ï¼ˆç¡®ä¿æ•°æ®å®‰å…¨ï¼‰</li></ul><p><strong>å®Œæ•´é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RDBé…ç½®</span></span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"><span class="built_in">dir</span> /var/lib/redis/</span><br><span class="line"></span><br><span class="line">rdbcompression <span class="built_in">yes</span></span><br><span class="line">rdbchecksum <span class="built_in">yes</span></span><br><span class="line">stop-writes-on-bgsave-error <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><h4 id="8-2-6-RDBå¤‡ä»½ä¸æ¢å¤"><a href="#8-2-6-RDBå¤‡ä»½ä¸æ¢å¤" class="headerlink" title="8.2.6 RDBå¤‡ä»½ä¸æ¢å¤"></a>8.2.6 RDBå¤‡ä»½ä¸æ¢å¤</h4><p><strong>1. RDBå¤‡ä»½</strong></p><p><strong>æ­¥éª¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. æŸ¥çœ‹RDBæ–‡ä»¶ç›®å½•</span></span><br><span class="line">127.0.0.1:6379&gt; CONFIG GET <span class="built_in">dir</span></span><br><span class="line">1) <span class="string">&quot;dir&quot;</span></span><br><span class="line">2) <span class="string">&quot;/var/lib/redis&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ‰‹åŠ¨è§¦å‘å¤‡ä»½ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; BGSAVE</span><br><span class="line">Background saving started by pid 12345</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ç­‰å¾…å¤‡ä»½å®Œæˆï¼ˆæŸ¥çœ‹çŠ¶æ€ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; INFO persistence</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ rdb_bgsave_in_progress:0 è¡¨ç¤ºå®Œæˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å¤åˆ¶RDBæ–‡ä»¶åˆ°å¤‡ä»½ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> /var/lib/redis/dump.rdb /backup/redis/dump_$(<span class="built_in">date</span> +%Y%m%d_%H%M%S).rdb</span><br></pre></td></tr></table></figure><p><strong>è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># backup_rdb.sh</span></span><br><span class="line"></span><br><span class="line">REDIS_CLI=<span class="string">&quot;/usr/local/bin/redis-cli&quot;</span></span><br><span class="line">BACKUP_DIR=<span class="string">&quot;/backup/redis&quot;</span></span><br><span class="line">RDB_DIR=<span class="string">&quot;/var/lib/redis&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§¦å‘å¤‡ä»½</span></span><br><span class="line"><span class="variable">$REDIS_CLI</span> BGSAVE</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰å¾…å¤‡ä»½å®Œæˆ</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;<span class="subst">$($REDIS_CLI INFO persistence | grep rdb_bgsave_in_progress | cut -d: -f2 | tr -d &#x27;\r&#x27;)</span>&quot;</span> != <span class="string">&quot;0&quot;</span> ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">sleep</span> 1</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶æ–‡ä»¶</span></span><br><span class="line">TIMESTAMP=$(<span class="built_in">date</span> +%Y%m%d_%H%M%S)</span><br><span class="line"><span class="built_in">cp</span> <span class="variable">$RDB_DIR</span>/dump.rdb <span class="variable">$BACKUP_DIR</span>/dump_<span class="variable">$TIMESTAMP</span>.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤7å¤©å‰çš„å¤‡ä»½</span></span><br><span class="line">find <span class="variable">$BACKUP_DIR</span> -name <span class="string">&quot;dump_*.rdb&quot;</span> -mtime +7 -delete</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Backup completed: dump_<span class="variable">$TIMESTAMP</span>.rdb&quot;</span></span><br></pre></td></tr></table></figure><p><strong>2. RDBæ¢å¤</strong></p><p><strong>æ­¥éª¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åœæ­¢RedisæœåŠ¡</span></span><br><span class="line">redis-cli SHUTDOWN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å¤‡ä»½å½“å‰RDBæ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰</span></span><br><span class="line"><span class="built_in">cp</span> /var/lib/redis/dump.rdb /var/lib/redis/dump.rdb.bak</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¤åˆ¶å¤‡ä»½æ–‡ä»¶åˆ°å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> /backup/redis/dump_20231117_120000.rdb /var/lib/redis/dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. ç¡®ä¿æ–‡ä»¶æƒé™æ­£ç¡®</span></span><br><span class="line"><span class="built_in">chown</span> redis:redis /var/lib/redis/dump.rdb</span><br><span class="line"><span class="built_in">chmod</span> 644 /var/lib/redis/dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. å¯åŠ¨Redis</span></span><br><span class="line">redis-server /etc/redis/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. éªŒè¯æ•°æ®</span></span><br><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 1000</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ æ¢å¤æ—¶<strong>å¿…é¡»åœæ­¢Redis</strong>ï¼Œå¦åˆ™å¯èƒ½è¦†ç›–æ•°æ®</li><li>âš ï¸ ç¡®ä¿å¤‡ä»½æ–‡ä»¶çš„<strong>æƒé™æ­£ç¡®</strong></li><li>âš ï¸ æ¢å¤å<strong>éªŒè¯æ•°æ®å®Œæ•´æ€§</strong></li></ul><h4 id="8-2-7-RDBä¼˜ç¼ºç‚¹åˆ†æ"><a href="#8-2-7-RDBä¼˜ç¼ºç‚¹åˆ†æ" class="headerlink" title="8.2.7 RDBä¼˜ç¼ºç‚¹åˆ†æ"></a>8.2.7 RDBä¼˜ç¼ºç‚¹åˆ†æ</h4><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é€‚åˆå¤§è§„æ¨¡æ•°æ®æ¢å¤</strong></td><td>æ¢å¤é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤§æ•°æ®é‡åœºæ™¯</td></tr><tr><td><strong>æ–‡ä»¶ä½“ç§¯å°</strong></td><td>å‹ç¼©åæ–‡ä»¶å°ï¼ŒèŠ‚çœç£ç›˜ç©ºé—´</td></tr><tr><td><strong>æ¢å¤é€Ÿåº¦å¿«</strong></td><td>ç›´æ¥åŠ è½½åˆ°å†…å­˜ï¼Œæ¯”AOFå¿«å¾ˆå¤š</td></tr><tr><td><strong>å¯¹æ€§èƒ½å½±å“å°</strong></td><td>å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ä¸»è¿›ç¨‹</td></tr><tr><td><strong>é€‚åˆå¤‡ä»½</strong></td><td>å¯ä»¥å®šæœŸå¤‡ä»½ï¼Œä¾¿äºç¾éš¾æ¢å¤</td></tr></tbody></table><p><strong>åŠ£åŠ¿</strong>ï¼š</p><table><thead><tr><th>åŠ£åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ•°æ®å¯èƒ½ä¸¢å¤±</strong></td><td>æœ€åä¸€æ¬¡å¿«ç…§åçš„æ•°æ®ä¼šä¸¢å¤±</td></tr><tr><td><strong>Forkæ¶ˆè€—æ€§èƒ½</strong></td><td>å¤§æ•°æ®é‡æ—¶forkæ“ä½œè€—æ—¶</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>Forkæ—¶å†…å­˜å¯èƒ½è†¨èƒ€åˆ°2å€</td></tr><tr><td><strong>ä¸é€‚åˆå®æ—¶å¤‡ä»½</strong></td><td>åªèƒ½å®šæœŸå¤‡ä»½ï¼Œä¸èƒ½å®æ—¶ä¿å­˜</td></tr></tbody></table><p><strong>æ•°æ®ä¸¢å¤±é£é™©</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´çº¿ï¼š</span><br><span class="line">T1: æ‰§è¡ŒRDBå¿«ç…§ï¼ˆä¿å­˜äº†T1æ—¶åˆ»çš„æ•°æ®ï¼‰</span><br><span class="line">T2: æ•°æ®ä¿®æ”¹ï¼ˆæœªä¿å­˜ï¼‰</span><br><span class="line">T3: æ•°æ®ä¿®æ”¹ï¼ˆæœªä¿å­˜ï¼‰</span><br><span class="line">T4: Rediså®•æœº âŒ</span><br><span class="line"></span><br><span class="line">ç»“æœï¼šT1åˆ°T4ä¹‹é—´çš„æ•°æ®å…¨éƒ¨ä¸¢å¤±</span><br></pre></td></tr></table></figure><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ˜¯å¦é€‚åˆ</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>æ•°æ®å¤‡ä»½</strong></td><td>âœ… é€‚åˆ</td><td>å®šæœŸå¤‡ä»½ï¼Œæ–‡ä»¶å°</td></tr><tr><td><strong>ç¾éš¾æ¢å¤</strong></td><td>âœ… é€‚åˆ</td><td>æ¢å¤é€Ÿåº¦å¿«</td></tr><tr><td><strong>æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜</strong></td><td>âŒ ä¸é€‚åˆ</td><td>å¯èƒ½ä¸¢å¤±æ•°æ®</td></tr><tr><td><strong>å®æ—¶æ€§è¦æ±‚é«˜</strong></td><td>âŒ ä¸é€‚åˆ</td><td>åªèƒ½å®šæœŸä¿å­˜</td></tr><tr><td><strong>å¤§è§„æ¨¡æ•°æ®</strong></td><td>âœ… é€‚åˆ</td><td>æ¢å¤é€Ÿåº¦å¿«</td></tr></tbody></table><h4 id="8-2-8-åŠ¨æ€åœæ­¢RDB"><a href="#8-2-8-åŠ¨æ€åœæ­¢RDB" class="headerlink" title="8.2.8 åŠ¨æ€åœæ­¢RDB"></a>8.2.8 åŠ¨æ€åœæ­¢RDB</h4><p><strong>æ–¹æ³•1ï¼šæ¸…ç©ºsaveé…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; CONFIG SET save <span class="string">&quot;&quot;</span></span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ³•2ï¼šæ³¨é‡Šé…ç½®æ–‡ä»¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘redis.conf</span></span><br><span class="line"><span class="comment"># save 900 1</span></span><br><span class="line"><span class="comment"># save 300 10</span></span><br><span class="line"><span class="comment"># save 60 10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯Redisæˆ–æ‰§è¡Œ</span></span><br><span class="line">127.0.0.1:6379&gt; CONFIG REWRITE</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; CONFIG GET save</span><br><span class="line">1) <span class="string">&quot;save&quot;</span></span><br><span class="line">2) <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="8-3-AOFæŒä¹…åŒ–"><a href="#8-3-AOFæŒä¹…åŒ–" class="headerlink" title="8.3 AOFæŒä¹…åŒ–"></a>8.3 AOFæŒä¹…åŒ–</h3><h4 id="8-3-1-ä»€ä¹ˆæ˜¯AOF"><a href="#8-3-1-ä»€ä¹ˆæ˜¯AOF" class="headerlink" title="8.3.1 ä»€ä¹ˆæ˜¯AOF"></a>8.3.1 ä»€ä¹ˆæ˜¯AOF</h4><p><strong>AOFï¼ˆAppend Only Fileï¼‰</strong>ï¼š</p><ul><li><strong>å…¨ç§°</strong>ï¼šAppend Only Fileï¼ˆåªè¿½åŠ æ–‡ä»¶ï¼‰</li><li><strong>åŸç†</strong>ï¼šä»¥<strong>æ—¥å¿—å½¢å¼</strong>è®°å½•æ¯ä¸ª<strong>å†™æ“ä½œ</strong>ï¼ˆå¢é‡ä¿å­˜ï¼‰</li><li><strong>ç‰¹ç‚¹</strong>ï¼šåªè¿½åŠ æ–‡ä»¶ï¼Œ<strong>ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶</strong></li><li><strong>æ¢å¤æ–¹å¼</strong>ï¼šRediså¯åŠ¨æ—¶è¯»å–AOFæ–‡ä»¶ï¼Œé‡æ–°æ‰§è¡Œæ‰€æœ‰å†™æ“ä½œ</li></ul><p><strong>AOFæ–‡ä»¶</strong>ï¼š</p><ul><li><strong>é»˜è®¤æ–‡ä»¶å</strong>ï¼š<code>appendonly.aof</code></li><li><strong>æ–‡ä»¶æ ¼å¼</strong>ï¼šæ–‡æœ¬æ–‡ä»¶ï¼ˆå¯è¯»ï¼‰</li><li><strong>å­˜å‚¨ä½ç½®</strong>ï¼šä¸RDBæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ï¼ˆé€šè¿‡<code>dir</code>é…ç½®ï¼‰</li></ul><p><strong>AOF vs RDB</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>RDB</th><th>AOF</th></tr></thead><tbody><tr><td><strong>è®°å½•æ–¹å¼</strong></td><td>å¿«ç…§ï¼ˆSnapshotï¼‰</td><td>æ—¥å¿—ï¼ˆLogï¼‰</td></tr><tr><td><strong>æ–‡ä»¶æ ¼å¼</strong></td><td>äºŒè¿›åˆ¶å‹ç¼©</td><td>æ–‡æœ¬æ–‡ä»¶</td></tr><tr><td><strong>è®°å½•å†…å®¹</strong></td><td>æ•°æ®æœ¬èº«</td><td>å†™æ“ä½œå‘½ä»¤</td></tr><tr><td><strong>æ–‡ä»¶å¤§å°</strong></td><td>å°</td><td>å¤§</td></tr><tr><td><strong>æ¢å¤é€Ÿåº¦</strong></td><td>å¿«</td><td>æ…¢</td></tr><tr><td><strong>æ•°æ®ä¸¢å¤±</strong></td><td>å¯èƒ½ä¸¢å¤±</td><td>å‡ ä¹ä¸ä¸¢å¤±</td></tr></tbody></table><h4 id="8-3-2-AOFæŒä¹…åŒ–æµç¨‹"><a href="#8-3-2-AOFæŒä¹…åŒ–æµç¨‹" class="headerlink" title="8.3.2 AOFæŒä¹…åŒ–æµç¨‹"></a>8.3.2 AOFæŒä¹…åŒ–æµç¨‹</h4><p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[å®¢æˆ·ç«¯å‘é€å†™å‘½ä»¤]</span><br><span class="line">    â†“</span><br><span class="line">[å‘½ä»¤è¿½åŠ åˆ°AOFç¼“å†²åŒº]</span><br><span class="line">    â†“</span><br><span class="line">[æ ¹æ®åŒæ­¥ç­–ç•¥åŒæ­¥åˆ°ç£ç›˜]</span><br><span class="line">    â†“</span><br><span class="line">[AOFæ–‡ä»¶å¤§å°è¶…è¿‡é˜ˆå€¼]</span><br><span class="line">    â†“</span><br><span class="line">[è§¦å‘AOFé‡å†™ï¼ˆå‹ç¼©ï¼‰]</span><br><span class="line">    â†“</span><br><span class="line">[Redisé‡å¯æ—¶åŠ è½½AOFæ–‡ä»¶]</span><br><span class="line">    â†“</span><br><span class="line">[é‡æ–°æ‰§è¡Œæ‰€æœ‰å†™æ“ä½œæ¢å¤æ•°æ®]</span><br></pre></td></tr></table></figure><p><strong>è¯¦ç»†æ­¥éª¤</strong>ï¼š</p><ol><li><strong>å‘½ä»¤è¿½åŠ </strong>ï¼šå®¢æˆ·ç«¯çš„è¯·æ±‚å†™å‘½ä»¤ä¼šè¢«<code>append</code>è¿½åŠ åˆ°AOFç¼“å†²åŒºå†…</li><li><strong>åŒæ­¥åˆ°ç£ç›˜</strong>ï¼šAOFç¼“å†²åŒºæ ¹æ®AOFæŒä¹…åŒ–ç­–ç•¥ï¼ˆalways&#x2F;everysec&#x2F;noï¼‰å°†æ“ä½œ<code>sync</code>åŒæ­¥åˆ°ç£ç›˜çš„AOFæ–‡ä»¶ä¸­</li><li><strong>AOFé‡å†™</strong>ï¼šAOFæ–‡ä»¶å¤§å°è¶…è¿‡é‡å†™ç­–ç•¥æˆ–æ‰‹åŠ¨é‡å†™æ—¶ï¼Œä¼šå¯¹AOFæ–‡ä»¶<code>rewrite</code>é‡å†™ï¼Œå‹ç¼©AOFæ–‡ä»¶å®¹é‡</li><li><strong>æ•°æ®æ¢å¤</strong>ï¼šRedisæœåŠ¡é‡å¯æ—¶ï¼Œä¼šé‡æ–°<code>load</code>åŠ è½½AOFæ–‡ä»¶ä¸­çš„å†™æ“ä½œè¾¾åˆ°æ•°æ®æ¢å¤çš„ç›®çš„</li></ol><p><strong>æµç¨‹å›¾</strong>ï¼š</p><p><img src="/images/redis/AOF%E6%B5%81%E7%A8%8B.png" alt="AOFæŒä¹…åŒ–æµç¨‹"></p><h4 id="8-3-3-AOFé…ç½®"><a href="#8-3-3-AOFé…ç½®" class="headerlink" title="8.3.3 AOFé…ç½®"></a>8.3.3 AOFé…ç½®</h4><p><strong>1. å¼€å¯AOF</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯AOFæŒä¹…åŒ–</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AOFæ–‡ä»¶å</span></span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AOFæ–‡ä»¶ä¿å­˜è·¯å¾„ï¼ˆä¸RDBç›¸åŒï¼‰</span></span><br><span class="line"><span class="built_in">dir</span> /var/lib/redis/</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; CONFIG GET appendonly</span><br><span class="line">1) <span class="string">&quot;appendonly&quot;</span></span><br><span class="line">2) <span class="string">&quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; CONFIG GET appendfilename</span><br><span class="line">1) <span class="string">&quot;appendfilename&quot;</span></span><br><span class="line">2) <span class="string">&quot;appendonly.aof&quot;</span></span><br></pre></td></tr></table></figure><p><strong>2. AOFåŒæ­¥é¢‘ç‡</strong></p><p><strong>é…ç½®é€‰é¡¹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line">appendfsync always    <span class="comment"># å§‹ç»ˆåŒæ­¥</span></span><br><span class="line">appendfsync everysec  <span class="comment"># æ¯ç§’åŒæ­¥ï¼ˆæ¨èï¼‰</span></span><br><span class="line">appendfsync no        <span class="comment"># ä¸ä¸»åŠ¨åŒæ­¥</span></span><br></pre></td></tr></table></figure><p><strong>ä¸‰ç§ç­–ç•¥å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>ç­–ç•¥</th><th>åŒæ­¥æ—¶æœº</th><th>æ€§èƒ½</th><th>æ•°æ®å®‰å…¨æ€§</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td><strong>always</strong></td><td>æ¯æ¬¡å†™å…¥éƒ½åŒæ­¥</td><td>âŒ æœ€æ…¢</td><td>âœ… æœ€é«˜ï¼ˆå‡ ä¹ä¸ä¸¢æ•°æ®ï¼‰</td><td>â­â­</td></tr><tr><td><strong>everysec</strong></td><td>æ¯ç§’åŒæ­¥ä¸€æ¬¡</td><td>âœ… è¾ƒå¿«</td><td>âœ… è¾ƒé«˜ï¼ˆæœ€å¤šä¸¢å¤±1ç§’æ•°æ®ï¼‰</td><td>â­â­â­â­â­</td></tr><tr><td><strong>no</strong></td><td>ç”±æ“ä½œç³»ç»Ÿå†³å®š</td><td>âœ… æœ€å¿«</td><td>âš ï¸ è¾ƒä½ï¼ˆå¯èƒ½ä¸¢å¤±è¾ƒå¤šæ•°æ®ï¼‰</td><td>â­â­</td></tr></tbody></table><p><strong>è¯¦ç»†è¯´æ˜</strong>ï¼š</p><p><strong>appendfsync always</strong>ï¼š</p><ul><li>âœ… <strong>æ•°æ®æœ€å®‰å…¨</strong>ï¼šæ¯æ¬¡Rediså†™å…¥éƒ½ä¼šç«‹åˆ»è®°å…¥æ—¥å¿—</li><li>âŒ <strong>æ€§èƒ½æœ€å·®</strong>ï¼šæ¯æ¬¡å†™å…¥éƒ½è¦è¿›è¡Œç£ç›˜IO</li><li>âš ï¸ <strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚æé«˜çš„åœºæ™¯</li></ul><p><strong>appendfsync everysec</strong>ï¼š</p><ul><li>âœ… <strong>æ€§èƒ½è¾ƒå¥½</strong>ï¼šæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œå¹³è¡¡äº†æ€§èƒ½å’Œæ•°æ®å®‰å…¨</li><li>âœ… <strong>æ¨èä½¿ç”¨</strong>ï¼šç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®</li><li>âš ï¸ <strong>å¯èƒ½ä¸¢å¤±</strong>ï¼šå¦‚æœå®•æœºï¼Œæœ¬ç§’çš„æ•°æ®å¯èƒ½ä¸¢å¤±</li></ul><p><strong>appendfsync no</strong>ï¼š</p><ul><li>âœ… <strong>æ€§èƒ½æœ€å¥½</strong>ï¼šRedisä¸ä¸»åŠ¨åŒæ­¥ï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®š</li><li>âš ï¸ <strong>æ•°æ®é£é™©</strong>ï¼šå¯èƒ½ä¸¢å¤±è¾ƒå¤šæ•°æ®ï¼ˆå–å†³äºæ“ä½œç³»ç»Ÿï¼‰</li><li>âš ï¸ <strong>ä¸æ¨è</strong>ï¼šé™¤éå¯¹æ€§èƒ½è¦æ±‚æé«˜ä¸”å¯ä»¥æ¥å—æ•°æ®ä¸¢å¤±</li></ul><p><strong>3. AOFå’ŒRDBåŒæ—¶å¼€å¯</strong></p><p><strong>ä¼˜å…ˆçº§</strong>ï¼š</p><ul><li>âœ… <strong>AOFä¼˜å…ˆ</strong>ï¼šå¦‚æœAOFå’ŒRDBåŒæ—¶å¼€å¯ï¼ŒRedis<strong>é»˜è®¤ä½¿ç”¨AOF</strong>æ¢å¤æ•°æ®</li><li>âœ… <strong>æ•°æ®æ›´å®Œæ•´</strong>ï¼šAOFè®°å½•æ›´è¯¦ç»†ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±</li></ul><p><strong>éªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŒæ—¶å¼€å¯RDBå’ŒAOF</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line">save 900 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯Redisåï¼Œä¼šä¼˜å…ˆåŠ è½½AOFæ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h4 id="8-3-4-AOFé‡å†™ï¼ˆRewriteï¼‰"><a href="#8-3-4-AOFé‡å†™ï¼ˆRewriteï¼‰" class="headerlink" title="8.3.4 AOFé‡å†™ï¼ˆRewriteï¼‰"></a>8.3.4 AOFé‡å†™ï¼ˆRewriteï¼‰</h4><p><strong>1. ä»€ä¹ˆæ˜¯AOFé‡å†™</strong></p><p><strong>é—®é¢˜</strong>ï¼š</p><ul><li>AOFé‡‡ç”¨<strong>æ–‡ä»¶è¿½åŠ æ–¹å¼</strong>ï¼Œæ–‡ä»¶ä¼š<strong>è¶Šæ¥è¶Šå¤§</strong></li><li>ä¾‹å¦‚ï¼šå¯¹åŒä¸€ä¸ªkeyæ‰§è¡Œ100æ¬¡<code>INCR</code>ï¼ŒAOFæ–‡ä»¶ä¼šè®°å½•100æ¡å‘½ä»¤</li><li>å®é™…ä¸Šåªéœ€è¦ä¸€æ¡<code>SET key 100</code>å°±å¯ä»¥æ¢å¤</li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>AOFé‡å†™</strong>ï¼šå½“AOFæ–‡ä»¶å¤§å°è¶…è¿‡é˜ˆå€¼æ—¶ï¼ŒRedisä¼šå¯åŠ¨AOFæ–‡ä»¶å†…å®¹å‹ç¼©</li><li><strong>ç›®çš„</strong>ï¼šåªä¿ç•™å¯ä»¥æ¢å¤æ•°æ®çš„<strong>æœ€å°æŒ‡ä»¤é›†</strong></li><li><strong>æ•ˆæœ</strong>ï¼šå¯ä»¥æ˜¾è‘—å‡å°‘AOFæ–‡ä»¶å¤§å°</li></ul><p><strong>2. AOFé‡å†™åŸç†</strong></p><p><strong>Redis 4.0ä¹‹å‰</strong>ï¼š</p><ul><li>é‡å†™æ—¶ï¼Œéå†å†…å­˜ä¸­çš„æ•°æ®ï¼Œç”Ÿæˆå¯¹åº”çš„å†™å‘½ä»¤</li><li>å†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€åæ›¿æ¢åŸAOFæ–‡ä»¶</li></ul><p><strong>Redis 4.0ä¹‹åï¼ˆæ··åˆæŒä¹…åŒ–ï¼‰</strong>ï¼š</p><ul><li>é‡å†™æ—¶ï¼Œå°†<strong>RDBå¿«ç…§</strong>ä»¥äºŒè¿›åˆ¶å½¢å¼é™„åœ¨æ–°çš„AOFæ–‡ä»¶å¤´éƒ¨</li><li>ä½œä¸ºå·²æœ‰çš„å†å²æ•°æ®ï¼Œæ›¿æ¢æ‰åŸæ¥çš„æµæ°´è´¦æ“ä½œ</li><li><strong>ä¼˜åŠ¿</strong>ï¼šç»“åˆRDBå’ŒAOFçš„ä¼˜åŠ¿ï¼Œæ¢å¤æ›´å¿«</li></ul><p><strong>é‡å†™æµç¨‹</strong>ï¼š</p><p><img src="/images/redis/AOF%E9%87%8D%E5%86%99%E6%B5%81%E7%A8%8B.png" alt="AOFé‡å†™æµç¨‹"></p><p><strong>è¯¦ç»†æ­¥éª¤</strong>ï¼š</p><ol><li><strong>è§¦å‘é‡å†™</strong>ï¼š<code>bgrewriteaof</code>è§¦å‘é‡å†™ï¼Œåˆ¤æ–­æ˜¯å¦å½“å‰æœ‰<code>bgsave</code>æˆ–<code>bgrewriteaof</code>åœ¨è¿è¡Œï¼Œå¦‚æœæœ‰ï¼Œåˆ™ç­‰å¾…è¯¥å‘½ä»¤ç»“æŸåå†ç»§ç»­æ‰§è¡Œ</li><li><strong>Forkå­è¿›ç¨‹</strong>ï¼šä¸»è¿›ç¨‹forkå‡ºå­è¿›ç¨‹æ‰§è¡Œé‡å†™æ“ä½œï¼Œä¿è¯ä¸»è¿›ç¨‹ä¸ä¼šé˜»å¡</li><li><strong>å†™å…¥ä¸´æ—¶æ–‡ä»¶</strong>ï¼šå­è¿›ç¨‹éå†rediså†…å­˜ä¸­æ•°æ®åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯çš„å†™è¯·æ±‚åŒæ—¶å†™å…¥<code>aof_buf</code>ç¼“å†²åŒºå’Œ<code>aof_rewrite_buf</code>é‡å†™ç¼“å†²åŒºï¼Œä¿è¯åŸAOFæ–‡ä»¶å®Œæ•´ä»¥åŠæ–°AOFæ–‡ä»¶ç”ŸæˆæœŸé—´çš„æ–°çš„æ•°æ®ä¿®æ”¹åŠ¨ä½œä¸ä¼šä¸¢å¤±</li><li><strong>åˆå¹¶ç¼“å†²åŒº</strong>ï¼šå­è¿›ç¨‹å†™å®Œæ–°çš„AOFæ–‡ä»¶åï¼Œå‘ä¸»è¿›ç¨‹å‘ä¿¡å·ï¼Œçˆ¶è¿›ç¨‹æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ï¼›ä¸»è¿›ç¨‹æŠŠ<code>aof_rewrite_buf</code>ä¸­çš„æ•°æ®å†™å…¥åˆ°æ–°çš„AOFæ–‡ä»¶</li><li><strong>æ›¿æ¢æ–‡ä»¶</strong>ï¼šä½¿ç”¨æ–°çš„AOFæ–‡ä»¶è¦†ç›–æ—§çš„AOFæ–‡ä»¶ï¼Œå®ŒæˆAOFé‡å†™</li></ol><p><strong>3. AOFé‡å†™è§¦å‘æœºåˆ¶</strong></p><p><strong>è‡ªåŠ¨è§¦å‘</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å†™åŸºå‡†å€¼ï¼šæ–‡ä»¶è¾¾åˆ°ä¸Šæ¬¡é‡å†™åå¤§å°çš„100%æ—¶å¼€å§‹é‡å†™</span></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å†™åŸºå‡†å€¼ï¼šæœ€å°æ–‡ä»¶64MB</span></span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br></pre></td></tr></table></figure><p><strong>è§¦å‘æ¡ä»¶</strong>ï¼š</p><ul><li>Redisä¼šè®°å½•ä¸Šæ¬¡é‡å†™æ—¶çš„AOFå¤§å°ï¼Œè®¾ä¸º<code>base_size</code></li><li>å¦‚æœRedisçš„AOFå½“å‰å¤§å° &gt;&#x3D; <code>base_size + base_size * 100%</code>ï¼ˆé»˜è®¤ï¼‰</li><li><strong>ä¸”</strong>å½“å‰å¤§å° &gt;&#x3D; 64MBï¼ˆé»˜è®¤ï¼‰</li><li>åˆ™Redisä¼šå¯¹AOFè¿›è¡Œé‡å†™</li></ul><p><strong>ç¤ºä¾‹è®¡ç®—</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">åœºæ™¯ï¼šæ–‡ä»¶è¾¾åˆ°70MBå¼€å§‹é‡å†™ï¼Œé™åˆ°50MBï¼Œä¸‹æ¬¡ä»€ä¹ˆæ—¶å€™å¼€å§‹é‡å†™ï¼Ÿ</span><br><span class="line"></span><br><span class="line">base_size = 50MBï¼ˆä¸Šæ¬¡é‡å†™åçš„å¤§å°ï¼‰</span><br><span class="line">å½“å‰å¤§å° = 50MB</span><br><span class="line"></span><br><span class="line">è§¦å‘æ¡ä»¶ï¼š</span><br><span class="line">å½“å‰å¤§å° &gt;= base_size + base_size * 100%</span><br><span class="line">50MB &gt;= 50MB + 50MB * 100%</span><br><span class="line">50MB &gt;= 100MB âŒï¼ˆä¸æ»¡è¶³ï¼‰</span><br><span class="line"></span><br><span class="line">å½“æ–‡ä»¶è¾¾åˆ°100MBæ—¶ï¼š</span><br><span class="line">100MB &gt;= 50MB + 50MB * 100%</span><br><span class="line">100MB &gt;= 100MB âœ…ï¼ˆæ»¡è¶³ï¼‰</span><br><span class="line"></span><br><span class="line">ç­”æ¡ˆï¼š100MBæ—¶å¼€å§‹é‡å†™</span><br></pre></td></tr></table></figure><p><strong>æ‰‹åŠ¨è§¦å‘</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; BGREWRITEAOF</span><br><span class="line">Background append only file rewriting started</span><br></pre></td></tr></table></figure><p><strong>4. AOFé‡å†™é…ç½®</strong></p><p><strong>no-appendfsync-on-rewrite</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line">no-appendfsync-on-rewrite no</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜</strong>ï¼š</p><table><thead><tr><th>é…ç½®å€¼</th><th>è¡Œä¸º</th><th>æ•°æ®å®‰å…¨æ€§</th><th>æ€§èƒ½</th><th>æ¨è</th></tr></thead><tbody><tr><td><strong>yes</strong></td><td>é‡å†™æœŸé—´ä¸å†™å…¥AOFæ–‡ä»¶ï¼Œåªå†™å…¥ç¼“å­˜</td><td>âš ï¸ é™ä½ï¼ˆå¯èƒ½ä¸¢å¤±ç¼“å­˜æ•°æ®ï¼‰</td><td>âœ… æé«˜ï¼ˆä¸é˜»å¡ï¼‰</td><td>â­â­â­</td></tr><tr><td><strong>no</strong></td><td>é‡å†™æœŸé—´ç»§ç»­å†™å…¥AOFæ–‡ä»¶</td><td>âœ… æé«˜ï¼ˆæ•°æ®å®‰å…¨ï¼‰</td><td>âš ï¸ é™ä½ï¼ˆå¯èƒ½é˜»å¡ï¼‰</td><td>â­â­â­â­</td></tr></tbody></table><p><strong>æ¨èé…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿäº§ç¯å¢ƒæ¨è</span></span><br><span class="line">no-appendfsync-on-rewrite no  <span class="comment"># æ•°æ®å®‰å…¨ä¼˜å…ˆ</span></span><br></pre></td></tr></table></figure><h4 id="8-3-5-AOFå¤‡ä»½ä¸æ¢å¤"><a href="#8-3-5-AOFå¤‡ä»½ä¸æ¢å¤" class="headerlink" title="8.3.5 AOFå¤‡ä»½ä¸æ¢å¤"></a>8.3.5 AOFå¤‡ä»½ä¸æ¢å¤</h4><p><strong>1. AOFå¤‡ä»½</strong></p><p><strong>æ­¥éª¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. æŸ¥çœ‹AOFæ–‡ä»¶ç›®å½•</span></span><br><span class="line">127.0.0.1:6379&gt; CONFIG GET <span class="built_in">dir</span></span><br><span class="line">1) <span class="string">&quot;dir&quot;</span></span><br><span class="line">2) <span class="string">&quot;/var/lib/redis&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ‰‹åŠ¨è§¦å‘é‡å†™ï¼ˆå¯é€‰ï¼Œå‹ç¼©æ–‡ä»¶ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; BGREWRITEAOF</span><br><span class="line">Background append only file rewriting started</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¤åˆ¶AOFæ–‡ä»¶åˆ°å¤‡ä»½ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> /var/lib/redis/appendonly.aof /backup/redis/appendonly_$(<span class="built_in">date</span> +%Y%m%d_%H%M%S).aof</span><br></pre></td></tr></table></figure><p><strong>è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># backup_aof.sh</span></span><br><span class="line"></span><br><span class="line">REDIS_CLI=<span class="string">&quot;/usr/local/bin/redis-cli&quot;</span></span><br><span class="line">BACKUP_DIR=<span class="string">&quot;/backup/redis&quot;</span></span><br><span class="line">AOF_DIR=<span class="string">&quot;/var/lib/redis&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§¦å‘é‡å†™ï¼ˆå‹ç¼©ï¼‰</span></span><br><span class="line"><span class="variable">$REDIS_CLI</span> BGREWRITEAOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰å¾…é‡å†™å®Œæˆ</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;<span class="subst">$($REDIS_CLI INFO persistence | grep aof_rewrite_in_progress | cut -d: -f2 | tr -d &#x27;\r&#x27;)</span>&quot;</span> != <span class="string">&quot;0&quot;</span> ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">sleep</span> 1</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶æ–‡ä»¶</span></span><br><span class="line">TIMESTAMP=$(<span class="built_in">date</span> +%Y%m%d_%H%M%S)</span><br><span class="line"><span class="built_in">cp</span> <span class="variable">$AOF_DIR</span>/appendonly.aof <span class="variable">$BACKUP_DIR</span>/appendonly_<span class="variable">$TIMESTAMP</span>.aof</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤7å¤©å‰çš„å¤‡ä»½</span></span><br><span class="line">find <span class="variable">$BACKUP_DIR</span> -name <span class="string">&quot;appendonly_*.aof&quot;</span> -mtime +7 -delete</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Backup completed: appendonly_<span class="variable">$TIMESTAMP</span>.aof&quot;</span></span><br></pre></td></tr></table></figure><p><strong>2. AOFæ¢å¤</strong></p><p><strong>æ­£å¸¸æ¢å¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ä¿®æ”¹é…ç½®ï¼Œå¼€å¯AOF</span></span><br><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å°†æœ‰æ•°æ®çš„aofæ–‡ä»¶å¤åˆ¶åˆ°å¯¹åº”ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> /backup/redis/appendonly_20231117_120000.aof /var/lib/redis/appendonly.aof</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ç¡®ä¿æ–‡ä»¶æƒé™</span></span><br><span class="line"><span class="built_in">chown</span> redis:redis /var/lib/redis/appendonly.aof</span><br><span class="line"><span class="built_in">chmod</span> 644 /var/lib/redis/appendonly.aof</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å¯åŠ¨Redis</span></span><br><span class="line">redis-server /etc/redis/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. éªŒè¯æ•°æ®</span></span><br><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 1000</span><br></pre></td></tr></table></figure><p><strong>å¼‚å¸¸æ¢å¤ï¼ˆAOFæ–‡ä»¶æŸåï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. å¤‡ä»½æŸåçš„AOFæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cp</span> /var/lib/redis/appendonly.aof /var/lib/redis/appendonly.aof.bak</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. ä½¿ç”¨redis-check-aofä¿®å¤</span></span><br><span class="line">redis-check-aof --fix /var/lib/redis/appendonly.aof</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="comment"># 0x              8b: Expected prefix &#x27;*&#x27;, got: &#x27;A&#x27;</span></span><br><span class="line"><span class="comment"># AOF analyzed: size=123, ok_up_to=100, diff=23</span></span><br><span class="line"><span class="comment"># This will shrink the AOF from 123 bytes, with 23 bytes, to 100 bytes</span></span><br><span class="line"><span class="comment"># Continue? [y/N]: y</span></span><br><span class="line"><span class="comment"># Successfully truncated AOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¯åŠ¨Redis</span></span><br><span class="line">redis-server /etc/redis/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. éªŒè¯æ•°æ®</span></span><br><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; DBSIZE</span><br><span class="line">(<span class="built_in">integer</span>) 950  <span class="comment"># å¯èƒ½æ¯”åŸæ¥å°‘ï¼ˆä¸¢å¤±äº†æŸåéƒ¨åˆ†çš„æ•°æ®ï¼‰</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ ä¿®å¤AOFæ–‡ä»¶å¯èƒ½ä¼š<strong>ä¸¢å¤±éƒ¨åˆ†æ•°æ®</strong>ï¼ˆæŸåéƒ¨åˆ†ï¼‰</li><li>âš ï¸ ä¿®å¤å‰<strong>åŠ¡å¿…å¤‡ä»½</strong>åŸæ–‡ä»¶</li><li>âš ï¸ ä¿®å¤å<strong>éªŒè¯æ•°æ®å®Œæ•´æ€§</strong></li></ul><h4 id="8-3-6-AOFä¼˜ç¼ºç‚¹åˆ†æ"><a href="#8-3-6-AOFä¼˜ç¼ºç‚¹åˆ†æ" class="headerlink" title="8.3.6 AOFä¼˜ç¼ºç‚¹åˆ†æ"></a>8.3.6 AOFä¼˜ç¼ºç‚¹åˆ†æ</h4><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å¤‡ä»½æœºåˆ¶æ›´ç¨³å¥</strong></td><td>ä¸¢å¤±æ•°æ®æ¦‚ç‡æ›´ä½ï¼Œæœ€å¤šä¸¢å¤±1ç§’æ•°æ®ï¼ˆeverysecï¼‰</td></tr><tr><td><strong>å¯è¯»çš„æ—¥å¿—æ–‡æœ¬</strong></td><td>AOFæ–‡ä»¶æ˜¯æ–‡æœ¬æ ¼å¼ï¼Œå¯ä»¥æŸ¥çœ‹å’Œç¼–è¾‘</td></tr><tr><td><strong>å¯ä»¥å¤„ç†è¯¯æ“ä½œ</strong></td><td>å¯ä»¥é€šè¿‡ç¼–è¾‘AOFæ–‡ä»¶æ¢å¤è¯¯åˆ é™¤çš„æ•°æ®</td></tr><tr><td><strong>æ•°æ®å®Œæ•´æ€§é«˜</strong></td><td>è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œæ•°æ®å‡ ä¹ä¸ä¸¢å¤±</td></tr><tr><td><strong>æ”¯æŒé‡å†™å‹ç¼©</strong></td><td>å¯ä»¥å‹ç¼©AOFæ–‡ä»¶ï¼Œå‡å°‘ç£ç›˜å ç”¨</td></tr></tbody></table><p><strong>åŠ£åŠ¿</strong>ï¼š</p><table><thead><tr><th>åŠ£åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å ç”¨æ›´å¤šç£ç›˜ç©ºé—´</strong></td><td>AOFæ–‡ä»¶é€šå¸¸æ¯”RDBæ–‡ä»¶å¤§</td></tr><tr><td><strong>æ¢å¤é€Ÿåº¦æ…¢</strong></td><td>éœ€è¦é‡æ–°æ‰§è¡Œæ‰€æœ‰å†™æ“ä½œï¼Œæ¯”RDBæ…¢</td></tr><tr><td><strong>æ€§èƒ½å‹åŠ›</strong></td><td>æ¯æ¬¡å†™æ“ä½œéƒ½è¦è®°å½•ï¼Œæœ‰ä¸€å®šæ€§èƒ½å½±å“</td></tr><tr><td><strong>å­˜åœ¨ä¸ªåˆ«Bug</strong></td><td>æå°‘æ•°æƒ…å†µä¸‹å¯èƒ½é€ æˆæ¢å¤å¤±è´¥</td></tr></tbody></table><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ˜¯å¦é€‚åˆ</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜</strong></td><td>âœ… é€‚åˆ</td><td>å‡ ä¹ä¸ä¸¢å¤±æ•°æ®</td></tr><tr><td><strong>å¯ä»¥æ¥å—æ¢å¤æ…¢</strong></td><td>âœ… é€‚åˆ</td><td>æ¢å¤é€Ÿåº¦å¯ä»¥æ¥å—</td></tr><tr><td><strong>éœ€è¦å¤„ç†è¯¯æ“ä½œ</strong></td><td>âœ… é€‚åˆ</td><td>å¯ä»¥ç¼–è¾‘AOFæ–‡ä»¶</td></tr><tr><td><strong>å¤§è§„æ¨¡æ•°æ®æ¢å¤</strong></td><td>âŒ ä¸é€‚åˆ</td><td>æ¢å¤é€Ÿåº¦æ…¢</td></tr><tr><td><strong>ç£ç›˜ç©ºé—´æœ‰é™</strong></td><td>âŒ ä¸é€‚åˆ</td><td>æ–‡ä»¶å ç”¨ç©ºé—´å¤§</td></tr></tbody></table><h3 id="8-4-æ··åˆæŒä¹…åŒ–ï¼ˆRedis-4-0-ï¼‰"><a href="#8-4-æ··åˆæŒä¹…åŒ–ï¼ˆRedis-4-0-ï¼‰" class="headerlink" title="8.4 æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰"></a>8.4 æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰</h3><h4 id="8-4-1-ä»€ä¹ˆæ˜¯æ··åˆæŒä¹…åŒ–"><a href="#8-4-1-ä»€ä¹ˆæ˜¯æ··åˆæŒä¹…åŒ–" class="headerlink" title="8.4.1 ä»€ä¹ˆæ˜¯æ··åˆæŒä¹…åŒ–"></a>8.4.1 ä»€ä¹ˆæ˜¯æ··åˆæŒä¹…åŒ–</h4><p><strong>æ··åˆæŒä¹…åŒ–ï¼ˆRDB + AOFï¼‰</strong>ï¼š</p><ul><li><strong>ç‰ˆæœ¬è¦æ±‚</strong>ï¼šRedis 4.0+</li><li><strong>åŸç†</strong>ï¼šç»“åˆRDBå’ŒAOFçš„ä¼˜åŠ¿</li><li><strong>æ–‡ä»¶æ ¼å¼</strong>ï¼šAOFæ–‡ä»¶å¤´éƒ¨æ˜¯RDBæ ¼å¼ï¼Œåé¢æ˜¯AOFæ ¼å¼</li></ul><p><strong>æ–‡ä»¶ç»“æ„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[appendonly.aofæ–‡ä»¶]</span><br><span class="line">â”œâ”€â”€ [RDBæ ¼å¼æ•°æ®]ï¼ˆæ–‡ä»¶å¤´éƒ¨ï¼ŒäºŒè¿›åˆ¶ï¼‰</span><br><span class="line">â”‚   â””â”€â”€ å†å²æ•°æ®å¿«ç…§</span><br><span class="line">â””â”€â”€ [AOFæ ¼å¼æ•°æ®]ï¼ˆæ–‡ä»¶å°¾éƒ¨ï¼Œæ–‡æœ¬ï¼‰</span><br><span class="line">    â””â”€â”€ å¢é‡å†™æ“ä½œ</span><br></pre></td></tr></table></figure><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… <strong>æ¢å¤é€Ÿåº¦å¿«</strong>ï¼šRDBéƒ¨åˆ†å¿«é€ŸåŠ è½½</li><li>âœ… <strong>æ•°æ®å®Œæ•´æ€§é«˜</strong>ï¼šAOFéƒ¨åˆ†ä¿è¯æ•°æ®ä¸ä¸¢å¤±</li><li>âœ… <strong>æ–‡ä»¶å¤§å°é€‚ä¸­</strong>ï¼šæ¯”çº¯AOFå°ï¼Œæ¯”çº¯RDBå¤§</li></ul><h4 id="8-4-2-æ··åˆæŒä¹…åŒ–é…ç½®"><a href="#8-4-2-æ··åˆæŒä¹…åŒ–é…ç½®" class="headerlink" title="8.4.2 æ··åˆæŒä¹…åŒ–é…ç½®"></a>8.4.2 æ··åˆæŒä¹…åŒ–é…ç½®</h4><p><strong>å¼€å¯æ··åˆæŒä¹…åŒ–</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯AOF</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰</span></span><br><span class="line">aof-use-rdb-preamble <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>éªŒè¯é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; CONFIG GET aof-use-rdb-preamble</span><br><span class="line">1) <span class="string">&quot;aof-use-rdb-preamble&quot;</span></span><br><span class="line">2) <span class="string">&quot;yes&quot;</span></span><br></pre></td></tr></table></figure><h4 id="8-4-3-æ··åˆæŒä¹…åŒ–å·¥ä½œæµç¨‹"><a href="#8-4-3-æ··åˆæŒä¹…åŒ–å·¥ä½œæµç¨‹" class="headerlink" title="8.4.3 æ··åˆæŒä¹…åŒ–å·¥ä½œæµç¨‹"></a>8.4.3 æ··åˆæŒä¹…åŒ–å·¥ä½œæµç¨‹</h4><p><strong>AOFé‡å†™æ—¶çš„æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[è§¦å‘AOFé‡å†™]</span><br><span class="line">    â†“</span><br><span class="line">[Forkå­è¿›ç¨‹]</span><br><span class="line">    â†“</span><br><span class="line">[å­è¿›ç¨‹å°†å†…å­˜æ•°æ®å†™å…¥RDBæ ¼å¼ï¼ˆæ–‡ä»¶å¤´éƒ¨ï¼‰]</span><br><span class="line">    â†“</span><br><span class="line">[å­è¿›ç¨‹ç»§ç»­å†™å…¥AOFæ ¼å¼ï¼ˆå¢é‡æ“ä½œï¼‰]</span><br><span class="line">    â†“</span><br><span class="line">[ä¸»è¿›ç¨‹å°†é‡å†™æœŸé—´çš„å†™æ“ä½œè¿½åŠ åˆ°æ–°æ–‡ä»¶]</span><br><span class="line">    â†“</span><br><span class="line">[ç”¨æ–°æ–‡ä»¶æ›¿æ¢æ—§AOFæ–‡ä»¶]</span><br></pre></td></tr></table></figure><p><strong>æ–‡ä»¶ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># AOFæ–‡ä»¶å†…å®¹ï¼ˆæ··åˆæ ¼å¼ï¼‰</span><br><span class="line"></span><br><span class="line"># RDBéƒ¨åˆ†ï¼ˆäºŒè¿›åˆ¶ï¼Œä¸å¯è¯»ï¼‰</span><br><span class="line">REDIS0009...</span><br><span class="line"></span><br><span class="line"># AOFéƒ¨åˆ†ï¼ˆæ–‡æœ¬ï¼Œå¯è¯»ï¼‰</span><br><span class="line">*2</span><br><span class="line">$6</span><br><span class="line">SELECT</span><br><span class="line">$1</span><br><span class="line">0</span><br><span class="line">*3</span><br><span class="line">$3</span><br><span class="line">SET</span><br><span class="line">$3</span><br><span class="line">key</span><br><span class="line">$5</span><br><span class="line">value</span><br></pre></td></tr></table></figure><h4 id="8-4-4-æ··åˆæŒä¹…åŒ–ä¼˜åŠ¿"><a href="#8-4-4-æ··åˆæŒä¹…åŒ–ä¼˜åŠ¿" class="headerlink" title="8.4.4 æ··åˆæŒä¹…åŒ–ä¼˜åŠ¿"></a>8.4.4 æ··åˆæŒä¹…åŒ–ä¼˜åŠ¿</h4><p><strong>å¯¹æ¯”çº¯RDBå’Œçº¯AOF</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>RDB</th><th>AOF</th><th>æ··åˆæŒä¹…åŒ–</th></tr></thead><tbody><tr><td><strong>æ¢å¤é€Ÿåº¦</strong></td><td>â­â­â­â­â­ æœ€å¿«</td><td>â­â­ æœ€æ…¢</td><td>â­â­â­â­ è¾ƒå¿«</td></tr><tr><td><strong>æ•°æ®å®Œæ•´æ€§</strong></td><td>â­â­ å¯èƒ½ä¸¢å¤±</td><td>â­â­â­â­â­ å‡ ä¹ä¸ä¸¢å¤±</td><td>â­â­â­â­â­ å‡ ä¹ä¸ä¸¢å¤±</td></tr><tr><td><strong>æ–‡ä»¶å¤§å°</strong></td><td>â­â­â­â­â­ æœ€å°</td><td>â­â­ æœ€å¤§</td><td>â­â­â­ ä¸­ç­‰</td></tr><tr><td><strong>æ€§èƒ½å½±å“</strong></td><td>â­â­â­â­ è¾ƒå°</td><td>â­â­â­ ä¸­ç­‰</td><td>â­â­â­ ä¸­ç­‰</td></tr><tr><td><strong>æ¨èåº¦</strong></td><td>â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­â­</td></tr></tbody></table><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>âœ… <strong>ç”Ÿäº§ç¯å¢ƒæ¨è</strong>ï¼šç»“åˆäº†RDBå’ŒAOFçš„ä¼˜åŠ¿</li><li>âœ… <strong>æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜</strong>ï¼šå‡ ä¹ä¸ä¸¢å¤±æ•°æ®</li><li>âœ… <strong>æ¢å¤é€Ÿåº¦è¦æ±‚</strong>ï¼šæ¯”çº¯AOFæ¢å¤å¿«</li><li>âœ… <strong>Redis 4.0+</strong>ï¼šå¿…é¡»ä½¿ç”¨Redis 4.0åŠä»¥ä¸Šç‰ˆæœ¬</li></ul><h3 id="8-5-æŒä¹…åŒ–ç­–ç•¥é€‰æ‹©"><a href="#8-5-æŒä¹…åŒ–ç­–ç•¥é€‰æ‹©" class="headerlink" title="8.5 æŒä¹…åŒ–ç­–ç•¥é€‰æ‹©"></a>8.5 æŒä¹…åŒ–ç­–ç•¥é€‰æ‹©</h3><h4 id="8-5-1-RDB-vs-AOF-vs-æ··åˆæŒä¹…åŒ–"><a href="#8-5-1-RDB-vs-AOF-vs-æ··åˆæŒä¹…åŒ–" class="headerlink" title="8.5.1 RDB vs AOF vs æ··åˆæŒä¹…åŒ–"></a>8.5.1 RDB vs AOF vs æ··åˆæŒä¹…åŒ–</h4><p><strong>å…¨é¢å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>RDB</th><th>AOF</th><th>æ··åˆæŒä¹…åŒ–</th></tr></thead><tbody><tr><td><strong>æŒä¹…åŒ–æ–¹å¼</strong></td><td>å¿«ç…§</td><td>æ—¥å¿—</td><td>RDB + AOF</td></tr><tr><td><strong>æ–‡ä»¶æ ¼å¼</strong></td><td>äºŒè¿›åˆ¶å‹ç¼©</td><td>æ–‡æœ¬</td><td>äºŒè¿›åˆ¶ + æ–‡æœ¬</td></tr><tr><td><strong>æ–‡ä»¶å¤§å°</strong></td><td>å°ï¼ˆå‹ç¼©åï¼‰</td><td>å¤§</td><td>ä¸­ç­‰</td></tr><tr><td><strong>æ¢å¤é€Ÿåº¦</strong></td><td>å¿«</td><td>æ…¢</td><td>è¾ƒå¿«</td></tr><tr><td><strong>æ•°æ®ä¸¢å¤±é£é™©</strong></td><td>é«˜ï¼ˆå¯èƒ½ä¸¢å¤±ï¼‰</td><td>ä½ï¼ˆå‡ ä¹ä¸ä¸¢å¤±ï¼‰</td><td>ä½ï¼ˆå‡ ä¹ä¸ä¸¢å¤±ï¼‰</td></tr><tr><td><strong>æ€§èƒ½å½±å“</strong></td><td>å°ï¼ˆå¼‚æ­¥ï¼‰</td><td>ä¸­ç­‰ï¼ˆåŒæ­¥ï¼‰</td><td>ä¸­ç­‰ï¼ˆåŒæ­¥ï¼‰</td></tr><tr><td><strong>å¯è¯»æ€§</strong></td><td>âŒ ä¸å¯è¯»</td><td>âœ… å¯è¯»</td><td>âš ï¸ éƒ¨åˆ†å¯è¯»</td></tr><tr><td><strong>ç‰ˆæœ¬è¦æ±‚</strong></td><td>Redis 1.0+</td><td>Redis 1.1+</td><td>Redis 4.0+</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¤‡ä»½ã€ç¾éš¾æ¢å¤</td><td>æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜</td><td>ç”Ÿäº§ç¯å¢ƒæ¨è</td></tr></tbody></table><h4 id="8-5-2-é€‰æ‹©å»ºè®®"><a href="#8-5-2-é€‰æ‹©å»ºè®®" class="headerlink" title="8.5.2 é€‰æ‹©å»ºè®®"></a>8.5.2 é€‰æ‹©å»ºè®®</h4><p><strong>åœºæ™¯1ï¼šæ•°æ®å¤‡ä»½å’Œç¾éš¾æ¢å¤</strong></p><p><strong>æ¨è</strong>ï¼šRDB</p><p><strong>åŸå› </strong>ï¼š</p><ul><li>âœ… æ–‡ä»¶å°ï¼Œä¾¿äºå¤‡ä»½</li><li>âœ… æ¢å¤é€Ÿåº¦å¿«</li><li>âœ… å¯ä»¥æ¥å—å°‘é‡æ•°æ®ä¸¢å¤±</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åªå¼€å¯RDB</span></span><br><span class="line">appendonly no</span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯2ï¼šæ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜</strong></p><p><strong>æ¨è</strong>ï¼šAOFï¼ˆeverysecï¼‰æˆ–æ··åˆæŒä¹…åŒ–</p><p><strong>åŸå› </strong>ï¼š</p><ul><li>âœ… æ•°æ®å‡ ä¹ä¸ä¸¢å¤±</li><li>âœ… å¯ä»¥å¤„ç†è¯¯æ“ä½œ</li><li>âœ… é€‚åˆå…³é”®ä¸šåŠ¡æ•°æ®</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># AOFé…ç½®</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–æ··åˆæŒä¹…åŒ–ï¼ˆæ¨èï¼‰</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line">appendfsync everysec</span><br><span class="line">aof-use-rdb-preamble <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯3ï¼šç”Ÿäº§ç¯å¢ƒï¼ˆé€šç”¨ï¼‰</strong></p><p><strong>æ¨è</strong>ï¼šæ··åˆæŒä¹…åŒ–</p><p><strong>åŸå› </strong>ï¼š</p><ul><li>âœ… ç»“åˆRDBå’ŒAOFçš„ä¼˜åŠ¿</li><li>âœ… æ¢å¤é€Ÿåº¦å¿«</li><li>âœ… æ•°æ®å®Œæ•´æ€§é«˜</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ··åˆæŒä¹…åŒ–é…ç½®</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line">appendfsync everysec</span><br><span class="line">aof-use-rdb-preamble <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒæ—¶ä¿ç•™RDBä½œä¸ºé¢å¤–å¤‡ä»½</span></span><br><span class="line">save 3600 1</span><br><span class="line">save 1800 100</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯4ï¼šæ€§èƒ½ä¼˜å…ˆï¼Œå¯æ¥å—æ•°æ®ä¸¢å¤±</strong></p><p><strong>æ¨è</strong>ï¼šRDB</p><p><strong>åŸå› </strong>ï¼š</p><ul><li>âœ… æ€§èƒ½å½±å“æœ€å°</li><li>âœ… æ¢å¤é€Ÿåº¦å¿«</li><li>âš ï¸ å¯ä»¥æ¥å—æ•°æ®ä¸¢å¤±</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">appendonly no</span><br><span class="line">save 3600 1  <span class="comment"># 1å°æ—¶å¤‡ä»½ä¸€æ¬¡</span></span><br></pre></td></tr></table></figure><h4 id="8-5-3-ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®"><a href="#8-5-3-ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®" class="headerlink" title="8.5.3 ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®"></a>8.5.3 ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®</h4><p><strong>å®Œæ•´é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== RDBé…ç½® ==========</span></span><br><span class="line"><span class="comment"># å®šæœŸå¤‡ä»½ï¼ˆä½œä¸ºé¢å¤–å¤‡ä»½ï¼‰</span></span><br><span class="line">save 3600 1      <span class="comment"># 1å°æ—¶å†…è‡³å°‘1ä¸ªkeyå˜åŒ–</span></span><br><span class="line">save 1800 100    <span class="comment"># 30åˆ†é’Ÿå†…è‡³å°‘100ä¸ªkeyå˜åŒ–</span></span><br><span class="line">save 300 1000    <span class="comment"># 5åˆ†é’Ÿå†…è‡³å°‘1000ä¸ªkeyå˜åŒ–</span></span><br><span class="line"></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"><span class="built_in">dir</span> /var/lib/redis/</span><br><span class="line"></span><br><span class="line">rdbcompression <span class="built_in">yes</span></span><br><span class="line">rdbchecksum <span class="built_in">yes</span></span><br><span class="line">stop-writes-on-bgsave-error <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== AOFé…ç½® ==========</span></span><br><span class="line"><span class="comment"># å¼€å¯AOF</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒæ­¥ç­–ç•¥ï¼ˆæ¨èeverysecï¼‰</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"></span><br><span class="line"><span class="comment"># AOFé‡å†™é…ç½®</span></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== æ··åˆæŒä¹…åŒ– ==========</span></span><br><span class="line"><span class="comment"># å¼€å¯æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰</span></span><br><span class="line">aof-use-rdb-preamble <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®è¯´æ˜</strong>ï¼š</p><ul><li>âœ… <strong>RDB</strong>ï¼šä½œä¸ºå®šæœŸå¤‡ä»½ï¼Œç”¨äºç¾éš¾æ¢å¤</li><li>âœ… <strong>AOF</strong>ï¼šä½œä¸ºä¸»è¦æŒä¹…åŒ–æ–¹å¼ï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§</li><li>âœ… <strong>æ··åˆæŒä¹…åŒ–</strong>ï¼šç»“åˆä¸¤è€…ä¼˜åŠ¿ï¼Œæ¢å¤é€Ÿåº¦å¿«ä¸”æ•°æ®å®Œæ•´</li></ul><h4 id="8-5-4-æŒä¹…åŒ–ç›‘æ§"><a href="#8-5-4-æŒä¹…åŒ–ç›‘æ§" class="headerlink" title="8.5.4 æŒä¹…åŒ–ç›‘æ§"></a>8.5.4 æŒä¹…åŒ–ç›‘æ§</h4><p><strong>æŸ¥çœ‹æŒä¹…åŒ–çŠ¶æ€</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; INFO persistence</span><br><span class="line"><span class="comment"># Persistence</span></span><br><span class="line">loading:0</span><br><span class="line">rdb_changes_since_last_save:0</span><br><span class="line">rdb_bgsave_in_progress:0</span><br><span class="line">rdb_last_save_time:1699123456</span><br><span class="line">rdb_last_bgsave_status:ok</span><br><span class="line">rdb_last_bgsave_time_sec:2</span><br><span class="line">rdb_current_bgsave_time_sec:-1</span><br><span class="line">aof_enabled:1</span><br><span class="line">aof_rewrite_in_progress:0</span><br><span class="line">aof_last_rewrite_time_sec:1</span><br><span class="line">aof_current_rewrite_time_sec:-1</span><br><span class="line">aof_last_bgrewrite_status:ok</span><br><span class="line">aof_last_write_status:ok</span><br><span class="line">aof_last_size:1234567</span><br><span class="line">aof_base_size:1000000</span><br><span class="line">aof_pending_rewrite:0</span><br><span class="line">aof_buffer_length:0</span><br><span class="line">aof_rewrite_buffer_length:0</span><br><span class="line">aof_pending_bio_fsync:0</span><br><span class="line">aof_delayed_fsync:0</span><br></pre></td></tr></table></figure><p><strong>å…³é”®æŒ‡æ ‡</strong>ï¼š</p><ul><li><code>rdb_bgsave_in_progress</code>ï¼šRDBæ˜¯å¦æ­£åœ¨æ‰§è¡Œï¼ˆ0&#x3D;å¦ï¼Œ1&#x3D;æ˜¯ï¼‰</li><li><code>aof_rewrite_in_progress</code>ï¼šAOFæ˜¯å¦æ­£åœ¨é‡å†™ï¼ˆ0&#x3D;å¦ï¼Œ1&#x3D;æ˜¯ï¼‰</li><li><code>aof_last_write_status</code>ï¼šæœ€åä¸€æ¬¡AOFå†™å…¥çŠ¶æ€ï¼ˆok&#x3D;æˆåŠŸï¼‰</li><li><code>aof_last_size</code>ï¼šå½“å‰AOFæ–‡ä»¶å¤§å°</li><li><code>aof_base_size</code>ï¼šä¸Šæ¬¡é‡å†™æ—¶çš„AOFæ–‡ä»¶å¤§å°</li></ul><h4 id="8-5-5-æŒä¹…åŒ–æœ€ä½³å®è·µ"><a href="#8-5-5-æŒä¹…åŒ–æœ€ä½³å®è·µ" class="headerlink" title="8.5.5 æŒä¹…åŒ–æœ€ä½³å®è·µ"></a>8.5.5 æŒä¹…åŒ–æœ€ä½³å®è·µ</h4><p><strong>1. å®šæœŸå¤‡ä»½</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯å¤©å¤‡ä»½ä¸€æ¬¡RDBå’ŒAOFæ–‡ä»¶</span></span><br><span class="line">0 2 * * * /path/to/backup_redis.sh</span><br></pre></td></tr></table></figure><p><strong>2. ç›‘æ§æŒä¹…åŒ–çŠ¶æ€</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›‘æ§è„šæœ¬</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">REDIS_CLI=<span class="string">&quot;/usr/local/bin/redis-cli&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥AOFå†™å…¥çŠ¶æ€</span></span><br><span class="line">AOF_STATUS=$(<span class="variable">$REDIS_CLI</span> INFO persistence | grep aof_last_write_status | <span class="built_in">cut</span> -d: -f2 | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$AOF_STATUS</span>&quot;</span> != <span class="string">&quot;ok&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;WARNING: AOF write failed!&quot;</span></span><br><span class="line">    <span class="comment"># å‘é€å‘Šè­¦</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥RDBçŠ¶æ€</span></span><br><span class="line">RDB_STATUS=$(<span class="variable">$REDIS_CLI</span> INFO persistence | grep rdb_last_bgsave_status | <span class="built_in">cut</span> -d: -f2 | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$RDB_STATUS</span>&quot;</span> != <span class="string">&quot;ok&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;WARNING: RDB save failed!&quot;</span></span><br><span class="line">    <span class="comment"># å‘é€å‘Šè­¦</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><strong>3. æ€§èƒ½ä¼˜åŒ–</strong></p><ul><li>âœ… ä½¿ç”¨<code>everysec</code>åŒæ­¥ç­–ç•¥ï¼ˆå¹³è¡¡æ€§èƒ½å’Œæ•°æ®å®‰å…¨ï¼‰</li><li>âœ… åˆç†è®¾ç½®AOFé‡å†™é˜ˆå€¼ï¼ˆé¿å…é¢‘ç¹é‡å†™ï¼‰</li><li>âœ… ä½¿ç”¨æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰</li><li>âœ… å®šæœŸæ¸…ç†æ—§çš„å¤‡ä»½æ–‡ä»¶</li></ul><p><strong>4. ç¾éš¾æ¢å¤é¢„æ¡ˆ</strong></p><ul><li>âœ… å®šæœŸæµ‹è¯•æ¢å¤æµç¨‹</li><li>âœ… ä¿ç•™å¤šä¸ªæ—¶é—´ç‚¹çš„å¤‡ä»½</li><li>âœ… å¤‡ä»½æ–‡ä»¶å­˜å‚¨åˆ°ä¸åŒä½ç½®</li><li>âœ… æ–‡æ¡£åŒ–æ¢å¤æ­¥éª¤</li></ul><h3 id="8-6-æ€»ç»“"><a href="#8-6-æ€»ç»“" class="headerlink" title="8.6 æ€»ç»“"></a>8.6 æ€»ç»“</h3><p><strong>æŒä¹…åŒ–é€‰æ‹©å»ºè®®</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>é…ç½®è¦ç‚¹</th></tr></thead><tbody><tr><td><strong>ç”Ÿäº§ç¯å¢ƒï¼ˆé€šç”¨ï¼‰</strong></td><td>æ··åˆæŒä¹…åŒ–</td><td>AOF + RDBï¼ŒeverysecåŒæ­¥</td></tr><tr><td><strong>æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜</strong></td><td>AOFï¼ˆeverysecï¼‰</td><td>å¼€å¯AOFï¼ŒeverysecåŒæ­¥</td></tr><tr><td><strong>æ€§èƒ½ä¼˜å…ˆ</strong></td><td>RDB</td><td>å…³é—­AOFï¼Œå®šæœŸRDBå¤‡ä»½</td></tr><tr><td><strong>å¤‡ä»½å’Œç¾éš¾æ¢å¤</strong></td><td>RDB</td><td>å®šæœŸRDBå¤‡ä»½ï¼Œæ–‡ä»¶å°æ¢å¤å¿«</td></tr></tbody></table><p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p><ol><li>âœ… <strong>æ··åˆæŒä¹…åŒ–</strong>æ˜¯ç”Ÿäº§ç¯å¢ƒçš„æœ€ä½³é€‰æ‹©ï¼ˆRedis 4.0+ï¼‰</li><li>âœ… <strong>AOF everysec</strong>æ˜¯æ•°æ®å®‰å…¨æ€§å’Œæ€§èƒ½çš„å¹³è¡¡ç‚¹</li><li>âœ… <strong>å®šæœŸå¤‡ä»½</strong>æ˜¯ç¾éš¾æ¢å¤çš„å…³é”®</li><li>âœ… <strong>ç›‘æ§æŒä¹…åŒ–çŠ¶æ€</strong>å¯ä»¥åŠæ—¶å‘ç°é—®é¢˜</li></ol><h2 id="9-Redisä¸»ä»å¤åˆ¶"><a href="#9-Redisä¸»ä»å¤åˆ¶" class="headerlink" title="9. Redisä¸»ä»å¤åˆ¶"></a>9. Redisä¸»ä»å¤åˆ¶</h2><h3 id="9-1-ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶"><a href="#9-1-ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶" class="headerlink" title="9.1 ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶"></a>9.1 ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶</h3><h4 id="9-1-1-ä¸»ä»å¤åˆ¶å®šä¹‰"><a href="#9-1-1-ä¸»ä»å¤åˆ¶å®šä¹‰" class="headerlink" title="9.1.1 ä¸»ä»å¤åˆ¶å®šä¹‰"></a>9.1.1 ä¸»ä»å¤åˆ¶å®šä¹‰</h4><p><strong>ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave Replicationï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šä¸»æœºï¼ˆMasterï¼‰æ•°æ®æ›´æ–°åï¼Œæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œ<strong>è‡ªåŠ¨åŒæ­¥</strong>åˆ°å¤‡æœºï¼ˆSlaveï¼‰çš„æœºåˆ¶</li><li><strong>è§’è‰²</strong>ï¼š<ul><li><strong>Masterï¼ˆä¸»èŠ‚ç‚¹ï¼‰</strong>ï¼šä»¥<strong>å†™</strong>ä¸ºä¸»ï¼Œè´Ÿè´£å¤„ç†å†™æ“ä½œ</li><li><strong>Slaveï¼ˆä»èŠ‚ç‚¹ï¼‰</strong>ï¼šä»¥<strong>è¯»</strong>ä¸ºä¸»ï¼Œè´Ÿè´£å¤„ç†è¯»æ“ä½œï¼Œå¹¶åŒæ­¥Masterçš„æ•°æ®</li></ul></li><li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>å•å‘æ•°æ®æµ</strong>ï¼Œä»Masteråˆ°Slave</li></ul><p><strong>æ¶æ„å›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Master    â”‚ (ä¸»èŠ‚ç‚¹ï¼Œå¯è¯»å†™)</span><br><span class="line">â”‚  (ä¸»èŠ‚ç‚¹)    â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚ æ•°æ®åŒæ­¥</span><br><span class="line">       â”‚</span><br><span class="line">   â”Œâ”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">   â”‚       â”‚         â”‚         â”‚</span><br><span class="line">â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”</span><br><span class="line">â”‚Slave1â”‚ â”‚Slave2â”‚ â”‚Slave3â”‚ â”‚Slave4â”‚ (ä»èŠ‚ç‚¹ï¼Œåªè¯»)</span><br><span class="line">â”‚(ä»èŠ‚ç‚¹)â”‚ â”‚(ä»èŠ‚ç‚¹)â”‚ â”‚(ä»èŠ‚ç‚¹)â”‚ â”‚(ä»èŠ‚ç‚¹)â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><h4 id="9-1-2-ä¸»ä»å¤åˆ¶çš„ä¼˜åŠ¿"><a href="#9-1-2-ä¸»ä»å¤åˆ¶çš„ä¼˜åŠ¿" class="headerlink" title="9.1.2 ä¸»ä»å¤åˆ¶çš„ä¼˜åŠ¿"></a>9.1.2 ä¸»ä»å¤åˆ¶çš„ä¼˜åŠ¿</h4><p><strong>1. è¯»å†™åˆ†ç¦»</strong></p><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ€§èƒ½æ‰©å±•</strong></td><td>è¯»æ“ä½œåˆ†æ•£åˆ°å¤šä¸ªSlaveï¼Œæé«˜æ•´ä½“è¯»æ€§èƒ½</td></tr><tr><td><strong>è´Ÿè½½å‡è¡¡</strong></td><td>ä¸»èŠ‚ç‚¹ä¸“æ³¨å†™æ“ä½œï¼Œä»èŠ‚ç‚¹å¤„ç†è¯»æ“ä½œ</td></tr><tr><td><strong>æé«˜ååé‡</strong></td><td>å¤šå°æœåŠ¡å™¨åŒæ—¶å¤„ç†è¯·æ±‚ï¼Œæé«˜ç³»ç»Ÿååé‡</td></tr></tbody></table><p><strong>æ¶æ„ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å†™è¯·æ±‚ â†’ Masterï¼ˆä¸»èŠ‚ç‚¹ï¼‰</span><br><span class="line">è¯»è¯·æ±‚ â†’ Slave1, Slave2, Slave3...ï¼ˆä»èŠ‚ç‚¹ï¼‰</span><br></pre></td></tr></table></figure><p><strong>2. å®¹ç¾å¿«é€Ÿæ¢å¤</strong></p><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ•°æ®å¤‡ä»½</strong></td><td>SlaveèŠ‚ç‚¹ä¿å­˜å®Œæ•´çš„æ•°æ®å‰¯æœ¬</td></tr><tr><td><strong>å¿«é€Ÿæ¢å¤</strong></td><td>Masteræ•…éšœæ—¶ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ°Slave</td></tr><tr><td><strong>é«˜å¯ç”¨æ€§</strong></td><td>æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¯é æ€§</td></tr></tbody></table><p><strong>3. æ•°æ®å†—ä½™</strong></p><table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å¤šå‰¯æœ¬</strong></td><td>æ•°æ®åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šä¿å­˜ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±</td></tr><tr><td><strong>åœ°ç†åˆ†å¸ƒ</strong></td><td>å¯ä»¥åœ¨ä¸åŒåœ°ç†ä½ç½®éƒ¨ç½²SlaveèŠ‚ç‚¹</td></tr><tr><td><strong>ç¾éš¾æ¢å¤</strong></td><td>å³ä½¿Masteræ‰€åœ¨æœºæˆ¿æ•…éšœï¼ŒSlaveä»å¯æä¾›æœåŠ¡</td></tr></tbody></table><h4 id="9-1-3-ä¸»ä»å¤åˆ¶åº”ç”¨åœºæ™¯"><a href="#9-1-3-ä¸»ä»å¤åˆ¶åº”ç”¨åœºæ™¯" class="headerlink" title="9.1.3 ä¸»ä»å¤åˆ¶åº”ç”¨åœºæ™¯"></a>9.1.3 ä¸»ä»å¤åˆ¶åº”ç”¨åœºæ™¯</h4><p><strong>åœºæ™¯1ï¼šè¯»å†™åˆ†ç¦»</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨åœºæ™¯ï¼š</span><br><span class="line">- è¯»å¤šå†™å°‘çš„ä¸šåŠ¡</span><br><span class="line">- éœ€è¦æé«˜è¯»æ€§èƒ½</span><br><span class="line">- éœ€è¦æ‰©å±•è¯»èƒ½åŠ›</span><br><span class="line"></span><br><span class="line">æ¶æ„ï¼š</span><br><span class="line">Masterï¼ˆå†™ï¼‰ â† å†™è¯·æ±‚</span><br><span class="line">Slave1ï¼ˆè¯»ï¼‰ â† è¯»è¯·æ±‚</span><br><span class="line">Slave2ï¼ˆè¯»ï¼‰ â† è¯»è¯·æ±‚</span><br><span class="line">Slave3ï¼ˆè¯»ï¼‰ â† è¯»è¯·æ±‚</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯2ï¼šæ•°æ®å¤‡ä»½</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨åœºæ™¯ï¼š</span><br><span class="line">- éœ€è¦å®šæœŸå¤‡ä»½æ•°æ®</span><br><span class="line">- éœ€è¦å¼‚åœ°å¤‡ä»½</span><br><span class="line">- éœ€è¦ç¾éš¾æ¢å¤</span><br><span class="line"></span><br><span class="line">æ¶æ„ï¼š</span><br><span class="line">Masterï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</span><br><span class="line">  â†“ æ•°æ®åŒæ­¥</span><br><span class="line">Slaveï¼ˆå¤‡ä»½ç¯å¢ƒï¼Œä¸åŒæœºæˆ¿ï¼‰</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯3ï¼šé«˜å¯ç”¨æ¶æ„</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨åœºæ™¯ï¼š</span><br><span class="line">- éœ€è¦é«˜å¯ç”¨æ€§</span><br><span class="line">- éœ€è¦å¿«é€Ÿæ•…éšœæ¢å¤</span><br><span class="line">- éœ€è¦é›¶åœæœºæ—¶é—´</span><br><span class="line"></span><br><span class="line">æ¶æ„ï¼š</span><br><span class="line">Masterï¼ˆä¸»èŠ‚ç‚¹ï¼‰</span><br><span class="line">  â†“ æ•°æ®åŒæ­¥</span><br><span class="line">Slave1ï¼ˆå¤‡ç”¨èŠ‚ç‚¹ï¼Œå¯å¿«é€Ÿåˆ‡æ¢ï¼‰</span><br><span class="line">Slave2ï¼ˆå¤‡ç”¨èŠ‚ç‚¹ï¼Œå¯å¿«é€Ÿåˆ‡æ¢ï¼‰</span><br></pre></td></tr></table></figure><h3 id="9-2-ä¸»ä»å¤åˆ¶åŸç†"><a href="#9-2-ä¸»ä»å¤åˆ¶åŸç†" class="headerlink" title="9.2 ä¸»ä»å¤åˆ¶åŸç†"></a>9.2 ä¸»ä»å¤åˆ¶åŸç†</h3><h4 id="9-2-1-ä¸»ä»å¤åˆ¶æµç¨‹"><a href="#9-2-1-ä¸»ä»å¤åˆ¶æµç¨‹" class="headerlink" title="9.2.1 ä¸»ä»å¤åˆ¶æµç¨‹"></a>9.2.1 ä¸»ä»å¤åˆ¶æµç¨‹</h4><p><strong>å®Œæ•´æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[Slaveå¯åŠ¨]</span><br><span class="line">    â†“</span><br><span class="line">[è¿æ¥Master]</span><br><span class="line">    â†“</span><br><span class="line">[å‘é€SYNCå‘½ä»¤]</span><br><span class="line">    â†“</span><br><span class="line">[Masteræ‰§è¡ŒBGSAVE]</span><br><span class="line">    â†“</span><br><span class="line">[Masterå‘é€RDBæ–‡ä»¶]</span><br><span class="line">    â†“</span><br><span class="line">[Slaveæ¥æ”¶å¹¶åŠ è½½RDB]</span><br><span class="line">    â†“</span><br><span class="line">[Masterå‘é€ç¼“å†²åŒºå‘½ä»¤]</span><br><span class="line">    â†“</span><br><span class="line">[Slaveæ‰§è¡Œå‘½ä»¤ï¼Œæ•°æ®åŒæ­¥å®Œæˆ]</span><br><span class="line">    â†“</span><br><span class="line">[MasteræŒç»­å‘é€å†™å‘½ä»¤]</span><br><span class="line">    â†“</span><br><span class="line">[SlaveæŒç»­æ¥æ”¶å¹¶æ‰§è¡Œ]</span><br></pre></td></tr></table></figure><h4 id="9-2-2-ä¸»ä»å¤åˆ¶ä¸‰ä¸ªé˜¶æ®µ"><a href="#9-2-2-ä¸»ä»å¤åˆ¶ä¸‰ä¸ªé˜¶æ®µ" class="headerlink" title="9.2.2 ä¸»ä»å¤åˆ¶ä¸‰ä¸ªé˜¶æ®µ"></a>9.2.2 ä¸»ä»å¤åˆ¶ä¸‰ä¸ªé˜¶æ®µ</h4><p><strong>é˜¶æ®µ1ï¼šå»ºç«‹è¿æ¥é˜¶æ®µ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. Slaveå¯åŠ¨ï¼Œå‘Masterå‘é€è¿æ¥è¯·æ±‚</span><br><span class="line">2. Masteræ¥å—è¿æ¥ï¼Œå»ºç«‹TCPè¿æ¥</span><br><span class="line">3. Slaveå‘é€PINGå‘½ä»¤ï¼Œæ£€æŸ¥è¿æ¥</span><br><span class="line">4. Masterå›å¤PONGï¼Œç¡®è®¤è¿æ¥</span><br><span class="line">5. å¦‚æœMasterè®¾ç½®äº†å¯†ç ï¼ŒSlaveå‘é€AUTHå‘½ä»¤è®¤è¯</span><br><span class="line">6. Slaveå‘é€REPLCONFå‘½ä»¤ï¼ŒæŠ¥å‘Šè‡ªå·±çš„ç«¯å£</span><br><span class="line">7. è¿æ¥å»ºç«‹å®Œæˆ</span><br></pre></td></tr></table></figure><p><strong>é˜¶æ®µ2ï¼šæ•°æ®åŒæ­¥é˜¶æ®µ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. Slaveå‘é€SYNCæˆ–PSYNCå‘½ä»¤</span><br><span class="line">2. Masteråˆ¤æ–­æ˜¯é¦–æ¬¡åŒæ­¥è¿˜æ˜¯å¢é‡åŒæ­¥</span><br><span class="line">   - é¦–æ¬¡åŒæ­¥ï¼šæ‰§è¡ŒBGSAVEï¼Œç”ŸæˆRDBæ–‡ä»¶</span><br><span class="line">   - å¢é‡åŒæ­¥ï¼šå‘é€å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­çš„å‘½ä»¤</span><br><span class="line">3. Masterå°†RDBæ–‡ä»¶å‘é€ç»™Slave</span><br><span class="line">4. Slaveæ¥æ”¶RDBæ–‡ä»¶ï¼Œæ¸…ç©ºæ—§æ•°æ®</span><br><span class="line">5. SlaveåŠ è½½RDBæ–‡ä»¶åˆ°å†…å­˜</span><br><span class="line">6. Masterå‘é€å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤</span><br><span class="line">7. Slaveæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œæ•°æ®åŒæ­¥å®Œæˆ</span><br></pre></td></tr></table></figure><p><strong>é˜¶æ®µ3ï¼šå‘½ä»¤ä¼ æ’­é˜¶æ®µ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. Masteræ‰§è¡Œå†™å‘½ä»¤</span><br><span class="line">2. Masterå°†å†™å‘½ä»¤å‘é€åˆ°å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</span><br><span class="line">3. Masterå°†å†™å‘½ä»¤å‘é€ç»™æ‰€æœ‰Slave</span><br><span class="line">4. Slaveæ¥æ”¶å¹¶æ‰§è¡Œå†™å‘½ä»¤</span><br><span class="line">5. ä¿æŒæ•°æ®å®æ—¶åŒæ­¥</span><br></pre></td></tr></table></figure><h4 id="9-2-3-ä¸»ä»å¤åˆ¶å‘½ä»¤"><a href="#9-2-3-ä¸»ä»å¤åˆ¶å‘½ä»¤" class="headerlink" title="9.2.3 ä¸»ä»å¤åˆ¶å‘½ä»¤"></a>9.2.3 ä¸»ä»å¤åˆ¶å‘½ä»¤</h4><p><strong>SYNCå‘½ä»¤ï¼ˆRedis 2.8ä¹‹å‰ï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slaveå‘é€SYNCå‘½ä»¤</span></span><br><span class="line">127.0.0.1:6380&gt; SYNC</span><br></pre></td></tr></table></figure><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>âŒ <strong>å…¨é‡å¤åˆ¶</strong>ï¼šæ¯æ¬¡éƒ½æ˜¯å…¨é‡å¤åˆ¶ï¼Œæ•ˆç‡ä½</li><li>âŒ <strong>ç½‘ç»œå¼€é”€å¤§</strong>ï¼šå³ä½¿åªæœ‰å°‘é‡æ•°æ®å˜åŒ–ï¼Œä¹Ÿè¦ä¼ è¾“æ•´ä¸ªRDBæ–‡ä»¶</li><li>âŒ <strong>å·²åºŸå¼ƒ</strong>ï¼šRedis 2.8ä¹‹åä½¿ç”¨PSYNCå‘½ä»¤</li></ul><p><strong>PSYNCå‘½ä»¤ï¼ˆRedis 2.8+ï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slaveå‘é€PSYNCå‘½ä»¤</span></span><br><span class="line">127.0.0.1:6380&gt; PSYNC &lt;runid&gt; &lt;offset&gt;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>runid</code>ï¼šMasterçš„è¿è¡ŒIDï¼ˆé¦–æ¬¡è¿æ¥ä¸º<code>?</code>ï¼‰</li><li><code>offset</code>ï¼šSlaveçš„å¤åˆ¶åç§»é‡ï¼ˆé¦–æ¬¡è¿æ¥ä¸º<code>-1</code>ï¼‰</li></ul><p><strong>PSYNCçš„ä¸¤ç§æ¨¡å¼</strong>ï¼š</p><table><thead><tr><th>æ¨¡å¼</th><th>è§¦å‘æ¡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å…¨é‡å¤åˆ¶</strong></td><td><code>PSYNC ? -1</code> æˆ– offsetä¸åœ¨å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</td><td>ä¼ è¾“å®Œæ•´RDBæ–‡ä»¶</td></tr><tr><td><strong>éƒ¨åˆ†å¤åˆ¶</strong></td><td>offsetåœ¨å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­</td><td>åªä¼ è¾“ç¼ºå¤±çš„å‘½ä»¤</td></tr></tbody></table><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… <strong>æ”¯æŒå¢é‡å¤åˆ¶</strong>ï¼šåªä¼ è¾“ç¼ºå¤±çš„æ•°æ®</li><li>âœ… <strong>ç½‘ç»œå¼€é”€å°</strong>ï¼šå‡å°‘ç½‘ç»œä¼ è¾“</li><li>âœ… <strong>æ•ˆç‡é«˜</strong>ï¼šé€‚åˆç½‘ç»œä¸­æ–­åçš„é‡è¿</li></ul><h4 id="9-2-4-å¤åˆ¶åç§»é‡"><a href="#9-2-4-å¤åˆ¶åç§»é‡" class="headerlink" title="9.2.4 å¤åˆ¶åç§»é‡"></a>9.2.4 å¤åˆ¶åç§»é‡</h4><p><strong>å¤åˆ¶åç§»é‡ï¼ˆReplication Offsetï¼‰</strong>ï¼š</p><ul><li><strong>Master</strong>ï¼šè®°å½•è‡ªå·±å‘Slaveå‘é€çš„å­—èŠ‚æ•°</li><li><strong>Slave</strong>ï¼šè®°å½•è‡ªå·±ä»Masteræ¥æ”¶çš„å­—èŠ‚æ•°</li><li><strong>ä½œç”¨</strong>ï¼šåˆ¤æ–­æ•°æ®æ˜¯å¦åŒæ­¥ï¼Œä»¥åŠéœ€è¦åŒæ­¥å“ªäº›æ•°æ®</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Masterå¤åˆ¶åç§»é‡ï¼š1000</span><br><span class="line">Slave1å¤åˆ¶åç§»é‡ï¼š1000  âœ… åŒæ­¥</span><br><span class="line">Slave2å¤åˆ¶åç§»é‡ï¼š950   âŒ è½å50å­—èŠ‚</span><br><span class="line">Slave3å¤åˆ¶åç§»é‡ï¼š1000  âœ… åŒæ­¥</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å¤åˆ¶åç§»é‡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MasteræŸ¥çœ‹</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:2</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=1000,lag=0</span><br><span class="line">slave1:ip=127.0.0.1,port=6381,state=online,offset=1000,lag=0</span><br><span class="line">master_repl_offset:1000</span><br><span class="line"></span><br><span class="line"><span class="comment"># SlaveæŸ¥çœ‹</span></span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br><span class="line">master_link_status:up</span><br><span class="line">slave_repl_offset:1000</span><br></pre></td></tr></table></figure><h4 id="9-2-5-å¤åˆ¶ç§¯å‹ç¼“å†²åŒº"><a href="#9-2-5-å¤åˆ¶ç§¯å‹ç¼“å†²åŒº" class="headerlink" title="9.2.5 å¤åˆ¶ç§¯å‹ç¼“å†²åŒº"></a>9.2.5 å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</h4><p><strong>å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼ˆReplication Backlogï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šMasterç»´æŠ¤çš„ä¸€ä¸ª<strong>å›ºå®šå¤§å°</strong>çš„FIFOé˜Ÿåˆ—</li><li><strong>ä½œç”¨</strong>ï¼šä¿å­˜æœ€è¿‘æ‰§è¡Œçš„å†™å‘½ä»¤ï¼Œç”¨äºå¢é‡å¤åˆ¶</li><li><strong>å¤§å°</strong>ï¼šé€šè¿‡<code>repl-backlog-size</code>é…ç½®ï¼ˆé»˜è®¤1MBï¼‰</li></ul><p><strong>å·¥ä½œåŸç†</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Masteræ‰§è¡Œå†™å‘½ä»¤</span><br><span class="line">    â†“</span><br><span class="line">å†™å…¥å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼ˆFIFOé˜Ÿåˆ—ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">å¦‚æœç¼“å†²åŒºæ»¡äº†ï¼Œæœ€æ—§çš„å‘½ä»¤è¢«è¦†ç›–</span><br><span class="line">    â†“</span><br><span class="line">Slaveæ–­çº¿é‡è¿</span><br><span class="line">    â†“</span><br><span class="line">å‘é€PSYNCå‘½ä»¤ï¼Œå¸¦ä¸Šoffset</span><br><span class="line">    â†“</span><br><span class="line">Masteræ£€æŸ¥offsetæ˜¯å¦åœ¨ç¼“å†²åŒºä¸­</span><br><span class="line">    â†“</span><br><span class="line">å¦‚æœåœ¨ï¼šå‘é€ç¼“å†²åŒºä¸­çš„å‘½ä»¤ï¼ˆå¢é‡å¤åˆ¶ï¼‰</span><br><span class="line">å¦‚æœä¸åœ¨ï¼šæ‰§è¡Œå…¨é‡å¤åˆ¶</span><br></pre></td></tr></table></figure><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf (Master)</span></span><br><span class="line"><span class="comment"># å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°ï¼ˆå»ºè®®è®¾ç½®ä¸ºï¼šæ¯ç§’å†™å…¥é‡ Ã— æ–­çº¿é‡è¿æ—¶é—´ Ã— 2ï¼‰</span></span><br><span class="line">repl-backlog-size 1mb</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå­˜æ´»æ—¶é—´ï¼ˆç§’ï¼‰</span></span><br><span class="line">repl-backlog-ttl 3600</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ ç¼“å†²åŒºå¤§å°è¦åˆç†è®¾ç½®ï¼Œå¤ªå°ä¼šå¯¼è‡´é¢‘ç¹å…¨é‡å¤åˆ¶</li><li>âš ï¸ å»ºè®®è®¾ç½®ä¸ºï¼š<code>æ¯ç§’å†™å…¥é‡ Ã— æœ€å¤§æ–­çº¿æ—¶é—´ Ã— 2</code></li><li>âš ï¸ ä¾‹å¦‚ï¼šæ¯ç§’1MBå†™å…¥ï¼Œæœ€å¤§æ–­çº¿5ç§’ï¼Œå»ºè®®è®¾ç½®ä¸º10MB</li></ul><h3 id="9-3-é…ç½®ä¸»ä»å¤åˆ¶"><a href="#9-3-é…ç½®ä¸»ä»å¤åˆ¶" class="headerlink" title="9.3 é…ç½®ä¸»ä»å¤åˆ¶"></a>9.3 é…ç½®ä¸»ä»å¤åˆ¶</h3><h4 id="9-3-1-æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰"><a href="#9-3-1-æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰" class="headerlink" title="9.3.1 æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰"></a>9.3.1 æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰</h4><p><strong>Masteré…ç½®ï¼ˆredis-master.confï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Masteré…ç½®</span></span><br><span class="line">port 6379</span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">pidfile /var/run/redis-master.pid</span><br><span class="line">logfile /var/log/redis/redis-master.log</span><br><span class="line"><span class="built_in">dir</span> /var/lib/redis/master</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦å¯†ç </span></span><br><span class="line">requirepass master123</span><br></pre></td></tr></table></figure><p><strong>Slaveé…ç½®ï¼ˆredis-slave.confï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slaveé…ç½®</span></span><br><span class="line">port 6380</span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">pidfile /var/run/redis-slave.pid</span><br><span class="line">logfile /var/log/redis/redis-slave.log</span><br><span class="line"><span class="built_in">dir</span> /var/lib/redis/slave</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®Masterä¿¡æ¯</span></span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœMasteræœ‰å¯†ç </span></span><br><span class="line">masterauth master123</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦åªè¯»ï¼ˆSlaveé»˜è®¤åªè¯»ï¼‰</span></span><br><span class="line">replica-read-only <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨æœåŠ¡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨Master</span></span><br><span class="line">redis-server /etc/redis/redis-master.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨Slave</span></span><br><span class="line">redis-server /etc/redis/redis-slave.conf</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MasteræŸ¥çœ‹</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:1</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=100,lag=0</span><br><span class="line"></span><br><span class="line"><span class="comment"># SlaveæŸ¥çœ‹</span></span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br><span class="line">master_link_status:up</span><br><span class="line">slave_repl_offset:100</span><br></pre></td></tr></table></figure><h4 id="9-3-2-æ–¹å¼2ï¼šå‘½ä»¤è¡Œæ–¹å¼ï¼ˆä¸´æ—¶ï¼‰"><a href="#9-3-2-æ–¹å¼2ï¼šå‘½ä»¤è¡Œæ–¹å¼ï¼ˆä¸´æ—¶ï¼‰" class="headerlink" title="9.3.2 æ–¹å¼2ï¼šå‘½ä»¤è¡Œæ–¹å¼ï¼ˆä¸´æ—¶ï¼‰"></a>9.3.2 æ–¹å¼2ï¼šå‘½ä»¤è¡Œæ–¹å¼ï¼ˆä¸´æ—¶ï¼‰</h4><p><strong>å¯åŠ¨Masterå’ŒSlave</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨Master</span></span><br><span class="line">redis-server --port 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨Slave</span></span><br><span class="line">redis-server --port 6380</span><br></pre></td></tr></table></figure><p><strong>åœ¨Slaveä¸Šæ‰§è¡Œå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿æ¥åˆ°Slave</span></span><br><span class="line">redis-cli -p 6380</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®Masterï¼ˆæ—§ç‰ˆæœ¬ä½¿ç”¨SLAVEOFï¼‰</span></span><br><span class="line">127.0.0.1:6380&gt; REPLICAOF 127.0.0.1 6379</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ï¼ˆRedis 5.0ä¹‹å‰ï¼‰</span></span><br><span class="line">127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 6379</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>å¦‚æœMasteræœ‰å¯†ç </strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Slaveä¸Šè®¾ç½®Masterå¯†ç </span></span><br><span class="line">127.0.0.1:6380&gt; CONFIG SET masterauth master123</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>å–æ¶ˆä¸»ä»å…³ç³»</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Slaveä¸Šæ‰§è¡Œ</span></span><br><span class="line">127.0.0.1:6380&gt; REPLICAOF NO ONE</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ï¼ˆRedis 5.0ä¹‹å‰ï¼‰</span></span><br><span class="line">127.0.0.1:6380&gt; SLAVEOF NO ONE</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><ul><li>âš ï¸ å‘½ä»¤è¡Œæ–¹å¼é…ç½®æ˜¯<strong>ä¸´æ—¶çš„</strong>ï¼Œé‡å¯åå¤±æ•ˆ</li><li>âš ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨<strong>é…ç½®æ–‡ä»¶æ–¹å¼</strong></li></ul><h4 id="9-3-3-æ–¹å¼3ï¼šå¯åŠ¨å‚æ•°æ–¹å¼"><a href="#9-3-3-æ–¹å¼3ï¼šå¯åŠ¨å‚æ•°æ–¹å¼" class="headerlink" title="9.3.3 æ–¹å¼3ï¼šå¯åŠ¨å‚æ•°æ–¹å¼"></a>9.3.3 æ–¹å¼3ï¼šå¯åŠ¨å‚æ•°æ–¹å¼</h4><p><strong>å¯åŠ¨Slaveæ—¶æŒ‡å®šMaster</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨Slaveï¼ŒæŒ‡å®šMaster</span></span><br><span class="line">redis-server --port 6380 --replicaof 127.0.0.1 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœMasteræœ‰å¯†ç </span></span><br><span class="line">redis-server --port 6380 --replicaof 127.0.0.1 6379 --masterauth master123</span><br></pre></td></tr></table></figure><h4 id="9-3-4-ä¸€ä¸»å¤šä»é…ç½®"><a href="#9-3-4-ä¸€ä¸»å¤šä»é…ç½®" class="headerlink" title="9.3.4 ä¸€ä¸»å¤šä»é…ç½®"></a>9.3.4 ä¸€ä¸»å¤šä»é…ç½®</h4><p><strong>æ¶æ„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">      Master (6379)</span><br><span class="line">     /    |    \</span><br><span class="line">    /     |     \</span><br><span class="line">Slave1  Slave2  Slave3</span><br><span class="line">(6380)  (6381)  (6382)</span><br></pre></td></tr></table></figure><p><strong>é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slave1é…ç½® (redis-slave1.conf)</span></span><br><span class="line">port 6380</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave2é…ç½® (redis-slave2.conf)</span></span><br><span class="line">port 6381</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave3é…ç½® (redis-slave3.conf)</span></span><br><span class="line">port 6382</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis/redis-master.conf</span><br><span class="line">redis-server /etc/redis/redis-slave1.conf</span><br><span class="line">redis-server /etc/redis/redis-slave2.conf</span><br><span class="line">redis-server /etc/redis/redis-slave3.conf</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MasteræŸ¥çœ‹æ‰€æœ‰Slave</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:3</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=100,lag=0</span><br><span class="line">slave1:ip=127.0.0.1,port=6381,state=online,offset=100,lag=0</span><br><span class="line">slave2:ip=127.0.0.1,port=6382,state=online,offset=100,lag=0</span><br></pre></td></tr></table></figure><h4 id="9-3-5-çº§è”å¤åˆ¶ï¼ˆä¸»-ä»-ä»ï¼‰"><a href="#9-3-5-çº§è”å¤åˆ¶ï¼ˆä¸»-ä»-ä»ï¼‰" class="headerlink" title="9.3.5 çº§è”å¤åˆ¶ï¼ˆä¸»-ä»-ä»ï¼‰"></a>9.3.5 çº§è”å¤åˆ¶ï¼ˆä¸»-ä»-ä»ï¼‰</h4><p><strong>æ¶æ„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Master (6379)</span><br><span class="line">   |</span><br><span class="line">Slave1 (6380) â† ä»Masterå¤åˆ¶</span><br><span class="line">   |</span><br><span class="line">Slave2 (6381) â† ä»Slave1å¤åˆ¶ï¼ˆå‡è½»Masterå‹åŠ›ï¼‰</span><br></pre></td></tr></table></figure><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slave1é…ç½®ï¼ˆä»Masterå¤åˆ¶ï¼‰</span></span><br><span class="line">port 6380</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave2é…ç½®ï¼ˆä»Slave1å¤åˆ¶ï¼‰</span></span><br><span class="line">port 6381</span><br><span class="line">replicaof 127.0.0.1 6380</span><br></pre></td></tr></table></figure><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… <strong>å‡è½»Masterå‹åŠ›</strong>ï¼šMasteråªéœ€è¦åŒæ­¥ç»™Slave1</li><li>âœ… <strong>æé«˜æ€§èƒ½</strong>ï¼šå‡å°‘Masterçš„ç½‘ç»œå’ŒIOå‹åŠ›</li><li>âœ… <strong>çµæ´»æ‰©å±•</strong>ï¼šå¯ä»¥æ„å»ºå¤šçº§ä»èŠ‚ç‚¹</li></ul><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ Slave1éœ€è¦å…è®¸å…¶ä»–Slaveè¿æ¥ï¼ˆå…³é—­<code>replica-read-only</code>æˆ–é…ç½®ä¸ºMasterï¼‰</li><li>âš ï¸ æ•°æ®å»¶è¿Ÿä¼šå¢åŠ ï¼ˆSlave2çš„æ•°æ®å»¶è¿Ÿ &#x3D; Slave1å»¶è¿Ÿ + Slave2å»¶è¿Ÿï¼‰</li></ul><h3 id="9-4-å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶"><a href="#9-4-å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶" class="headerlink" title="9.4 å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶"></a>9.4 å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶</h3><h4 id="9-4-1-å…¨é‡å¤åˆ¶ï¼ˆFull-Replicationï¼‰"><a href="#9-4-1-å…¨é‡å¤åˆ¶ï¼ˆFull-Replicationï¼‰" class="headerlink" title="9.4.1 å…¨é‡å¤åˆ¶ï¼ˆFull Replicationï¼‰"></a>9.4.1 å…¨é‡å¤åˆ¶ï¼ˆFull Replicationï¼‰</h4><p><strong>ä»€ä¹ˆæ˜¯å…¨é‡å¤åˆ¶</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šSlaveé¦–æ¬¡è¿æ¥Masterï¼Œæˆ–å¤åˆ¶ç§¯å‹ç¼“å†²åŒºæ— æ³•æ»¡è¶³æ—¶ï¼ŒMasterå°†<strong>å®Œæ•´çš„RDBæ–‡ä»¶</strong>å‘é€ç»™Slave</li><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼š<ol><li>Slaveé¦–æ¬¡è¿æ¥Master</li><li>Slaveçš„offsetä¸åœ¨Masterçš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­</li><li>Slaveå‘é€<code>PSYNC ? -1</code>å‘½ä»¤</li></ol></li></ul><p><strong>å…¨é‡å¤åˆ¶æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. Slaveå‘é€PSYNC ? -1ï¼ˆæˆ–SYNCï¼‰</span><br><span class="line">   â†“</span><br><span class="line">2. Masteræ‰§è¡ŒBGSAVEï¼Œç”ŸæˆRDBæ–‡ä»¶</span><br><span class="line">   â†“</span><br><span class="line">3. Masterå°†RDBæ–‡ä»¶å‘é€ç»™Slaveï¼ˆç½‘ç»œä¼ è¾“ï¼‰</span><br><span class="line">   â†“</span><br><span class="line">4. Slaveæ¥æ”¶RDBæ–‡ä»¶ï¼Œä¿å­˜åˆ°ç£ç›˜</span><br><span class="line">   â†“</span><br><span class="line">5. Slaveæ¸…ç©ºæ—§æ•°æ®</span><br><span class="line">   â†“</span><br><span class="line">6. SlaveåŠ è½½RDBæ–‡ä»¶åˆ°å†…å­˜</span><br><span class="line">   â†“</span><br><span class="line">7. Masterå‘é€å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤</span><br><span class="line">   â†“</span><br><span class="line">8. Slaveæ‰§è¡Œè¿™äº›å‘½ä»¤</span><br><span class="line">   â†“</span><br><span class="line">9. å…¨é‡å¤åˆ¶å®Œæˆ</span><br></pre></td></tr></table></figure><p><strong>å…¨é‡å¤åˆ¶ç‰¹ç‚¹</strong>ï¼š</p><table><thead><tr><th>ç‰¹ç‚¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ•°æ®å®Œæ•´</strong></td><td>ä¼ è¾“å®Œæ•´çš„æ•°æ®å¿«ç…§</td></tr><tr><td><strong>ç½‘ç»œå¼€é”€å¤§</strong></td><td>éœ€è¦ä¼ è¾“æ•´ä¸ªRDBæ–‡ä»¶</td></tr><tr><td><strong>è€—æ—¶è¾ƒé•¿</strong></td><td>å¤§æ•°æ®é‡æ—¶å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿç”šè‡³æ›´ä¹…</td></tr><tr><td><strong>é˜»å¡Master</strong></td><td>BGSAVEä¼šforkå­è¿›ç¨‹ï¼Œå¯èƒ½å½±å“æ€§èƒ½</td></tr><tr><td><strong>ç£ç›˜IOé«˜</strong></td><td>Slaveéœ€è¦å†™å…¥å’ŒåŠ è½½RDBæ–‡ä»¶</td></tr></tbody></table><p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p><ul><li>âœ… åˆç†è®¾ç½®å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°ï¼Œå‡å°‘å…¨é‡å¤åˆ¶</li><li>âœ… åœ¨ä½å³°æœŸè¿›è¡Œå…¨é‡å¤åˆ¶</li><li>âœ… ä½¿ç”¨æ— ç›˜å¤åˆ¶ï¼ˆRedis 2.8.18+ï¼‰</li></ul><h4 id="9-4-2-å¢é‡å¤åˆ¶ï¼ˆPartial-Replicationï¼‰"><a href="#9-4-2-å¢é‡å¤åˆ¶ï¼ˆPartial-Replicationï¼‰" class="headerlink" title="9.4.2 å¢é‡å¤åˆ¶ï¼ˆPartial Replicationï¼‰"></a>9.4.2 å¢é‡å¤åˆ¶ï¼ˆPartial Replicationï¼‰</h4><p><strong>ä»€ä¹ˆæ˜¯å¢é‡å¤åˆ¶</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šSlaveæ–­çº¿é‡è¿åï¼Œå¦‚æœoffsetåœ¨Masterçš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­ï¼ŒMasteråªå‘é€<strong>ç¼ºå¤±çš„å‘½ä»¤</strong></li><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼š<ol><li>Slaveä¹‹å‰å·²ç»è¿æ¥è¿‡Master</li><li>Slaveçš„offsetåœ¨Masterçš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­</li><li>Slaveå‘é€<code>PSYNC &lt;runid&gt; &lt;offset&gt;</code>å‘½ä»¤</li></ol></li></ul><p><strong>å¢é‡å¤åˆ¶æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1. Slaveæ–­çº¿é‡è¿</span><br><span class="line">   â†“</span><br><span class="line">2. Slaveå‘é€PSYNC &lt;runid&gt; &lt;offset&gt;</span><br><span class="line">   â†“</span><br><span class="line">3. Masteræ£€æŸ¥offsetæ˜¯å¦åœ¨å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­</span><br><span class="line">   â†“</span><br><span class="line">4. å¦‚æœåœ¨ç¼“å†²åŒºä¸­ï¼š</span><br><span class="line">   - Masterå‘é€CONTINUEå›å¤</span><br><span class="line">   - Masterå‘é€ç¼“å†²åŒºä¸­offsetä¹‹åçš„æ‰€æœ‰å‘½ä»¤</span><br><span class="line">   â†“</span><br><span class="line">5. Slaveæ¥æ”¶å¹¶æ‰§è¡Œè¿™äº›å‘½ä»¤</span><br><span class="line">   â†“</span><br><span class="line">6. å¢é‡å¤åˆ¶å®Œæˆï¼Œæ•°æ®åŒæ­¥</span><br></pre></td></tr></table></figure><p><strong>å¢é‡å¤åˆ¶ç‰¹ç‚¹</strong>ï¼š</p><table><thead><tr><th>ç‰¹ç‚¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç½‘ç»œå¼€é”€å°</strong></td><td>åªä¼ è¾“ç¼ºå¤±çš„å‘½ä»¤</td></tr><tr><td><strong>é€Ÿåº¦å¿«</strong></td><td>é€šå¸¸å‡ ç§’å†…å®Œæˆ</td></tr><tr><td><strong>ä¸é˜»å¡Master</strong></td><td>ä¸éœ€è¦æ‰§è¡ŒBGSAVE</td></tr><tr><td><strong>æ•ˆç‡é«˜</strong></td><td>é€‚åˆç½‘ç»œçŸ­æš‚ä¸­æ–­åçš„é‡è¿</td></tr></tbody></table><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åœºæ™¯ï¼šSlaveæ–­çº¿5ç§’åé‡è¿</span><br><span class="line"></span><br><span class="line">Masterå¤åˆ¶åç§»é‡ï¼š10000</span><br><span class="line">Slaveå¤åˆ¶åç§»é‡ï¼š9500ï¼ˆæ–­çº¿æ—¶çš„offsetï¼‰</span><br><span class="line">ç¼ºå¤±æ•°æ®ï¼š500å­—èŠ‚</span><br><span class="line"></span><br><span class="line">å¢é‡å¤åˆ¶ï¼š</span><br><span class="line">- Masteræ£€æŸ¥ï¼š9500åœ¨å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­ âœ…</span><br><span class="line">- Masterå‘é€ï¼šoffset 9500-10000ä¹‹é—´çš„å‘½ä»¤</span><br><span class="line">- Slaveæ¥æ”¶å¹¶æ‰§è¡Œï¼šæ•°æ®åŒæ­¥å®Œæˆ</span><br><span class="line">- è€—æ—¶ï¼š&lt; 1ç§’</span><br></pre></td></tr></table></figure><h4 id="9-4-3-å…¨é‡å¤åˆ¶-vs-å¢é‡å¤åˆ¶"><a href="#9-4-3-å…¨é‡å¤åˆ¶-vs-å¢é‡å¤åˆ¶" class="headerlink" title="9.4.3 å…¨é‡å¤åˆ¶ vs å¢é‡å¤åˆ¶"></a>9.4.3 å…¨é‡å¤åˆ¶ vs å¢é‡å¤åˆ¶</h4><p><strong>å¯¹æ¯”è¡¨</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>å…¨é‡å¤åˆ¶</th><th>å¢é‡å¤åˆ¶</th></tr></thead><tbody><tr><td><strong>è§¦å‘æ¡ä»¶</strong></td><td>é¦–æ¬¡è¿æ¥æˆ–offsetä¸åœ¨ç¼“å†²åŒº</td><td>offsetåœ¨ç¼“å†²åŒºä¸­</td></tr><tr><td><strong>ä¼ è¾“æ•°æ®</strong></td><td>å®Œæ•´RDBæ–‡ä»¶</td><td>ç¼ºå¤±çš„å‘½ä»¤</td></tr><tr><td><strong>ç½‘ç»œå¼€é”€</strong></td><td>âš ï¸ å¤§ï¼ˆå‡ MBåˆ°å‡ GBï¼‰</td><td>âœ… å°ï¼ˆå‡ KBåˆ°å‡ MBï¼‰</td></tr><tr><td><strong>è€—æ—¶</strong></td><td>âš ï¸ é•¿ï¼ˆå‡ åˆ†é’Ÿåˆ°å‡ ååˆ†é’Ÿï¼‰</td><td>âœ… çŸ­ï¼ˆå‡ ç§’åˆ°å‡ åˆ†é’Ÿï¼‰</td></tr><tr><td><strong>Masteræ€§èƒ½å½±å“</strong></td><td>âš ï¸ å¤§ï¼ˆéœ€è¦BGSAVEï¼‰</td><td>âœ… å°ï¼ˆåªå‘é€å‘½ä»¤ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>é¦–æ¬¡åŒæ­¥ã€é•¿æ—¶é—´æ–­çº¿</td><td>çŸ­æš‚æ–­çº¿é‡è¿</td></tr><tr><td><strong>æ¨èåº¦</strong></td><td>â­â­</td><td>â­â­â­â­â­</td></tr></tbody></table><p><strong>å¦‚ä½•å‡å°‘å…¨é‡å¤åˆ¶</strong>ï¼š</p><ol><li><p>âœ… <strong>åˆç†è®¾ç½®å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å»ºè®®è®¾ç½®ä¸ºï¼šæ¯ç§’å†™å…¥é‡ Ã— æœ€å¤§æ–­çº¿æ—¶é—´ Ã— 2</span></span><br><span class="line">repl-backlog-size 10mb</span><br></pre></td></tr></table></figure></li><li><p>âœ… <strong>ç›‘æ§å¤åˆ¶çŠ¶æ€</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šæœŸæ£€æŸ¥SlaveçŠ¶æ€</span></span><br><span class="line">INFO replication</span><br></pre></td></tr></table></figure></li><li><p>âœ… <strong>ç½‘ç»œä¼˜åŒ–</strong>ï¼š</p><ul><li>ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œè¿æ¥</li><li>é¿å…é¢‘ç¹çš„ç½‘ç»œä¸­æ–­</li></ul></li><li><p>âœ… <strong>åŠæ—¶å¤„ç†æ•…éšœ</strong>ï¼š</p><ul><li>å¿«é€Ÿæ¢å¤Slaveè¿æ¥</li><li>é¿å…é•¿æ—¶é—´æ–­çº¿</li></ul></li></ol><h4 id="9-4-4-æ— ç›˜å¤åˆ¶ï¼ˆDiskless-Replicationï¼‰"><a href="#9-4-4-æ— ç›˜å¤åˆ¶ï¼ˆDiskless-Replicationï¼‰" class="headerlink" title="9.4.4 æ— ç›˜å¤åˆ¶ï¼ˆDiskless Replicationï¼‰"></a>9.4.4 æ— ç›˜å¤åˆ¶ï¼ˆDiskless Replicationï¼‰</h4><p><strong>ä»€ä¹ˆæ˜¯æ— ç›˜å¤åˆ¶</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šMasterç›´æ¥å°†RDBæ•°æ®é€šè¿‡<strong>ç½‘ç»œ</strong>å‘é€ç»™Slaveï¼Œä¸å†™å…¥ç£ç›˜</li><li><strong>ç‰ˆæœ¬è¦æ±‚</strong>ï¼šRedis 2.8.18+</li><li><strong>ä¼˜åŠ¿</strong>ï¼šå‡å°‘ç£ç›˜IOï¼Œæé«˜å¤åˆ¶é€Ÿåº¦</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf (Master)</span></span><br><span class="line"><span class="comment"># å¼€å¯æ— ç›˜å¤åˆ¶</span></span><br><span class="line">repl-diskless-sync <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ— ç›˜å¤åˆ¶å»¶è¿Ÿæ—¶é—´ï¼ˆç­‰å¾…æ›´å¤šSlaveè¿æ¥ï¼‰</span></span><br><span class="line">repl-diskless-sync-delay 5</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œåŸç†</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä¼ ç»Ÿå¤åˆ¶ï¼š</span><br><span class="line">Master â†’ å†™å…¥ç£ç›˜ â†’ è¯»å–ç£ç›˜ â†’ ç½‘ç»œä¼ è¾“ â†’ Slave</span><br><span class="line"></span><br><span class="line">æ— ç›˜å¤åˆ¶ï¼š</span><br><span class="line">Master â†’ å†…å­˜ â†’ ç½‘ç»œä¼ è¾“ â†’ Slave</span><br></pre></td></tr></table></figure><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>âœ… ç£ç›˜IOæ€§èƒ½è¾ƒå·®</li><li>âœ… ç½‘ç»œå¸¦å®½å……è¶³</li><li>âœ… éœ€è¦å¿«é€Ÿå¤åˆ¶</li></ul><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ éœ€è¦è¶³å¤Ÿçš„ç½‘ç»œå¸¦å®½</li><li>âš ï¸ å¤šä¸ªSlaveåŒæ—¶è¿æ¥æ—¶ï¼Œä¼šç­‰å¾…<code>repl-diskless-sync-delay</code>ç§’</li></ul><h3 id="9-5-ä¸»ä»å¤åˆ¶æ³¨æ„äº‹é¡¹"><a href="#9-5-ä¸»ä»å¤åˆ¶æ³¨æ„äº‹é¡¹" class="headerlink" title="9.5 ä¸»ä»å¤åˆ¶æ³¨æ„äº‹é¡¹"></a>9.5 ä¸»ä»å¤åˆ¶æ³¨æ„äº‹é¡¹</h3><h4 id="9-5-1-æ•°æ®ä¸€è‡´æ€§"><a href="#9-5-1-æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="9.5.1 æ•°æ®ä¸€è‡´æ€§"></a>9.5.1 æ•°æ®ä¸€è‡´æ€§</h4><p><strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼š</p><ul><li><strong>ç‰¹ç‚¹</strong>ï¼šä¸»ä»å¤åˆ¶æ˜¯<strong>å¼‚æ­¥</strong>çš„ï¼Œå­˜åœ¨çŸ­æš‚çš„æ•°æ®ä¸ä¸€è‡´</li><li><strong>å»¶è¿Ÿ</strong>ï¼šé€šå¸¸å‡ æ¯«ç§’åˆ°å‡ ç§’</li><li><strong>å½±å“</strong>ï¼šSlaveå¯èƒ½è¯»å–åˆ°æ—§æ•°æ®</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´çº¿ï¼š</span><br><span class="line">T1: Masteræ‰§è¡Œ SET key value</span><br><span class="line">T2: Masterè¿”å›OKç»™å®¢æˆ·ç«¯</span><br><span class="line">T3: Masterå‘é€å‘½ä»¤ç»™Slaveï¼ˆç½‘ç»œå»¶è¿Ÿï¼‰</span><br><span class="line">T4: Slaveæ‰§è¡Œå‘½ä»¤ï¼Œæ•°æ®æ›´æ–°</span><br><span class="line"></span><br><span class="line">T2-T4ä¹‹é—´ï¼šSlaveå¯èƒ½è¿”å›æ—§æ•°æ®</span><br></pre></td></tr></table></figure><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li><p><strong>è¯»å†™åˆ†ç¦»ç­–ç•¥</strong>ï¼š</p><ul><li>å¯¹ä¸€è‡´æ€§è¦æ±‚é«˜çš„è¯»æ“ä½œï¼Œä»Masterè¯»å–</li><li>å¯¹ä¸€è‡´æ€§è¦æ±‚ä½çš„è¯»æ“ä½œï¼Œä»Slaveè¯»å–</li></ul></li><li><p><strong>ç›‘æ§å¤åˆ¶å»¶è¿Ÿ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹Slaveå»¶è¿Ÿ</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=1000,lag=1</span><br><span class="line"><span class="comment"># lag=1 è¡¨ç¤ºå»¶è¿Ÿ1ç§’</span></span><br></pre></td></tr></table></figure></li><li><p><strong>ç­‰å¾…å¤åˆ¶å®Œæˆ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™æ“ä½œåç­‰å¾…Nä¸ªSlaveå¤åˆ¶å®Œæˆ</span></span><br><span class="line">SET key value</span><br><span class="line">WAIT 2 1000  <span class="comment"># ç­‰å¾…2ä¸ªSlaveï¼Œè¶…æ—¶æ—¶é—´1000ms</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="9-5-2-ä¸»ä»åˆ‡æ¢"><a href="#9-5-2-ä¸»ä»åˆ‡æ¢" class="headerlink" title="9.5.2 ä¸»ä»åˆ‡æ¢"></a>9.5.2 ä¸»ä»åˆ‡æ¢</h4><p><strong>æ‰‹åŠ¨åˆ‡æ¢</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åœ¨Slaveä¸Šæ‰§è¡Œï¼Œå–æ¶ˆä¸»ä»å…³ç³»</span></span><br><span class="line">127.0.0.1:6380&gt; REPLICAOF NO ONE</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åœ¨Slaveä¸Šè®¾ç½®å¯†ç ï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span><br><span class="line">127.0.0.1:6380&gt; CONFIG SET requirepass newpassword</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å…¶ä»–SlaveæŒ‡å‘æ–°çš„Master</span></span><br><span class="line">127.0.0.1:6381&gt; REPLICAOF 127.0.0.1 6380</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>è‡ªåŠ¨åˆ‡æ¢</strong>ï¼š</p><ul><li>ä½¿ç”¨**Redis Sentinelï¼ˆå“¨å…µï¼‰**å®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»</li><li>è¯¦è§â€Rediså“¨å…µæ¨¡å¼â€ç« èŠ‚</li></ul><h4 id="9-5-3-æ•°æ®ä¸¢å¤±é£é™©"><a href="#9-5-3-æ•°æ®ä¸¢å¤±é£é™©" class="headerlink" title="9.5.3 æ•°æ®ä¸¢å¤±é£é™©"></a>9.5.3 æ•°æ®ä¸¢å¤±é£é™©</h4><p><strong>åœºæ™¯1ï¼šMasteræœªæŒä¹…åŒ–ï¼ŒMasterå®•æœº</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">é£é™©ï¼š</span><br><span class="line">- Masteræœªå¼€å¯RDBæˆ–AOF</span><br><span class="line">- Masterå®•æœºï¼Œå†…å­˜æ•°æ®ä¸¢å¤±</span><br><span class="line">- Slaveæœ‰æ•°æ®ï¼Œä½†å¯èƒ½ä¸æ˜¯æœ€æ–°çš„</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line">- Masterå¿…é¡»å¼€å¯æŒä¹…åŒ–ï¼ˆRDBæˆ–AOFï¼‰</span><br><span class="line">- æ¨èä½¿ç”¨AOF everysecæˆ–æ··åˆæŒä¹…åŒ–</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯2ï¼šMasteræŒä¹…åŒ–å»¶è¿Ÿï¼ŒMasterå®•æœº</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">é£é™©ï¼š</span><br><span class="line">- Masterå¼€å¯AOF everysec</span><br><span class="line">- æœ€å1ç§’çš„å†™æ“ä½œå¯èƒ½æœªæŒä¹…åŒ–</span><br><span class="line">- Masterå®•æœºï¼Œè¿™1ç§’çš„æ•°æ®ä¸¢å¤±</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line">- ä½¿ç”¨AOF alwaysï¼ˆæ€§èƒ½å½±å“å¤§ï¼‰</span><br><span class="line">- æˆ–æ¥å—å°‘é‡æ•°æ®ä¸¢å¤±çš„é£é™©</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯3ï¼šç½‘ç»œåˆ†åŒºå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">é£é™©ï¼š</span><br><span class="line">- Masterå’ŒSlaveç½‘ç»œåˆ†åŒº</span><br><span class="line">- Masterç»§ç»­æ¥å—å†™æ“ä½œ</span><br><span class="line">- Slaveæ— æ³•åŒæ­¥ï¼Œæ•°æ®ä¸ä¸€è‡´</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line">- ä½¿ç”¨Redis Sentinelç›‘æ§</span><br><span class="line">- é…ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</span><br></pre></td></tr></table></figure><h4 id="9-5-4-æ€§èƒ½ä¼˜åŒ–"><a href="#9-5-4-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="9.5.4 æ€§èƒ½ä¼˜åŒ–"></a>9.5.4 æ€§èƒ½ä¼˜åŒ–</h4><p><strong>1. å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¼˜åŒ–</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®ä¸šåŠ¡é‡è®¾ç½®åˆç†å¤§å°</span></span><br><span class="line"><span class="comment"># å…¬å¼ï¼šæ¯ç§’å†™å…¥é‡ Ã— æœ€å¤§æ–­çº¿æ—¶é—´ Ã— 2</span></span><br><span class="line">repl-backlog-size 10mb</span><br></pre></td></tr></table></figure><p><strong>2. æ— ç›˜å¤åˆ¶</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯æ— ç›˜å¤åˆ¶ï¼Œå‡å°‘ç£ç›˜IO</span></span><br><span class="line">repl-diskless-sync <span class="built_in">yes</span></span><br><span class="line">repl-diskless-sync-delay 5</span><br></pre></td></tr></table></figure><p><strong>3. çº§è”å¤åˆ¶</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ä¸»-ä»-ä»æ¶æ„ï¼Œå‡è½»Masterå‹åŠ›</span><br></pre></td></tr></table></figure><p><strong>4. è¯»å†™åˆ†ç¦»</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å†™æ“ä½œ â†’ Master</span><br><span class="line">è¯»æ“ä½œ â†’ Slaveï¼ˆå¤šä¸ªSlaveè´Ÿè½½å‡è¡¡ï¼‰</span><br></pre></td></tr></table></figure><h4 id="9-5-5-å®‰å…¨é…ç½®"><a href="#9-5-5-å®‰å…¨é…ç½®" class="headerlink" title="9.5.5 å®‰å…¨é…ç½®"></a>9.5.5 å®‰å…¨é…ç½®</h4><p><strong>1. å¯†ç è®¤è¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Masterè®¾ç½®å¯†ç </span></span><br><span class="line">requirepass master123</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slaveé…ç½®Masterå¯†ç </span></span><br><span class="line">masterauth master123</span><br></pre></td></tr></table></figure><p><strong>2. ç½‘ç»œéš”ç¦»</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Masteråªå…è®¸ç‰¹å®šIPè¿æ¥</span></span><br><span class="line"><span class="built_in">bind</span> 192.168.1.100</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨é˜²ç«å¢™é™åˆ¶è®¿é—®</span></span><br><span class="line">iptables -A INPUT -p tcp --dport 6379 -s 192.168.1.0/24 -j ACCEPT</span><br></pre></td></tr></table></figure><p><strong>3. ç¦ç”¨å±é™©å‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Masterä¸Šç¦ç”¨FLUSHALLã€FLUSHDBç­‰å±é™©å‘½ä»¤</span></span><br><span class="line">rename-command FLUSHALL <span class="string">&quot;&quot;</span></span><br><span class="line">rename-command FLUSHDB <span class="string">&quot;&quot;</span></span><br><span class="line">rename-command CONFIG <span class="string">&quot;CONFIG_9f8d7c6b5a4e3d2c1b0a9f8e7d6c5b4a&quot;</span></span><br></pre></td></tr></table></figure><h4 id="9-5-6-ç›‘æ§æŒ‡æ ‡"><a href="#9-5-6-ç›‘æ§æŒ‡æ ‡" class="headerlink" title="9.5.6 ç›‘æ§æŒ‡æ ‡"></a>9.5.6 ç›‘æ§æŒ‡æ ‡</h4><p><strong>å…³é”®æŒ‡æ ‡</strong>ï¼š</p><table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th><th>æ­£å¸¸å€¼</th></tr></thead><tbody><tr><td><code>connected_slaves</code></td><td>è¿æ¥çš„Slaveæ•°é‡</td><td>&gt; 0</td></tr><tr><td><code>master_repl_offset</code></td><td>Masterå¤åˆ¶åç§»é‡</td><td>æŒç»­å¢é•¿</td></tr><tr><td><code>slave_repl_offset</code></td><td>Slaveå¤åˆ¶åç§»é‡</td><td>æ¥è¿‘Master</td></tr><tr><td><code>lag</code></td><td>å¤åˆ¶å»¶è¿Ÿï¼ˆç§’ï¼‰</td><td>&lt; 1</td></tr><tr><td><code>master_link_status</code></td><td>è¿æ¥çŠ¶æ€</td><td>up</td></tr><tr><td><code>slave_priority</code></td><td>Slaveä¼˜å…ˆçº§</td><td>æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</td></tr></tbody></table><p><strong>ç›‘æ§å‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Masterç›‘æ§</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slaveç›‘æ§</span></span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¤åˆ¶å»¶è¿Ÿ</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication | grep lag</span><br></pre></td></tr></table></figure><h3 id="9-6-å®æˆ˜æ¡ˆä¾‹"><a href="#9-6-å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="9.6 å®æˆ˜æ¡ˆä¾‹"></a>9.6 å®æˆ˜æ¡ˆä¾‹</h3><h4 id="9-6-1-æ¡ˆä¾‹1ï¼šä¸€ä¸»äºŒä»æ¶æ„"><a href="#9-6-1-æ¡ˆä¾‹1ï¼šä¸€ä¸»äºŒä»æ¶æ„" class="headerlink" title="9.6.1 æ¡ˆä¾‹1ï¼šä¸€ä¸»äºŒä»æ¶æ„"></a>9.6.1 æ¡ˆä¾‹1ï¼šä¸€ä¸»äºŒä»æ¶æ„</h4><p><strong>éœ€æ±‚</strong>ï¼š</p><ul><li>1ä¸ªMasterå¤„ç†å†™æ“ä½œ</li><li>2ä¸ªSlaveå¤„ç†è¯»æ“ä½œ</li><li>å®ç°è¯»å†™åˆ†ç¦»</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Masteré…ç½® (redis-master.conf)</span></span><br><span class="line">port 6379</span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">requirepass master123</span><br><span class="line">repl-backlog-size 10mb</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave1é…ç½® (redis-slave1.conf)</span></span><br><span class="line">port 6380</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br><span class="line">replica-read-only <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave2é…ç½® (redis-slave2.conf)</span></span><br><span class="line">port 6381</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br><span class="line">replica-read-only <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>åº”ç”¨ä»£ç ï¼ˆJavaï¼‰</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†™æ“ä½œä½¿ç”¨Master</span></span><br><span class="line"><span class="type">Jedis</span> <span class="variable">master</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">master.auth(<span class="string">&quot;master123&quot;</span>);</span><br><span class="line">master.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»æ“ä½œä½¿ç”¨Slaveï¼ˆè´Ÿè½½å‡è¡¡ï¼‰</span></span><br><span class="line"><span class="type">JedisPoolConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">List&lt;JedisPool&gt; slavePools = Arrays.asList(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">JedisPool</span>(config, <span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6380</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">JedisPool</span>(config, <span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6381</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½®è¯¢æˆ–éšæœºé€‰æ‹©Slave</span></span><br><span class="line"><span class="type">Jedis</span> <span class="variable">slave</span> <span class="operator">=</span> slavePools.get(random.nextInt(<span class="number">2</span>)).getResource();</span><br><span class="line"><span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> slave.get(<span class="string">&quot;key&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="9-6-2-æ¡ˆä¾‹2ï¼šä¸»ä»åˆ‡æ¢æ¼”ç»ƒ"><a href="#9-6-2-æ¡ˆä¾‹2ï¼šä¸»ä»åˆ‡æ¢æ¼”ç»ƒ" class="headerlink" title="9.6.2 æ¡ˆä¾‹2ï¼šä¸»ä»åˆ‡æ¢æ¼”ç»ƒ"></a>9.6.2 æ¡ˆä¾‹2ï¼šä¸»ä»åˆ‡æ¢æ¼”ç»ƒ</h4><p><strong>åœºæ™¯</strong>ï¼šMasteræ•…éšœï¼Œæ‰‹åŠ¨åˆ‡æ¢åˆ°Slave</p><p><strong>æ­¥éª¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åœæ­¢Masterï¼ˆæ¨¡æ‹Ÿæ•…éšœï¼‰</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379 SHUTDOWN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åœ¨Slave1ä¸Šå–æ¶ˆä¸»ä»å…³ç³»</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6380</span><br><span class="line">127.0.0.1:6380&gt; REPLICAOF NO ONE</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. è®¾ç½®æ–°Masterå¯†ç </span></span><br><span class="line">127.0.0.1:6380&gt; CONFIG SET requirepass newmaster123</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å°†Slave2æŒ‡å‘æ–°çš„Master</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6381</span><br><span class="line">127.0.0.1:6381&gt; REPLICAOF 127.0.0.1 6380</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6381&gt; CONFIG SET masterauth newmaster123</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. éªŒè¯æ–°æ¶æ„</span></span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line">role:master</span><br><span class="line">connected_slaves:1</span><br></pre></td></tr></table></figure><h4 id="9-6-3-æ¡ˆä¾‹3ï¼šçº§è”å¤åˆ¶æ¶æ„"><a href="#9-6-3-æ¡ˆä¾‹3ï¼šçº§è”å¤åˆ¶æ¶æ„" class="headerlink" title="9.6.3 æ¡ˆä¾‹3ï¼šçº§è”å¤åˆ¶æ¶æ„"></a>9.6.3 æ¡ˆä¾‹3ï¼šçº§è”å¤åˆ¶æ¶æ„</h4><p><strong>éœ€æ±‚</strong>ï¼š</p><ul><li>å‡è½»Masterå‹åŠ›</li><li>æ”¯æŒå¤šçº§ä»èŠ‚ç‚¹</li></ul><p><strong>æ¶æ„</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Master (6379)</span><br><span class="line">  â†“</span><br><span class="line">Slave1 (6380) â† ä»Masterå¤åˆ¶</span><br><span class="line">  â†“</span><br><span class="line">Slave2 (6381) â† ä»Slave1å¤åˆ¶</span><br><span class="line">Slave3 (6382) â† ä»Slave1å¤åˆ¶</span><br></pre></td></tr></table></figure><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slave1é…ç½®ï¼ˆå…è®¸å…¶ä»–Slaveè¿æ¥ï¼‰</span></span><br><span class="line">port 6380</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">replica-read-only <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave2å’ŒSlave3é…ç½®ï¼ˆä»Slave1å¤åˆ¶ï¼‰</span></span><br><span class="line">port 6381</span><br><span class="line">replicaof 127.0.0.1 6380</span><br><span class="line"></span><br><span class="line">port 6382</span><br><span class="line">replicaof 127.0.0.1 6380</span><br></pre></td></tr></table></figure><h3 id="9-7-æ€»ç»“"><a href="#9-7-æ€»ç»“" class="headerlink" title="9.7 æ€»ç»“"></a>9.7 æ€»ç»“</h3><p><strong>ä¸»ä»å¤åˆ¶æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p><ol><li>âœ… <strong>è¯»å†™åˆ†ç¦»</strong>ï¼šMasterå†™ï¼ŒSlaveè¯»ï¼Œæé«˜æ€§èƒ½</li><li>âœ… <strong>æ•°æ®å¤‡ä»½</strong>ï¼šSlaveä¿å­˜å®Œæ•´æ•°æ®å‰¯æœ¬</li><li>âœ… <strong>é«˜å¯ç”¨</strong>ï¼šMasteræ•…éšœæ—¶å¯ä»¥åˆ‡æ¢åˆ°Slave</li><li>âœ… <strong>å¢é‡å¤åˆ¶</strong>ï¼šPSYNCå‘½ä»¤æ”¯æŒå¢é‡å¤åˆ¶ï¼Œæé«˜æ•ˆç‡</li><li>âœ… <strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼šå¼‚æ­¥å¤åˆ¶ï¼Œå­˜åœ¨çŸ­æš‚å»¶è¿Ÿ</li></ol><p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p><ol><li>âœ… <strong>Masterå¿…é¡»å¼€å¯æŒä¹…åŒ–</strong>ï¼ˆRDBæˆ–AOFï¼‰</li><li>âœ… <strong>åˆç†è®¾ç½®å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°</strong></li><li>âœ… <strong>ç›‘æ§å¤åˆ¶çŠ¶æ€å’Œå»¶è¿Ÿ</strong></li><li>âœ… <strong>ä½¿ç”¨å¯†ç è®¤è¯ï¼Œä¿è¯å®‰å…¨</strong></li><li>âœ… <strong>ç”Ÿäº§ç¯å¢ƒä½¿ç”¨Redis Sentinelå®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»</strong></li></ol><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ˜¯å¦é€‚åˆ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>è¯»å†™åˆ†ç¦»</strong></td><td>âœ… é€‚åˆ</td><td>è¯»å¤šå†™å°‘çš„ä¸šåŠ¡</td></tr><tr><td><strong>æ•°æ®å¤‡ä»½</strong></td><td>âœ… é€‚åˆ</td><td>éœ€è¦æ•°æ®å†—ä½™</td></tr><tr><td><strong>é«˜å¯ç”¨</strong></td><td>âš ï¸ éœ€è¦é…åˆSentinel</td><td>éœ€è¦è‡ªåŠ¨æ•…éšœè½¬ç§»</td></tr><tr><td><strong>å¤§è§„æ¨¡è¯»</strong></td><td>âœ… é€‚åˆ</td><td>å¯ä»¥æ‰©å±•å¤šä¸ªSlave</td></tr><tr><td><strong>å¼ºä¸€è‡´æ€§</strong></td><td>âŒ ä¸é€‚åˆ</td><td>å­˜åœ¨æ•°æ®å»¶è¿Ÿ</td></tr></tbody></table><hr><h2 id="10-Rediså“¨å…µæ¨¡å¼"><a href="#10-Rediså“¨å…µæ¨¡å¼" class="headerlink" title="10. Rediså“¨å…µæ¨¡å¼"></a>10. Rediså“¨å…µæ¨¡å¼</h2><h3 id="10-1-ä»€ä¹ˆæ˜¯å“¨å…µæ¨¡å¼"><a href="#10-1-ä»€ä¹ˆæ˜¯å“¨å…µæ¨¡å¼" class="headerlink" title="10.1 ä»€ä¹ˆæ˜¯å“¨å…µæ¨¡å¼"></a>10.1 ä»€ä¹ˆæ˜¯å“¨å…µæ¨¡å¼</h3><h4 id="10-1-1-å“¨å…µæ¨¡å¼å®šä¹‰"><a href="#10-1-1-å“¨å…µæ¨¡å¼å®šä¹‰" class="headerlink" title="10.1.1 å“¨å…µæ¨¡å¼å®šä¹‰"></a>10.1.1 å“¨å…µæ¨¡å¼å®šä¹‰</h4><p><strong>Redis Sentinelï¼ˆå“¨å…µï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šRedisçš„**é«˜å¯ç”¨æ€§ï¼ˆHigh Availabilityï¼‰**è§£å†³æ–¹æ¡ˆ</li><li><strong>ä½œç”¨</strong>ï¼šç›‘æ§Masterå’ŒSlaveï¼Œå®ç°<strong>è‡ªåŠ¨æ•…éšœè½¬ç§»</strong></li><li><strong>ç‰ˆæœ¬è¦æ±‚</strong>ï¼šRedis 2.8+</li></ul><p><strong>è§£å†³çš„é—®é¢˜</strong>ï¼š</p><ul><li>âŒ <strong>ä¸»ä»å¤åˆ¶çš„ä¸è¶³</strong>ï¼šMasteræ•…éšœæ—¶éœ€è¦<strong>æ‰‹åŠ¨åˆ‡æ¢</strong></li><li>âŒ <strong>æ— æ³•è‡ªåŠ¨æ¢å¤</strong>ï¼šéœ€è¦äººå·¥å¹²é¢„ï¼Œæ¢å¤æ—¶é—´é•¿</li><li>âŒ <strong>æœåŠ¡ä¸­æ–­</strong>ï¼šåˆ‡æ¢æœŸé—´æœåŠ¡ä¸å¯ç”¨</li></ul><p><strong>å“¨å…µæ¨¡å¼çš„ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… <strong>è‡ªåŠ¨æ•…éšœè½¬ç§»</strong>ï¼šMasteræ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°Slave</li><li>âœ… <strong>é«˜å¯ç”¨æ€§</strong>ï¼šå‡å°‘æœåŠ¡ä¸­æ–­æ—¶é—´</li><li>âœ… <strong>è‡ªåŠ¨å‘ç°</strong>ï¼šè‡ªåŠ¨å‘ç°Masterå’ŒSlave</li><li>âœ… <strong>é€šçŸ¥æœºåˆ¶</strong>ï¼šæ•…éšœæ—¶å¯ä»¥é€šè¿‡è„šæœ¬é€šçŸ¥ç®¡ç†å‘˜</li></ul><h4 id="10-1-2-å“¨å…µæ¨¡å¼æ¶æ„"><a href="#10-1-2-å“¨å…µæ¨¡å¼æ¶æ„" class="headerlink" title="10.1.2 å“¨å…µæ¨¡å¼æ¶æ„"></a>10.1.2 å“¨å…µæ¨¡å¼æ¶æ„</h4><p><strong>æ¶æ„å›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Master    â”‚ (ä¸»èŠ‚ç‚¹)</span><br><span class="line">â”‚   (6379)    â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚ æ•°æ®åŒæ­¥</span><br><span class="line">       â”‚</span><br><span class="line">   â”Œâ”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">   â”‚       â”‚         â”‚</span><br><span class="line">â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”</span><br><span class="line">â”‚Slave1â”‚ â”‚Slave2â”‚ â”‚Slave3â”‚ (ä»èŠ‚ç‚¹)</span><br><span class="line">â”‚(6380)â”‚ â”‚(6381)â”‚ â”‚(6382)â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜</span><br><span class="line">   â†‘       â†‘       â†‘</span><br><span class="line">   â”‚       â”‚       â”‚</span><br><span class="line">   â””â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”˜</span><br><span class="line">       â”‚       â”‚</span><br><span class="line">   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”¬â”€â”€â”€â–¼â”€â”€â”€â”¬â”€â”€â”€â–¼â”€â”€â”€â”</span><br><span class="line">   â”‚Sentinelâ”‚Sentinelâ”‚Sentinelâ”‚ (å“¨å…µèŠ‚ç‚¹)</span><br><span class="line">   â”‚(26379) â”‚(26380) â”‚(26381) â”‚</span><br><span class="line">   â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚       â”‚       â”‚</span><br><span class="line">       â””â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”˜</span><br><span class="line">           â”‚       â”‚</span><br><span class="line">      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”</span><br><span class="line">      â”‚  å“¨å…µé›†ç¾¤é€šä¿¡    â”‚</span><br><span class="line">      â”‚  (è‡ªåŠ¨å‘ç°)      â”‚</span><br><span class="line">      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><p><strong>ç»„ä»¶è¯´æ˜</strong>ï¼š</p><table><thead><tr><th>ç»„ä»¶</th><th>è¯´æ˜</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>Master</strong></td><td>Redisä¸»èŠ‚ç‚¹</td><td>å¤„ç†å†™æ“ä½œ</td></tr><tr><td><strong>Slave</strong></td><td>Redisä»èŠ‚ç‚¹</td><td>å¤„ç†è¯»æ“ä½œï¼Œå¤‡ä»½æ•°æ®</td></tr><tr><td><strong>Sentinel</strong></td><td>å“¨å…µèŠ‚ç‚¹</td><td>ç›‘æ§Masterå’ŒSlaveï¼Œæ‰§è¡Œæ•…éšœè½¬ç§»</td></tr></tbody></table><h4 id="10-1-3-å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½"><a href="#10-1-3-å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="10.1.3 å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½"></a>10.1.3 å“¨å…µçš„æ ¸å¿ƒåŠŸèƒ½</h4><p><strong>1. ç›‘æ§ï¼ˆMonitoringï¼‰</strong></p><ul><li><strong>åŠŸèƒ½</strong>ï¼šæŒç»­ç›‘æ§Masterå’ŒSlaveæ˜¯å¦æ­£å¸¸è¿è¡Œ</li><li><strong>æ–¹å¼</strong>ï¼šå®šæœŸå‘é€PINGå‘½ä»¤</li><li><strong>é¢‘ç‡</strong>ï¼šé»˜è®¤æ¯ç§’1æ¬¡</li></ul><p><strong>2. é€šçŸ¥ï¼ˆNotificationï¼‰</strong></p><ul><li><strong>åŠŸèƒ½</strong>ï¼šå½“è¢«ç›‘æ§çš„Rediså®ä¾‹å‡ºç°é—®é¢˜æ—¶ï¼Œé€šçŸ¥ç®¡ç†å‘˜</li><li><strong>æ–¹å¼</strong>ï¼šæ‰§è¡Œé…ç½®çš„è„šæœ¬æˆ–å‘é€é€šçŸ¥</li></ul><p><strong>3. è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆAutomatic Failoverï¼‰</strong></p><ul><li><strong>åŠŸèƒ½</strong>ï¼šMasteræ•…éšœæ—¶ï¼Œè‡ªåŠ¨å°†æŸä¸ªSlaveæå‡ä¸ºMaster</li><li><strong>è¿‡ç¨‹</strong>ï¼š<ol><li>æ£€æµ‹Masteræ•…éšœ</li><li>é€‰ä¸¾æ–°çš„Master</li><li>é€šçŸ¥å…¶ä»–Slaveåˆ‡æ¢</li><li>æ›´æ–°å®¢æˆ·ç«¯é…ç½®</li></ol></li></ul><p><strong>4. é…ç½®æä¾›è€…ï¼ˆConfiguration Providerï¼‰</strong></p><ul><li><strong>åŠŸèƒ½</strong>ï¼šå®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œè¿”å›å½“å‰Masterçš„åœ°å€</li><li><strong>ä½œç”¨</strong>ï¼šå®¢æˆ·ç«¯å¯ä»¥è‡ªåŠ¨å‘ç°Master</li></ul><h4 id="10-1-4-å“¨å…µæ¨¡å¼-vs-ä¸»ä»å¤åˆ¶"><a href="#10-1-4-å“¨å…µæ¨¡å¼-vs-ä¸»ä»å¤åˆ¶" class="headerlink" title="10.1.4 å“¨å…µæ¨¡å¼ vs ä¸»ä»å¤åˆ¶"></a>10.1.4 å“¨å…µæ¨¡å¼ vs ä¸»ä»å¤åˆ¶</h4><p><strong>å¯¹æ¯”è¡¨</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>ä¸»ä»å¤åˆ¶</th><th>å“¨å…µæ¨¡å¼</th></tr></thead><tbody><tr><td><strong>æ•…éšœæ£€æµ‹</strong></td><td>âŒ æ— </td><td>âœ… è‡ªåŠ¨æ£€æµ‹</td></tr><tr><td><strong>æ•…éšœè½¬ç§»</strong></td><td>âŒ æ‰‹åŠ¨</td><td>âœ… è‡ªåŠ¨</td></tr><tr><td><strong>é«˜å¯ç”¨æ€§</strong></td><td>âš ï¸ ä½</td><td>âœ… é«˜</td></tr><tr><td><strong>æœåŠ¡ä¸­æ–­</strong></td><td>âš ï¸ éœ€è¦äººå·¥å¹²é¢„</td><td>âœ… è‡ªåŠ¨æ¢å¤</td></tr><tr><td><strong>å¤æ‚åº¦</strong></td><td>âœ… ç®€å•</td><td>âš ï¸ è¾ƒå¤æ‚</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ•°æ®å¤‡ä»½ã€è¯»å†™åˆ†ç¦»</td><td>é«˜å¯ç”¨ç”Ÿäº§ç¯å¢ƒ</td></tr></tbody></table><h3 id="10-2-å“¨å…µé…ç½®"><a href="#10-2-å“¨å…µé…ç½®" class="headerlink" title="10.2 å“¨å…µé…ç½®"></a>10.2 å“¨å…µé…ç½®</h3><h4 id="10-2-1-åŸºæœ¬é…ç½®"><a href="#10-2-1-åŸºæœ¬é…ç½®" class="headerlink" title="10.2.1 åŸºæœ¬é…ç½®"></a>10.2.1 åŸºæœ¬é…ç½®</h4><p><strong>å“¨å…µé…ç½®æ–‡ä»¶ï¼ˆsentinel.confï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sentinel.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç«¯å£ï¼ˆé»˜è®¤26379ï¼‰</span></span><br><span class="line">port 26379</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼</span></span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">logfile /var/log/redis/sentinel.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="built_in">dir</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›‘æ§Master</span></span><br><span class="line"><span class="comment"># æ ¼å¼ï¼šsentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;port&gt; &lt;quorum&gt;</span></span><br><span class="line"><span class="comment"># master-name: Masterçš„åç§°ï¼ˆè‡ªå®šä¹‰ï¼‰</span></span><br><span class="line"><span class="comment"># ip: Masterçš„IPåœ°å€</span></span><br><span class="line"><span class="comment"># port: Masterçš„ç«¯å£</span></span><br><span class="line"><span class="comment"># quorum: æŠ•ç¥¨æ•°ï¼ˆè‡³å°‘éœ€è¦å¤šå°‘ä¸ªSentinelåŒæ„æ‰èƒ½åˆ¤å®šMasteræ•…éšœï¼‰</span></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># Masterå¯†ç ï¼ˆå¦‚æœMasterè®¾ç½®äº†å¯†ç ï¼‰</span></span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line"></span><br><span class="line"><span class="comment"># Masteræ•…éšœåˆ¤å®šæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line"><span class="comment"># å¦‚æœåœ¨è¿™ä¸ªæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°Masterçš„å“åº”ï¼Œåˆ¤å®šä¸ºæ•…éšœ</span></span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•…éšœè½¬ç§»è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¹¶è¡ŒåŒæ­¥Slaveæ•°é‡</span></span><br><span class="line"><span class="comment"># æ•…éšœè½¬ç§»æ—¶ï¼ŒåŒæ—¶å‘å¤šå°‘ä¸ªSlaveå‘é€åŒæ­¥å‘½ä»¤</span></span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br></pre></td></tr></table></figure><p><strong>é…ç½®è¯´æ˜</strong>ï¼š</p><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th><th>æ¨èå€¼</th></tr></thead><tbody><tr><td><code>port</code></td><td>å“¨å…µç«¯å£</td><td>26379</td><td>26379</td></tr><tr><td><code>sentinel monitor</code></td><td>ç›‘æ§çš„Master</td><td>-</td><td>å¿…é¡»é…ç½®</td></tr><tr><td><code>quorum</code></td><td>æŠ•ç¥¨æ•°</td><td>-</td><td>è‡³å°‘2ï¼ˆ3ä¸ªå“¨å…µæ—¶ï¼‰</td></tr><tr><td><code>down-after-milliseconds</code></td><td>æ•…éšœåˆ¤å®šæ—¶é—´</td><td>30000</td><td>5000-10000</td></tr><tr><td><code>failover-timeout</code></td><td>æ•…éšœè½¬ç§»è¶…æ—¶</td><td>180000</td><td>10000-30000</td></tr><tr><td><code>parallel-syncs</code></td><td>å¹¶è¡ŒåŒæ­¥æ•°</td><td>1</td><td>1-3</td></tr></tbody></table><h4 id="10-2-2-å¯åŠ¨å“¨å…µ"><a href="#10-2-2-å¯åŠ¨å“¨å…µ" class="headerlink" title="10.2.2 å¯åŠ¨å“¨å…µ"></a>10.2.2 å¯åŠ¨å“¨å…µ</h4><p><strong>å¯åŠ¨å‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶</span></span><br><span class="line">redis-sentinel /etc/redis/sentinel.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šä½¿ç”¨redis-serverï¼ˆæ¨èï¼‰</span></span><br><span class="line">redis-server /etc/redis/sentinel.conf --sentinel</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯å¯åŠ¨</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å“¨å…µè¿›ç¨‹</span></span><br><span class="line">ps aux | grep sentinel</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å“¨å…µä¿¡æ¯</span></span><br><span class="line">redis-cli -p 26379</span><br><span class="line">127.0.0.1:26379&gt; INFO sentinel</span><br><span class="line"><span class="comment"># Sentinel</span></span><br><span class="line">sentinel_masters:1</span><br><span class="line">sentinel_tilt:0</span><br><span class="line">sentinel_running_scripts:0</span><br><span class="line">sentinel_scripts_queue_length:0</span><br><span class="line">sentinel_simulate_failure_flags:0</span><br><span class="line">master0:name=mymaster,status=ok,address=127.0.0.1:6379,slaves=2,sentinels=3</span><br></pre></td></tr></table></figure><h4 id="10-2-3-å¤šå“¨å…µé…ç½®"><a href="#10-2-3-å¤šå“¨å…µé…ç½®" class="headerlink" title="10.2.3 å¤šå“¨å…µé…ç½®"></a>10.2.3 å¤šå“¨å…µé…ç½®</h4><p><strong>ä¸ºä»€ä¹ˆéœ€è¦å¤šä¸ªå“¨å…µï¼Ÿ</strong></p><ul><li>âœ… <strong>é˜²æ­¢è¯¯åˆ¤</strong>ï¼šå•ä¸ªå“¨å…µå¯èƒ½è¯¯åˆ¤Masteræ•…éšœ</li><li>âœ… <strong>é«˜å¯ç”¨</strong>ï¼šå“¨å…µæœ¬èº«ä¹Ÿéœ€è¦é«˜å¯ç”¨</li><li>âœ… <strong>æŠ•ç¥¨æœºåˆ¶</strong>ï¼šéœ€è¦å¤šä¸ªå“¨å…µæŠ•ç¥¨å†³å®šæ•…éšœè½¬ç§»</li></ul><p><strong>æ¨èé…ç½®</strong>ï¼š</p><ul><li><strong>è‡³å°‘3ä¸ªå“¨å…µ</strong>ï¼ˆå¥‡æ•°ä¸ªï¼Œé¿å…è„‘è£‚ï¼‰</li><li><strong>quorumè®¾ç½®ä¸º2</strong>ï¼ˆè‡³å°‘2ä¸ªå“¨å…µåŒæ„ï¼‰</li></ul><p><strong>é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sentinel1é…ç½® (sentinel1.conf)</span></span><br><span class="line">port 26379</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sentinel2é…ç½® (sentinel2.conf)</span></span><br><span class="line">port 26380</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sentinel3é…ç½® (sentinel3.conf)</span></span><br><span class="line">port 26381</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨æ‰€æœ‰å“¨å…µ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis/sentinel1.conf --sentinel</span><br><span class="line">redis-server /etc/redis/sentinel2.conf --sentinel</span><br><span class="line">redis-server /etc/redis/sentinel3.conf --sentinel</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯å“¨å…µé›†ç¾¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:26379&gt; SENTINEL sentinels mymaster</span><br><span class="line">1)  1) <span class="string">&quot;name&quot;</span></span><br><span class="line">    2) <span class="string">&quot;127.0.0.1:26380&quot;</span></span><br><span class="line">    3) <span class="string">&quot;ip&quot;</span></span><br><span class="line">    4) <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">    5) <span class="string">&quot;port&quot;</span></span><br><span class="line">    6) <span class="string">&quot;26380&quot;</span></span><br><span class="line">    7) <span class="string">&quot;runid&quot;</span></span><br><span class="line">    8) <span class="string">&quot;abc123...&quot;</span></span><br><span class="line">    9) <span class="string">&quot;flags&quot;</span></span><br><span class="line">   10) <span class="string">&quot;sentinel&quot;</span></span><br><span class="line">2)  1) <span class="string">&quot;name&quot;</span></span><br><span class="line">    2) <span class="string">&quot;127.0.0.1:26381&quot;</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h4 id="10-2-4-é«˜çº§é…ç½®"><a href="#10-2-4-é«˜çº§é…ç½®" class="headerlink" title="10.2.4 é«˜çº§é…ç½®"></a>10.2.4 é«˜çº§é…ç½®</h4><p><strong>é€šçŸ¥è„šæœ¬</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sentinel.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•…éšœè½¬ç§»æ—¶æ‰§è¡Œè„šæœ¬</span></span><br><span class="line"><span class="comment"># æ ¼å¼ï¼šsentinel notification-script &lt;master-name&gt; &lt;script-path&gt;</span></span><br><span class="line">sentinel notification-script mymaster /etc/redis/notify.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯é‡æ–°é…ç½®è„šæœ¬</span></span><br><span class="line">sentinel client-reconfig-script mymaster /etc/redis/reconfig.sh</span><br></pre></td></tr></table></figure><p><strong>é€šçŸ¥è„šæœ¬ç¤ºä¾‹ï¼ˆnotify.shï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># notify.sh</span></span><br><span class="line"></span><br><span class="line">MASTER_IP=<span class="variable">$6</span></span><br><span class="line">MASTER_PORT=<span class="variable">$7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€é‚®ä»¶é€šçŸ¥</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Masteræ•…éšœè½¬ç§»: <span class="variable">$MASTER_IP</span>:<span class="variable">$MASTER_PORT</span>&quot;</span> | mail -s <span class="string">&quot;Redisæ•…éšœè½¬ç§»&quot;</span> admin@example.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€çŸ­ä¿¡é€šçŸ¥ï¼ˆç¤ºä¾‹ï¼‰</span></span><br><span class="line"><span class="comment"># curl -X POST &quot;https://api.sms.com/send&quot; -d &quot;message=Redisæ•…éšœè½¬ç§»&quot;</span></span><br></pre></td></tr></table></figure><p><strong>å®¢æˆ·ç«¯é‡æ–°é…ç½®è„šæœ¬ï¼ˆreconfig.shï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># reconfig.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°è´Ÿè½½å‡è¡¡å™¨é…ç½®</span></span><br><span class="line"><span class="comment"># æ›´æ–°DNSè®°å½•</span></span><br><span class="line"><span class="comment"># æ›´æ–°åº”ç”¨é…ç½®</span></span><br></pre></td></tr></table></figure><p><strong>å…¶ä»–é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿æŠ¤æ¨¡å¼ï¼ˆé»˜è®¤å¼€å¯ï¼‰</span></span><br><span class="line">protected-mode <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å“¨å…µå¯†ç ï¼ˆå¦‚æœå¼€å¯ä¿æŠ¤æ¨¡å¼ï¼‰</span></span><br><span class="line">requirepass sentinel123</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—çº§åˆ«</span></span><br><span class="line">loglevel notice</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡ŒIDæ–‡ä»¶</span></span><br><span class="line">sentinel myid abc123def456...</span><br></pre></td></tr></table></figure><h3 id="10-3-æ•…éšœè½¬ç§»"><a href="#10-3-æ•…éšœè½¬ç§»" class="headerlink" title="10.3 æ•…éšœè½¬ç§»"></a>10.3 æ•…éšœè½¬ç§»</h3><h4 id="10-3-1-æ•…éšœæ£€æµ‹"><a href="#10-3-1-æ•…éšœæ£€æµ‹" class="headerlink" title="10.3.1 æ•…éšœæ£€æµ‹"></a>10.3.1 æ•…éšœæ£€æµ‹</h4><p><strong>æ£€æµ‹æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1. å“¨å…µæ¯ç§’å‘Masterå‘é€PINGå‘½ä»¤</span><br><span class="line">   â†“</span><br><span class="line">2. Masteræ­£å¸¸ï¼šè¿”å›PONG</span><br><span class="line">   â†“</span><br><span class="line">3. Masterå¼‚å¸¸ï¼šæ— å“åº”æˆ–è¿”å›é”™è¯¯</span><br><span class="line">   â†“</span><br><span class="line">4. å“¨å…µæ ‡è®°Masterä¸º&quot;ä¸»è§‚ä¸‹çº¿&quot;ï¼ˆSDOWNï¼‰</span><br><span class="line">   â†“</span><br><span class="line">5. å“¨å…µè¯¢é—®å…¶ä»–å“¨å…µï¼šMasteræ˜¯å¦ä¸‹çº¿ï¼Ÿ</span><br><span class="line">   â†“</span><br><span class="line">6. å¦‚æœquorumä¸ªå“¨å…µéƒ½è®¤ä¸ºMasterä¸‹çº¿</span><br><span class="line">   â†“</span><br><span class="line">7. å“¨å…µæ ‡è®°Masterä¸º&quot;å®¢è§‚ä¸‹çº¿&quot;ï¼ˆODOWNï¼‰</span><br><span class="line">   â†“</span><br><span class="line">8. å¼€å§‹æ•…éšœè½¬ç§»æµç¨‹</span><br></pre></td></tr></table></figure><p><strong>ä¸»è§‚ä¸‹çº¿ï¼ˆSDOWNï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šå•ä¸ªå“¨å…µè®¤ä¸ºMasterä¸å¯ç”¨</li><li><strong>æ¡ä»¶</strong>ï¼šåœ¨<code>down-after-milliseconds</code>æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å“åº”</li><li><strong>ä½œç”¨</strong>ï¼šè§¦å‘è¯¢é—®å…¶ä»–å“¨å…µ</li></ul><p><strong>å®¢è§‚ä¸‹çº¿ï¼ˆODOWNï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šquorumä¸ªå“¨å…µéƒ½è®¤ä¸ºMasterä¸å¯ç”¨</li><li><strong>æ¡ä»¶</strong>ï¼šè‡³å°‘quorumä¸ªå“¨å…µæŠ•ç¥¨åŒæ„</li><li><strong>ä½œç”¨</strong>ï¼šè§¦å‘æ•…éšœè½¬ç§»</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">åœºæ™¯ï¼š3ä¸ªå“¨å…µï¼Œquorum=2</span><br><span class="line"></span><br><span class="line">å“¨å…µ1ï¼šæ£€æµ‹åˆ°Masteræ— å“åº” â†’ æ ‡è®°SDOWN</span><br><span class="line">å“¨å…µ2ï¼šæ£€æµ‹åˆ°Masteræ— å“åº” â†’ æ ‡è®°SDOWN</span><br><span class="line">å“¨å…µ3ï¼šMasteræ­£å¸¸å“åº” â†’ ä¸æ ‡è®°</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š</span><br><span class="line">- 2ä¸ªå“¨å…µè®¤ä¸ºMasterä¸‹çº¿ï¼ˆ&gt;= quorum=2ï¼‰</span><br><span class="line">- Masterè¢«æ ‡è®°ä¸ºODOWN</span><br><span class="line">- å¼€å§‹æ•…éšœè½¬ç§»</span><br></pre></td></tr></table></figure><h4 id="10-3-2-æ•…éšœè½¬ç§»æµç¨‹"><a href="#10-3-2-æ•…éšœè½¬ç§»æµç¨‹" class="headerlink" title="10.3.2 æ•…éšœè½¬ç§»æµç¨‹"></a>10.3.2 æ•…éšœè½¬ç§»æµç¨‹</h4><p><strong>å®Œæ•´æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Masteræ•…éšœ]</span><br><span class="line">    â†“</span><br><span class="line">[å“¨å…µæ£€æµ‹åˆ°ODOWN]</span><br><span class="line">    â†“</span><br><span class="line">[é€‰ä¸¾Leaderå“¨å…µ]</span><br><span class="line">    â†“</span><br><span class="line">[Leaderå“¨å…µé€‰æ‹©æ–°Master]</span><br><span class="line">    â†“</span><br><span class="line">[Leaderå“¨å…µæ‰§è¡Œæ•…éšœè½¬ç§»]</span><br><span class="line">    â†“</span><br><span class="line">[é€šçŸ¥å…¶ä»–Slaveåˆ‡æ¢]</span><br><span class="line">    â†“</span><br><span class="line">[æ›´æ–°å“¨å…µé…ç½®]</span><br><span class="line">    â†“</span><br><span class="line">[æ•…éšœè½¬ç§»å®Œæˆ]</span><br></pre></td></tr></table></figure><p><strong>è¯¦ç»†æ­¥éª¤</strong>ï¼š</p><p><strong>æ­¥éª¤1ï¼šé€‰ä¸¾Leaderå“¨å…µ</strong></p><ul><li><strong>æ–¹æ³•</strong>ï¼šä½¿ç”¨Raftç®—æ³•é€‰ä¸¾</li><li><strong>è§„åˆ™</strong>ï¼šè·å¾—è¶…è¿‡åŠæ•°å“¨å…µæŠ•ç¥¨çš„å“¨å…µæˆä¸ºLeader</li><li><strong>ä½œç”¨</strong>ï¼šåªæœ‰ä¸€ä¸ªå“¨å…µæ‰§è¡Œæ•…éšœè½¬ç§»ï¼Œé¿å…å†²çª</li></ul><p><strong>æ­¥éª¤2ï¼šé€‰æ‹©æ–°Master</strong></p><p><strong>é€‰æ‹©è§„åˆ™</strong>ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰ï¼š</p><ol><li><strong>ä¼˜å…ˆçº§</strong>ï¼š<code>replica-priority</code>è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</li><li><strong>å¤åˆ¶åç§»é‡</strong>ï¼šé€‰æ‹©å¤åˆ¶åç§»é‡æœ€å¤§çš„Slave</li><li><strong>è¿è¡ŒID</strong>ï¼šé€‰æ‹©è¿è¡ŒIDæœ€å°çš„Slave</li></ol><p><strong>é…ç½®ä¼˜å…ˆçº§</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Slaveçš„redis.confä¸­è®¾ç½®</span></span><br><span class="line">replica-priority 100  <span class="comment"># é»˜è®¤100ï¼Œè¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span></span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤3ï¼šæ‰§è¡Œæ•…éšœè½¬ç§»</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Leaderå“¨å…µæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. å°†é€‰ä¸­çš„Slaveæå‡ä¸ºMaster</span></span><br><span class="line">SLAVEOF NO ONE</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. é€šçŸ¥å…¶ä»–Slaveåˆ‡æ¢Master</span></span><br><span class="line">SLAVEOF &lt;new-master-ip&gt; &lt;new-master-port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ›´æ–°å“¨å…µé…ç½®</span></span><br><span class="line"><span class="comment"># å“¨å…µä¼šè‡ªåŠ¨æ›´æ–°sentinel.confæ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤4ï¼šæ›´æ–°é…ç½®</strong></p><ul><li>å“¨å…µä¼šè‡ªåŠ¨æ›´æ–°<code>sentinel.conf</code>æ–‡ä»¶</li><li>æ›´æ–°Masteråœ°å€ä¸ºæ–°Masterçš„åœ°å€</li><li>å®¢æˆ·ç«¯é‡æ–°è¿æ¥æ—¶ï¼Œä¼šè·å–æ–°çš„Masteråœ°å€</li></ul><h4 id="10-3-3-æ•…éšœè½¬ç§»ç¤ºä¾‹"><a href="#10-3-3-æ•…éšœè½¬ç§»ç¤ºä¾‹" class="headerlink" title="10.3.3 æ•…éšœè½¬ç§»ç¤ºä¾‹"></a>10.3.3 æ•…éšœè½¬ç§»ç¤ºä¾‹</h4><p><strong>åœºæ™¯</strong>ï¼šMasteræ•…éšœï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°Slave1</p><p><strong>åˆå§‹çŠ¶æ€</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Master</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line">role:master</span><br><span class="line">connected_slaves:2</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave1</span></span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave2</span></span><br><span class="line">127.0.0.1:6381&gt; INFO replication</span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br></pre></td></tr></table></figure><p><strong>æ¨¡æ‹ŸMasteræ•…éšœ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢Master</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379 SHUTDOWN</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å“¨å…µæ—¥å¿—</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹sentinel.log</span></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/redis/sentinel.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç¤ºä¾‹ï¼š</span></span><br><span class="line">+sdown master mymaster 127.0.0.1 6379</span><br><span class="line">+odown master mymaster 127.0.0.1 6379 <span class="comment">#quorum 2/2</span></span><br><span class="line">+try-failover master mymaster 127.0.0.1 6379</span><br><span class="line">+vote-for-leader abc123 1</span><br><span class="line">+elected-leader master mymaster 127.0.0.1 6379</span><br><span class="line">+failover-state-select-slave master mymaster 127.0.0.1 6379</span><br><span class="line">+selected-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6379</span><br><span class="line">+failover-state-send-slaveof-noone slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6379</span><br><span class="line">+failover-state-wait-promotion slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6379</span><br><span class="line">+promoted-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6379</span><br><span class="line">+failover-state-reconf-slaves master mymaster 127.0.0.1 6379</span><br><span class="line">+slave-reconf-sent slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6379</span><br><span class="line">+slave-reconf-inprog slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6379</span><br><span class="line">+slave-reconf-done slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6379</span><br><span class="line">+failover-end master mymaster 127.0.0.1 6379</span><br><span class="line">+switch-master mymaster 127.0.0.1 6379 127.0.0.1 6380</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯æ–°Master</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ–°Master</span></span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line">role:master</span><br><span class="line">connected_slaves:1</span><br><span class="line">slave0:ip=127.0.0.1,port=6381,state=online</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Slave2</span></span><br><span class="line">127.0.0.1:6381&gt; INFO replication</span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6380  <span class="comment"># å·²åˆ‡æ¢åˆ°æ–°Master</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å“¨å…µé…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å“¨å…µè‡ªåŠ¨æ›´æ–°äº†é…ç½®</span></span><br><span class="line"><span class="built_in">cat</span> /etc/redis/sentinel.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6380 2</span><br><span class="line"><span class="comment"># Masteråœ°å€å·²æ›´æ–°ä¸º6380</span></span><br></pre></td></tr></table></figure><h4 id="10-3-4-æ•…éšœæ¢å¤"><a href="#10-3-4-æ•…éšœæ¢å¤" class="headerlink" title="10.3.4 æ•…éšœæ¢å¤"></a>10.3.4 æ•…éšœæ¢å¤</h4><p><strong>åŸMasteræ¢å¤åçš„å¤„ç†</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[åŸMasteræ¢å¤]</span><br><span class="line">    â†“</span><br><span class="line">[å“¨å…µæ£€æµ‹åˆ°åŸMasterä¸Šçº¿]</span><br><span class="line">    â†“</span><br><span class="line">[åŸMasteræˆä¸ºæ–°Masterçš„Slave]</span><br><span class="line">    â†“</span><br><span class="line">[æ•°æ®åŒæ­¥å®Œæˆ]</span><br><span class="line">    â†“</span><br><span class="line">[åŸMasterä½œä¸ºSlaveè¿è¡Œ]</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨åŸMaster</span></span><br><span class="line">redis-server /etc/redis/redis-master.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åŸMasterçŠ¶æ€</span></span><br><span class="line">127.0.0.1:6379&gt; INFO replication</span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6380  <span class="comment"># å·²æˆä¸ºæ–°Masterçš„Slave</span></span><br></pre></td></tr></table></figure><p><strong>æ‰‹åŠ¨åˆ‡æ¢å›åŸMaster</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœéœ€è¦åˆ‡æ¢å›åŸMasterï¼Œå¯ä»¥ï¼š</span></span><br><span class="line"><span class="comment"># 1. åœæ­¢æ–°Master</span></span><br><span class="line"><span class="comment"># 2. åœ¨å“¨å…µä¸Šæ‰§è¡Œæ•…éšœè½¬ç§»</span></span><br><span class="line"><span class="comment"># 3. æˆ–æ‰‹åŠ¨é…ç½®</span></span><br></pre></td></tr></table></figure><h3 id="10-4-å“¨å…µé›†ç¾¤"><a href="#10-4-å“¨å…µé›†ç¾¤" class="headerlink" title="10.4 å“¨å…µé›†ç¾¤"></a>10.4 å“¨å…µé›†ç¾¤</h3><h4 id="10-4-1-å“¨å…µé›†ç¾¤æ¶æ„"><a href="#10-4-1-å“¨å…µé›†ç¾¤æ¶æ„" class="headerlink" title="10.4.1 å“¨å…µé›†ç¾¤æ¶æ„"></a>10.4.1 å“¨å…µé›†ç¾¤æ¶æ„</h4><p><strong>ä¸ºä»€ä¹ˆéœ€è¦å“¨å…µé›†ç¾¤ï¼Ÿ</strong></p><ul><li>âœ… <strong>é˜²æ­¢è¯¯åˆ¤</strong>ï¼šå•ä¸ªå“¨å…µå¯èƒ½è¯¯åˆ¤Masteræ•…éšœ</li><li>âœ… <strong>é«˜å¯ç”¨</strong>ï¼šå“¨å…µæœ¬èº«ä¹Ÿéœ€è¦é«˜å¯ç”¨</li><li>âœ… <strong>æŠ•ç¥¨æœºåˆ¶</strong>ï¼šéœ€è¦å¤šä¸ªå“¨å…µæŠ•ç¥¨å†³å®šæ•…éšœè½¬ç§»</li></ul><p><strong>æ¨èé…ç½®</strong>ï¼š</p><table><thead><tr><th>å“¨å…µæ•°é‡</th><th>quorum</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>1ä¸ª</strong></td><td>1</td><td>âŒ ä¸æ¨èï¼Œå®¹æ˜“è¯¯åˆ¤</td></tr><tr><td><strong>2ä¸ª</strong></td><td>1</td><td>âš ï¸ ä¸æ¨èï¼Œå¯èƒ½å‡ºç°è„‘è£‚</td></tr><tr><td><strong>3ä¸ª</strong></td><td>2</td><td>âœ… <strong>æ¨è</strong>ï¼Œæœ€ä½³é…ç½®</td></tr><tr><td><strong>5ä¸ª</strong></td><td>3</td><td>âœ… é€‚åˆå¤§è§„æ¨¡ç¯å¢ƒ</td></tr><tr><td><strong>7ä¸ª</strong></td><td>4</td><td>âœ… é€‚åˆè¶…å¤§è§„æ¨¡ç¯å¢ƒ</td></tr></tbody></table><p><strong>æ¶æ„å›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">      Master (6379)</span><br><span class="line">     /    |    \</span><br><span class="line">    /     |     \</span><br><span class="line">Slave1  Slave2  Slave3</span><br><span class="line">(6380)  (6381)  (6382)</span><br><span class="line"> â†‘       â†‘       â†‘</span><br><span class="line"> â”‚       â”‚       â”‚</span><br><span class="line"> â””â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”˜</span><br><span class="line">     â”‚       â”‚</span><br><span class="line"> â”Œâ”€â”€â”€â–¼â”€â”€â”€â”¬â”€â”€â”€â–¼â”€â”€â”€â”¬â”€â”€â”€â–¼â”€â”€â”€â”</span><br><span class="line"> â”‚Sentinelâ”‚Sentinelâ”‚Sentinelâ”‚</span><br><span class="line"> â”‚(26379) â”‚(26380) â”‚(26381) â”‚</span><br><span class="line"> â””â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜</span><br><span class="line">     â”‚   â”‚   â”‚   â”‚   â”‚</span><br><span class="line">     â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜</span><br><span class="line">     å“¨å…µé›†ç¾¤é€šä¿¡</span><br><span class="line">    (è‡ªåŠ¨å‘ç°)</span><br></pre></td></tr></table></figure><h4 id="10-4-2-å“¨å…µè‡ªåŠ¨å‘ç°"><a href="#10-4-2-å“¨å…µè‡ªåŠ¨å‘ç°" class="headerlink" title="10.4.2 å“¨å…µè‡ªåŠ¨å‘ç°"></a>10.4.2 å“¨å…µè‡ªåŠ¨å‘ç°</h4><p><strong>è‡ªåŠ¨å‘ç°æœºåˆ¶</strong>ï¼š</p><ol><li><strong>å‘å¸ƒè®¢é˜…</strong>ï¼šå“¨å…µé€šè¿‡Redisçš„å‘å¸ƒè®¢é˜…åŠŸèƒ½é€šä¿¡</li><li><strong>è‡ªåŠ¨å‘ç°</strong>ï¼šå“¨å…µè‡ªåŠ¨å‘ç°å…¶ä»–å“¨å…µ</li><li><strong>å…±äº«ä¿¡æ¯</strong>ï¼šå“¨å…µä¹‹é—´å…±äº«Masterå’ŒSlaveä¿¡æ¯</li></ol><p><strong>æŸ¥çœ‹å“¨å…µä¿¡æ¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰å“¨å…µ</span></span><br><span class="line">127.0.0.1:26379&gt; SENTINEL sentinels mymaster</span><br><span class="line">1)  1) <span class="string">&quot;name&quot;</span></span><br><span class="line">    2) <span class="string">&quot;127.0.0.1:26380&quot;</span></span><br><span class="line">    3) <span class="string">&quot;ip&quot;</span></span><br><span class="line">    4) <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">    5) <span class="string">&quot;port&quot;</span></span><br><span class="line">    6) <span class="string">&quot;26380&quot;</span></span><br><span class="line">    7) <span class="string">&quot;runid&quot;</span></span><br><span class="line">    8) <span class="string">&quot;abc123...&quot;</span></span><br><span class="line">    9) <span class="string">&quot;flags&quot;</span></span><br><span class="line">   10) <span class="string">&quot;sentinel&quot;</span></span><br><span class="line">2)  1) <span class="string">&quot;name&quot;</span></span><br><span class="line">    2) <span class="string">&quot;127.0.0.1:26381&quot;</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Masterä¿¡æ¯</span></span><br><span class="line">127.0.0.1:26379&gt; SENTINEL masters</span><br><span class="line">1)  1) <span class="string">&quot;name&quot;</span></span><br><span class="line">    2) <span class="string">&quot;mymaster&quot;</span></span><br><span class="line">    3) <span class="string">&quot;ip&quot;</span></span><br><span class="line">    4) <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">    5) <span class="string">&quot;port&quot;</span></span><br><span class="line">    6) <span class="string">&quot;6379&quot;</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Slaveä¿¡æ¯</span></span><br><span class="line">127.0.0.1:26379&gt; SENTINEL slaves mymaster</span><br><span class="line">1)  1) <span class="string">&quot;name&quot;</span></span><br><span class="line">    2) <span class="string">&quot;127.0.0.1:6380&quot;</span></span><br><span class="line">    3) <span class="string">&quot;ip&quot;</span></span><br><span class="line">    4) <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">    5) <span class="string">&quot;port&quot;</span></span><br><span class="line">    6) <span class="string">&quot;6380&quot;</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h4 id="10-4-3-å“¨å…µé›†ç¾¤é…ç½®"><a href="#10-4-3-å“¨å…µé›†ç¾¤é…ç½®" class="headerlink" title="10.4.3 å“¨å…µé›†ç¾¤é…ç½®"></a>10.4.3 å“¨å…µé›†ç¾¤é…ç½®</h4><p><strong>å®Œæ•´é…ç½®ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sentinel1.conf</span></span><br><span class="line">port 26379</span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">logfile /var/log/redis/sentinel1.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">dir</span> /tmp</span><br><span class="line"></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># sentinel2.conf</span></span><br><span class="line">port 26380</span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">logfile /var/log/redis/sentinel2.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">dir</span> /tmp</span><br><span class="line"></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># sentinel3.conf</span></span><br><span class="line">port 26381</span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">logfile /var/log/redis/sentinel3.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">dir</span> /tmp</span><br><span class="line"></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨æ‰€æœ‰å“¨å…µ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis/sentinel1.conf --sentinel</span><br><span class="line">redis-server /etc/redis/sentinel2.conf --sentinel</span><br><span class="line">redis-server /etc/redis/sentinel3.conf --sentinel</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯é›†ç¾¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å“¨å…µæ•°é‡</span></span><br><span class="line">127.0.0.1:26379&gt; SENTINEL sentinels mymaster</span><br><span class="line"><span class="comment"># åº”è¯¥çœ‹åˆ°2ä¸ªå…¶ä»–å“¨å…µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å“¨å…µçŠ¶æ€</span></span><br><span class="line">127.0.0.1:26379&gt; INFO sentinel</span><br><span class="line">sentinel_masters:1</span><br><span class="line">master0:name=mymaster,status=ok,address=127.0.0.1:6379,slaves=2,sentinels=3</span><br></pre></td></tr></table></figure><h3 id="10-5-å®¢æˆ·ç«¯è¿æ¥"><a href="#10-5-å®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="10.5 å®¢æˆ·ç«¯è¿æ¥"></a>10.5 å®¢æˆ·ç«¯è¿æ¥</h3><h4 id="10-5-1-Javaå®¢æˆ·ç«¯è¿æ¥"><a href="#10-5-1-Javaå®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="10.5.1 Javaå®¢æˆ·ç«¯è¿æ¥"></a>10.5.1 Javaå®¢æˆ·ç«¯è¿æ¥</h4><p><strong>Jedisè¿æ¥å“¨å…µ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisSentinelPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisSentinelExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// å“¨å…µåœ°å€åˆ—è¡¨</span></span><br><span class="line">        Set&lt;String&gt; sentinels = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        sentinels.add(<span class="string">&quot;127.0.0.1:26379&quot;</span>);</span><br><span class="line">        sentinels.add(<span class="string">&quot;127.0.0.1:26380&quot;</span>);</span><br><span class="line">        sentinels.add(<span class="string">&quot;127.0.0.1:26381&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Masteråç§°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">masterName</span> <span class="operator">=</span> <span class="string">&quot;mymaster&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿æ¥æ± é…ç½®</span></span><br><span class="line">        <span class="type">JedisPoolConfig</span> <span class="variable">poolConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">        poolConfig.setMaxTotal(<span class="number">10</span>);</span><br><span class="line">        poolConfig.setMaxIdle(<span class="number">5</span>);</span><br><span class="line">        poolConfig.setMinIdle(<span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºå“¨å…µè¿æ¥æ± </span></span><br><span class="line">        <span class="type">JedisSentinelPool</span> <span class="variable">sentinelPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisSentinelPool</span>(</span><br><span class="line">            masterName, </span><br><span class="line">            sentinels, </span><br><span class="line">            poolConfig,</span><br><span class="line">            <span class="string">&quot;master123&quot;</span>  <span class="comment">// Masterå¯†ç </span></span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> sentinelPool.getResource();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">            jedis.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> jedis.get(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Value: &quot;</span> + value);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// å½’è¿˜è¿æ¥</span></span><br><span class="line">            <span class="keyword">if</span> (jedis != <span class="literal">null</span>) &#123;</span><br><span class="line">                jedis.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å…³é—­è¿æ¥æ± </span></span><br><span class="line">        sentinelPool.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Spring Booté…ç½®</strong>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.yml</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">master:</span> <span class="string">mymaster</span></span><br><span class="line">      <span class="attr">nodes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:26379</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:26380</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:26381</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">master123</span></span><br><span class="line">    <span class="attr">pool:</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">max-idle:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><h4 id="10-5-2-Pythonå®¢æˆ·ç«¯è¿æ¥"><a href="#10-5-2-Pythonå®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="10.5.2 Pythonå®¢æˆ·ç«¯è¿æ¥"></a>10.5.2 Pythonå®¢æˆ·ç«¯è¿æ¥</h4><p><strong>redis-pyè¿æ¥å“¨å…µ</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> redis.sentinel <span class="keyword">import</span> Sentinel</span><br><span class="line"></span><br><span class="line"><span class="comment"># å“¨å…µåœ°å€åˆ—è¡¨</span></span><br><span class="line">sentinels = [</span><br><span class="line">    (<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">26379</span>),</span><br><span class="line">    (<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">26380</span>),</span><br><span class="line">    (<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">26381</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå“¨å…µè¿æ¥</span></span><br><span class="line">sentinel = Sentinel(sentinels, socket_timeout=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–Masterè¿æ¥</span></span><br><span class="line">master = sentinel.master_for(<span class="string">&#x27;mymaster&#x27;</span>, </span><br><span class="line">                              password=<span class="string">&#x27;master123&#x27;</span>,</span><br><span class="line">                              socket_timeout=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–Slaveè¿æ¥ï¼ˆç”¨äºè¯»æ“ä½œï¼‰</span></span><br><span class="line">slave = sentinel.slave_for(<span class="string">&#x27;mymaster&#x27;</span>,</span><br><span class="line">                           password=<span class="string">&#x27;master123&#x27;</span>,</span><br><span class="line">                           socket_timeout=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™æ“ä½œä½¿ç”¨Master</span></span><br><span class="line">master.<span class="built_in">set</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»æ“ä½œä½¿ç”¨Slave</span></span><br><span class="line">value = slave.get(<span class="string">&#x27;key&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Value: <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="10-6-å®æˆ˜æ¡ˆä¾‹"><a href="#10-6-å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="10.6 å®æˆ˜æ¡ˆä¾‹"></a>10.6 å®æˆ˜æ¡ˆä¾‹</h3><h4 id="10-6-1-æ¡ˆä¾‹1ï¼šä¸‰å“¨å…µä¸€ä¸»äºŒä»æ¶æ„"><a href="#10-6-1-æ¡ˆä¾‹1ï¼šä¸‰å“¨å…µä¸€ä¸»äºŒä»æ¶æ„" class="headerlink" title="10.6.1 æ¡ˆä¾‹1ï¼šä¸‰å“¨å…µä¸€ä¸»äºŒä»æ¶æ„"></a>10.6.1 æ¡ˆä¾‹1ï¼šä¸‰å“¨å…µä¸€ä¸»äºŒä»æ¶æ„</h4><p><strong>éœ€æ±‚</strong>ï¼š</p><ul><li>1ä¸ªMasterï¼Œ2ä¸ªSlave</li><li>3ä¸ªå“¨å…µç›‘æ§</li><li>å®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»</li></ul><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Masteré…ç½® (redis-master.conf)</span></span><br><span class="line">port 6379</span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">requirepass master123</span><br><span class="line">repl-backlog-size 10mb</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave1é…ç½® (redis-slave1.conf)</span></span><br><span class="line">port 6380</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br><span class="line">replica-read-only <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Slave2é…ç½® (redis-slave2.conf)</span></span><br><span class="line">port 6381</span><br><span class="line">replicaof 127.0.0.1 6379</span><br><span class="line">masterauth master123</span><br><span class="line">replica-read-only <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å“¨å…µé…ç½®ï¼ˆ3ä¸ªå“¨å…µé…ç½®ç›¸åŒï¼Œåªæ˜¯ç«¯å£ä¸åŒï¼‰</span></span><br><span class="line">port 26379</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line">sentinel auth-pass mymaster master123</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨Masterå’ŒSlave</span></span><br><span class="line">redis-server /etc/redis/redis-master.conf</span><br><span class="line">redis-server /etc/redis/redis-slave1.conf</span><br><span class="line">redis-server /etc/redis/redis-slave2.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨å“¨å…µ</span></span><br><span class="line">redis-server /etc/redis/sentinel1.conf --sentinel</span><br><span class="line">redis-server /etc/redis/sentinel2.conf --sentinel</span><br><span class="line">redis-server /etc/redis/sentinel3.conf --sentinel</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•æ•…éšœè½¬ç§»</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åœæ­¢Master</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6379 -a master123 SHUTDOWN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. ç­‰å¾…å‡ ç§’ï¼ŒæŸ¥çœ‹å“¨å…µæ—¥å¿—</span></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/redis/sentinel.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. éªŒè¯æ–°Master</span></span><br><span class="line">redis-cli -h 127.0.0.1 -p 6380 -a master123</span><br><span class="line">127.0.0.1:6380&gt; INFO replication</span><br><span class="line">role:master  <span class="comment"># å·²åˆ‡æ¢ä¸ºMaster</span></span><br></pre></td></tr></table></figure><h4 id="10-6-2-æ¡ˆä¾‹2ï¼šå“¨å…µç›‘æ§è„šæœ¬"><a href="#10-6-2-æ¡ˆä¾‹2ï¼šå“¨å…µç›‘æ§è„šæœ¬" class="headerlink" title="10.6.2 æ¡ˆä¾‹2ï¼šå“¨å…µç›‘æ§è„šæœ¬"></a>10.6.2 æ¡ˆä¾‹2ï¼šå“¨å…µç›‘æ§è„šæœ¬</h4><p><strong>ç›‘æ§è„šæœ¬ï¼ˆmonitor_sentinel.shï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># monitor_sentinel.sh</span></span><br><span class="line"></span><br><span class="line">SENTINEL_HOST=<span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">SENTINEL_PORT=<span class="string">&quot;26379&quot;</span></span><br><span class="line">MASTER_NAME=<span class="string">&quot;mymaster&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥å“¨å…µçŠ¶æ€</span></span><br><span class="line"><span class="function"><span class="title">check_sentinel</span></span>() &#123;</span><br><span class="line">    result=$(redis-cli -h <span class="variable">$SENTINEL_HOST</span> -p <span class="variable">$SENTINEL_PORT</span> INFO sentinel 2&gt;/dev/null)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;ERROR: æ— æ³•è¿æ¥å“¨å…µ&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ£€æŸ¥MasterçŠ¶æ€</span></span><br><span class="line">    master_status=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$result</span>&quot;</span> | grep <span class="string">&quot;status&quot;</span> | awk -F: <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$master_status</span>&quot;</span> != <span class="string">&quot;ok&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;WARNING: MasterçŠ¶æ€å¼‚å¸¸: <span class="variable">$master_status</span>&quot;</span></span><br><span class="line">        <span class="comment"># å‘é€å‘Šè­¦</span></span><br><span class="line">        send_alert <span class="string">&quot;MasterçŠ¶æ€å¼‚å¸¸: <span class="variable">$master_status</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ£€æŸ¥Slaveæ•°é‡</span></span><br><span class="line">    slave_count=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$result</span>&quot;</span> | grep <span class="string">&quot;slaves&quot;</span> | awk -F, <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | awk -F: <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$slave_count</span>&quot;</span> -lt 1 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;WARNING: Slaveæ•°é‡ä¸è¶³: <span class="variable">$slave_count</span>&quot;</span></span><br><span class="line">        send_alert <span class="string">&quot;Slaveæ•°é‡ä¸è¶³: <span class="variable">$slave_count</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ£€æŸ¥å“¨å…µæ•°é‡</span></span><br><span class="line">    sentinel_count=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$result</span>&quot;</span> | grep <span class="string">&quot;sentinels&quot;</span> | awk -F, <span class="string">&#x27;&#123;print $3&#125;&#x27;</span> | awk -F: <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$sentinel_count</span>&quot;</span> -lt 3 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;WARNING: å“¨å…µæ•°é‡ä¸è¶³: <span class="variable">$sentinel_count</span>&quot;</span></span><br><span class="line">        send_alert <span class="string">&quot;å“¨å…µæ•°é‡ä¸è¶³: <span class="variable">$sentinel_count</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;OK: MasterçŠ¶æ€æ­£å¸¸, Slaveæ•°é‡: <span class="variable">$slave_count</span>, å“¨å…µæ•°é‡: <span class="variable">$sentinel_count</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">send_alert</span></span>() &#123;</span><br><span class="line">    message=<span class="variable">$1</span></span><br><span class="line">    <span class="comment"># å‘é€é‚®ä»¶</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$message</span>&quot;</span> | mail -s <span class="string">&quot;Rediså“¨å…µå‘Šè­¦&quot;</span> admin@example.com</span><br><span class="line">    <span class="comment"># æˆ–å‘é€çŸ­ä¿¡ã€é’‰é’‰ç­‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œæ£€æŸ¥</span></span><br><span class="line">check_sentinel</span><br></pre></td></tr></table></figure><p><strong>å®šæ—¶ä»»åŠ¡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ åˆ°crontabï¼Œæ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span></span><br><span class="line">*/5 * * * * /path/to/monitor_sentinel.sh</span><br></pre></td></tr></table></figure><h3 id="10-7-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"><a href="#10-7-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ" class="headerlink" title="10.7 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"></a>10.7 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h3><h4 id="10-7-1-æ³¨æ„äº‹é¡¹"><a href="#10-7-1-æ³¨æ„äº‹é¡¹" class="headerlink" title="10.7.1 æ³¨æ„äº‹é¡¹"></a>10.7.1 æ³¨æ„äº‹é¡¹</h4><p><strong>1. quorumè®¾ç½®</strong></p><ul><li>âš ï¸ <strong>quorumä¸èƒ½å¤ªå¤§</strong>ï¼šå¤ªå¤§å¯èƒ½å¯¼è‡´æ— æ³•åˆ¤å®šæ•…éšœ</li><li>âš ï¸ <strong>quorumä¸èƒ½å¤ªå°</strong>ï¼šå¤ªå°å¯èƒ½å¯¼è‡´è¯¯åˆ¤</li><li>âœ… <strong>æ¨è</strong>ï¼šquorum &#x3D; (å“¨å…µæ•°é‡ &#x2F; 2) + 1</li></ul><p><strong>2. ç½‘ç»œåˆ†åŒºï¼ˆSplit-Brainï¼‰</strong></p><ul><li>âš ï¸ <strong>é—®é¢˜</strong>ï¼šç½‘ç»œåˆ†åŒºå¯èƒ½å¯¼è‡´å¤šä¸ªMaster</li><li>âœ… <strong>è§£å†³</strong>ï¼šä½¿ç”¨å¥‡æ•°ä¸ªå“¨å…µï¼Œquorumè®¾ç½®åˆç†</li></ul><p><strong>3. å“¨å…µæ•°é‡</strong></p><ul><li>âš ï¸ <strong>è‡³å°‘3ä¸ªå“¨å…µ</strong>ï¼šé¿å…è„‘è£‚</li><li>âš ï¸ <strong>å¥‡æ•°ä¸ªå“¨å…µ</strong>ï¼šä¾¿äºæŠ•ç¥¨å†³ç­–</li><li>âœ… <strong>æ¨è</strong>ï¼š3ä¸ªæˆ–5ä¸ªå“¨å…µ</li></ul><p><strong>4. æ•…éšœè½¬ç§»æ—¶é—´</strong></p><ul><li>âš ï¸ <strong>down-after-milliseconds</strong>ï¼šä¸èƒ½å¤ªå°ï¼Œé¿å…è¯¯åˆ¤</li><li>âš ï¸ <strong>failover-timeout</strong>ï¼šä¸èƒ½å¤ªå°ï¼Œç¡®ä¿æ•…éšœè½¬ç§»å®Œæˆ</li><li>âœ… <strong>æ¨è</strong>ï¼šdown-after-milliseconds&#x3D;5000, failover-timeout&#x3D;10000</li></ul><h4 id="10-7-2-æœ€ä½³å®è·µ"><a href="#10-7-2-æœ€ä½³å®è·µ" class="headerlink" title="10.7.2 æœ€ä½³å®è·µ"></a>10.7.2 æœ€ä½³å®è·µ</h4><p><strong>1. å“¨å…µéƒ¨ç½²</strong></p><ul><li>âœ… <strong>ç‹¬ç«‹éƒ¨ç½²</strong>ï¼šå“¨å…µä¸è¦å’ŒRediséƒ¨ç½²åœ¨åŒä¸€æœåŠ¡å™¨</li><li>âœ… <strong>å¤šæœºæˆ¿éƒ¨ç½²</strong>ï¼šå“¨å…µéƒ¨ç½²åœ¨ä¸åŒæœºæˆ¿ï¼Œæé«˜å¯ç”¨æ€§</li><li>âœ… <strong>ç›‘æ§å‘Šè­¦</strong>ï¼šç›‘æ§å“¨å…µçŠ¶æ€ï¼ŒåŠæ—¶å‘Šè­¦</li></ul><p><strong>2. é…ç½®ä¼˜åŒ–</strong></p><ul><li>âœ… <strong>åˆç†è®¾ç½®quorum</strong>ï¼šæ ¹æ®å“¨å…µæ•°é‡è®¾ç½®</li><li>âœ… <strong>ä¼˜åŒ–è¶…æ—¶æ—¶é—´</strong>ï¼šæ ¹æ®ç½‘ç»œæƒ…å†µè°ƒæ•´</li><li>âœ… <strong>å¼€å¯é€šçŸ¥è„šæœ¬</strong>ï¼šæ•…éšœæ—¶åŠæ—¶é€šçŸ¥</li></ul><p><strong>3. å®¢æˆ·ç«¯é…ç½®</strong></p><ul><li>âœ… <strong>è¿æ¥æ± é…ç½®</strong>ï¼šåˆç†è®¾ç½®è¿æ¥æ± å¤§å°</li><li>âœ… <strong>é‡è¯•æœºåˆ¶</strong>ï¼šå®ç°è‡ªåŠ¨é‡è¯•</li><li>âœ… <strong>æ•…éšœåˆ‡æ¢</strong>ï¼šå®¢æˆ·ç«¯è‡ªåŠ¨åˆ‡æ¢Master</li></ul><p><strong>4. ç›‘æ§æŒ‡æ ‡</strong></p><table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th><th>æ­£å¸¸å€¼</th></tr></thead><tbody><tr><td><code>sentinel_masters</code></td><td>ç›‘æ§çš„Masteræ•°é‡</td><td>1</td></tr><tr><td><code>master_status</code></td><td>MasterçŠ¶æ€</td><td>ok</td></tr><tr><td><code>slave_count</code></td><td>Slaveæ•°é‡</td><td>&gt;&#x3D; 1</td></tr><tr><td><code>sentinel_count</code></td><td>å“¨å…µæ•°é‡</td><td>&gt;&#x3D; 3</td></tr><tr><td><code>failover_count</code></td><td>æ•…éšœè½¬ç§»æ¬¡æ•°</td><td>ç›‘æ§è¶‹åŠ¿</td></tr></tbody></table><h3 id="10-8-æ€»ç»“"><a href="#10-8-æ€»ç»“" class="headerlink" title="10.8 æ€»ç»“"></a>10.8 æ€»ç»“</h3><p><strong>å“¨å…µæ¨¡å¼æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p><ol><li>âœ… <strong>è‡ªåŠ¨æ•…éšœè½¬ç§»</strong>ï¼šMasteræ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°Slave</li><li>âœ… <strong>é«˜å¯ç”¨æ€§</strong>ï¼šå‡å°‘æœåŠ¡ä¸­æ–­æ—¶é—´</li><li>âœ… <strong>è‡ªåŠ¨å‘ç°</strong>ï¼šè‡ªåŠ¨å‘ç°Masterå’ŒSlave</li><li>âœ… <strong>æŠ•ç¥¨æœºåˆ¶</strong>ï¼šå¤šä¸ªå“¨å…µæŠ•ç¥¨å†³å®šæ•…éšœè½¬ç§»</li><li>âœ… <strong>é…ç½®æä¾›è€…</strong>ï¼šå®¢æˆ·ç«¯è‡ªåŠ¨è·å–Masteråœ°å€</li></ol><p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p><ol><li>âœ… <strong>è‡³å°‘3ä¸ªå“¨å…µ</strong>ï¼šé¿å…è„‘è£‚å’Œè¯¯åˆ¤</li><li>âœ… <strong>åˆç†è®¾ç½®quorum</strong>ï¼šquorum &#x3D; (å“¨å…µæ•°é‡ &#x2F; 2) + 1</li><li>âœ… <strong>ç‹¬ç«‹éƒ¨ç½²å“¨å…µ</strong>ï¼šä¸è¦å’ŒRediséƒ¨ç½²åœ¨åŒä¸€æœåŠ¡å™¨</li><li>âœ… <strong>ç›‘æ§å‘Šè­¦</strong>ï¼šç›‘æ§å“¨å…µçŠ¶æ€ï¼ŒåŠæ—¶å‘Šè­¦</li><li>âœ… <strong>å®¢æˆ·ç«¯è‡ªåŠ¨åˆ‡æ¢</strong>ï¼šä½¿ç”¨æ”¯æŒå“¨å…µçš„å®¢æˆ·ç«¯</li></ol><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ˜¯å¦é€‚åˆ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é«˜å¯ç”¨ç”Ÿäº§ç¯å¢ƒ</strong></td><td>âœ… é€‚åˆ</td><td>éœ€è¦è‡ªåŠ¨æ•…éšœè½¬ç§»</td></tr><tr><td><strong>è¯»å†™åˆ†ç¦»</strong></td><td>âœ… é€‚åˆ</td><td>é…åˆä¸»ä»å¤åˆ¶ä½¿ç”¨</td></tr><tr><td><strong>æ•°æ®å¤‡ä»½</strong></td><td>âœ… é€‚åˆ</td><td>è‡ªåŠ¨åˆ‡æ¢ä¿è¯æœåŠ¡å¯ç”¨</td></tr><tr><td><strong>å•æœºç¯å¢ƒ</strong></td><td>âŒ ä¸é€‚åˆ</td><td>éœ€è¦å¤šå°æœåŠ¡å™¨</td></tr><tr><td><strong>ç®€å•å¤‡ä»½</strong></td><td>âš ï¸ è¿‡åº¦è®¾è®¡</td><td>ä¸»ä»å¤åˆ¶å³å¯</td></tr></tbody></table><hr><h2 id="11-Redisé›†ç¾¤"><a href="#11-Redisé›†ç¾¤" class="headerlink" title="11. Redisé›†ç¾¤"></a>11. Redisé›†ç¾¤</h2><h3 id="11-1-ä»€ä¹ˆæ˜¯Redisé›†ç¾¤"><a href="#11-1-ä»€ä¹ˆæ˜¯Redisé›†ç¾¤" class="headerlink" title="11.1 ä»€ä¹ˆæ˜¯Redisé›†ç¾¤"></a>11.1 ä»€ä¹ˆæ˜¯Redisé›†ç¾¤</h3><h4 id="11-1-1-é›†ç¾¤æ¨¡å¼å®šä¹‰"><a href="#11-1-1-é›†ç¾¤æ¨¡å¼å®šä¹‰" class="headerlink" title="11.1.1 é›†ç¾¤æ¨¡å¼å®šä¹‰"></a>11.1.1 é›†ç¾¤æ¨¡å¼å®šä¹‰</h4><p><strong>Redis Clusterï¼ˆé›†ç¾¤ï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šRedisçš„<strong>åˆ†å¸ƒå¼</strong>å’Œ<strong>é«˜å¯ç”¨</strong>è§£å†³æ–¹æ¡ˆ</li><li><strong>ç‰ˆæœ¬è¦æ±‚</strong>ï¼šRedis 3.0+</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>âœ… <strong>æ•°æ®åˆ†ç‰‡</strong>ï¼šæ•°æ®è‡ªåŠ¨åˆ†ç‰‡åˆ°å¤šä¸ªèŠ‚ç‚¹</li><li>âœ… <strong>é«˜å¯ç”¨</strong>ï¼šèŠ‚ç‚¹æ•…éšœè‡ªåŠ¨è½¬ç§»</li><li>âœ… <strong>æ— ä¸­å¿ƒåŒ–</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹å¹³ç­‰ï¼Œæ— å•ç‚¹æ•…éšœ</li><li>âœ… <strong>çº¿æ€§æ‰©å±•</strong>ï¼šå¯ä»¥æ°´å¹³æ‰©å±•èŠ‚ç‚¹</li></ul></li></ul><p><strong>è§£å†³çš„é—®é¢˜</strong>ï¼š</p><ul><li>âŒ <strong>å•æœºé™åˆ¶</strong>ï¼šå•æœºRediså†…å­˜å’Œæ€§èƒ½æœ‰é™</li><li>âŒ <strong>å•ç‚¹æ•…éšœ</strong>ï¼šå•æœºæ•…éšœå¯¼è‡´æœåŠ¡ä¸å¯ç”¨</li><li>âŒ <strong>æ— æ³•æ‰©å±•</strong>ï¼šæ— æ³•æ°´å¹³æ‰©å±•</li></ul><p><strong>é›†ç¾¤æ¨¡å¼çš„ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… <strong>é«˜å¯ç”¨æ€§</strong>ï¼šèŠ‚ç‚¹æ•…éšœè‡ªåŠ¨è½¬ç§»ï¼ŒæœåŠ¡ä¸ä¸­æ–­</li><li>âœ… <strong>é«˜æ€§èƒ½</strong>ï¼šæ•°æ®åˆ†ç‰‡ï¼Œæé«˜æ•´ä½“æ€§èƒ½</li><li>âœ… <strong>å¯æ‰©å±•æ€§</strong>ï¼šå¯ä»¥åŠ¨æ€æ·»åŠ æˆ–åˆ é™¤èŠ‚ç‚¹</li><li>âœ… <strong>æ— ä¸­å¿ƒåŒ–</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹å¹³ç­‰ï¼Œæ— å•ç‚¹æ•…éšœ</li></ul><h4 id="11-1-2-é›†ç¾¤æ¶æ„"><a href="#11-1-2-é›†ç¾¤æ¶æ„" class="headerlink" title="11.1.2 é›†ç¾¤æ¶æ„"></a>11.1.2 é›†ç¾¤æ¶æ„</h4><p><strong>æ¶æ„å›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚  Node1      â”‚  â”‚  Node2      â”‚  â”‚  Node3      â”‚</span><br><span class="line">â”‚ (Master)    â”‚  â”‚ (Master)    â”‚  â”‚ (Master)    â”‚</span><br><span class="line">â”‚  Slot:      â”‚  â”‚  Slot:      â”‚  â”‚  Slot:      â”‚</span><br><span class="line">â”‚  0-5460     â”‚  â”‚  5461-10922 â”‚  â”‚  10923-16383â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚                â”‚                â”‚</span><br><span class="line">       â”‚ å¤åˆ¶           â”‚ å¤åˆ¶           â”‚ å¤åˆ¶</span><br><span class="line">       â”‚                â”‚                â”‚</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚  Node4      â”‚  â”‚  Node5      â”‚  â”‚  Node6      â”‚</span><br><span class="line">â”‚ (Slave)     â”‚  â”‚ (Slave)     â”‚  â”‚ (Slave)     â”‚</span><br><span class="line">â”‚ å¤‡ä»½Node1   â”‚  â”‚ å¤‡ä»½Node2   â”‚  â”‚ å¤‡ä»½Node3   â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚                â”‚                â”‚</span><br><span class="line">       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">              Gossipåè®®é€šä¿¡</span><br></pre></td></tr></table></figure><p><strong>ç»„ä»¶è¯´æ˜</strong>ï¼š</p><table><thead><tr><th>ç»„ä»¶</th><th>è¯´æ˜</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>MasterèŠ‚ç‚¹</strong></td><td>ä¸»èŠ‚ç‚¹</td><td>å¤„ç†è¯»å†™æ“ä½œï¼Œç®¡ç†å“ˆå¸Œæ§½</td></tr><tr><td><strong>SlaveèŠ‚ç‚¹</strong></td><td>ä»èŠ‚ç‚¹</td><td>å¤‡ä»½Masteræ•°æ®ï¼Œæ•…éšœæ—¶æå‡ä¸ºMaster</td></tr><tr><td><strong>å“ˆå¸Œæ§½ï¼ˆSlotï¼‰</strong></td><td>æ•°æ®åˆ†ç‰‡å•ä½</td><td>16384ä¸ªæ§½ï¼Œåˆ†é…åˆ°å„ä¸ªèŠ‚ç‚¹</td></tr><tr><td><strong>Gossipåè®®</strong></td><td>èŠ‚ç‚¹é€šä¿¡åè®®</td><td>èŠ‚ç‚¹ä¹‹é—´äº¤æ¢ä¿¡æ¯</td></tr></tbody></table><p><strong>æœ€å°é›†ç¾¤é…ç½®</strong>ï¼š</p><ul><li><strong>è‡³å°‘3ä¸ªMasterèŠ‚ç‚¹</strong>ï¼šä¿è¯é«˜å¯ç”¨</li><li><strong>æ¯ä¸ªMasterè‡³å°‘1ä¸ªSlave</strong>ï¼šä¿è¯æ•°æ®å¤‡ä»½</li><li><strong>æ€»å…±è‡³å°‘6ä¸ªèŠ‚ç‚¹</strong>ï¼š3ä¸ªMaster + 3ä¸ªSlave</li></ul><h4 id="11-1-3-é›†ç¾¤-vs-å“¨å…µæ¨¡å¼"><a href="#11-1-3-é›†ç¾¤-vs-å“¨å…µæ¨¡å¼" class="headerlink" title="11.1.3 é›†ç¾¤ vs å“¨å…µæ¨¡å¼"></a>11.1.3 é›†ç¾¤ vs å“¨å…µæ¨¡å¼</h4><p><strong>å¯¹æ¯”è¡¨</strong>ï¼š</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>å“¨å…µæ¨¡å¼</th><th>é›†ç¾¤æ¨¡å¼</th></tr></thead><tbody><tr><td><strong>æ•°æ®å­˜å‚¨</strong></td><td>å•æœºå­˜å‚¨</td><td>åˆ†ç‰‡å­˜å‚¨</td></tr><tr><td><strong>æ‰©å±•æ€§</strong></td><td>âŒ å‚ç›´æ‰©å±•</td><td>âœ… æ°´å¹³æ‰©å±•</td></tr><tr><td><strong>æ•°æ®é‡</strong></td><td>å—å•æœºå†…å­˜é™åˆ¶</td><td>å¯æ‰©å±•åˆ°å¤šå°æœºå™¨</td></tr><tr><td><strong>å¤æ‚åº¦</strong></td><td>âš ï¸ è¾ƒç®€å•</td><td>âš ï¸ è¾ƒå¤æ‚</td></tr><tr><td><strong>ç‰ˆæœ¬è¦æ±‚</strong></td><td>Redis 2.8+</td><td>Redis 3.0+</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ä¸­å°è§„æ¨¡ï¼Œé«˜å¯ç”¨</td><td>å¤§è§„æ¨¡ï¼Œé«˜å¯ç”¨+æ‰©å±•</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>å•æœºæ€§èƒ½</td><td>å¤šæœºæ€§èƒ½å åŠ </td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>æ•°æ®é‡ &lt; å•æœºå†…å­˜</strong></td><td>å“¨å…µæ¨¡å¼</td><td>ç®€å•ï¼Œå¤Ÿç”¨</td></tr><tr><td><strong>æ•°æ®é‡ &gt; å•æœºå†…å­˜</strong></td><td>é›†ç¾¤æ¨¡å¼</td><td>å¿…é¡»åˆ†ç‰‡</td></tr><tr><td><strong>éœ€è¦æ°´å¹³æ‰©å±•</strong></td><td>é›†ç¾¤æ¨¡å¼</td><td>æ”¯æŒåŠ¨æ€æ‰©å±•</td></tr><tr><td><strong>ä¸­å°è§„æ¨¡åº”ç”¨</strong></td><td>å“¨å…µæ¨¡å¼</td><td>é…ç½®ç®€å•</td></tr><tr><td><strong>å¤§è§„æ¨¡åº”ç”¨</strong></td><td>é›†ç¾¤æ¨¡å¼</td><td>æ€§èƒ½æ›´å¥½</td></tr></tbody></table><h3 id="11-2-æ•°æ®åˆ†ç‰‡ï¼ˆå“ˆå¸Œæ§½ï¼‰"><a href="#11-2-æ•°æ®åˆ†ç‰‡ï¼ˆå“ˆå¸Œæ§½ï¼‰" class="headerlink" title="11.2 æ•°æ®åˆ†ç‰‡ï¼ˆå“ˆå¸Œæ§½ï¼‰"></a>11.2 æ•°æ®åˆ†ç‰‡ï¼ˆå“ˆå¸Œæ§½ï¼‰</h3><h4 id="11-2-1-ä»€ä¹ˆæ˜¯å“ˆå¸Œæ§½"><a href="#11-2-1-ä»€ä¹ˆæ˜¯å“ˆå¸Œæ§½" class="headerlink" title="11.2.1 ä»€ä¹ˆæ˜¯å“ˆå¸Œæ§½"></a>11.2.1 ä»€ä¹ˆæ˜¯å“ˆå¸Œæ§½</h4><p><strong>å“ˆå¸Œæ§½ï¼ˆHash Slotï¼‰</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šRedisé›†ç¾¤å°†æ•°æ®åˆ†æˆ<strong>16384ä¸ªæ§½</strong>ï¼Œæ¯ä¸ªæ§½åˆ†é…ç»™ä¸€ä¸ªèŠ‚ç‚¹</li><li><strong>ä½œç”¨</strong>ï¼šå®ç°æ•°æ®åˆ†ç‰‡ï¼Œå°†æ•°æ®åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>å›ºå®šæ•°é‡ï¼š16384ä¸ªæ§½ï¼ˆ2^14ï¼‰</li><li>å‡åŒ€åˆ†é…ï¼šæ§½å‡åŒ€åˆ†é…åˆ°å„ä¸ªMasterèŠ‚ç‚¹</li><li>åŠ¨æ€è°ƒæ•´ï¼šå¯ä»¥åŠ¨æ€è¿ç§»æ§½åˆ°å…¶ä»–èŠ‚ç‚¹</li></ul></li></ul><p><strong>æ§½åˆ†é…ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">3ä¸ªMasterèŠ‚ç‚¹ï¼š</span><br><span class="line">- Node1: æ§½ 0-5460 (5461ä¸ªæ§½)</span><br><span class="line">- Node2: æ§½ 5461-10922 (5462ä¸ªæ§½)</span><br><span class="line">- Node3: æ§½ 10923-16383 (5461ä¸ªæ§½)</span><br><span class="line"></span><br><span class="line">6ä¸ªMasterèŠ‚ç‚¹ï¼š</span><br><span class="line">- Node1: æ§½ 0-2730 (2731ä¸ªæ§½)</span><br><span class="line">- Node2: æ§½ 2731-5460 (2730ä¸ªæ§½)</span><br><span class="line">- Node3: æ§½ 5461-8191 (2731ä¸ªæ§½)</span><br><span class="line">- Node4: æ§½ 8192-10922 (2731ä¸ªæ§½)</span><br><span class="line">- Node5: æ§½ 10923-13652 (2730ä¸ªæ§½)</span><br><span class="line">- Node6: æ§½ 13653-16383 (2731ä¸ªæ§½)</span><br></pre></td></tr></table></figure><h4 id="11-2-2-é”®å€¼å¯¹è·¯ç”±"><a href="#11-2-2-é”®å€¼å¯¹è·¯ç”±" class="headerlink" title="11.2.2 é”®å€¼å¯¹è·¯ç”±"></a>11.2.2 é”®å€¼å¯¹è·¯ç”±</h4><p><strong>è®¡ç®—æ§½ä½</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redisä½¿ç”¨CRC16ç®—æ³•è®¡ç®—keyçš„æ§½ä½</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">slot</span>(<span class="params">key</span>):</span><br><span class="line">    crc = crc16(key)</span><br><span class="line">    <span class="keyword">return</span> crc % <span class="number">16384</span></span><br></pre></td></tr></table></figure><p><strong>è·¯ç”±æµç¨‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[å®¢æˆ·ç«¯å‘é€å‘½ä»¤]</span><br><span class="line">    â†“</span><br><span class="line">[è®¡ç®—keyçš„æ§½ä½]</span><br><span class="line">    â†“</span><br><span class="line">[æŸ¥æ‰¾æ§½ä½å¯¹åº”çš„èŠ‚ç‚¹]</span><br><span class="line">    â†“</span><br><span class="line">[å¦‚æœæ§½ä½åœ¨å½“å‰èŠ‚ç‚¹]</span><br><span class="line">    â†“</span><br><span class="line">[æ‰§è¡Œå‘½ä»¤]</span><br><span class="line">    â†“</span><br><span class="line">[å¦‚æœæ§½ä½åœ¨å…¶ä»–èŠ‚ç‚¹]</span><br><span class="line">    â†“</span><br><span class="line">[è¿”å›MOVEDé‡å®šå‘]</span><br><span class="line">    â†“</span><br><span class="line">[å®¢æˆ·ç«¯é‡å®šå‘åˆ°æ­£ç¡®èŠ‚ç‚¹]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ç«¯è¿æ¥åˆ°Node1</span></span><br><span class="line">127.0.0.1:7001&gt; SET user:1001 <span class="string">&quot;value&quot;</span></span><br><span class="line"><span class="comment"># è®¡ç®—æ§½ä½ï¼šCRC16(&quot;user:1001&quot;) % 16384 = 5000</span></span><br><span class="line"><span class="comment"># æ§½ä½5000åœ¨Node1ä¸Šï¼Œç›´æ¥æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯è¿æ¥åˆ°Node1</span></span><br><span class="line">127.0.0.1:7001&gt; SET user:2001 <span class="string">&quot;value&quot;</span></span><br><span class="line"><span class="comment"># è®¡ç®—æ§½ä½ï¼šCRC16(&quot;user:2001&quot;) % 16384 = 10000</span></span><br><span class="line"><span class="comment"># æ§½ä½10000åœ¨Node2ä¸Šï¼Œè¿”å›MOVEDé‡å®šå‘</span></span><br><span class="line"><span class="comment"># -MOVED 10000 127.0.0.1:7002</span></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯é‡å®šå‘åˆ°Node2æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><h4 id="11-2-3-å“ˆå¸Œæ ‡ç­¾ï¼ˆHash-Tagsï¼‰"><a href="#11-2-3-å“ˆå¸Œæ ‡ç­¾ï¼ˆHash-Tagsï¼‰" class="headerlink" title="11.2.3 å“ˆå¸Œæ ‡ç­¾ï¼ˆHash Tagsï¼‰"></a>11.2.3 å“ˆå¸Œæ ‡ç­¾ï¼ˆHash Tagsï¼‰</h4><p><strong>ä»€ä¹ˆæ˜¯å“ˆå¸Œæ ‡ç­¾</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šä½¿ç”¨<code>&#123;&#125;</code>æŒ‡å®škeyçš„ä¸€éƒ¨åˆ†ç”¨äºè®¡ç®—æ§½ä½</li><li><strong>ä½œç”¨</strong>ï¼šè®©ç›¸å…³çš„keyå­˜å‚¨åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹</li><li><strong>æ ¼å¼</strong>ï¼š<code>&#123;tag&#125;key</code></li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ä½¿ç”¨å“ˆå¸Œæ ‡ç­¾ï¼ˆå¯èƒ½å­˜å‚¨åœ¨ä¸åŒèŠ‚ç‚¹ï¼‰</span></span><br><span class="line">SET user:1001:name <span class="string">&quot;Alice&quot;</span></span><br><span class="line">SET user:1001:age <span class="string">&quot;25&quot;</span></span><br><span class="line">SET user:1001:email <span class="string">&quot;alice@example.com&quot;</span></span><br><span class="line"><span class="comment"># è¿™ä¸‰ä¸ªkeyå¯èƒ½å­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å“ˆå¸Œæ ‡ç­¾ï¼ˆå­˜å‚¨åœ¨åŒä¸€èŠ‚ç‚¹ï¼‰</span></span><br><span class="line">SET &#123;user:1001&#125;:name <span class="string">&quot;Alice&quot;</span></span><br><span class="line">SET &#123;user:1001&#125;:age <span class="string">&quot;25&quot;</span></span><br><span class="line">SET &#123;user:1001&#125;:email <span class="string">&quot;alice@example.com&quot;</span></span><br><span class="line"><span class="comment"># è¿™ä¸‰ä¸ªkeyéƒ½ä½¿ç”¨&quot;user:1001&quot;è®¡ç®—æ§½ä½ï¼Œå­˜å‚¨åœ¨åŒä¸€èŠ‚ç‚¹</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>âœ… <strong>å¤škeyæ“ä½œ</strong>ï¼šMGETã€MSETç­‰éœ€è¦å¤šä¸ªkeyåœ¨åŒä¸€èŠ‚ç‚¹</li><li>âœ… <strong>äº‹åŠ¡æ“ä½œ</strong>ï¼šMULTI&#x2F;EXECéœ€è¦æ‰€æœ‰keyåœ¨åŒä¸€èŠ‚ç‚¹</li><li>âœ… <strong>Luaè„šæœ¬</strong>ï¼šè„šæœ¬ä¸­çš„keyéœ€è¦åœ¨åŒä¸€èŠ‚ç‚¹</li></ul><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>âš ï¸ åªè®¡ç®—<code>&#123;&#125;</code>å†…çš„å†…å®¹ï¼Œ<code>&#123;&#125;</code>å¤–çš„å†…å®¹ä¸å‚ä¸è®¡ç®—</li><li>âš ï¸ å¦‚æœ<code>&#123;&#125;</code>ä¸ºç©ºï¼Œä½¿ç”¨æ•´ä¸ªkeyè®¡ç®—æ§½ä½</li><li>âš ï¸ å¤šä¸ª<code>&#123;&#125;</code>æ—¶ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ª<code>&#123;&#125;</code>çš„å†…å®¹</li></ul><h3 id="11-3-é›†ç¾¤æ­å»º"><a href="#11-3-é›†ç¾¤æ­å»º" class="headerlink" title="11.3 é›†ç¾¤æ­å»º"></a>11.3 é›†ç¾¤æ­å»º</h3><h4 id="11-3-1-å‡†å¤‡å·¥ä½œ"><a href="#11-3-1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="11.3.1 å‡†å¤‡å·¥ä½œ"></a>11.3.1 å‡†å¤‡å·¥ä½œ</h4><p><strong>ç¯å¢ƒè¦æ±‚</strong>ï¼š</p><ul><li>Redis 3.0+</li><li>è‡³å°‘6ä¸ªèŠ‚ç‚¹ï¼ˆ3ä¸ªMaster + 3ä¸ªSlaveï¼‰</li><li>æ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶</li></ul><p><strong>ç›®å½•ç»“æ„</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/opt/redis-cluster/</span><br><span class="line">â”œâ”€â”€ 7001/</span><br><span class="line">â”‚   â”œâ”€â”€ redis.conf</span><br><span class="line">â”‚   â””â”€â”€ nodes.conf</span><br><span class="line">â”œâ”€â”€ 7002/</span><br><span class="line">â”‚   â”œâ”€â”€ redis.conf</span><br><span class="line">â”‚   â””â”€â”€ nodes.conf</span><br><span class="line">â”œâ”€â”€ 7003/</span><br><span class="line">â”‚   â”œâ”€â”€ redis.conf</span><br><span class="line">â”‚   â””â”€â”€ nodes.conf</span><br><span class="line">â”œâ”€â”€ 7004/</span><br><span class="line">â”‚   â”œâ”€â”€ redis.conf</span><br><span class="line">â”‚   â””â”€â”€ nodes.conf</span><br><span class="line">â”œâ”€â”€ 7005/</span><br><span class="line">â”‚   â”œâ”€â”€ redis.conf</span><br><span class="line">â”‚   â””â”€â”€ nodes.conf</span><br><span class="line">â””â”€â”€ 7006/</span><br><span class="line">    â”œâ”€â”€ redis.conf</span><br><span class="line">    â””â”€â”€ nodes.conf</span><br></pre></td></tr></table></figure><h4 id="11-3-2-é…ç½®æ–‡ä»¶"><a href="#11-3-2-é…ç½®æ–‡ä»¶" class="headerlink" title="11.3.2 é…ç½®æ–‡ä»¶"></a>11.3.2 é…ç½®æ–‡ä»¶</h4><p><strong>MasterèŠ‚ç‚¹é…ç½®ï¼ˆredis-7001.confï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç«¯å£</span></span><br><span class="line">port 7001</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»‘å®šåœ°å€</span></span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PIDæ–‡ä»¶</span></span><br><span class="line">pidfile /var/run/redis_7001.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">logfile /var/log/redis/redis_7001.<span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®ç›®å½•</span></span><br><span class="line"><span class="built_in">dir</span> /opt/redis-cluster/7001/</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯é›†ç¾¤æ¨¡å¼</span></span><br><span class="line">cluster-enabled <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é›†ç¾¤é…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</span></span><br><span class="line">cluster-config-file nodes-7001.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># èŠ‚ç‚¹è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">cluster-node-timeout 15000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒä¹…åŒ–</span></span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># AOF</span></span><br><span class="line">appendonly <span class="built_in">yes</span></span><br><span class="line">appendfilename <span class="string">&quot;appendonly-7001.aof&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè®¾ç½®äº†å¯†ç </span></span><br><span class="line">requirepass cluster123</span><br><span class="line">masterauth cluster123</span><br></pre></td></tr></table></figure><p><strong>SlaveèŠ‚ç‚¹é…ç½®ï¼ˆredis-7004.confï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸Masteré…ç½®ç›¸åŒï¼Œåªæ˜¯ç«¯å£ä¸åŒ</span></span><br><span class="line">port 7004</span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">pidfile /var/run/redis_7004.pid</span><br><span class="line">logfile /var/log/redis/redis_7004.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">dir</span> /opt/redis-cluster/7004/</span><br><span class="line">cluster-enabled <span class="built_in">yes</span></span><br><span class="line">cluster-config-file nodes-7004.conf</span><br><span class="line">cluster-node-timeout 15000</span><br><span class="line">requirepass cluster123</span><br><span class="line">masterauth cluster123</span><br></pre></td></tr></table></figure><h4 id="11-3-3-å¯åŠ¨èŠ‚ç‚¹"><a href="#11-3-3-å¯åŠ¨èŠ‚ç‚¹" class="headerlink" title="11.3.3 å¯åŠ¨èŠ‚ç‚¹"></a>11.3.3 å¯åŠ¨èŠ‚ç‚¹</h4><p><strong>å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨6ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">redis-server /opt/redis-cluster/7001/redis.conf</span><br><span class="line">redis-server /opt/redis-cluster/7002/redis.conf</span><br><span class="line">redis-server /opt/redis-cluster/7003/redis.conf</span><br><span class="line">redis-server /opt/redis-cluster/7004/redis.conf</span><br><span class="line">redis-server /opt/redis-cluster/7005/redis.conf</span><br><span class="line">redis-server /opt/redis-cluster/7006/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å¯åŠ¨</span></span><br><span class="line">ps aux | grep redis-server</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿æ¥èŠ‚ç‚¹</span></span><br><span class="line">redis-cli -p 7001</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯ï¼ˆæ­¤æ—¶è¿˜æœªåˆ›å»ºé›†ç¾¤ï¼‰</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER INFO</span><br><span class="line">cluster_state:fail</span><br><span class="line">cluster_slots_assigned:0</span><br><span class="line">cluster_known_nodes:1</span><br></pre></td></tr></table></figure><h4 id="11-3-4-åˆ›å»ºé›†ç¾¤"><a href="#11-3-4-åˆ›å»ºé›†ç¾¤" class="headerlink" title="11.3.4 åˆ›å»ºé›†ç¾¤"></a>11.3.4 åˆ›å»ºé›†ç¾¤</h4><p><strong>æ–¹å¼1ï¼šä½¿ç”¨redis-cliåˆ›å»ºï¼ˆæ¨èï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redis 5.0+</span></span><br><span class="line">redis-cli --cluster create \</span><br><span class="line">  127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 \</span><br><span class="line">  127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 \</span><br><span class="line">  --cluster-replicas 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè®¾ç½®äº†å¯†ç </span></span><br><span class="line">redis-cli --cluster create \</span><br><span class="line">  127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 \</span><br><span class="line">  127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 \</span><br><span class="line">  --cluster-replicas 1 \</span><br><span class="line">  -a cluster123</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>--cluster create</code>ï¼šåˆ›å»ºé›†ç¾¤</li><li><code>--cluster-replicas 1</code>ï¼šæ¯ä¸ªMasteræœ‰1ä¸ªSlave</li><li><code>-a</code>ï¼šå¯†ç è®¤è¯</li></ul><p><strong>äº¤äº’å¼åˆ›å»º</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; Performing <span class="built_in">hash</span> slots allocation on 6 nodes...</span><br><span class="line">Master[0] -&gt; Slots 0 - 5460</span><br><span class="line">Master[1] -&gt; Slots 5461 - 10922</span><br><span class="line">Master[2] -&gt; Slots 10923 - 16383</span><br><span class="line">Adding replica 127.0.0.1:7004 to 127.0.0.1:7001</span><br><span class="line">Adding replica 127.0.0.1:7005 to 127.0.0.1:7002</span><br><span class="line">Adding replica 127.0.0.1:7006 to 127.0.0.1:7003</span><br><span class="line">&gt;&gt;&gt; Trying to optimize slaves allocation <span class="keyword">for</span> anti-affinity</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">&gt;&gt;&gt; Check <span class="keyword">for</span> open slots...</span><br><span class="line">&gt;&gt;&gt; Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line">&gt;&gt;&gt; Send CLUSTER MEET messages to <span class="built_in">join</span> the cluster</span><br><span class="line">Waiting <span class="keyword">for</span> the cluster to <span class="built_in">join</span>...</span><br><span class="line">&gt;&gt;&gt; Configure node as replica of 127.0.0.1:7001</span><br><span class="line">[OK] New cluster configured successfully</span><br></pre></td></tr></table></figure><p><strong>æ–¹å¼2ï¼šæ‰‹åŠ¨åˆ›å»ºï¼ˆäº†è§£å³å¯ï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. è®©æ‰€æœ‰èŠ‚ç‚¹äº’ç›¸è®¤è¯†</span></span><br><span class="line">redis-cli -p 7001 CLUSTER MEET 127.0.0.1 7002</span><br><span class="line">redis-cli -p 7001 CLUSTER MEET 127.0.0.1 7003</span><br><span class="line"><span class="comment"># ... å…¶ä»–èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆ†é…æ§½ä½</span></span><br><span class="line">redis-cli -p 7001 CLUSTER ADDSLOTS &#123;0..5460&#125;</span><br><span class="line">redis-cli -p 7002 CLUSTER ADDSLOTS &#123;5461..10922&#125;</span><br><span class="line">redis-cli -p 7003 CLUSTER ADDSLOTS &#123;10923..16383&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. è®¾ç½®ä¸»ä»å…³ç³»</span></span><br><span class="line">redis-cli -p 7004 CLUSTER REPLICATE &lt;node-id-7001&gt;</span><br><span class="line">redis-cli -p 7005 CLUSTER REPLICATE &lt;node-id-7002&gt;</span><br><span class="line">redis-cli -p 7006 CLUSTER REPLICATE &lt;node-id-7003&gt;</span><br></pre></td></tr></table></figure><h4 id="11-3-5-éªŒè¯é›†ç¾¤"><a href="#11-3-5-éªŒè¯é›†ç¾¤" class="headerlink" title="11.3.5 éªŒè¯é›†ç¾¤"></a>11.3.5 éªŒè¯é›†ç¾¤</h4><p><strong>æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿æ¥ä»»æ„èŠ‚ç‚¹</span></span><br><span class="line">redis-cli -p 7001 -c  <span class="comment"># -cè¡¨ç¤ºé›†ç¾¤æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER INFO</span><br><span class="line">cluster_state:ok</span><br><span class="line">cluster_slots_assigned:16384</span><br><span class="line">cluster_slots_ok:16384</span><br><span class="line">cluster_slots_pfail:0</span><br><span class="line">cluster_slots_fail:0</span><br><span class="line">cluster_known_nodes:6</span><br><span class="line">cluster_size:3</span><br><span class="line">cluster_current_epoch:6</span><br><span class="line">cluster_my_epoch:1</span><br><span class="line">cluster_stats_messages_sent:1234</span><br><span class="line">cluster_stats_messages_received:1234</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER NODES</span><br><span class="line">abc123... 127.0.0.1:7001@17001 myself,master - 0 0 1 connected 0-5460</span><br><span class="line">def456... 127.0.0.1:7002@17002 master - 0 0 2 connected 5461-10922</span><br><span class="line">ghi789... 127.0.0.1:7003@17003 master - 0 0 3 connected 10923-16383</span><br><span class="line">jkl012... 127.0.0.1:7004@17004 slave abc123... 0 0 4 connected</span><br><span class="line">mno345... 127.0.0.1:7005@17005 slave def456... 0 0 5 connected</span><br><span class="line">pqr678... 127.0.0.1:7006@17006 slave ghi789... 0 0 6 connected</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•æ•°æ®æ“ä½œ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®æ•°æ®ï¼ˆä¼šè‡ªåŠ¨é‡å®šå‘ï¼‰</span></span><br><span class="line">127.0.0.1:7001&gt; SET user:1001 <span class="string">&quot;Alice&quot;</span></span><br><span class="line">-&gt; Redirected to slot [9189] located at 127.0.0.1:7002</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">127.0.0.1:7002&gt; GET user:1001</span><br><span class="line"><span class="string">&quot;Alice&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ§½ä½ä¿¡æ¯</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER KEYSLOT user:1001</span><br><span class="line">(<span class="built_in">integer</span>) 9189</span><br></pre></td></tr></table></figure><h3 id="11-4-é›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹"><a href="#11-4-é›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹" class="headerlink" title="11.4 é›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹"></a>11.4 é›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹</h3><h4 id="11-4-1-é›†ç¾¤æ‰©å®¹"><a href="#11-4-1-é›†ç¾¤æ‰©å®¹" class="headerlink" title="11.4.1 é›†ç¾¤æ‰©å®¹"></a>11.4.1 é›†ç¾¤æ‰©å®¹</h4><p><strong>åœºæ™¯</strong>ï¼šæ·»åŠ æ–°çš„Masterå’ŒSlaveèŠ‚ç‚¹</p><p><strong>æ­¥éª¤1ï¼šå¯åŠ¨æ–°èŠ‚ç‚¹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æ–°MasterèŠ‚ç‚¹ï¼ˆ7007ï¼‰</span></span><br><span class="line">redis-server /opt/redis-cluster/7007/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æ–°SlaveèŠ‚ç‚¹ï¼ˆ7008ï¼‰</span></span><br><span class="line">redis-server /opt/redis-cluster/7008/redis.conf</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤2ï¼šæ·»åŠ èŠ‚ç‚¹åˆ°é›†ç¾¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ MasterèŠ‚ç‚¹</span></span><br><span class="line">redis-cli --cluster add-node 127.0.0.1:7007 127.0.0.1:7001</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ SlaveèŠ‚ç‚¹</span></span><br><span class="line">redis-cli --cluster add-node 127.0.0.1:7008 127.0.0.1:7001 --cluster-slave</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤3ï¼šåˆ†é…æ§½ä½</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šè‡ªåŠ¨åˆ†é…ï¼ˆä»ç°æœ‰èŠ‚ç‚¹è¿ç§»æ§½ä½ï¼‰</span></span><br><span class="line">redis-cli --cluster reshard 127.0.0.1:7001</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤äº’å¼ï¼š</span></span><br><span class="line"><span class="comment"># How many slots do you want to move? 4096</span></span><br><span class="line"><span class="comment"># What is the receiving node ID? &lt;node-id-7007&gt;</span></span><br><span class="line"><span class="comment"># Source node #1: all</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šæ‰‹åŠ¨åˆ†é…ï¼ˆæŒ‡å®šä»å“ªäº›èŠ‚ç‚¹è¿ç§»ï¼‰</span></span><br><span class="line">redis-cli --cluster reshard 127.0.0.1:7001 \</span><br><span class="line">  --cluster-from &lt;node-id-7001&gt;,&lt;node-id-7002&gt;,&lt;node-id-7003&gt; \</span><br><span class="line">  --cluster-to &lt;node-id-7007&gt; \</span><br><span class="line">  --cluster-slots 4096</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤4ï¼šè®¾ç½®Slave</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæ·»åŠ Slaveæ—¶æ²¡æœ‰æŒ‡å®šï¼Œå¯ä»¥æ‰‹åŠ¨è®¾ç½®</span></span><br><span class="line">redis-cli -p 7008 CLUSTER REPLICATE &lt;node-id-7007&gt;</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤5ï¼šéªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER NODES</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ§½ä½åˆ†é…</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER SLOTS</span><br></pre></td></tr></table></figure><h4 id="11-4-2-é›†ç¾¤ç¼©å®¹"><a href="#11-4-2-é›†ç¾¤ç¼©å®¹" class="headerlink" title="11.4.2 é›†ç¾¤ç¼©å®¹"></a>11.4.2 é›†ç¾¤ç¼©å®¹</h4><p><strong>åœºæ™¯</strong>ï¼šç§»é™¤èŠ‚ç‚¹</p><p><strong>æ­¥éª¤1ï¼šè¿ç§»æ§½ä½</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†è¦ç§»é™¤èŠ‚ç‚¹çš„æ§½ä½è¿ç§»åˆ°å…¶ä»–èŠ‚ç‚¹</span></span><br><span class="line">redis-cli --cluster reshard 127.0.0.1:7001</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤äº’å¼ï¼š</span></span><br><span class="line"><span class="comment"># How many slots do you want to move? 5461</span></span><br><span class="line"><span class="comment"># What is the receiving node ID? &lt;node-id-7001&gt;</span></span><br><span class="line"><span class="comment"># Source node #1: &lt;node-id-7002&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤2ï¼šç§»é™¤SlaveèŠ‚ç‚¹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç§»é™¤SlaveèŠ‚ç‚¹ï¼ˆæ— éœ€è¿ç§»æ§½ä½ï¼‰</span></span><br><span class="line">redis-cli --cluster del-node 127.0.0.1:7001 &lt;node-id-7008&gt;</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤3ï¼šç§»é™¤MasterèŠ‚ç‚¹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¡®ä¿æ‰€æœ‰æ§½ä½å·²è¿ç§»</span></span><br><span class="line">redis-cli --cluster check 127.0.0.1:7001</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»é™¤MasterèŠ‚ç‚¹</span></span><br><span class="line">redis-cli --cluster del-node 127.0.0.1:7001 &lt;node-id-7002&gt;</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤4ï¼šéªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER NODES</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥é›†ç¾¤çŠ¶æ€</span></span><br><span class="line">redis-cli --cluster check 127.0.0.1:7001</span><br></pre></td></tr></table></figure><h4 id="11-4-3-æ§½ä½è¿ç§»"><a href="#11-4-3-æ§½ä½è¿ç§»" class="headerlink" title="11.4.3 æ§½ä½è¿ç§»"></a>11.4.3 æ§½ä½è¿ç§»</h4><p><strong>æ‰‹åŠ¨è¿ç§»æ§½ä½</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿ç§»å•ä¸ªæ§½ä½</span></span><br><span class="line">redis-cli --cluster setslot &lt;slot&gt; importing &lt;source-node-id&gt; 127.0.0.1:7001</span><br><span class="line">redis-cli --cluster setslot &lt;slot&gt; migrating &lt;target-node-id&gt; 127.0.0.1:7002</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿ç§»æ§½ä½ä¸­çš„key</span></span><br><span class="line">redis-cli --cluster migrate 127.0.0.1:7002 &lt;key&gt; 0 5000</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®Œæˆè¿ç§»</span></span><br><span class="line">redis-cli --cluster setslot &lt;slot&gt; node &lt;target-node-id&gt; 127.0.0.1:7001</span><br><span class="line">redis-cli --cluster setslot &lt;slot&gt; node &lt;target-node-id&gt; 127.0.0.1:7002</span><br></pre></td></tr></table></figure><p><strong>æ‰¹é‡è¿ç§»</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨reshardå‘½ä»¤æ‰¹é‡è¿ç§»</span></span><br><span class="line">redis-cli --cluster reshard 127.0.0.1:7001</span><br></pre></td></tr></table></figure><h3 id="11-5-æ•…éšœè½¬ç§»"><a href="#11-5-æ•…éšœè½¬ç§»" class="headerlink" title="11.5 æ•…éšœè½¬ç§»"></a>11.5 æ•…éšœè½¬ç§»</h3><h4 id="11-5-1-è‡ªåŠ¨æ•…éšœè½¬ç§»"><a href="#11-5-1-è‡ªåŠ¨æ•…éšœè½¬ç§»" class="headerlink" title="11.5.1 è‡ªåŠ¨æ•…éšœè½¬ç§»"></a>11.5.1 è‡ªåŠ¨æ•…éšœè½¬ç§»</h4><p><strong>æ•…éšœæ£€æµ‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[MasterèŠ‚ç‚¹æ•…éšœ]</span><br><span class="line">    â†“</span><br><span class="line">[SlaveèŠ‚ç‚¹æ£€æµ‹åˆ°Masteræ•…éšœ]</span><br><span class="line">    â†“</span><br><span class="line">[SlaveèŠ‚ç‚¹æ ‡è®°Masterä¸ºFAIL]</span><br><span class="line">    â†“</span><br><span class="line">[SlaveèŠ‚ç‚¹å‘å…¶ä»–èŠ‚ç‚¹å¹¿æ’­FAILæ¶ˆæ¯]</span><br><span class="line">    â†“</span><br><span class="line">[å…¶ä»–èŠ‚ç‚¹ç¡®è®¤Masteræ•…éšœ]</span><br><span class="line">    â†“</span><br><span class="line">[SlaveèŠ‚ç‚¹æå‡ä¸ºMaster]</span><br><span class="line">    â†“</span><br><span class="line">[æ¥ç®¡åŸMasterçš„æ§½ä½]</span><br><span class="line">    â†“</span><br><span class="line">[æ•…éšœè½¬ç§»å®Œæˆ]</span><br></pre></td></tr></table></figure><p><strong>æ•…éšœè½¬ç§»æ¡ä»¶</strong>ï¼š</p><ul><li>MasterèŠ‚ç‚¹æ•…éšœï¼ˆæ— æ³•å“åº”PINGï¼‰</li><li>è‡³å°‘ä¸€ä¸ªSlaveèŠ‚ç‚¹å¯ç”¨</li><li>å¤§å¤šæ•°èŠ‚ç‚¹ç¡®è®¤Masteræ•…éšœ</li></ul><h4 id="11-5-2-æ‰‹åŠ¨æ•…éšœè½¬ç§»"><a href="#11-5-2-æ‰‹åŠ¨æ•…éšœè½¬ç§»" class="headerlink" title="11.5.2 æ‰‹åŠ¨æ•…éšœè½¬ç§»"></a>11.5.2 æ‰‹åŠ¨æ•…éšœè½¬ç§»</h4><p><strong>åœºæ™¯</strong>ï¼šç»´æŠ¤æ—¶æ‰‹åŠ¨åˆ‡æ¢Master</p><p><strong>æ­¥éª¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨SlaveèŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span></span><br><span class="line">redis-cli -p 7004 CLUSTER FAILOVER</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…å¼ºåˆ¶æ•…éšœè½¬ç§»ï¼ˆå³ä½¿Masteræ­£å¸¸ï¼‰</span></span><br><span class="line">redis-cli -p 7004 CLUSTER FAILOVER FORCE</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…å¸¦è¶…æ—¶çš„æ•…éšœè½¬ç§»</span></span><br><span class="line">redis-cli -p 7004 CLUSTER FAILOVER TAKEOVER</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</span></span><br><span class="line">127.0.0.1:7001&gt; CLUSTER NODES</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸSlaveå·²æå‡ä¸ºMaster</span></span><br><span class="line"><span class="comment"># åŸMasterå·²é™çº§ä¸ºSlave</span></span><br></pre></td></tr></table></figure><h3 id="11-6-å®¢æˆ·ç«¯è¿æ¥"><a href="#11-6-å®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="11.6 å®¢æˆ·ç«¯è¿æ¥"></a>11.6 å®¢æˆ·ç«¯è¿æ¥</h3><h4 id="11-6-1-Javaå®¢æˆ·ç«¯è¿æ¥"><a href="#11-6-1-Javaå®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="11.6.1 Javaå®¢æˆ·ç«¯è¿æ¥"></a>11.6.1 Javaå®¢æˆ·ç«¯è¿æ¥</h4><p><strong>Jedisè¿æ¥é›†ç¾¤</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisCluster;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.HostAndPort;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisClusterExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// é›†ç¾¤èŠ‚ç‚¹åˆ—è¡¨</span></span><br><span class="line">        Set&lt;HostAndPort&gt; nodes = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">7001</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">7002</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">7003</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">7004</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">7005</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">7006</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿æ¥æ± é…ç½®</span></span><br><span class="line">        <span class="type">JedisPoolConfig</span> <span class="variable">poolConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">        poolConfig.setMaxTotal(<span class="number">10</span>);</span><br><span class="line">        poolConfig.setMaxIdle(<span class="number">5</span>);</span><br><span class="line">        poolConfig.setMinIdle(<span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºé›†ç¾¤è¿æ¥</span></span><br><span class="line">        <span class="type">JedisCluster</span> <span class="variable">jedisCluster</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisCluster</span>(</span><br><span class="line">            nodes,</span><br><span class="line">            <span class="number">2000</span>,  <span class="comment">// è¿æ¥è¶…æ—¶</span></span><br><span class="line">            <span class="number">2000</span>,  <span class="comment">// è¯»å–è¶…æ—¶</span></span><br><span class="line">            <span class="number">5</span>,     <span class="comment">// æœ€å¤§é‡å®šå‘æ¬¡æ•°</span></span><br><span class="line">            poolConfig,</span><br><span class="line">            <span class="string">&quot;cluster123&quot;</span>  <span class="comment">// å¯†ç </span></span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">            jedisCluster.set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> jedisCluster.get(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Value: &quot;</span> + value);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// å…³é—­è¿æ¥</span></span><br><span class="line">            jedisCluster.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Spring Booté…ç½®</strong>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.yml</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">cluster:</span></span><br><span class="line">      <span class="attr">nodes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:7001</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:7002</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:7003</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:7004</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:7005</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:7006</span></span><br><span class="line">      <span class="attr">max-redirects:</span> <span class="number">5</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">cluster123</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">2000</span></span><br><span class="line">    <span class="attr">pool:</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">max-idle:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><h4 id="11-6-2-Pythonå®¢æˆ·ç«¯è¿æ¥"><a href="#11-6-2-Pythonå®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="11.6.2 Pythonå®¢æˆ·ç«¯è¿æ¥"></a>11.6.2 Pythonå®¢æˆ·ç«¯è¿æ¥</h4><p><strong>redis-pyè¿æ¥é›†ç¾¤</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rediscluster <span class="keyword">import</span> RedisCluster</span><br><span class="line"></span><br><span class="line"><span class="comment"># é›†ç¾¤èŠ‚ç‚¹åˆ—è¡¨</span></span><br><span class="line">startup_nodes = [</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7001&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7002&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7003&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7004&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7005&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7006&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé›†ç¾¤è¿æ¥</span></span><br><span class="line">rc = RedisCluster(</span><br><span class="line">    startup_nodes=startup_nodes,</span><br><span class="line">    decode_responses=<span class="literal">True</span>,</span><br><span class="line">    password=<span class="string">&quot;cluster123&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">rc.<span class="built_in">set</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>)</span><br><span class="line">value = rc.get(<span class="string">&quot;key&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Value: <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="11-7-å®æˆ˜æ¡ˆä¾‹"><a href="#11-7-å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="11.7 å®æˆ˜æ¡ˆä¾‹"></a>11.7 å®æˆ˜æ¡ˆä¾‹</h3><h4 id="11-7-1-æ¡ˆä¾‹1ï¼š6èŠ‚ç‚¹é›†ç¾¤æ­å»º"><a href="#11-7-1-æ¡ˆä¾‹1ï¼š6èŠ‚ç‚¹é›†ç¾¤æ­å»º" class="headerlink" title="11.7.1 æ¡ˆä¾‹1ï¼š6èŠ‚ç‚¹é›†ç¾¤æ­å»º"></a>11.7.1 æ¡ˆä¾‹1ï¼š6èŠ‚ç‚¹é›†ç¾¤æ­å»º</h4><p><strong>éœ€æ±‚</strong>ï¼šæ­å»º3ä¸»3ä»çš„Redisé›†ç¾¤</p><p><strong>é…ç½®è„šæœ¬ï¼ˆsetup-cluster.shï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># setup-cluster.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> 7001 7002 7003 7004 7005 7006; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">mkdir</span> -p /opt/redis-cluster/<span class="variable">$port</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> 7001 7002 7003 7004 7005 7006; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">cat</span> &gt; /opt/redis-cluster/<span class="variable">$port</span>/redis.conf &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">port $port</span></span><br><span class="line"><span class="string">bind 0.0.0.0</span></span><br><span class="line"><span class="string">daemonize yes</span></span><br><span class="line"><span class="string">pidfile /var/run/redis_$port.pid</span></span><br><span class="line"><span class="string">logfile /var/log/redis/redis_$port.log</span></span><br><span class="line"><span class="string">dir /opt/redis-cluster/$port/</span></span><br><span class="line"><span class="string">cluster-enabled yes</span></span><br><span class="line"><span class="string">cluster-config-file nodes-$port.conf</span></span><br><span class="line"><span class="string">cluster-node-timeout 15000</span></span><br><span class="line"><span class="string">appendonly yes</span></span><br><span class="line"><span class="string">requirepass cluster123</span></span><br><span class="line"><span class="string">masterauth cluster123</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> 7001 7002 7003 7004 7005 7006; <span class="keyword">do</span></span><br><span class="line">    redis-server /opt/redis-cluster/<span class="variable">$port</span>/redis.conf</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰å¾…èŠ‚ç‚¹å¯åŠ¨</span></span><br><span class="line"><span class="built_in">sleep</span> 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé›†ç¾¤</span></span><br><span class="line">redis-cli --cluster create \</span><br><span class="line">  127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 \</span><br><span class="line">  127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 \</span><br><span class="line">  --cluster-replicas 1 \</span><br><span class="line">  -a cluster123</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Cluster setup completed!&quot;</span></span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œè„šæœ¬</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x setup-cluster.sh</span><br><span class="line">./setup-cluster.sh</span><br></pre></td></tr></table></figure><h4 id="11-7-2-æ¡ˆä¾‹2ï¼šé›†ç¾¤ç›‘æ§è„šæœ¬"><a href="#11-7-2-æ¡ˆä¾‹2ï¼šé›†ç¾¤ç›‘æ§è„šæœ¬" class="headerlink" title="11.7.2 æ¡ˆä¾‹2ï¼šé›†ç¾¤ç›‘æ§è„šæœ¬"></a>11.7.2 æ¡ˆä¾‹2ï¼šé›†ç¾¤ç›‘æ§è„šæœ¬</h4><p><strong>ç›‘æ§è„šæœ¬ï¼ˆmonitor-cluster.shï¼‰</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># monitor-cluster.sh</span></span><br><span class="line"></span><br><span class="line">CLUSTER_NODES=<span class="string">&quot;127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003&quot;</span></span><br><span class="line">PASSWORD=<span class="string">&quot;cluster123&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">check_cluster</span></span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> <span class="variable">$CLUSTER_NODES</span>; <span class="keyword">do</span></span><br><span class="line">        host=$(<span class="built_in">echo</span> <span class="variable">$node</span> | <span class="built_in">cut</span> -d: -f1)</span><br><span class="line">        port=$(<span class="built_in">echo</span> <span class="variable">$node</span> | <span class="built_in">cut</span> -d: -f2)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€</span></span><br><span class="line">        result=$(redis-cli -h <span class="variable">$host</span> -p <span class="variable">$port</span> -a <span class="variable">$PASSWORD</span> CLUSTER INFO 2&gt;/dev/null)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;ERROR: èŠ‚ç‚¹ <span class="variable">$node</span> æ— æ³•è¿æ¥&quot;</span></span><br><span class="line">            send_alert <span class="string">&quot;èŠ‚ç‚¹ <span class="variable">$node</span> æ— æ³•è¿æ¥&quot;</span></span><br><span class="line">            <span class="built_in">continue</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥é›†ç¾¤çŠ¶æ€</span></span><br><span class="line">        cluster_state=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$result</span>&quot;</span> | grep <span class="string">&quot;cluster_state&quot;</span> | <span class="built_in">cut</span> -d: -f2 | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$cluster_state</span>&quot;</span> != <span class="string">&quot;ok&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;WARNING: èŠ‚ç‚¹ <span class="variable">$node</span> é›†ç¾¤çŠ¶æ€å¼‚å¸¸: <span class="variable">$cluster_state</span>&quot;</span></span><br><span class="line">            send_alert <span class="string">&quot;èŠ‚ç‚¹ <span class="variable">$node</span> é›†ç¾¤çŠ¶æ€å¼‚å¸¸: <span class="variable">$cluster_state</span>&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ§½ä½</span></span><br><span class="line">        slots_assigned=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$result</span>&quot;</span> | grep <span class="string">&quot;cluster_slots_assigned&quot;</span> | <span class="built_in">cut</span> -d: -f2 | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">        slots_ok=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$result</span>&quot;</span> | grep <span class="string">&quot;cluster_slots_ok&quot;</span> | <span class="built_in">cut</span> -d: -f2 | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$slots_assigned</span>&quot;</span> != <span class="string">&quot;<span class="variable">$slots_ok</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;WARNING: èŠ‚ç‚¹ <span class="variable">$node</span> æ§½ä½å¼‚å¸¸: assigned=<span class="variable">$slots_assigned</span>, ok=<span class="variable">$slots_ok</span>&quot;</span></span><br><span class="line">            send_alert <span class="string">&quot;èŠ‚ç‚¹ <span class="variable">$node</span> æ§½ä½å¼‚å¸¸&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;OK: èŠ‚ç‚¹ <span class="variable">$node</span> çŠ¶æ€æ­£å¸¸&quot;</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">send_alert</span></span>() &#123;</span><br><span class="line">    message=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$message</span>&quot;</span> | mail -s <span class="string">&quot;Redisé›†ç¾¤å‘Šè­¦&quot;</span> admin@example.com</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">check_cluster</span><br></pre></td></tr></table></figure><h3 id="11-8-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"><a href="#11-8-æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ" class="headerlink" title="11.8 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ"></a>11.8 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h3><h4 id="11-8-1-æ³¨æ„äº‹é¡¹"><a href="#11-8-1-æ³¨æ„äº‹é¡¹" class="headerlink" title="11.8.1 æ³¨æ„äº‹é¡¹"></a>11.8.1 æ³¨æ„äº‹é¡¹</h4><p><strong>1. æ§½ä½åˆ†é…</strong>ï¼š</p><ul><li>âš ï¸ <strong>å¿…é¡»è¦†ç›–æ‰€æœ‰16384ä¸ªæ§½ä½</strong></li><li>âš ï¸ <strong>æ¯ä¸ªæ§½ä½åªèƒ½åˆ†é…ç»™ä¸€ä¸ªMaster</strong></li><li>âš ï¸ <strong>æ§½ä½åˆ†é…è¦å‡åŒ€</strong></li></ul><p><strong>2. èŠ‚ç‚¹æ•°é‡</strong>ï¼š</p><ul><li>âš ï¸ <strong>è‡³å°‘3ä¸ªMasterèŠ‚ç‚¹</strong></li><li>âš ï¸ <strong>æ¯ä¸ªMasterè‡³å°‘1ä¸ªSlave</strong></li><li>âš ï¸ <strong>æ€»å…±è‡³å°‘6ä¸ªèŠ‚ç‚¹</strong></li></ul><p><strong>3. ç½‘ç»œè¦æ±‚</strong>ï¼š</p><ul><li>âš ï¸ <strong>æ‰€æœ‰èŠ‚ç‚¹å¿…é¡»èƒ½å¤Ÿäº’ç›¸é€šä¿¡</strong></li><li>âš ï¸ <strong>éœ€è¦å¼€æ”¾é›†ç¾¤ç«¯å£ï¼ˆèŠ‚ç‚¹ç«¯å£+10000ï¼‰</strong></li><li>âš ï¸ <strong>å»ºè®®ä½¿ç”¨å†…ç½‘é€šä¿¡</strong></li></ul><p><strong>4. æ•°æ®ä¸€è‡´æ€§</strong>ï¼š</p><ul><li>âš ï¸ <strong>å¼‚æ­¥å¤åˆ¶ï¼Œå­˜åœ¨çŸ­æš‚å»¶è¿Ÿ</strong></li><li>âš ï¸ <strong>ä½¿ç”¨å“ˆå¸Œæ ‡ç­¾ä¿è¯å¤škeyæ“ä½œçš„ä¸€è‡´æ€§</strong></li></ul><h4 id="11-8-2-æœ€ä½³å®è·µ"><a href="#11-8-2-æœ€ä½³å®è·µ" class="headerlink" title="11.8.2 æœ€ä½³å®è·µ"></a>11.8.2 æœ€ä½³å®è·µ</h4><p><strong>1. èŠ‚ç‚¹éƒ¨ç½²</strong>ï¼š</p><ul><li>âœ… <strong>Masterå’ŒSlaveéƒ¨ç½²åœ¨ä¸åŒæœåŠ¡å™¨</strong></li><li>âœ… <strong>ä½¿ç”¨å¥‡æ•°ä¸ªMasterèŠ‚ç‚¹</strong></li><li>âœ… <strong>åˆç†åˆ†é…æ§½ä½</strong></li></ul><p><strong>2. æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p><ul><li>âœ… <strong>ä½¿ç”¨å“ˆå¸Œæ ‡ç­¾å‡å°‘è·¨èŠ‚ç‚¹æ“ä½œ</strong></li><li>âœ… <strong>åˆç†è®¾ç½®è¿æ¥æ± å¤§å°</strong></li><li>âœ… <strong>ç›‘æ§èŠ‚ç‚¹æ€§èƒ½</strong></li></ul><p><strong>3. å®‰å…¨é…ç½®</strong>ï¼š</p><ul><li>âœ… <strong>è®¾ç½®å¯†ç è®¤è¯</strong></li><li>âœ… <strong>ä½¿ç”¨é˜²ç«å¢™é™åˆ¶è®¿é—®</strong></li><li>âœ… <strong>å®šæœŸå¤‡ä»½æ•°æ®</strong></li></ul><p><strong>4. ç›‘æ§æŒ‡æ ‡</strong>ï¼š</p><table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th><th>æ­£å¸¸å€¼</th></tr></thead><tbody><tr><td><code>cluster_state</code></td><td>é›†ç¾¤çŠ¶æ€</td><td>ok</td></tr><tr><td><code>cluster_slots_assigned</code></td><td>å·²åˆ†é…æ§½ä½</td><td>16384</td></tr><tr><td><code>cluster_slots_ok</code></td><td>æ­£å¸¸æ§½ä½</td><td>16384</td></tr><tr><td><code>cluster_known_nodes</code></td><td>å·²çŸ¥èŠ‚ç‚¹æ•°</td><td>&gt;&#x3D; 6</td></tr><tr><td><code>cluster_size</code></td><td>MasterèŠ‚ç‚¹æ•°</td><td>&gt;&#x3D; 3</td></tr></tbody></table><h3 id="11-9-æ€»ç»“"><a href="#11-9-æ€»ç»“" class="headerlink" title="11.9 æ€»ç»“"></a>11.9 æ€»ç»“</h3><p><strong>Redisé›†ç¾¤æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p><ol><li>âœ… <strong>æ•°æ®åˆ†ç‰‡</strong>ï¼šä½¿ç”¨16384ä¸ªå“ˆå¸Œæ§½å®ç°æ•°æ®åˆ†ç‰‡</li><li>âœ… <strong>é«˜å¯ç”¨</strong>ï¼šMasteræ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°Slave</li><li>âœ… <strong>æ— ä¸­å¿ƒåŒ–</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹å¹³ç­‰ï¼Œæ— å•ç‚¹æ•…éšœ</li><li>âœ… <strong>æ°´å¹³æ‰©å±•</strong>ï¼šå¯ä»¥åŠ¨æ€æ·»åŠ æˆ–åˆ é™¤èŠ‚ç‚¹</li><li>âœ… <strong>å“ˆå¸Œæ ‡ç­¾</strong>ï¼šä¿è¯ç›¸å…³keyåœ¨åŒä¸€èŠ‚ç‚¹</li></ol><p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p><ol><li>âœ… <strong>è‡³å°‘6ä¸ªèŠ‚ç‚¹</strong>ï¼š3ä¸ªMaster + 3ä¸ªSlave</li><li>âœ… <strong>å‡åŒ€åˆ†é…æ§½ä½</strong>ï¼šä¿è¯è´Ÿè½½å‡è¡¡</li><li>âœ… <strong>ä½¿ç”¨å“ˆå¸Œæ ‡ç­¾</strong>ï¼šä¿è¯å¤škeyæ“ä½œçš„ä¸€è‡´æ€§</li><li>âœ… <strong>ç›‘æ§é›†ç¾¤çŠ¶æ€</strong>ï¼šåŠæ—¶å‘ç°é—®é¢˜</li><li>âœ… <strong>å®šæœŸå¤‡ä»½æ•°æ®</strong>ï¼šé˜²æ­¢æ•°æ®ä¸¢å¤±</li></ol><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ˜¯å¦é€‚åˆ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ•°æ®é‡ &gt; å•æœºå†…å­˜</strong></td><td>âœ… é€‚åˆ</td><td>å¿…é¡»ä½¿ç”¨é›†ç¾¤</td></tr><tr><td><strong>éœ€è¦æ°´å¹³æ‰©å±•</strong></td><td>âœ… é€‚åˆ</td><td>æ”¯æŒåŠ¨æ€æ‰©å±•</td></tr><tr><td><strong>é«˜å¯ç”¨è¦æ±‚</strong></td><td>âœ… é€‚åˆ</td><td>è‡ªåŠ¨æ•…éšœè½¬ç§»</td></tr><tr><td><strong>å¤škeyæ“ä½œé¢‘ç¹</strong></td><td>âš ï¸ éœ€è¦æ³¨æ„</td><td>ä½¿ç”¨å“ˆå¸Œæ ‡ç­¾</td></tr><tr><td><strong>æ•°æ®é‡ &lt; å•æœºå†…å­˜</strong></td><td>âš ï¸ è¿‡åº¦è®¾è®¡</td><td>å“¨å…µæ¨¡å¼å³å¯</td></tr></tbody></table><hr><h2 id="12-Rediså®æˆ˜åº”ç”¨"><a href="#12-Rediså®æˆ˜åº”ç”¨" class="headerlink" title="12. Rediså®æˆ˜åº”ç”¨"></a>12. Rediså®æˆ˜åº”ç”¨</h2><h3 id="12-1-ç¼“å­˜è®¾è®¡"><a href="#12-1-ç¼“å­˜è®¾è®¡" class="headerlink" title="12.1 ç¼“å­˜è®¾è®¡"></a>12.1 ç¼“å­˜è®¾è®¡</h3><h4 id="12-1-1-ç¼“å­˜ç­–ç•¥"><a href="#12-1-1-ç¼“å­˜ç­–ç•¥" class="headerlink" title="12.1.1 ç¼“å­˜ç­–ç•¥"></a>12.1.1 ç¼“å­˜ç­–ç•¥</h4><p><strong>Cache Asideï¼ˆæ—è·¯ç¼“å­˜ï¼‰</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è¯»æ“ä½œï¼š</span><br><span class="line">1. å…ˆæŸ¥ç¼“å­˜</span><br><span class="line">2. ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›</span><br><span class="line">3. ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“</span><br><span class="line">4. å°†æ•°æ®å†™å…¥ç¼“å­˜</span><br><span class="line">5. è¿”å›æ•°æ®</span><br><span class="line"></span><br><span class="line">å†™æ“ä½œï¼š</span><br><span class="line">1. æ›´æ–°æ•°æ®åº“</span><br><span class="line">2. åˆ é™¤ç¼“å­˜ï¼ˆæˆ–æ›´æ–°ç¼“å­˜ï¼‰</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + id;</span><br><span class="line">        <span class="comment">// 1. å…ˆæŸ¥ç¼“å­˜</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) redisTemplate.opsForValue().get(key);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> user;  <span class="comment">// ç¼“å­˜å‘½ä¸­</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“</span></span><br><span class="line">        user = userMapper.selectById(id);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 3. å†™å…¥ç¼“å­˜</span></span><br><span class="line">            redisTemplate.opsForValue().set(key, user, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ›´æ–°æ•°æ®åº“</span></span><br><span class="line">        userMapper.updateById(user);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. åˆ é™¤ç¼“å­˜</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + user.getId();</span><br><span class="line">        redisTemplate.delete(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Write Throughï¼ˆå†™é€ï¼‰</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å†™æ“ä½œï¼š</span><br><span class="line">1. å…ˆæ›´æ–°ç¼“å­˜</span><br><span class="line">2. å†æ›´æ–°æ•°æ®åº“</span><br><span class="line">3. ä¸¤è€…éƒ½æˆåŠŸæ‰ç®—æˆåŠŸ</span><br></pre></td></tr></table></figure><p><strong>Write Backï¼ˆå†™å›ï¼‰</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å†™æ“ä½œï¼š</span><br><span class="line">1. åªæ›´æ–°ç¼“å­˜</span><br><span class="line">2. å¼‚æ­¥æ‰¹é‡æ›´æ–°æ•°æ®åº“</span><br><span class="line">3. é€‚åˆå†™å¤šè¯»å°‘çš„åœºæ™¯</span><br></pre></td></tr></table></figure><h4 id="12-1-2-ç¼“å­˜æ›´æ–°ç­–ç•¥"><a href="#12-1-2-ç¼“å­˜æ›´æ–°ç­–ç•¥" class="headerlink" title="12.1.2 ç¼“å­˜æ›´æ–°ç­–ç•¥"></a>12.1.2 ç¼“å­˜æ›´æ–°ç­–ç•¥</h4><p><strong>ç­–ç•¥å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>ç­–ç•¥</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>åˆ é™¤ç¼“å­˜</strong></td><td>ç®€å•ï¼Œä¿è¯ä¸€è‡´æ€§</td><td>å¯èƒ½çŸ­æš‚ä¸ä¸€è‡´</td><td>å†™å°‘è¯»å¤š</td></tr><tr><td><strong>æ›´æ–°ç¼“å­˜</strong></td><td>ä¸€è‡´æ€§æ›´å¥½</td><td>å¯èƒ½æµªè´¹èµ„æº</td><td>å†™å¤šè¯»å¤š</td></tr><tr><td><strong>å»¶è¿ŸåŒåˆ </strong></td><td>ä¸€è‡´æ€§æœ€å¥½</td><td>å®ç°å¤æ‚</td><td>å¼ºä¸€è‡´æ€§è¦æ±‚</td></tr></tbody></table><p><strong>å»¶è¿ŸåŒåˆ </strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + user.getId();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. åˆ é™¤ç¼“å­˜</span></span><br><span class="line">    redisTemplate.delete(key);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ›´æ–°æ•°æ®åº“</span></span><br><span class="line">    userMapper.updateById(user);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. å»¶è¿Ÿåˆ é™¤ï¼ˆå¼‚æ­¥ï¼‰</span></span><br><span class="line">    CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);  <span class="comment">// å»¶è¿Ÿ500ms</span></span><br><span class="line">            redisTemplate.delete(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="12-1-3-ç¼“å­˜é¢„çƒ­"><a href="#12-1-3-ç¼“å­˜é¢„çƒ­" class="headerlink" title="12.1.3 ç¼“å­˜é¢„çƒ­"></a>12.1.3 ç¼“å­˜é¢„çƒ­</h4><p><strong>ä»€ä¹ˆæ˜¯ç¼“å­˜é¢„çƒ­</strong>ï¼š</p><ul><li>ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œæå‰åŠ è½½çƒ­ç‚¹æ•°æ®åˆ°ç¼“å­˜</li><li>é¿å…é¦–æ¬¡è¯·æ±‚æ—¶ç¼“å­˜æœªå‘½ä¸­</li></ul><p><strong>å®ç°æ–¹å¼</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheWarmup</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">warmup</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// åŠ è½½çƒ­ç‚¹æ•°æ®</span></span><br><span class="line">        List&lt;User&gt; hotUsers = userMapper.selectHotUsers();</span><br><span class="line">        <span class="keyword">for</span> (User user : hotUsers) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + user.getId();</span><br><span class="line">            redisTemplate.opsForValue().set(key, user, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-2-åˆ†å¸ƒå¼é”"><a href="#12-2-åˆ†å¸ƒå¼é”" class="headerlink" title="12.2 åˆ†å¸ƒå¼é”"></a>12.2 åˆ†å¸ƒå¼é”</h3><h4 id="12-2-1-åŸºäºSETNXå®ç°"><a href="#12-2-1-åŸºäºSETNXå®ç°" class="headerlink" title="12.2.1 åŸºäºSETNXå®ç°"></a>12.2.1 åŸºäºSETNXå®ç°</h4><p><strong>åŸºæœ¬å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DistributedLock</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">tryLock</span><span class="params">(String key, String value, <span class="type">long</span> expireTime)</span> &#123;</span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> redisTemplate.opsForValue()</span><br><span class="line">            .setIfAbsent(key, value, expireTime, TimeUnit.SECONDS);</span><br><span class="line">        <span class="keyword">return</span> Boolean.TRUE.equals(result);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unlock</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨Luaè„šæœ¬ä¿è¯åŸå­æ€§</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">script</span> <span class="operator">=</span> <span class="string">&quot;if redis.call(&#x27;get&#x27;, KEYS[1]) == ARGV[1] then &quot;</span> +</span><br><span class="line">                       <span class="string">&quot;return redis.call(&#x27;del&#x27;, KEYS[1]) &quot;</span> +</span><br><span class="line">                       <span class="string">&quot;else return 0 end&quot;</span>;</span><br><span class="line">        redisTemplate.execute(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">DefaultRedisScript</span>&lt;&gt;(script, Long.class),</span><br><span class="line">            Collections.singletonList(key),</span><br><span class="line">            value</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼š</p><ul><li>âš ï¸ é”è¿‡æœŸæ—¶é—´è®¾ç½®ä¸å½“å¯èƒ½å¯¼è‡´æ­»é”</li><li>âš ï¸ éœ€è¦ä¿è¯è§£é”çš„æ˜¯åŠ é”çš„å®¢æˆ·ç«¯</li></ul><h4 id="12-2-2-Redissonå®ç°ï¼ˆæ¨èï¼‰"><a href="#12-2-2-Redissonå®ç°ï¼ˆæ¨èï¼‰" class="headerlink" title="12.2.2 Redissonå®ç°ï¼ˆæ¨èï¼‰"></a>12.2.2 Redissonå®ç°ï¼ˆæ¨èï¼‰</h4><p><strong>ä¾èµ–</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.redisson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>redisson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.24.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedissonConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedissonClient <span class="title function_">redissonClient</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Config</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Config</span>();</span><br><span class="line">        config.useSingleServer()</span><br><span class="line">            .setAddress(<span class="string">&quot;redis://127.0.0.1:6379&quot;</span>)</span><br><span class="line">            .setPassword(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Redisson.create(config);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedissonClient redissonClient;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createOrder</span><span class="params">(Long userId, Long productId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">lockKey</span> <span class="operator">=</span> <span class="string">&quot;order:lock:&quot;</span> + productId;</span><br><span class="line">        <span class="type">RLock</span> <span class="variable">lock</span> <span class="operator">=</span> redissonClient.getLock(lockKey);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å°è¯•åŠ é”ï¼Œæœ€å¤šç­‰å¾…10ç§’ï¼Œé”å®šå30ç§’è‡ªåŠ¨è§£é”</span></span><br><span class="line">            <span class="keyword">if</span> (lock.tryLock(<span class="number">10</span>, <span class="number">30</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">                <span class="comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// é‡Šæ”¾é”</span></span><br><span class="line">            <span class="keyword">if</span> (lock.isHeldByCurrentThread()) &#123;</span><br><span class="line">                lock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Redissonç‰¹æ€§</strong>ï¼š</p><ul><li>âœ… <strong>è‡ªåŠ¨ç»­æœŸ</strong>ï¼šçœ‹é—¨ç‹—æœºåˆ¶ï¼Œè‡ªåŠ¨å»¶é•¿é”è¿‡æœŸæ—¶é—´</li><li>âœ… <strong>å¯é‡å…¥é”</strong>ï¼šæ”¯æŒåŒä¸€çº¿ç¨‹å¤šæ¬¡åŠ é”</li><li>âœ… <strong>å…¬å¹³é”</strong>ï¼šæ”¯æŒå…¬å¹³é”å’Œéå…¬å¹³é”</li><li>âœ… <strong>è¯»å†™é”</strong>ï¼šæ”¯æŒè¯»å†™é”</li></ul><h3 id="12-3-å»¶æ—¶é˜Ÿåˆ—"><a href="#12-3-å»¶æ—¶é˜Ÿåˆ—" class="headerlink" title="12.3 å»¶æ—¶é˜Ÿåˆ—"></a>12.3 å»¶æ—¶é˜Ÿåˆ—</h3><h4 id="12-3-1-åŸºäºZSetå®ç°"><a href="#12-3-1-åŸºäºZSetå®ç°" class="headerlink" title="12.3.1 åŸºäºZSetå®ç°"></a>12.3.1 åŸºäºZSetå®ç°</h4><p><strong>åŸç†</strong>ï¼š</p><ul><li>ä½¿ç”¨ZSetçš„scoreå­˜å‚¨æ‰§è¡Œæ—¶é—´</li><li>å®šæ—¶æ‰«æåˆ°æœŸçš„ä»»åŠ¡</li></ul><p><strong>å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayQueueService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAY_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;delay:queue&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ å»¶æ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addTask</span><span class="params">(String taskId, String data, <span class="type">long</span> delaySeconds)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">executeTime</span> <span class="operator">=</span> System.currentTimeMillis() + delaySeconds * <span class="number">1000</span>;</span><br><span class="line">        redisTemplate.opsForZSet().add(DELAY_QUEUE, data, executeTime);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ°æœŸçš„ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getExpiredTasks</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">now</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        Set&lt;String&gt; tasks = redisTemplate.opsForZSet()</span><br><span class="line">            .rangeByScore(DELAY_QUEUE, <span class="number">0</span>, now);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (tasks != <span class="literal">null</span> &amp;&amp; !tasks.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">// åˆ é™¤å·²è·å–çš„ä»»åŠ¡</span></span><br><span class="line">            redisTemplate.opsForZSet().removeRangeByScore(DELAY_QUEUE, <span class="number">0</span>, now);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(tasks);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®šæ—¶æ‰«æä»»åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Scheduled(fixedDelay = 1000)</span>  <span class="comment">// æ¯ç§’æ‰«æä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">scanTasks</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; tasks = getExpiredTasks();</span><br><span class="line">        <span class="keyword">for</span> (String task : tasks) &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†ä»»åŠ¡</span></span><br><span class="line">            processTask(task);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processTask</span><span class="params">(String task)</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†ä»»åŠ¡é€»è¾‘</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å¤„ç†ä»»åŠ¡: &quot;</span> + task);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="12-3-2-åŸºäºListå®ç°"><a href="#12-3-2-åŸºäºListå®ç°" class="headerlink" title="12.3.2 åŸºäºListå®ç°"></a>12.3.2 åŸºäºListå®ç°</h4><p><strong>å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleDelayQueue</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAY_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;delay:queue&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ å»¶æ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addTask</span><span class="params">(String taskId, <span class="type">long</span> delaySeconds)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">executeTime</span> <span class="operator">=</span> System.currentTimeMillis() + delaySeconds * <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨Listå­˜å‚¨ï¼ŒæŒ‰æ‰§è¡Œæ—¶é—´æ’åº</span></span><br><span class="line">        redisTemplate.opsForList().leftPush(DELAY_QUEUE, </span><br><span class="line">            executeTime + <span class="string">&quot;:&quot;</span> + taskId);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ°æœŸçš„ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">pollTasks</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; tasks = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">task</span> <span class="operator">=</span> redisTemplate.opsForList().rightPop(DELAY_QUEUE, </span><br><span class="line">                <span class="number">1</span>, TimeUnit.SECONDS);</span><br><span class="line">            <span class="keyword">if</span> (task == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            String[] parts = task.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">            <span class="type">long</span> <span class="variable">executeTime</span> <span class="operator">=</span> Long.parseLong(parts[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">if</span> (executeTime &lt;= System.currentTimeMillis()) &#123;</span><br><span class="line">                tasks.add(parts[<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// æœªåˆ°æœŸï¼Œæ”¾å›é˜Ÿåˆ—</span></span><br><span class="line">                redisTemplate.opsForList().rightPush(DELAY_QUEUE, task);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tasks;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-4-æ’è¡Œæ¦œ"><a href="#12-4-æ’è¡Œæ¦œ" class="headerlink" title="12.4 æ’è¡Œæ¦œ"></a>12.4 æ’è¡Œæ¦œ</h3><h4 id="12-4-1-åŸºäºZSetå®ç°"><a href="#12-4-1-åŸºäºZSetå®ç°" class="headerlink" title="12.4.1 åŸºäºZSetå®ç°"></a>12.4.1 åŸºäºZSetå®ç°</h4><p><strong>å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LeaderboardService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LEADERBOARD</span> <span class="operator">=</span> <span class="string">&quot;leaderboard:game1&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°åˆ†æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateScore</span><span class="params">(Long userId, <span class="type">double</span> score)</span> &#123;</span><br><span class="line">        redisTemplate.opsForZSet().add(LEADERBOARD, </span><br><span class="line">            String.valueOf(userId), score);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ’è¡Œæ¦œï¼ˆTop Nï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;RankInfo&gt; <span class="title function_">getTopN</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        Set&lt;ZSetOperations.TypedTuple&lt;String&gt;&gt; tuples = </span><br><span class="line">            redisTemplate.opsForZSet().reverseRangeWithScores(LEADERBOARD, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        List&lt;RankInfo&gt; ranks = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">rank</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ZSetOperations.TypedTuple&lt;String&gt; tuple : tuples) &#123;</span><br><span class="line">            <span class="type">RankInfo</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RankInfo</span>();</span><br><span class="line">            info.setUserId(Long.parseLong(tuple.getValue()));</span><br><span class="line">            info.setScore(tuple.getScore());</span><br><span class="line">            info.setRank(rank++);</span><br><span class="line">            ranks.add(info);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ranks;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç”¨æˆ·æ’å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getUserRank</span><span class="params">(Long userId)</span> &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">rank</span> <span class="operator">=</span> redisTemplate.opsForZSet()</span><br><span class="line">            .reverseRank(LEADERBOARD, String.valueOf(userId));</span><br><span class="line">        <span class="keyword">return</span> rank != <span class="literal">null</span> ? rank + <span class="number">1</span> : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç”¨æˆ·åˆ†æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">getUserScore</span><span class="params">(Long userId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet()</span><br><span class="line">            .score(LEADERBOARD, String.valueOf(userId));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°åˆ†æ•°</span></span><br><span class="line">leaderboardService.updateScore(<span class="number">1001L</span>, <span class="number">100.5</span>);</span><br><span class="line">leaderboardService.updateScore(<span class="number">1002L</span>, <span class="number">95.0</span>);</span><br><span class="line">leaderboardService.updateScore(<span class="number">1003L</span>, <span class="number">88.5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–Top 10</span></span><br><span class="line">List&lt;RankInfo&gt; top10 = leaderboardService.getTopN(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ç”¨æˆ·æ’å</span></span><br><span class="line"><span class="type">Long</span> <span class="variable">rank</span> <span class="operator">=</span> leaderboardService.getUserRank(<span class="number">1001L</span>);</span><br></pre></td></tr></table></figure><h3 id="12-5-é™æµ"><a href="#12-5-é™æµ" class="headerlink" title="12.5 é™æµ"></a>12.5 é™æµ</h3><h4 id="12-5-1-å›ºå®šçª—å£é™æµ"><a href="#12-5-1-å›ºå®šçª—å£é™æµ" class="headerlink" title="12.5.1 å›ºå®šçª—å£é™æµ"></a>12.5.1 å›ºå®šçª—å£é™æµ</h4><p><strong>å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RateLimiter</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›ºå®šçª—å£é™æµ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é™æµkey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> limit é™åˆ¶æ¬¡æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> windowSeconds æ—¶é—´çª—å£ï¼ˆç§’ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAllowed</span><span class="params">(String key, <span class="type">int</span> limit, <span class="type">int</span> windowSeconds)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">redisKey</span> <span class="operator">=</span> <span class="string">&quot;rate:limit:&quot;</span> + key;</span><br><span class="line">        <span class="type">String</span> <span class="variable">count</span> <span class="operator">=</span> redisTemplate.opsForValue().get(redisKey);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (count == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œè®¾ç½®è®¡æ•°å’Œè¿‡æœŸæ—¶é—´</span></span><br><span class="line">            redisTemplate.opsForValue().set(redisKey, <span class="string">&quot;1&quot;</span>, </span><br><span class="line">                windowSeconds, TimeUnit.SECONDS);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> <span class="variable">currentCount</span> <span class="operator">=</span> Integer.parseInt(count);</span><br><span class="line">        <span class="keyword">if</span> (currentCount &lt; limit) &#123;</span><br><span class="line">            <span class="comment">// è®¡æ•°åŠ 1</span></span><br><span class="line">            redisTemplate.opsForValue().increment(redisKey);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// è¶…è¿‡é™åˆ¶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="12-5-2-æ»‘åŠ¨çª—å£é™æµ"><a href="#12-5-2-æ»‘åŠ¨çª—å£é™æµ" class="headerlink" title="12.5.2 æ»‘åŠ¨çª—å£é™æµ"></a>12.5.2 æ»‘åŠ¨çª—å£é™æµ</h4><p><strong>å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SlidingWindowRateLimiter</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨çª—å£é™æµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAllowed</span><span class="params">(String key, <span class="type">int</span> limit, <span class="type">int</span> windowSeconds)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">now</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">windowStart</span> <span class="operator">=</span> now - windowSeconds * <span class="number">1000</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">redisKey</span> <span class="operator">=</span> <span class="string">&quot;rate:limit:sliding:&quot;</span> + key;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨ZSetå­˜å‚¨ï¼Œscoreä¸ºæ—¶é—´æˆ³</span></span><br><span class="line">        redisTemplate.opsForZSet().removeRangeByScore(redisKey, <span class="number">0</span>, windowStart);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–å½“å‰çª—å£å†…çš„è¯·æ±‚æ•°</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> redisTemplate.opsForZSet().count(redisKey, windowStart, now);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (count != <span class="literal">null</span> &amp;&amp; count &lt; limit) &#123;</span><br><span class="line">            <span class="comment">// æ·»åŠ å½“å‰è¯·æ±‚</span></span><br><span class="line">            redisTemplate.opsForZSet().add(redisKey, </span><br><span class="line">                UUID.randomUUID().toString(), now);</span><br><span class="line">            <span class="comment">// è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line">            redisTemplate.expire(redisKey, windowSeconds + <span class="number">1</span>, TimeUnit.SECONDS);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="12-5-3-ä»¤ç‰Œæ¡¶é™æµ"><a href="#12-5-3-ä»¤ç‰Œæ¡¶é™æµ" class="headerlink" title="12.5.3 ä»¤ç‰Œæ¡¶é™æµ"></a>12.5.3 ä»¤ç‰Œæ¡¶é™æµ</h4><p><strong>å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenBucketRateLimiter</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»¤ç‰Œæ¡¶é™æµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAllowed</span><span class="params">(String key, <span class="type">int</span> capacity, <span class="type">int</span> refillRate)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">redisKey</span> <span class="operator">=</span> <span class="string">&quot;rate:limit:token:&quot;</span> + key;</span><br><span class="line">        <span class="type">long</span> <span class="variable">now</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨Luaè„šæœ¬ä¿è¯åŸå­æ€§</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">script</span> <span class="operator">=</span> </span><br><span class="line">            <span class="string">&quot;local key = KEYS[1] &quot;</span> +</span><br><span class="line">            <span class="string">&quot;local capacity = tonumber(ARGV[1]) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;local refillRate = tonumber(ARGV[2]) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;local now = tonumber(ARGV[3]) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;local tokens = redis.call(&#x27;get&#x27;, key) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;if tokens == false then &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  tokens = capacity &quot;</span> +</span><br><span class="line">            <span class="string">&quot;else &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  local lastRefill = tonumber(redis.call(&#x27;get&#x27;, key .. &#x27;:time&#x27;)) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  if lastRefill then &quot;</span> +</span><br><span class="line">            <span class="string">&quot;    local elapsed = now - lastRefill &quot;</span> +</span><br><span class="line">            <span class="string">&quot;    local newTokens = math.min(capacity, tokens + elapsed * refillRate / 1000) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;    tokens = newTokens &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  end &quot;</span> +</span><br><span class="line">            <span class="string">&quot;end &quot;</span> +</span><br><span class="line">            <span class="string">&quot;if tokens &gt;= 1 then &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  tokens = tokens - 1 &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  redis.call(&#x27;set&#x27;, key, tokens) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  redis.call(&#x27;set&#x27;, key .. &#x27;:time&#x27;, now) &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  return 1 &quot;</span> +</span><br><span class="line">            <span class="string">&quot;else &quot;</span> +</span><br><span class="line">            <span class="string">&quot;  return 0 &quot;</span> +</span><br><span class="line">            <span class="string">&quot;end&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        DefaultRedisScript&lt;Long&gt; redisScript = <span class="keyword">new</span> <span class="title class_">DefaultRedisScript</span>&lt;&gt;();</span><br><span class="line">        redisScript.setScriptText(script);</span><br><span class="line">        redisScript.setResultType(Long.class);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Long</span> <span class="variable">result</span> <span class="operator">=</span> redisTemplate.execute(redisScript, </span><br><span class="line">            Collections.singletonList(redisKey),</span><br><span class="line">            String.valueOf(capacity),</span><br><span class="line">            String.valueOf(refillRate),</span><br><span class="line">            String.valueOf(now));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result != <span class="literal">null</span> &amp;&amp; result == <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="13-Redisæ€§èƒ½ä¼˜åŒ–"><a href="#13-Redisæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="13. Redisæ€§èƒ½ä¼˜åŒ–"></a>13. Redisæ€§èƒ½ä¼˜åŒ–</h2><h3 id="13-1-å†…å­˜ä¼˜åŒ–"><a href="#13-1-å†…å­˜ä¼˜åŒ–" class="headerlink" title="13.1 å†…å­˜ä¼˜åŒ–"></a>13.1 å†…å­˜ä¼˜åŒ–</h3><h4 id="13-1-1-æ•°æ®ç»“æ„é€‰æ‹©"><a href="#13-1-1-æ•°æ®ç»“æ„é€‰æ‹©" class="headerlink" title="13.1.1 æ•°æ®ç»“æ„é€‰æ‹©"></a>13.1.1 æ•°æ®ç»“æ„é€‰æ‹©</h4><p><strong>é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„</strong>ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ•°æ®ç»“æ„</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>ç®€å•é”®å€¼å¯¹</strong></td><td>String</td><td>æœ€ç®€å•ï¼Œæ€§èƒ½æœ€å¥½</td></tr><tr><td><strong>å¯¹è±¡å­˜å‚¨</strong></td><td>Hash</td><td>å¯ä»¥éƒ¨åˆ†æ›´æ–°ï¼ŒèŠ‚çœå†…å­˜</td></tr><tr><td><strong>åˆ—è¡¨æ“ä½œ</strong></td><td>List</td><td>æ”¯æŒé˜Ÿåˆ—ã€æ ˆæ“ä½œ</td></tr><tr><td><strong>å»é‡é›†åˆ</strong></td><td>Set</td><td>è‡ªåŠ¨å»é‡</td></tr><tr><td><strong>æœ‰åºé›†åˆ</strong></td><td>ZSet</td><td>æ”¯æŒæ’åºå’ŒèŒƒå›´æŸ¥è¯¢</td></tr><tr><td><strong>ä½æ“ä½œ</strong></td><td>Bitmap</td><td>èŠ‚çœå†…å­˜ï¼Œé€‚åˆå¸ƒå°”å€¼</td></tr></tbody></table><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸æ¨èï¼šä½¿ç”¨Stringå­˜å‚¨å¯¹è±¡</span></span><br><span class="line">redisTemplate.opsForValue().set(<span class="string">&quot;user:1001&quot;</span>, JSON.toJSONString(user));</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šä½¿ç”¨Hashå­˜å‚¨å¯¹è±¡</span></span><br><span class="line">redisTemplate.opsForHash().putAll(<span class="string">&quot;user:1001&quot;</span>, userToMap(user));</span><br></pre></td></tr></table></figure><h4 id="13-1-2-é”®åä¼˜åŒ–"><a href="#13-1-2-é”®åä¼˜åŒ–" class="headerlink" title="13.1.2 é”®åä¼˜åŒ–"></a>13.1.2 é”®åä¼˜åŒ–</h4><p><strong>ä¼˜åŒ–åŸåˆ™</strong>ï¼š</p><ul><li>âœ… ä½¿ç”¨ç®€çŸ­ä½†æœ‰æ„ä¹‰çš„é”®å</li><li>âœ… é¿å…è¿‡é•¿çš„é”®å</li><li>âœ… ä½¿ç”¨ç»Ÿä¸€çš„å‘½åè§„èŒƒ</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸æ¨èï¼šé”®åè¿‡é•¿</span></span><br><span class="line"><span class="string">&quot;user:profile:information:detail:1001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šç®€çŸ­é”®å</span></span><br><span class="line"><span class="string">&quot;u:1001&quot;</span> æˆ– <span class="string">&quot;user:1001&quot;</span></span><br></pre></td></tr></table></figure><h4 id="13-1-3-è¿‡æœŸæ—¶é—´è®¾ç½®"><a href="#13-1-3-è¿‡æœŸæ—¶é—´è®¾ç½®" class="headerlink" title="13.1.3 è¿‡æœŸæ—¶é—´è®¾ç½®"></a>13.1.3 è¿‡æœŸæ—¶é—´è®¾ç½®</h4><p><strong>åˆç†è®¾ç½®è¿‡æœŸæ—¶é—´</strong>ï¼š</p><ul><li>âœ… é¿å…æ•°æ®æ— é™å¢é•¿</li><li>âœ… æ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆé€‚çš„è¿‡æœŸæ—¶é—´</li><li>âœ… ä½¿ç”¨éšæœºè¿‡æœŸæ—¶é—´é¿å…ç¼“å­˜é›ªå´©</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆå¸¦éšæœºå€¼ï¼Œé¿å…åŒæ—¶è¿‡æœŸï¼‰</span></span><br><span class="line"><span class="type">int</span> <span class="variable">baseExpire</span> <span class="operator">=</span> <span class="number">3600</span>;  <span class="comment">// åŸºç¡€è¿‡æœŸæ—¶é—´1å°æ—¶</span></span><br><span class="line"><span class="type">int</span> <span class="variable">randomExpire</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">600</span>);  <span class="comment">// éšæœº0-10åˆ†é’Ÿ</span></span><br><span class="line">redisTemplate.expire(key, baseExpire + randomExpire, TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure><h4 id="13-1-4-å†…å­˜æ·˜æ±°ç­–ç•¥"><a href="#13-1-4-å†…å­˜æ·˜æ±°ç­–ç•¥" class="headerlink" title="13.1.4 å†…å­˜æ·˜æ±°ç­–ç•¥"></a>13.1.4 å†…å­˜æ·˜æ±°ç­–ç•¥</h4><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line">maxmemory 2gb</span><br><span class="line">maxmemory-policy allkeys-lru</span><br></pre></td></tr></table></figure><p><strong>ç­–ç•¥é€‰æ‹©</strong>ï¼š</p><table><thead><tr><th>ç­–ç•¥</th><th>è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>noeviction</strong></td><td>ä¸æ·˜æ±°ï¼Œè¿”å›é”™è¯¯</td><td>æ•°æ®ä¸èƒ½ä¸¢å¤±</td></tr><tr><td><strong>allkeys-lru</strong></td><td>æ‰€æœ‰keyçš„LRUæ·˜æ±°</td><td>é€šç”¨åœºæ™¯</td></tr><tr><td><strong>allkeys-lfu</strong></td><td>æ‰€æœ‰keyçš„LFUæ·˜æ±°</td><td>çƒ­ç‚¹æ•°æ®åœºæ™¯</td></tr><tr><td><strong>volatile-lru</strong></td><td>è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyçš„LRUæ·˜æ±°</td><td>ç¼“å­˜åœºæ™¯</td></tr><tr><td><strong>volatile-lfu</strong></td><td>è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyçš„LFUæ·˜æ±°</td><td>ç¼“å­˜åœºæ™¯</td></tr><tr><td><strong>allkeys-random</strong></td><td>éšæœºæ·˜æ±°</td><td>æ— ç‰¹æ®Šè¦æ±‚</td></tr><tr><td><strong>volatile-random</strong></td><td>éšæœºæ·˜æ±°è¿‡æœŸkey</td><td>ç¼“å­˜åœºæ™¯</td></tr><tr><td><strong>volatile-ttl</strong></td><td>æ·˜æ±°å³å°†è¿‡æœŸçš„key</td><td>ç¼“å­˜åœºæ™¯</td></tr></tbody></table><h3 id="13-2-å‘½ä»¤ä¼˜åŒ–"><a href="#13-2-å‘½ä»¤ä¼˜åŒ–" class="headerlink" title="13.2 å‘½ä»¤ä¼˜åŒ–"></a>13.2 å‘½ä»¤ä¼˜åŒ–</h3><h4 id="13-2-1-æ‰¹é‡æ“ä½œ"><a href="#13-2-1-æ‰¹é‡æ“ä½œ" class="headerlink" title="13.2.1 æ‰¹é‡æ“ä½œ"></a>13.2.1 æ‰¹é‡æ“ä½œ</h4><p><strong>ä½¿ç”¨Pipeline</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸æ¨èï¼šå¾ªç¯æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    redisTemplate.opsForValue().set(<span class="string">&quot;key:&quot;</span> + i, <span class="string">&quot;value:&quot;</span> + i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šä½¿ç”¨Pipelineæ‰¹é‡æ‰§è¡Œ</span></span><br><span class="line">List&lt;Object&gt; results = redisTemplate.executePipelined(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">RedisCallback</span>&lt;Object&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">doInRedis</span><span class="params">(RedisConnection connection)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">                connection.set((<span class="string">&quot;key:&quot;</span> + i).getBytes(), </span><br><span class="line">                    (<span class="string">&quot;value:&quot;</span> + i).getBytes());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æ‰¹é‡å‘½ä»¤</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸æ¨èï¼šå¾ªç¯æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">    redisTemplate.delete(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šæ‰¹é‡åˆ é™¤</span></span><br><span class="line">redisTemplate.delete(keys);</span><br></pre></td></tr></table></figure><h4 id="13-2-2-é¿å…å¤§key"><a href="#13-2-2-é¿å…å¤§key" class="headerlink" title="13.2.2 é¿å…å¤§key"></a>13.2.2 é¿å…å¤§key</h4><p><strong>å¤§keyé—®é¢˜</strong>ï¼š</p><ul><li>âš ï¸ å ç”¨å†…å­˜å¤§</li><li>âš ï¸ ç½‘ç»œä¼ è¾“æ…¢</li><li>âš ï¸ é˜»å¡å…¶ä»–æ“ä½œ</li></ul><p><strong>ä¼˜åŒ–æ–¹æ³•</strong>ï¼š</p><ul><li>âœ… æ‹†åˆ†å¤§keyä¸ºå¤šä¸ªå°key</li><li>âœ… ä½¿ç”¨Hashå­˜å‚¨å¤§å¯¹è±¡</li><li>âœ… å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸æ¨èï¼šå¤§key</span></span><br><span class="line">redisTemplate.opsForList().rightPushAll(<span class="string">&quot;big:list&quot;</span>, hugeList);</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šæ‹†åˆ†ä¸ºå¤šä¸ªå°key</span></span><br><span class="line"><span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hugeList.size(); i += batchSize) &#123;</span><br><span class="line">    List&lt;String&gt; batch = hugeList.subList(i, </span><br><span class="line">        Math.min(i + batchSize, hugeList.size()));</span><br><span class="line">    redisTemplate.opsForList().rightPushAll(<span class="string">&quot;list:&quot;</span> + (i / batchSize), batch);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="13-2-3-ä½¿ç”¨Luaè„šæœ¬"><a href="#13-2-3-ä½¿ç”¨Luaè„šæœ¬" class="headerlink" title="13.2.3 ä½¿ç”¨Luaè„šæœ¬"></a>13.2.3 ä½¿ç”¨Luaè„šæœ¬</h4><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… åŸå­æ€§æ‰§è¡Œ</li><li>âœ… å‡å°‘ç½‘ç»œå¾€è¿”</li><li>âœ… æé«˜æ€§èƒ½</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸå­æ€§å¢åŠ å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="type">String</span> <span class="variable">script</span> <span class="operator">=</span> </span><br><span class="line">    <span class="string">&quot;local count = redis.call(&#x27;incr&#x27;, KEYS[1]) &quot;</span> +</span><br><span class="line">    <span class="string">&quot;if count == 1 then &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  redis.call(&#x27;expire&#x27;, KEYS[1], ARGV[1]) &quot;</span> +</span><br><span class="line">    <span class="string">&quot;end &quot;</span> +</span><br><span class="line">    <span class="string">&quot;return count&quot;</span>;</span><br><span class="line"></span><br><span class="line">DefaultRedisScript&lt;Long&gt; redisScript = <span class="keyword">new</span> <span class="title class_">DefaultRedisScript</span>&lt;&gt;();</span><br><span class="line">redisScript.setScriptText(script);</span><br><span class="line">redisScript.setResultType(Long.class);</span><br><span class="line"></span><br><span class="line"><span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> redisTemplate.execute(redisScript, </span><br><span class="line">    Collections.singletonList(<span class="string">&quot;counter:key&quot;</span>),</span><br><span class="line">    <span class="string">&quot;60&quot;</span>);  <span class="comment">// è¿‡æœŸæ—¶é—´60ç§’</span></span><br></pre></td></tr></table></figure><h3 id="13-3-ç½‘ç»œä¼˜åŒ–"><a href="#13-3-ç½‘ç»œä¼˜åŒ–" class="headerlink" title="13.3 ç½‘ç»œä¼˜åŒ–"></a>13.3 ç½‘ç»œä¼˜åŒ–</h3><h4 id="13-3-1-è¿æ¥æ± é…ç½®"><a href="#13-3-1-è¿æ¥æ± é…ç½®" class="headerlink" title="13.3.1 è¿æ¥æ± é…ç½®"></a>13.3.1 è¿æ¥æ± é…ç½®</h4><p><strong>Jedisè¿æ¥æ± </strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> JedisConnectionFactory <span class="title function_">jedisConnectionFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">JedisPoolConfig</span> <span class="variable">poolConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">        poolConfig.setMaxTotal(<span class="number">20</span>);      <span class="comment">// æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">        poolConfig.setMaxIdle(<span class="number">10</span>);       <span class="comment">// æœ€å¤§ç©ºé—²è¿æ¥</span></span><br><span class="line">        poolConfig.setMinIdle(<span class="number">5</span>);        <span class="comment">// æœ€å°ç©ºé—²è¿æ¥</span></span><br><span class="line">        poolConfig.setTestOnBorrow(<span class="literal">true</span>); <span class="comment">// å€Ÿç”¨è¿æ¥æ—¶æµ‹è¯•</span></span><br><span class="line">        poolConfig.setTestOnReturn(<span class="literal">true</span>); <span class="comment">// å½’è¿˜è¿æ¥æ—¶æµ‹è¯•</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">JedisConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisConnectionFactory</span>(poolConfig);</span><br><span class="line">        factory.setHostName(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">        factory.setPort(<span class="number">6379</span>);</span><br><span class="line">        factory.setPassword(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="13-3-2-å‡å°‘ç½‘ç»œå¾€è¿”"><a href="#13-3-2-å‡å°‘ç½‘ç»œå¾€è¿”" class="headerlink" title="13.3.2 å‡å°‘ç½‘ç»œå¾€è¿”"></a>13.3.2 å‡å°‘ç½‘ç»œå¾€è¿”</h4><p><strong>ä½¿ç”¨æ‰¹é‡æ“ä½œ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸æ¨èï¼šå¤šæ¬¡ç½‘ç»œå¾€è¿”</span></span><br><span class="line"><span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> redisTemplate.opsForValue().get(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ¨èï¼šæ‰¹é‡è·å–</span></span><br><span class="line">List&lt;Object&gt; values = redisTemplate.opsForValue().multiGet(keys);</span><br></pre></td></tr></table></figure><h3 id="13-4-æ…¢æŸ¥è¯¢åˆ†æ"><a href="#13-4-æ…¢æŸ¥è¯¢åˆ†æ" class="headerlink" title="13.4 æ…¢æŸ¥è¯¢åˆ†æ"></a>13.4 æ…¢æŸ¥è¯¢åˆ†æ</h3><h4 id="13-4-1-æ…¢æŸ¥è¯¢é…ç½®"><a href="#13-4-1-æ…¢æŸ¥è¯¢é…ç½®" class="headerlink" title="13.4.1 æ…¢æŸ¥è¯¢é…ç½®"></a>13.4.1 æ…¢æŸ¥è¯¢é…ç½®</h4><p><strong>é…ç½®</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis.conf</span></span><br><span class="line"><span class="comment"># æ…¢æŸ¥è¯¢æ—¥å¿—é˜ˆå€¼ï¼ˆå¾®ç§’ï¼‰</span></span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ…¢æŸ¥è¯¢æ—¥å¿—æœ€å¤§é•¿åº¦</span></span><br><span class="line">slowlog-max-len 128</span><br></pre></td></tr></table></figure><h4 id="13-4-2-æŸ¥çœ‹æ…¢æŸ¥è¯¢"><a href="#13-4-2-æŸ¥çœ‹æ…¢æŸ¥è¯¢" class="headerlink" title="13.4.2 æŸ¥çœ‹æ…¢æŸ¥è¯¢"></a>13.4.2 æŸ¥çœ‹æ…¢æŸ¥è¯¢</h4><p><strong>å‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">127.0.0.1:6379&gt; SLOWLOG GET 10</span><br><span class="line">1) 1) (<span class="built_in">integer</span>) 1              <span class="comment"># æ—¥å¿—ID</span></span><br><span class="line">   2) (<span class="built_in">integer</span>) 1699123456      <span class="comment"># æ—¶é—´æˆ³</span></span><br><span class="line">   3) (<span class="built_in">integer</span>) 15000           <span class="comment"># æ‰§è¡Œæ—¶é—´ï¼ˆå¾®ç§’ï¼‰</span></span><br><span class="line">   4) 1) <span class="string">&quot;KEYS&quot;</span>                  <span class="comment"># å‘½ä»¤</span></span><br><span class="line">      2) <span class="string">&quot;*&quot;</span></span><br><span class="line">   5) <span class="string">&quot;127.0.0.1:12345&quot;</span>          <span class="comment"># å®¢æˆ·ç«¯åœ°å€</span></span><br><span class="line">   6) <span class="string">&quot;&quot;</span>                         <span class="comment"># å®¢æˆ·ç«¯åç§°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ…¢æŸ¥è¯¢æ—¥å¿—æ•°é‡</span></span><br><span class="line">127.0.0.1:6379&gt; SLOWLOG LEN</span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç©ºæ…¢æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">127.0.0.1:6379&gt; SLOWLOG RESET</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><h4 id="13-4-3-æ€§èƒ½ç›‘æ§"><a href="#13-4-3-æ€§èƒ½ç›‘æ§" class="headerlink" title="13.4.3 æ€§èƒ½ç›‘æ§"></a>13.4.3 æ€§èƒ½ç›‘æ§</h4><p><strong>ç›‘æ§æŒ‡æ ‡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ€§èƒ½ç»Ÿè®¡</span></span><br><span class="line">127.0.0.1:6379&gt; INFO stats</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å‘½ä»¤ç»Ÿè®¡</span></span><br><span class="line">127.0.0.1:6379&gt; INFO commandstats</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å†…å­˜ä½¿ç”¨</span></span><br><span class="line">127.0.0.1:6379&gt; INFO memory</span><br></pre></td></tr></table></figure><hr><h2 id="14-Rediså¸¸è§é—®é¢˜"><a href="#14-Rediså¸¸è§é—®é¢˜" class="headerlink" title="14. Rediså¸¸è§é—®é¢˜"></a>14. Rediså¸¸è§é—®é¢˜</h2><h3 id="14-1-ç¼“å­˜ç©¿é€"><a href="#14-1-ç¼“å­˜ç©¿é€" class="headerlink" title="14.1 ç¼“å­˜ç©¿é€"></a>14.1 ç¼“å­˜ç©¿é€</h3><h4 id="14-1-1-é—®é¢˜æè¿°"><a href="#14-1-1-é—®é¢˜æè¿°" class="headerlink" title="14.1.1 é—®é¢˜æè¿°"></a>14.1.1 é—®é¢˜æè¿°</h4><p><strong>ç¼“å­˜ç©¿é€</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šæŸ¥è¯¢ä¸€ä¸ª<strong>ä¸å­˜åœ¨çš„æ•°æ®</strong>ï¼Œç¼“å­˜å’Œæ•°æ®åº“éƒ½æ²¡æœ‰</li><li><strong>é—®é¢˜</strong>ï¼šæ¯æ¬¡è¯·æ±‚éƒ½æ‰“åˆ°æ•°æ®åº“ï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å¤§</li><li><strong>åœºæ™¯</strong>ï¼šæ¶æ„è¯·æ±‚ã€æ— æ•ˆçš„key</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è¯·æ±‚ï¼šGET /user/999999  (ç”¨æˆ·ä¸å­˜åœ¨)</span><br><span class="line">  â†“</span><br><span class="line">æŸ¥ç¼“å­˜ï¼šæœªå‘½ä¸­</span><br><span class="line">  â†“</span><br><span class="line">æŸ¥æ•°æ®åº“ï¼šæœªæ‰¾åˆ°</span><br><span class="line">  â†“</span><br><span class="line">è¿”å›ç©ºç»“æœï¼ˆä¸ç¼“å­˜ï¼‰</span><br><span class="line">  â†“</span><br><span class="line">ä¸‹æ¬¡è¯·æ±‚ç»§ç»­æŸ¥æ•°æ®åº“ âŒ</span><br></pre></td></tr></table></figure><h4 id="14-1-2-è§£å†³æ–¹æ¡ˆ"><a href="#14-1-2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="14.1.2 è§£å†³æ–¹æ¡ˆ"></a>14.1.2 è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šç¼“å­˜ç©ºå€¼</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + id;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) redisTemplate.opsForValue().get(key);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯ç©ºå€¼æ ‡è®°ï¼Œè¿”å›null</span></span><br><span class="line">        <span class="keyword">if</span> (user.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æŸ¥æ•°æ®åº“</span></span><br><span class="line">    user = userMapper.selectById(id);</span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(key, user, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ç¼“å­˜ç©ºå€¼ï¼Œè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">emptyUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        redisTemplate.opsForValue().set(key, emptyUser, <span class="number">5</span>, TimeUnit.MINUTES);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šå¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BLOOM_FILTER</span> <span class="operator">=</span> <span class="string">&quot;bloom:user&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–å¸ƒéš†è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initBloomFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// åŠ è½½æ‰€æœ‰ç”¨æˆ·IDåˆ°å¸ƒéš†è¿‡æ»¤å™¨</span></span><br><span class="line">        List&lt;Long&gt; userIds = userMapper.selectAllIds();</span><br><span class="line">        <span class="keyword">for</span> (Long id : userIds) &#123;</span><br><span class="line">            addToBloomFilter(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ åˆ°å¸ƒéš†è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addToBloomFilter</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨å¤šä¸ªhashå‡½æ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">hash</span> <span class="operator">=</span> (id.hashCode() + i * <span class="number">31</span>) % <span class="number">1000000</span>;</span><br><span class="line">            redisTemplate.opsForValue().setBit(BLOOM_FILTER, hash, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">mightExist</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">hash</span> <span class="operator">=</span> (id.hashCode() + i * <span class="number">31</span>) % <span class="number">1000000</span>;</span><br><span class="line">            <span class="keyword">if</span> (!redisTemplate.opsForValue().getBit(BLOOM_FILTER, hash)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// è‚¯å®šä¸å­˜åœ¨</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// å¯èƒ½å­˜åœ¨</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="comment">// å…ˆæ£€æŸ¥å¸ƒéš†è¿‡æ»¤å™¨</span></span><br><span class="line">        <span class="keyword">if</span> (!mightExist(id)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// è‚¯å®šä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¯èƒ½å­˜åœ¨ï¼Œç»§ç»­æŸ¥è¯¢</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + id;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) redisTemplate.opsForValue().get(key);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> user;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        user = userMapper.selectById(id);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            redisTemplate.opsForValue().set(key, user, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="14-2-ç¼“å­˜å‡»ç©¿"><a href="#14-2-ç¼“å­˜å‡»ç©¿" class="headerlink" title="14.2 ç¼“å­˜å‡»ç©¿"></a>14.2 ç¼“å­˜å‡»ç©¿</h3><h4 id="14-2-1-é—®é¢˜æè¿°"><a href="#14-2-1-é—®é¢˜æè¿°" class="headerlink" title="14.2.1 é—®é¢˜æè¿°"></a>14.2.1 é—®é¢˜æè¿°</h4><p><strong>ç¼“å­˜å‡»ç©¿</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šæŸä¸ª<strong>çƒ­ç‚¹keyè¿‡æœŸ</strong>ï¼Œå¤§é‡è¯·æ±‚åŒæ—¶è®¿é—®æ•°æ®åº“</li><li><strong>é—®é¢˜</strong>ï¼šæ•°æ®åº“å‹åŠ›ç¬é—´å¢å¤§</li><li><strong>åœºæ™¯</strong>ï¼šçƒ­ç‚¹æ•°æ®è¿‡æœŸ</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">çƒ­ç‚¹keyè¿‡æœŸ</span><br><span class="line">  â†“</span><br><span class="line">å¤§é‡è¯·æ±‚åŒæ—¶åˆ°è¾¾</span><br><span class="line">  â†“</span><br><span class="line">ç¼“å­˜æœªå‘½ä¸­</span><br><span class="line">  â†“</span><br><span class="line">æ‰€æœ‰è¯·æ±‚éƒ½æŸ¥æ•°æ®åº“ âŒ</span><br></pre></td></tr></table></figure><h4 id="14-2-2-è§£å†³æ–¹æ¡ˆ"><a href="#14-2-2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="14.2.2 è§£å†³æ–¹æ¡ˆ"></a>14.2.2 è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šäº’æ–¥é”</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + id;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) redisTemplate.opsForValue().get(key);</span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨åˆ†å¸ƒå¼é”</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">lockKey</span> <span class="operator">=</span> <span class="string">&quot;lock:user:&quot;</span> + id;</span><br><span class="line">    <span class="type">RLock</span> <span class="variable">lock</span> <span class="operator">=</span> redissonClient.getLock(lockKey);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (lock.tryLock(<span class="number">10</span>, <span class="number">30</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">            <span class="comment">// åŒé‡æ£€æŸ¥</span></span><br><span class="line">            user = (User) redisTemplate.opsForValue().get(key);</span><br><span class="line">            <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> user;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æŸ¥æ•°æ®åº“</span></span><br><span class="line">            user = userMapper.selectById(id);</span><br><span class="line">            <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">                redisTemplate.opsForValue().set(key, user, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// è·å–é”å¤±è´¥ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•</span></span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">return</span> getUser(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (lock.isHeldByCurrentThread()) &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šæ°¸ä¸è¿‡æœŸ + å¼‚æ­¥æ›´æ–°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + id;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) redisTemplate.opsForValue().get(key);</span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¼‚æ­¥æ›´æ–°ç¼“å­˜</span></span><br><span class="line">        CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">latestUser</span> <span class="operator">=</span> userMapper.selectById(id);</span><br><span class="line">            <span class="keyword">if</span> (latestUser != <span class="literal">null</span>) &#123;</span><br><span class="line">                redisTemplate.opsForValue().set(key, latestUser);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“</span></span><br><span class="line">    user = userMapper.selectById(id);</span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(key, user);  <span class="comment">// æ°¸ä¸è¿‡æœŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="14-3-ç¼“å­˜é›ªå´©"><a href="#14-3-ç¼“å­˜é›ªå´©" class="headerlink" title="14.3 ç¼“å­˜é›ªå´©"></a>14.3 ç¼“å­˜é›ªå´©</h3><h4 id="14-3-1-é—®é¢˜æè¿°"><a href="#14-3-1-é—®é¢˜æè¿°" class="headerlink" title="14.3.1 é—®é¢˜æè¿°"></a>14.3.1 é—®é¢˜æè¿°</h4><p><strong>ç¼“å­˜é›ªå´©</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šå¤§é‡ç¼“å­˜<strong>åŒæ—¶è¿‡æœŸ</strong>ï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚æ‰“åˆ°æ•°æ®åº“</li><li><strong>é—®é¢˜</strong>ï¼šæ•°æ®åº“å‹åŠ›ç¬é—´å¢å¤§ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®åº“å´©æºƒ</li><li><strong>åœºæ™¯</strong>ï¼šç¼“å­˜æ‰¹é‡è¿‡æœŸã€Rediså®•æœº</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¤§é‡ç¼“å­˜åŒæ—¶è¿‡æœŸ</span><br><span class="line">  â†“</span><br><span class="line">å¤§é‡è¯·æ±‚åŒæ—¶åˆ°è¾¾</span><br><span class="line">  â†“</span><br><span class="line">ç¼“å­˜æœªå‘½ä¸­</span><br><span class="line">  â†“</span><br><span class="line">æ‰€æœ‰è¯·æ±‚éƒ½æŸ¥æ•°æ®åº“</span><br><span class="line">  â†“</span><br><span class="line">æ•°æ®åº“å‹åŠ›è¿‡å¤§ï¼Œå¯èƒ½å´©æºƒ âŒ</span><br></pre></td></tr></table></figure><h4 id="14-3-2-è§£å†³æ–¹æ¡ˆ"><a href="#14-3-2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="14.3.2 è§£å†³æ–¹æ¡ˆ"></a>14.3.2 è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šéšæœºè¿‡æœŸæ—¶é—´</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCache</span><span class="params">(String key, Object value, <span class="type">int</span> baseExpireSeconds)</span> &#123;</span><br><span class="line">    <span class="comment">// åŸºç¡€è¿‡æœŸæ—¶é—´ + éšæœºæ—¶é—´ï¼ˆ0-600ç§’ï¼‰</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">randomExpire</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">600</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">expireSeconds</span> <span class="operator">=</span> baseExpireSeconds + randomExpire;</span><br><span class="line">    redisTemplate.opsForValue().set(key, value, expireSeconds, TimeUnit.SECONDS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šå¤šçº§ç¼“å­˜</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MultiLevelCache</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Cache&lt;String, Object&gt; localCache = </span><br><span class="line">        Caffeine.newBuilder()</span><br><span class="line">            .maximumSize(<span class="number">10000</span>)</span><br><span class="line">            .expireAfterWrite(<span class="number">5</span>, TimeUnit.MINUTES)</span><br><span class="line">            .build();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. å…ˆæŸ¥æœ¬åœ°ç¼“å­˜</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> localCache.getIfPresent(key);</span><br><span class="line">        <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æŸ¥Redis</span></span><br><span class="line">        value = redisTemplate.opsForValue().get(key);</span><br><span class="line">        <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line">            localCache.put(key, value);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. æŸ¥æ•°æ®åº“</span></span><br><span class="line">        value = loadFromDatabase(key);</span><br><span class="line">        <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line">            redisTemplate.opsForValue().set(key, value, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">            localCache.put(key, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ3ï¼šç†”æ–­é™çº§</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CircuitBreakerCache</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="type">boolean</span> <span class="variable">circuitOpen</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="variable">lastFailureTime</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">CIRCUIT_TIMEOUT</span> <span class="operator">=</span> <span class="number">60000</span>;  <span class="comment">// 1åˆ†é’Ÿ</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="comment">// ç†”æ–­å™¨æ‰“å¼€ï¼Œç›´æ¥è¿”å›é»˜è®¤å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (circuitOpen) &#123;</span><br><span class="line">            <span class="keyword">if</span> (System.currentTimeMillis() - lastFailureTime &gt; CIRCUIT_TIMEOUT) &#123;</span><br><span class="line">                circuitOpen = <span class="literal">false</span>;  <span class="comment">// å°è¯•æ¢å¤</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> getDefaultValue(key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> redisTemplate.opsForValue().get(key);</span><br><span class="line">            <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line">                circuitOpen = <span class="literal">false</span>;  <span class="comment">// æ¢å¤æ­£å¸¸</span></span><br><span class="line">                <span class="keyword">return</span> value;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æŸ¥æ•°æ®åº“</span></span><br><span class="line">            value = loadFromDatabase(key);</span><br><span class="line">            <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line">                redisTemplate.opsForValue().set(key, value, <span class="number">1</span>, TimeUnit.HOURS);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// å‘ç”Ÿå¼‚å¸¸ï¼Œæ‰“å¼€ç†”æ–­å™¨</span></span><br><span class="line">            circuitOpen = <span class="literal">true</span>;</span><br><span class="line">            lastFailureTime = System.currentTimeMillis();</span><br><span class="line">            <span class="keyword">return</span> getDefaultValue(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="14-4-æ•°æ®ä¸€è‡´æ€§"><a href="#14-4-æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="14.4 æ•°æ®ä¸€è‡´æ€§"></a>14.4 æ•°æ®ä¸€è‡´æ€§</h3><h4 id="14-4-1-é—®é¢˜æè¿°"><a href="#14-4-1-é—®é¢˜æè¿°" class="headerlink" title="14.4.1 é—®é¢˜æè¿°"></a>14.4.1 é—®é¢˜æè¿°</h4><p><strong>æ•°æ®ä¸€è‡´æ€§</strong>ï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´</li><li><strong>åŸå› </strong>ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸å½“ã€å¹¶å‘æ›´æ–°</li></ul><h4 id="14-4-2-è§£å†³æ–¹æ¡ˆ"><a href="#14-4-2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="14.4.2 è§£å†³æ–¹æ¡ˆ"></a>14.4.2 è§£å†³æ–¹æ¡ˆ</h4><p><strong>æ–¹æ¡ˆ1ï¼šå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. æ›´æ–°æ•°æ®åº“</span></span><br><span class="line">    userMapper.updateById(user);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. åˆ é™¤ç¼“å­˜</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + user.getId();</span><br><span class="line">    redisTemplate.delete(key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ2ï¼šå»¶è¿ŸåŒåˆ </strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;user:&quot;</span> + user.getId();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. åˆ é™¤ç¼“å­˜</span></span><br><span class="line">    redisTemplate.delete(key);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ›´æ–°æ•°æ®åº“</span></span><br><span class="line">    userMapper.updateById(user);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. å»¶è¿Ÿåˆ é™¤ï¼ˆå¼‚æ­¥ï¼‰</span></span><br><span class="line">    CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);  <span class="comment">// å»¶è¿Ÿ500ms</span></span><br><span class="line">            redisTemplate.delete(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ3ï¼šåŸºäºæ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheUpdateService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ›´æ–°æ•°æ®åº“</span></span><br><span class="line">        userMapper.updateById(user);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">CacheUpdateMessage</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CacheUpdateMessage</span>();</span><br><span class="line">        message.setType(<span class="string">&quot;DELETE&quot;</span>);</span><br><span class="line">        message.setKey(<span class="string">&quot;user:&quot;</span> + user.getId());</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;cache.update&quot;</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;cache.update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleCacheUpdate</span><span class="params">(CacheUpdateMessage message)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;DELETE&quot;</span>.equals(message.getType())) &#123;</span><br><span class="line">            redisTemplate.delete(message.getKey());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆ4ï¼šä½¿ç”¨Canalç›‘å¬binlog</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨Canalç›‘å¬MySQL binlogï¼Œè‡ªåŠ¨æ›´æ–°ç¼“å­˜</span></span><br><span class="line"><span class="comment">// è¿™æ ·å¯ä»¥ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“çš„ä¸€è‡´æ€§</span></span><br></pre></td></tr></table></figure><hr><h2 id="15-å­¦ä¹ èµ„æºæ¨è"><a href="#15-å­¦ä¹ èµ„æºæ¨è" class="headerlink" title="15. å­¦ä¹ èµ„æºæ¨è"></a>15. å­¦ä¹ èµ„æºæ¨è</h2><h3 id="å®˜æ–¹èµ„æº"><a href="#å®˜æ–¹èµ„æº" class="headerlink" title="å®˜æ–¹èµ„æº"></a>å®˜æ–¹èµ„æº</h3><ul><li><a href="https://redis.io/documentation">Rediså®˜æ–¹æ–‡æ¡£</a> - æœ€æƒå¨çš„å­¦ä¹ èµ„æ–™</li><li><a href="http://www.redis.cn/">Redisä¸­æ–‡ç½‘</a> - ä¸­æ–‡ç¤¾åŒº</li><li><a href="http://doc.redisfans.com/">Rediså‘½ä»¤å‚è€ƒ</a> - å‘½ä»¤é€ŸæŸ¥</li></ul><h3 id="å­¦ä¹ å·¥å…·"><a href="#å­¦ä¹ å·¥å…·" class="headerlink" title="å­¦ä¹ å·¥å…·"></a>å­¦ä¹ å·¥å…·</h3><ul><li><strong>RedisInsight</strong> - Rediså®˜æ–¹å¯è§†åŒ–å·¥å…·</li><li><strong>Another Redis Desktop Manager</strong> - å¼€æºRediså®¢æˆ·ç«¯</li><li><strong>Redisåœ¨çº¿æµ‹è¯•</strong> - åœ¨çº¿ä½“éªŒRediså‘½ä»¤</li></ul><h3 id="å®æˆ˜é¡¹ç›®"><a href="#å®æˆ˜é¡¹ç›®" class="headerlink" title="å®æˆ˜é¡¹ç›®"></a>å®æˆ˜é¡¹ç›®</h3><ul><li>ç¼“å­˜ç³»ç»Ÿè®¾è®¡</li><li>åˆ†å¸ƒå¼é”å®ç°</li><li>æ’è¡Œæ¦œç³»ç»Ÿ</li><li>ç§’æ€ç³»ç»Ÿ</li></ul><hr><hr><h2 id="ğŸ“-æ–‡æ¡£ä¿¡æ¯"><a href="#ğŸ“-æ–‡æ¡£ä¿¡æ¯" class="headerlink" title="ğŸ“ æ–‡æ¡£ä¿¡æ¯"></a>ğŸ“ æ–‡æ¡£ä¿¡æ¯</h2><ul><li><strong>æœ€åæ›´æ–°</strong>: 2025-11-09</li><li><strong>ä½œè€…</strong>: Suo</li><li><strong>æ ‡ç­¾</strong>: Redis, ä¸­é—´ä»¶, ç¼“å­˜, NoSQL, åˆ†å¸ƒå¼</li><li><strong>ç‰ˆæœ¬</strong>: v1.0</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£æ˜¯ä¸€ä»½å…¨é¢çš„Rediså­¦ä¹ æŒ‡å—ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼Œæ¶µç›–äº†Redisçš„å„ä¸ªæ–¹é¢ã€‚æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æ”¶è—å’Œåˆ†äº«ã€‚</p></blockquote><hr><h2 id="ğŸ™-è‡´è°¢"><a href="#ğŸ™-è‡´è°¢" class="headerlink" title="ğŸ™ è‡´è°¢"></a>ğŸ™ è‡´è°¢</h2><p>æ„Ÿè°¢æ‰€æœ‰ä¸ºRedisç¤¾åŒºåšå‡ºè´¡çŒ®çš„å¼€å‘è€…ä»¬ï¼Œä»¥åŠæ‰€æœ‰æä¾›ä¼˜ç§€å­¦ä¹ èµ„æºçš„ä½œè€…ä»¬ã€‚</p><hr><h2 id="ğŸ“„-ç‰ˆæƒå£°æ˜"><a href="#ğŸ“„-ç‰ˆæƒå£°æ˜" class="headerlink" title="ğŸ“„ ç‰ˆæƒå£°æ˜"></a>ğŸ“„ ç‰ˆæƒå£°æ˜</h2><p>æœ¬æ–‡æ¡£é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> ä¸­é—´ä»¶ </tag>
            
            <tag> ç¼“å­˜ </tag>
            
            <tag> NoSQL </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—</title>
      <link href="//programming-shortcuts-guide/"/>
      <url>//programming-shortcuts-guide/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨-æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—-âŒ¨ï¸"><a href="#ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨-æ•ˆç‡æå‡å¿…å¤‡æŒ‡å—-âŒ¨ï¸" class="headerlink" title="ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å— âŒ¨ï¸"></a>ç¼–ç¨‹å·¥å…·å¿«æ·é”®å¤§å…¨ - æ•ˆç‡æå‡å¿…å¤‡æŒ‡å— âŒ¨ï¸</h1><blockquote><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚ç†Ÿç»ƒæŒæ¡å¼€å‘å·¥å…·çš„å¿«æ·é”®ï¼Œå¯ä»¥è®©ä½ çš„ç¼–ç æ•ˆç‡æå‡æ•°å€ï¼Œå‡å°‘é¼ æ ‡æ“ä½œï¼Œè®©åŒæ‰‹å§‹ç»ˆä¿æŒåœ¨é”®ç›˜ä¸Šï¼Œäº«å—è¡Œäº‘æµæ°´èˆ¬çš„ç¼–ç¨‹ä½“éªŒã€‚æœ¬æŒ‡å—æ”¶å½•äº†ä¸»æµç¼–ç¨‹å·¥å…·çš„å¸¸ç”¨å¿«æ·é”®ï¼Œæ˜¯æ¯ä½å¼€å‘è€…çš„æ•ˆç‡æå‡å¿…å¤‡æ‰‹å†Œï¼ğŸš€</p></blockquote><blockquote><p>ğŸ“ <strong>æ›´æ–°è¯´æ˜</strong>ï¼šæœ¬æ–‡æ¡£æŒç»­æ›´æ–°ä¸­ï¼Œç›®å‰å·²æ”¶å½•ï¼š<strong>IntelliJ IDEA</strong>ã€‚</p></blockquote><p><img src="/images/shortcuts/cover.png" alt="å¿«æ·é”®æŒ‡å—"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><h3 id="ğŸ“Œ-å·²æ”¶å½•å·¥å…·"><a href="#ğŸ“Œ-å·²æ”¶å½•å·¥å…·" class="headerlink" title="ğŸ“Œ å·²æ”¶å½•å·¥å…·"></a>ğŸ“Œ å·²æ”¶å½•å·¥å…·</h3><h4 id="IntelliJ-IDEA-å¿«æ·é”®-âœ…"><a href="#IntelliJ-IDEA-å¿«æ·é”®-âœ…" class="headerlink" title="IntelliJ IDEA å¿«æ·é”® âœ…"></a>IntelliJ IDEA å¿«æ·é”® âœ…</h4><ul><li><a href="#1-%E5%9F%BA%E7%A1%80%E7%BC%96%E8%BE%91">1. åŸºç¡€ç¼–è¾‘</a><ul><li><a href="#11-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">1.1 åŸºæœ¬æ“ä½œ</a></li><li><a href="#12-%E9%80%89%E6%8B%A9%E6%89%A9%E5%B1%95">1.2 é€‰æ‹©æ‰©å±•</a></li><li><a href="#13-%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91">1.3 æ–‡æœ¬ç¼–è¾‘</a></li></ul></li><li><a href="#2-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90">2. ä»£ç ç”Ÿæˆ</a></li><li><a href="#3-%E4%BB%A3%E7%A0%81%E5%AF%BC%E8%88%AA">3. ä»£ç å¯¼èˆª</a><ul><li><a href="#31-%E6%9F%A5%E6%89%BE%E5%92%8C%E6%90%9C%E7%B4%A2">3.1 æŸ¥æ‰¾å’Œæœç´¢</a></li><li><a href="#32-%E4%BB%A3%E7%A0%81%E8%B7%B3%E8%BD%AC">3.2 ä»£ç è·³è½¬</a></li><li><a href="#33-%E5%8E%86%E5%8F%B2%E5%AF%BC%E8%88%AA">3.3 å†å²å¯¼èˆª</a></li></ul></li><li><a href="#4-%E9%87%8D%E6%9E%84%E6%93%8D%E4%BD%9C">4. é‡æ„æ“ä½œ</a></li><li><a href="#5-%E7%AA%97%E5%8F%A3%E5%92%8C%E8%A7%86%E5%9B%BE">5. çª—å£å’Œè§†å›¾</a><ul><li><a href="#51-%E7%AA%97%E5%8F%A3%E5%88%87%E6%8D%A2">5.1 çª—å£åˆ‡æ¢</a></li><li><a href="#52-%E4%BB%A3%E7%A0%81%E6%8A%98%E5%8F%A0">5.2 ä»£ç æŠ˜å </a></li><li><a href="#53-%E5%B7%A5%E5%85%B7%E7%AA%97%E5%8F%A3">5.3 å·¥å…·çª—å£</a></li></ul></li><li><a href="#6-%E8%BF%90%E8%A1%8C%E8%B0%83%E8%AF%95">6. è¿è¡Œè°ƒè¯•</a><ul><li><a href="#61-%E8%BF%90%E8%A1%8C%E5%92%8C%E8%B0%83%E8%AF%95">6.1 è¿è¡Œå’Œè°ƒè¯•</a></li><li><a href="#62-%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95">6.2 æ–­ç‚¹è°ƒè¯•</a></li><li><a href="#63-%E6%B5%8B%E8%AF%95">6.3 æµ‹è¯•</a></li></ul></li><li><a href="#7-%E5%BF%AB%E6%8D%B7%E9%94%AE%E8%AE%B0%E5%BF%86%E6%8A%80%E5%B7%A7">7. å¿«æ·é”®è®°å¿†æŠ€å·§</a></li><li><a href="#8-%E6%80%BB%E7%BB%93%E4%B8%8E%E5%BB%BA%E8%AE%AE">8. æ€»ç»“ä¸å»ºè®®</a></li></ul><h3 id="ğŸš§-è®¡åˆ’æ”¶å½•"><a href="#ğŸš§-è®¡åˆ’æ”¶å½•" class="headerlink" title="ğŸš§ è®¡åˆ’æ”¶å½•"></a>ğŸš§ è®¡åˆ’æ”¶å½•</h3><ul><li><strong>Sublime Text å¿«æ·é”®</strong> - æ•¬è¯·æœŸå¾…</li><li><strong>Chrome DevTools å¿«æ·é”®</strong> - æ•¬è¯·æœŸå¾…</li><li><strong>Git å·¥å…·å¿«æ·é”®</strong> - æ•¬è¯·æœŸå¾…</li><li><strong>ç»ˆç«¯&#x2F;å‘½ä»¤è¡Œå¿«æ·é”®</strong> - æ•¬è¯·æœŸå¾…</li></ul><hr><h2 id="IntelliJ-IDEA-å¿«æ·é”®-ğŸ’¼"><a href="#IntelliJ-IDEA-å¿«æ·é”®-ğŸ’¼" class="headerlink" title="IntelliJ IDEA å¿«æ·é”® ğŸ’¼"></a>IntelliJ IDEA å¿«æ·é”® ğŸ’¼</h2><blockquote><p>IntelliJ IDEA æ˜¯Javaå¼€å‘è€…çš„é¦–é€‰IDEï¼Œå®ƒæ‹¥æœ‰å¼ºå¤§ä¸”å®Œå–„çš„å¿«æ·é”®ä½“ç³»ã€‚ç†Ÿç»ƒæŒæ¡è¿™äº›å¿«æ·é”®ï¼Œå¯ä»¥è®©ä½ çš„Javaå¼€å‘æ•ˆç‡æå‡æ•°å€ã€‚</p></blockquote><h3 id="1-åŸºç¡€ç¼–è¾‘-ğŸ“"><a href="#1-åŸºç¡€ç¼–è¾‘-ğŸ“" class="headerlink" title="1. åŸºç¡€ç¼–è¾‘ ğŸ“"></a>1. åŸºç¡€ç¼–è¾‘ ğŸ“</h3><h4 id="1-1-åŸºæœ¬æ“ä½œ"><a href="#1-1-åŸºæœ¬æ“ä½œ" class="headerlink" title="1.1 åŸºæœ¬æ“ä½œ"></a>1.1 åŸºæœ¬æ“ä½œ</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å¤åˆ¶å½“å‰è¡Œ</strong></td><td><code>Ctrl + D</code></td><td><code>Cmd + D</code></td><td>å¤åˆ¶å½“å‰è¡Œåˆ°ä¸‹ä¸€è¡Œ</td></tr><tr><td><strong>åˆ é™¤å½“å‰è¡Œ</strong></td><td><code>Ctrl + Y</code></td><td><code>Cmd + Delete</code></td><td>åˆ é™¤å½“å‰è¡Œ</td></tr><tr><td><strong>ç§»åŠ¨è¡Œï¼ˆä¸Šï¼‰</strong></td><td><code>Ctrl + Shift + â†‘</code></td><td><code>Cmd + Shift + â†‘</code></td><td>ä¸Šç§»å½“å‰è¡Œ</td></tr><tr><td><strong>ç§»åŠ¨è¡Œï¼ˆä¸‹ï¼‰</strong></td><td><code>Ctrl + Shift + â†“</code></td><td><code>Cmd + Shift + â†“</code></td><td>ä¸‹ç§»å½“å‰è¡Œ</td></tr><tr><td><strong>ä»£ç æ ¼å¼åŒ–</strong></td><td><code>Ctrl + Alt + L</code></td><td><code>Cmd + Option + L</code></td><td>æ ¼å¼åŒ–ä»£ç </td></tr><tr><td><strong>ä¼˜åŒ–å¯¼å…¥</strong></td><td><code>Ctrl + Alt + O</code></td><td><code>Ctrl + Option + O</code></td><td>ä¼˜åŒ–importè¯­å¥</td></tr><tr><td><strong>æ³¨é‡Š&#x2F;å–æ¶ˆæ³¨é‡Š</strong></td><td><code>Ctrl + /</code></td><td><code>Cmd + /</code></td><td>è¡Œæ³¨é‡Š</td></tr><tr><td><strong>å—æ³¨é‡Š</strong></td><td><code>Ctrl + Shift + /</code></td><td><code>Cmd + Option + /</code></td><td>å—æ³¨é‡Š</td></tr></tbody></table><h4 id="1-2-é€‰æ‹©æ‰©å±•"><a href="#1-2-é€‰æ‹©æ‰©å±•" class="headerlink" title="1.2 é€‰æ‹©æ‰©å±•"></a>1.2 é€‰æ‹©æ‰©å±•</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ‰©å±•é€‰æ‹©</strong></td><td><code>Ctrl + W</code></td><td><code>Option + â†‘</code></td><td>æŒ‰è¯­æ³•æ‰©å±•é€‰æ‹©èŒƒå›´</td></tr><tr><td><strong>ç¼©å°é€‰æ‹©</strong></td><td><code>Ctrl + Shift + W</code></td><td><code>Option + â†“</code></td><td>ç¼©å°é€‰æ‹©èŒƒå›´</td></tr><tr><td><strong>é€‰ä¸­æ‰€æœ‰å‡ºç°</strong></td><td><code>Ctrl + Alt + Shift + J</code></td><td><code>Cmd + Ctrl + G</code></td><td>é€‰ä¸­æ‰€æœ‰ç›¸åŒå†…å®¹å¹¶æ‰¹é‡ç¼–è¾‘</td></tr><tr><td><strong>åˆ—é€‰æ‹©æ¨¡å¼</strong></td><td><code>Alt + Shift + Insert</code></td><td><code>Cmd + Shift + 8</code></td><td>åˆ‡æ¢åˆ—é€‰æ‹©æ¨¡å¼</td></tr><tr><td><strong>å¤šå…‰æ ‡ç¼–è¾‘</strong></td><td><code>Alt + é¼ æ ‡å·¦é”®æ‹–åŠ¨</code></td><td><code>Option + é¼ æ ‡å·¦é”®æ‹–åŠ¨</code></td><td>åˆ›å»ºå¤šä¸ªå…‰æ ‡è¿›è¡Œæ‰¹é‡ç¼–è¾‘</td></tr></tbody></table><h4 id="1-3-æ–‡æœ¬ç¼–è¾‘"><a href="#1-3-æ–‡æœ¬ç¼–è¾‘" class="headerlink" title="1.3 æ–‡æœ¬ç¼–è¾‘"></a>1.3 æ–‡æœ¬ç¼–è¾‘</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>åˆ é™¤åˆ°è¯é¦–</strong></td><td><code>Ctrl + BackSpace</code></td><td><code>Option + Delete</code></td><td>åˆ é™¤åˆ°å•è¯å¼€å§‹</td></tr><tr><td><strong>åˆ é™¤åˆ°è¯å°¾</strong></td><td><code>Ctrl + Delete</code></td><td><code>Option + Fn + Delete</code></td><td>åˆ é™¤åˆ°å•è¯ç»“æŸ</td></tr><tr><td><strong>å¤§å°å†™åˆ‡æ¢</strong></td><td><code>Ctrl + Shift + U</code></td><td><code>Cmd + Shift + U</code></td><td>åˆ‡æ¢é€‰ä¸­æ–‡æœ¬çš„å¤§å°å†™</td></tr><tr><td><strong>è¡¥å…¨è¯­å¥</strong></td><td><code>Ctrl + Shift + Enter</code></td><td><code>Cmd + Shift + Enter</code></td><td>æ™ºèƒ½è¡¥å…¨è¯­å¥ï¼ˆè‡ªåŠ¨æ·»åŠ åˆ†å·ã€æ‹¬å·ç­‰ï¼‰</td></tr><tr><td><strong>æ’¤é”€</strong></td><td><code>Ctrl + Z</code></td><td><code>Cmd + Z</code></td><td>æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ</td></tr><tr><td><strong>é‡åš</strong></td><td><code>Ctrl + Shift + Z</code></td><td><code>Cmd + Shift + Z</code></td><td>é‡åšï¼ˆå–æ¶ˆæ’¤é”€ï¼‰</td></tr></tbody></table><h3 id="2-ä»£ç ç”Ÿæˆ-ğŸ”§"><a href="#2-ä»£ç ç”Ÿæˆ-ğŸ”§" class="headerlink" title="2. ä»£ç ç”Ÿæˆ ğŸ”§"></a>2. ä»£ç ç”Ÿæˆ ğŸ”§</h3><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç”Ÿæˆä»£ç </strong></td><td><code>Alt + Insert</code></td><td><code>Cmd + N</code></td><td>ç”Ÿæˆgetter&#x2F;setterç­‰</td></tr><tr><td><strong>æ™ºèƒ½æç¤º</strong></td><td><code>Ctrl + Space</code></td><td><code>Ctrl + Space</code></td><td>åŸºæœ¬ä»£ç è¡¥å…¨</td></tr><tr><td><strong>æ™ºèƒ½è¡¥å…¨</strong></td><td><code>Ctrl + Shift + Space</code></td><td><code>Ctrl + Shift + Space</code></td><td>æ™ºèƒ½ä»£ç è¡¥å…¨</td></tr><tr><td><strong>å¿«é€Ÿä¿®å¤</strong></td><td><code>Alt + Enter</code></td><td><code>Option + Enter</code></td><td>æ˜¾ç¤ºå¿«é€Ÿä¿®å¤å»ºè®®</td></tr><tr><td><strong>è¦†å†™æ–¹æ³•</strong></td><td><code>Ctrl + O</code></td><td><code>Cmd + O</code></td><td>è¦†å†™çˆ¶ç±»æ–¹æ³•</td></tr><tr><td><strong>å®ç°æ–¹æ³•</strong></td><td><code>Ctrl + I</code></td><td><code>Cmd + I</code></td><td>å®ç°æ¥å£æ–¹æ³•</td></tr><tr><td><strong>ç¯ç»•ä»£ç </strong></td><td><code>Ctrl + Alt + T</code></td><td><code>Cmd + Option + T</code></td><td>ç”¨if&#x2F;tryç­‰ç¯ç»•ä»£ç </td></tr></tbody></table><h3 id="3-ä»£ç å¯¼èˆª-ğŸ§­"><a href="#3-ä»£ç å¯¼èˆª-ğŸ§­" class="headerlink" title="3. ä»£ç å¯¼èˆª ğŸ§­"></a>3. ä»£ç å¯¼èˆª ğŸ§­</h3><h4 id="3-1-æŸ¥æ‰¾å’Œæœç´¢"><a href="#3-1-æŸ¥æ‰¾å’Œæœç´¢" class="headerlink" title="3.1 æŸ¥æ‰¾å’Œæœç´¢"></a>3.1 æŸ¥æ‰¾å’Œæœç´¢</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å…¨å±€æœç´¢</strong></td><td><code>Shift + Shift</code></td><td><code>Shift + Shift</code></td><td>Search Everywhereï¼ˆå…¨èƒ½æœç´¢ï¼‰</td></tr><tr><td><strong>è·³è½¬åˆ°ç±»</strong></td><td><code>Ctrl + N</code></td><td><code>Cmd + O</code></td><td>å¿«é€ŸæŸ¥æ‰¾ç±»</td></tr><tr><td><strong>è·³è½¬åˆ°æ–‡ä»¶</strong></td><td><code>Ctrl + Shift + N</code></td><td><code>Cmd + Shift + O</code></td><td>å¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶</td></tr><tr><td><strong>è·³è½¬åˆ°ç¬¦å·</strong></td><td><code>Ctrl + Alt + Shift + N</code></td><td><code>Cmd + Option + O</code></td><td>æŸ¥æ‰¾æ–¹æ³•æˆ–å˜é‡</td></tr><tr><td><strong>æŸ¥æ‰¾åŠ¨ä½œ</strong></td><td><code>Ctrl + Shift + A</code></td><td><code>Cmd + Shift + A</code></td><td>æŸ¥æ‰¾å¹¶æ‰§è¡Œä»»ä½•IDEAæ“ä½œ</td></tr><tr><td><strong>å½“å‰æ–‡ä»¶æŸ¥æ‰¾</strong></td><td><code>Ctrl + F</code></td><td><code>Cmd + F</code></td><td>åœ¨å½“å‰æ–‡ä»¶ä¸­æŸ¥æ‰¾</td></tr><tr><td><strong>å½“å‰æ–‡ä»¶æ›¿æ¢</strong></td><td><code>Ctrl + R</code></td><td><code>Cmd + R</code></td><td>åœ¨å½“å‰æ–‡ä»¶ä¸­æ›¿æ¢</td></tr><tr><td><strong>å…¨å±€æŸ¥æ‰¾</strong></td><td><code>Ctrl + Shift + F</code></td><td><code>Cmd + Shift + F</code></td><td>åœ¨æ•´ä¸ªé¡¹ç›®ä¸­æŸ¥æ‰¾</td></tr><tr><td><strong>å…¨å±€æ›¿æ¢</strong></td><td><code>Ctrl + Shift + R</code></td><td><code>Cmd + Shift + R</code></td><td>åœ¨æ•´ä¸ªé¡¹ç›®ä¸­æ›¿æ¢</td></tr></tbody></table><h4 id="3-2-ä»£ç è·³è½¬"><a href="#3-2-ä»£ç è·³è½¬" class="headerlink" title="3.2 ä»£ç è·³è½¬"></a>3.2 ä»£ç è·³è½¬</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>è·³è½¬åˆ°å£°æ˜</strong></td><td><code>Ctrl + B</code> æˆ– <code>Ctrl + Click</code></td><td><code>Cmd + B</code></td><td>è·³è½¬åˆ°å£°æ˜</td></tr><tr><td><strong>è·³è½¬åˆ°å®ç°</strong></td><td><code>Ctrl + Alt + B</code></td><td><code>Cmd + Option + B</code></td><td>è·³è½¬åˆ°å®ç°</td></tr><tr><td><strong>è·³è½¬åˆ°çˆ¶ç±»</strong></td><td><code>Ctrl + U</code></td><td><code>Cmd + U</code></td><td>è·³è½¬åˆ°çˆ¶ç±»æˆ–çˆ¶æ–¹æ³•</td></tr><tr><td><strong>æŸ¥çœ‹ç±»ç»§æ‰¿å…³ç³»</strong></td><td><code>Ctrl + H</code></td><td><code>Cmd + H</code></td><td>æŸ¥çœ‹ç±»å‹å±‚æ¬¡ç»“æ„</td></tr><tr><td><strong>æŸ¥æ‰¾ç”¨æ³•</strong></td><td><code>Alt + F7</code></td><td><code>Option + F7</code></td><td>æŸ¥æ‰¾ä½¿ç”¨ä½ç½®</td></tr><tr><td><strong>è·³è½¬åˆ°æŒ‡å®šè¡Œ</strong></td><td><code>Ctrl + G</code></td><td><code>Cmd + L</code></td><td>è·³è½¬åˆ°æŒ‡å®šè¡Œå·</td></tr><tr><td><strong>è·³è½¬åˆ°ä»£ç å—å¼€å§‹</strong></td><td><code>Ctrl + [</code></td><td><code>Cmd + Option + [</code></td><td>ç§»åŠ¨åˆ°ä»£ç å—å¼€å§‹</td></tr><tr><td><strong>è·³è½¬åˆ°ä»£ç å—ç»“æŸ</strong></td><td><code>Ctrl + ]</code></td><td><code>Cmd + Option + ]</code></td><td>ç§»åŠ¨åˆ°ä»£ç å—ç»“æŸ</td></tr><tr><td><strong>ä¸Šä¸€ä¸ªæ–¹æ³•</strong></td><td><code>Alt + â†‘</code></td><td><code>Ctrl + â†‘</code></td><td>è·³è½¬åˆ°ä¸Šä¸€ä¸ªæ–¹æ³•</td></tr><tr><td><strong>ä¸‹ä¸€ä¸ªæ–¹æ³•</strong></td><td><code>Alt + â†“</code></td><td><code>Ctrl + â†“</code></td><td>è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæ–¹æ³•</td></tr><tr><td><strong>ä¸‹ä¸€ä¸ªé”™è¯¯</strong></td><td><code>F2</code></td><td><code>F2</code></td><td>è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé”™è¯¯æˆ–è­¦å‘Š</td></tr><tr><td><strong>ä¸Šä¸€ä¸ªé”™è¯¯</strong></td><td><code>Shift + F2</code></td><td><code>Shift + F2</code></td><td>è·³è½¬åˆ°ä¸Šä¸€ä¸ªé”™è¯¯</td></tr></tbody></table><h4 id="3-3-å†å²å¯¼èˆª"><a href="#3-3-å†å²å¯¼èˆª" class="headerlink" title="3.3 å†å²å¯¼èˆª"></a>3.3 å†å²å¯¼èˆª</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æœ€è¿‘çš„æ–‡ä»¶</strong></td><td><code>Ctrl + E</code></td><td><code>Cmd + E</code></td><td>æ˜¾ç¤ºæœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶</td></tr><tr><td><strong>æœ€è¿‘çš„ä½ç½®</strong></td><td><code>Ctrl + Shift + E</code></td><td><code>Cmd + Shift + E</code></td><td>æ˜¾ç¤ºæœ€è¿‘ç¼–è¾‘ä½ç½®</td></tr><tr><td><strong>åé€€</strong></td><td><code>Ctrl + Alt + â†</code></td><td><code>Cmd + [</code></td><td>è¿”å›ä¸Šä¸€ä¸ªä½ç½®</td></tr><tr><td><strong>å‰è¿›</strong></td><td><code>Ctrl + Alt + â†’</code></td><td><code>Cmd + ]</code></td><td>å‰è¿›åˆ°ä¸‹ä¸€ä¸ªä½ç½®</td></tr><tr><td><strong>ä¸Šæ¬¡ç¼–è¾‘ä½ç½®</strong></td><td><code>Ctrl + Shift + BackSpace</code></td><td><code>Cmd + Shift + Delete</code></td><td>å›åˆ°ä¸Šæ¬¡ç¼–è¾‘çš„ä½ç½®</td></tr></tbody></table><h3 id="4-é‡æ„æ“ä½œ-ğŸ”„"><a href="#4-é‡æ„æ“ä½œ-ğŸ”„" class="headerlink" title="4. é‡æ„æ“ä½œ ğŸ”„"></a>4. é‡æ„æ“ä½œ ğŸ”„</h3><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é‡æ„èœå•</strong></td><td><code>Ctrl + Alt + Shift + T</code></td><td><code>Ctrl + T</code></td><td>æ‰“å¼€é‡æ„èœå•</td></tr><tr><td><strong>é‡å‘½å</strong></td><td><code>Shift + F6</code></td><td><code>Shift + F6</code></td><td>é‡å‘½åå˜é‡&#x2F;æ–¹æ³•&#x2F;ç±»</td></tr><tr><td><strong>æå–å˜é‡</strong></td><td><code>Ctrl + Alt + V</code></td><td><code>Cmd + Option + V</code></td><td>æå–ä¸ºå˜é‡</td></tr><tr><td><strong>æå–å¸¸é‡</strong></td><td><code>Ctrl + Alt + C</code></td><td><code>Cmd + Option + C</code></td><td>æå–ä¸ºå¸¸é‡</td></tr><tr><td><strong>æå–æ–¹æ³•</strong></td><td><code>Ctrl + Alt + M</code></td><td><code>Cmd + Option + M</code></td><td>æå–ä¸ºæ–¹æ³•</td></tr><tr><td><strong>æå–å‚æ•°</strong></td><td><code>Ctrl + Alt + P</code></td><td><code>Cmd + Option + P</code></td><td>æå–ä¸ºå‚æ•°</td></tr><tr><td><strong>å†…è”</strong></td><td><code>Ctrl + Alt + N</code></td><td><code>Cmd + Option + N</code></td><td>å†…è”å˜é‡&#x2F;æ–¹æ³•</td></tr></tbody></table><h3 id="5-çª—å£å’Œè§†å›¾-ğŸªŸ"><a href="#5-çª—å£å’Œè§†å›¾-ğŸªŸ" class="headerlink" title="5. çª—å£å’Œè§†å›¾ ğŸªŸ"></a>5. çª—å£å’Œè§†å›¾ ğŸªŸ</h3><h4 id="5-1-çª—å£åˆ‡æ¢"><a href="#5-1-çª—å£åˆ‡æ¢" class="headerlink" title="5.1 çª—å£åˆ‡æ¢"></a>5.1 çª—å£åˆ‡æ¢</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>åˆ‡æ¢æ ‡ç­¾é¡µ</strong></td><td><code>Alt + â†</code> &#x2F; <code>Alt + â†’</code></td><td><code>Cmd + Shift + [</code> &#x2F; <code>]</code></td><td>åˆ‡æ¢å·¦å³æ ‡ç­¾é¡µ</td></tr><tr><td><strong>åˆ‡æ¢ç¼–è¾‘å™¨</strong></td><td><code>Ctrl + Tab</code></td><td><code>Ctrl + Tab</code></td><td>å¿«é€Ÿåˆ‡æ¢æ‰“å¼€çš„æ–‡ä»¶</td></tr><tr><td><strong>å…³é—­å½“å‰æ ‡ç­¾</strong></td><td><code>Ctrl + F4</code></td><td><code>Cmd + W</code></td><td>å…³é—­å½“å‰æ–‡ä»¶</td></tr><tr><td><strong>é¡¹ç›®çª—å£åˆ‡æ¢</strong></td><td><code>Ctrl + Alt + [</code> &#x2F; <code>]</code></td><td><code>Cmd + Option + [</code> &#x2F; <code>]</code></td><td>å¤šé¡¹ç›®çª—å£åˆ‡æ¢</td></tr><tr><td><strong>éšè—æ‰€æœ‰å·¥å…·çª—</strong></td><td><code>Ctrl + Shift + F12</code></td><td><code>Cmd + Shift + F12</code></td><td>æœ€å¤§åŒ–ç¼–è¾‘å™¨</td></tr></tbody></table><h4 id="5-2-ä»£ç æŠ˜å "><a href="#5-2-ä»£ç æŠ˜å " class="headerlink" title="5.2 ä»£ç æŠ˜å "></a>5.2 ä»£ç æŠ˜å </h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æŠ˜å ä»£ç å—</strong></td><td><code>Ctrl + -</code></td><td><code>Cmd + -</code></td><td>æŠ˜å å½“å‰ä»£ç å—</td></tr><tr><td><strong>å±•å¼€ä»£ç å—</strong></td><td><code>Ctrl + +</code></td><td><code>Cmd + +</code></td><td>å±•å¼€å½“å‰ä»£ç å—</td></tr><tr><td><strong>æŠ˜å æ‰€æœ‰</strong></td><td><code>Ctrl + Shift + -</code></td><td><code>Cmd + Shift + -</code></td><td>æŠ˜å æ‰€æœ‰ä»£ç å—</td></tr><tr><td><strong>å±•å¼€æ‰€æœ‰</strong></td><td><code>Ctrl + Shift + +</code></td><td><code>Cmd + Shift + +</code></td><td>å±•å¼€æ‰€æœ‰ä»£ç å—</td></tr></tbody></table><h4 id="5-3-å·¥å…·çª—å£"><a href="#5-3-å·¥å…·çª—å£" class="headerlink" title="5.3 å·¥å…·çª—å£"></a>5.3 å·¥å…·çª—å£</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é¡¹ç›®ç»“æ„</strong></td><td><code>Alt + 1</code></td><td><code>Cmd + 1</code></td><td>æ˜¾ç¤º&#x2F;éšè—é¡¹ç›®çª—å£</td></tr><tr><td><strong>æ”¶è—å¤¹</strong></td><td><code>Alt + 2</code></td><td><code>Cmd + 2</code></td><td>æ˜¾ç¤º&#x2F;éšè—æ”¶è—å¤¹</td></tr><tr><td><strong>è¿è¡Œ</strong></td><td><code>Alt + 4</code></td><td><code>Cmd + 4</code></td><td>æ˜¾ç¤º&#x2F;éšè—è¿è¡Œçª—å£</td></tr><tr><td><strong>è°ƒè¯•</strong></td><td><code>Alt + 5</code></td><td><code>Cmd + 5</code></td><td>æ˜¾ç¤º&#x2F;éšè—è°ƒè¯•çª—å£</td></tr><tr><td><strong>ç»ˆç«¯</strong></td><td><code>Alt + F12</code></td><td><code>Option + F12</code></td><td>æ˜¾ç¤º&#x2F;éšè—ç»ˆç«¯</td></tr><tr><td><strong>ç‰ˆæœ¬æ§åˆ¶</strong></td><td><code>Alt + 9</code></td><td><code>Cmd + 9</code></td><td>æ˜¾ç¤º&#x2F;éšè—ç‰ˆæœ¬æ§åˆ¶çª—å£</td></tr></tbody></table><h3 id="6-è¿è¡Œè°ƒè¯•-â–¶ï¸"><a href="#6-è¿è¡Œè°ƒè¯•-â–¶ï¸" class="headerlink" title="6. è¿è¡Œè°ƒè¯• â–¶ï¸"></a>6. è¿è¡Œè°ƒè¯• â–¶ï¸</h3><h4 id="6-1-è¿è¡Œå’Œè°ƒè¯•"><a href="#6-1-è¿è¡Œå’Œè°ƒè¯•" class="headerlink" title="6.1 è¿è¡Œå’Œè°ƒè¯•"></a>6.1 è¿è¡Œå’Œè°ƒè¯•</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>è¿è¡Œ</strong></td><td><code>Shift + F10</code></td><td><code>Ctrl + R</code></td><td>è¿è¡Œç¨‹åº</td></tr><tr><td><strong>è°ƒè¯•</strong></td><td><code>Shift + F9</code></td><td><code>Ctrl + D</code></td><td>è°ƒè¯•ç¨‹åº</td></tr><tr><td><strong>åœæ­¢</strong></td><td><code>Ctrl + F2</code></td><td><code>Cmd + F2</code></td><td>åœæ­¢ç¨‹åº</td></tr><tr><td><strong>è¿è¡Œå½“å‰é…ç½®</strong></td><td><code>Ctrl + Shift + F10</code></td><td><code>Ctrl + Shift + R</code></td><td>è¿è¡Œå…‰æ ‡æ‰€åœ¨çš„é…ç½®</td></tr></tbody></table><h4 id="6-2-æ–­ç‚¹è°ƒè¯•"><a href="#6-2-æ–­ç‚¹è°ƒè¯•" class="headerlink" title="6.2 æ–­ç‚¹è°ƒè¯•"></a>6.2 æ–­ç‚¹è°ƒè¯•</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>åˆ‡æ¢æ–­ç‚¹</strong></td><td><code>Ctrl + F8</code></td><td><code>Cmd + F8</code></td><td>æ·»åŠ &#x2F;ç§»é™¤æ–­ç‚¹</td></tr><tr><td><strong>æŸ¥çœ‹æ–­ç‚¹</strong></td><td><code>Ctrl + Shift + F8</code></td><td><code>Cmd + Shift + F8</code></td><td>æŸ¥çœ‹æ‰€æœ‰æ–­ç‚¹</td></tr><tr><td><strong>æ­¥è¿‡</strong></td><td><code>F8</code></td><td><code>F8</code></td><td>å•æ­¥è·³è¿‡</td></tr><tr><td><strong>æ­¥å…¥</strong></td><td><code>F7</code></td><td><code>F7</code></td><td>å•æ­¥è¿›å…¥</td></tr><tr><td><strong>æ­¥å‡º</strong></td><td><code>Shift + F8</code></td><td><code>Shift + F8</code></td><td>å•æ­¥è·³å‡º</td></tr><tr><td><strong>ç»§ç»­æ‰§è¡Œ</strong></td><td><code>F9</code></td><td><code>Cmd + Option + R</code></td><td>ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹</td></tr><tr><td><strong>è®¡ç®—è¡¨è¾¾å¼</strong></td><td><code>Alt + F8</code></td><td><code>Option + F8</code></td><td>è®¡ç®—è¡¨è¾¾å¼å€¼</td></tr></tbody></table><h4 id="6-3-æµ‹è¯•"><a href="#6-3-æµ‹è¯•" class="headerlink" title="6.3 æµ‹è¯•"></a>6.3 æµ‹è¯•</h4><table><thead><tr><th>åŠŸèƒ½</th><th>Windows&#x2F;Linux</th><th>Mac</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>è·³è½¬åˆ°æµ‹è¯•</strong></td><td><code>Ctrl + Shift + T</code></td><td><code>Cmd + Shift + T</code></td><td>åœ¨æµ‹è¯•ç±»å’Œæºç±»ä¹‹é—´è·³è½¬</td></tr><tr><td><strong>è¿è¡Œæµ‹è¯•</strong></td><td><code>Ctrl + Shift + F10</code></td><td><code>Ctrl + Shift + R</code></td><td>è¿è¡Œå½“å‰æµ‹è¯•æ–¹æ³•&#x2F;ç±»</td></tr></tbody></table><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šIDEAçš„å¿«æ·é”®éå¸¸ä¸°å¯Œï¼Œå»ºè®®é€šè¿‡<code>Ctrl + Shift + A</code>ï¼ˆMac: <code>Cmd + Shift + A</code>ï¼‰æœç´¢ä»»ä½•æ“ä½œã€‚</p></blockquote><hr><h3 id="7-å¿«æ·é”®è®°å¿†æŠ€å·§-ğŸ§ "><a href="#7-å¿«æ·é”®è®°å¿†æŠ€å·§-ğŸ§ " class="headerlink" title="7. å¿«æ·é”®è®°å¿†æŠ€å·§ ğŸ§ "></a>7. å¿«æ·é”®è®°å¿†æŠ€å·§ ğŸ§ </h3><h4 id="7-1-è®°å¿†æ–¹æ³•"><a href="#7-1-è®°å¿†æ–¹æ³•" class="headerlink" title="7.1 è®°å¿†æ–¹æ³•"></a>7.1 è®°å¿†æ–¹æ³•</h4><h4 id="åˆ†ç±»è®°å¿†"><a href="#åˆ†ç±»è®°å¿†" class="headerlink" title="åˆ†ç±»è®°å¿†"></a>åˆ†ç±»è®°å¿†</h4><p>å°†IDEAå¿«æ·é”®æŒ‰åŠŸèƒ½åˆ†ç±»ï¼š</p><ul><li><strong>ç¼–è¾‘æ“ä½œ</strong>ï¼šCtrl&#x2F;Cmd + D&#x2F;Yï¼ˆå¤åˆ¶&#x2F;åˆ é™¤è¡Œï¼‰</li><li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šAlt&#x2F;Cmd + Insert&#x2F;N</li><li><strong>å¯¼èˆªæ“ä½œ</strong>ï¼šCtrl&#x2F;Cmd + N&#x2F;B&#x2F;Eï¼ˆè·³è½¬ç±»&#x2F;å£°æ˜&#x2F;æœ€è¿‘æ–‡ä»¶ï¼‰</li><li><strong>é‡æ„æ“ä½œ</strong>ï¼šShift + F6ï¼ˆé‡å‘½åï¼‰ï¼ŒCtrl&#x2F;Cmd + Alt + M&#x2F;V&#x2F;Cï¼ˆæå–æ–¹æ³•&#x2F;å˜é‡&#x2F;å¸¸é‡ï¼‰</li></ul><h4 id="åŠ©è®°è¯è”æƒ³"><a href="#åŠ©è®°è¯è”æƒ³" class="headerlink" title="åŠ©è®°è¯è”æƒ³"></a>åŠ©è®°è¯è”æƒ³</h4><ul><li><code>Ctrl + N</code>ï¼š<strong>N</strong>avigate to classï¼ˆè·³è½¬åˆ°ç±»ï¼‰</li><li><code>Ctrl + B</code>ï¼š<strong>B</strong>rowse declarationï¼ˆæµè§ˆå£°æ˜ï¼‰</li><li><code>Shift + F6</code>ï¼š<strong>F6</strong> â†’ <strong>R</strong>enameï¼ˆé‡å‘½åï¼‰</li><li><code>Alt + Insert</code>ï¼š<strong>Insert</strong> codeï¼ˆæ’å…¥ä»£ç ï¼‰</li><li><code>Ctrl + Alt + L</code>ï¼š<strong>L</strong>ayout codeï¼ˆæ ¼å¼åŒ–ä»£ç ï¼‰</li></ul><h4 id="é€æ­¥å­¦ä¹ "><a href="#é€æ­¥å­¦ä¹ " class="headerlink" title="é€æ­¥å­¦ä¹ "></a>é€æ­¥å­¦ä¹ </h4><ol><li><strong>ç¬¬ä¸€å‘¨</strong>ï¼šæŒæ¡åŸºç¡€ç¼–è¾‘å¿«æ·é”®ï¼ˆå¤åˆ¶&#x2F;åˆ é™¤è¡Œã€ä»£ç æ ¼å¼åŒ–ç­‰ï¼‰</li><li><strong>ç¬¬äºŒå‘¨</strong>ï¼šæŒæ¡ä»£ç å¯¼èˆªå¿«æ·é”®ï¼ˆè·³è½¬åˆ°ç±»&#x2F;æ–‡ä»¶&#x2F;å£°æ˜ï¼‰</li><li><strong>ç¬¬ä¸‰å‘¨</strong>ï¼šå­¦ä¹ ä»£ç ç”Ÿæˆå’Œå¿«é€Ÿä¿®å¤</li><li><strong>ç¬¬å››å‘¨</strong>ï¼šæŒæ¡é‡æ„æ“ä½œå’Œè°ƒè¯•å¿«æ·é”®</li></ol><h4 id="7-2-ç»ƒä¹ å»ºè®®"><a href="#7-2-ç»ƒä¹ å»ºè®®" class="headerlink" title="7.2 ç»ƒä¹ å»ºè®®"></a>7.2 ç»ƒä¹ å»ºè®®</h4><h5 id="åˆ»æ„ç»ƒä¹ "><a href="#åˆ»æ„ç»ƒä¹ " class="headerlink" title="åˆ»æ„ç»ƒä¹ "></a>åˆ»æ„ç»ƒä¹ </h5><ol><li><strong>å¼ºåˆ¶ä½¿ç”¨</strong>ï¼šç¦ç”¨é¼ æ ‡ä¸€å¤©ï¼Œåªä½¿ç”¨é”®ç›˜</li><li><strong>æ¯æ—¥ç›®æ ‡</strong>ï¼šæ¯å¤©å­¦ä¹ 3-5ä¸ªæ–°å¿«æ·é”®</li><li><strong>å®æˆ˜åº”ç”¨</strong>ï¼šåœ¨å®é™…Javaé¡¹ç›®ä¸­ä¸»åŠ¨ä½¿ç”¨å¿«æ·é”®</li><li><strong>å®šæœŸå¤ä¹ </strong>ï¼šæ¯å‘¨å›é¡¾å·²å­¦ä¹ çš„å¿«æ·é”®</li></ol><h5 id="å·¥å…·è¾…åŠ©"><a href="#å·¥å…·è¾…åŠ©" class="headerlink" title="å·¥å…·è¾…åŠ©"></a>å·¥å…·è¾…åŠ©</h5><ul><li><strong>Key Promoter Xæ’ä»¶</strong>ï¼š<ul><li>IDEAå†…ç½®æ’ä»¶ï¼Œä¼šåœ¨ä½¿ç”¨é¼ æ ‡æ—¶æç¤ºå¯¹åº”çš„å¿«æ·é”®</li><li>å®‰è£…ï¼šSettings â†’ Plugins â†’ æœç´¢ â€œKey Promoter Xâ€</li></ul></li><li><strong>å¿«æ·é”®é€ŸæŸ¥è¡¨</strong>ï¼šæ‰“å°å‡ºæ¥è´´åœ¨æ˜¾ç¤ºå™¨æ—è¾¹</li><li><strong>åœ¨çº¿èµ„æº</strong>ï¼š<ul><li><a href="https://www.jetbrains.com/help/idea/mastering-keyboard-shortcuts.html">JetBrainså®˜æ–¹å¿«æ·é”®æ–‡æ¡£</a></li><li><a href="https://www.shortcutfoo.com/">Shortcut Foo</a> - IntelliJ IDEAä¸“é¡¹è®­ç»ƒ</li></ul></li></ul><h4 id="7-3-è‡ªå®šä¹‰å¿«æ·é”®"><a href="#7-3-è‡ªå®šä¹‰å¿«æ·é”®" class="headerlink" title="7.3 è‡ªå®šä¹‰å¿«æ·é”®"></a>7.3 è‡ªå®šä¹‰å¿«æ·é”®</h4><h5 id="IDEA-è‡ªå®šä¹‰"><a href="#IDEA-è‡ªå®šä¹‰" class="headerlink" title="IDEA è‡ªå®šä¹‰"></a>IDEA è‡ªå®šä¹‰</h5><ol><li>æ‰“å¼€è®¾ç½®ï¼š<code>Ctrl + Alt + S</code> (Mac: <code>Cmd + ,</code>)</li><li>å¯¼èˆªåˆ° <code>Keymap</code></li><li>å³é”®ç‚¹å‡»è¦ä¿®æ”¹çš„æ“ä½œ</li><li>é€‰æ‹© <code>Add Keyboard Shortcut</code></li><li>è¾“å…¥æ–°çš„å¿«æ·é”®</li></ol><h5 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h5><ul><li>âœ… ä¿æŒKeymapçš„ä¸€è‡´æ€§ï¼ˆæ¨èä½¿ç”¨é»˜è®¤çš„IntelliJ IDEA keymapï¼‰</li><li>âœ… ä¸è¦è¦†ç›–å¸¸ç”¨çš„ç³»ç»Ÿçº§å¿«æ·é”®</li><li>âœ… ä½¿ç”¨æœªè¢«å ç”¨çš„ç»„åˆé”®</li><li>âœ… è®°å½•è‡ªå®šä¹‰çš„å¿«æ·é”®</li><li>âŒ é¿å…è¿‡äºå¤æ‚çš„ç»„åˆé”®</li><li>âŒ ä¸è¦ä¿®æ”¹å¤ªå¤šé»˜è®¤å¿«æ·é”®</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå¯ä»¥é€šè¿‡ <code>Help â†’ Keyboard Shortcuts PDF</code> è·å–å®˜æ–¹å¿«æ·é”®é€ŸæŸ¥è¡¨</p></blockquote><hr><h3 id="8-æ€»ç»“ä¸å»ºè®®-ğŸ¯"><a href="#8-æ€»ç»“ä¸å»ºè®®-ğŸ¯" class="headerlink" title="8. æ€»ç»“ä¸å»ºè®® ğŸ¯"></a>8. æ€»ç»“ä¸å»ºè®® ğŸ¯</h3><h4 id="å­¦ä¹ è·¯å¾„å»ºè®®"><a href="#å­¦ä¹ è·¯å¾„å»ºè®®" class="headerlink" title="å­¦ä¹ è·¯å¾„å»ºè®®"></a>å­¦ä¹ è·¯å¾„å»ºè®®</h4><p><strong>åˆçº§é˜¶æ®µ</strong>ï¼ˆ1-2å‘¨ï¼‰</p><ul><li>æŒæ¡åŸºç¡€ç¼–è¾‘æ“ä½œï¼ˆ<code>Ctrl+D</code> å¤åˆ¶è¡Œã€<code>Ctrl+Y</code> åˆ é™¤è¡Œã€<code>Ctrl+/</code> æ³¨é‡Šï¼‰</li><li>å­¦ä¹ ä»£ç å¯¼èˆªï¼ˆ<code>Ctrl+N</code> è·³è½¬åˆ°ç±»ã€<code>Ctrl+B</code> è·³è½¬åˆ°å£°æ˜ï¼‰</li><li>ç†Ÿæ‚‰ä»£ç æ ¼å¼åŒ–ï¼ˆ<code>Ctrl+Alt+L</code>ï¼‰å’Œä¼˜åŒ–å¯¼å…¥ï¼ˆ<code>Ctrl+Alt+O</code>ï¼‰</li></ul><p><strong>ä¸­çº§é˜¶æ®µ</strong>ï¼ˆ3-4å‘¨ï¼‰</p><ul><li>æŒæ¡ä»£ç ç”Ÿæˆï¼ˆ<code>Alt+Insert</code> ç”Ÿæˆä»£ç ã€<code>Alt+Enter</code> å¿«é€Ÿä¿®å¤ï¼‰</li><li>å­¦ä¹ é«˜çº§å¯¼èˆªï¼ˆ<code>Ctrl+E</code> æœ€è¿‘æ–‡ä»¶ã€<code>Ctrl+Shift+E</code> æœ€è¿‘ä½ç½®ï¼‰</li><li>ç†Ÿæ‚‰è°ƒè¯•å¿«æ·é”®ï¼ˆ<code>F8</code> æ­¥è¿‡ã€<code>F7</code> æ­¥å…¥ã€<code>F9</code> ç»§ç»­ï¼‰</li><li>æŒæ¡æŸ¥æ‰¾å’Œæ›¿æ¢ï¼ˆ<code>Ctrl+F</code> æŸ¥æ‰¾ã€<code>Ctrl+Shift+F</code> å…¨å±€æŸ¥æ‰¾ï¼‰</li></ul><p><strong>é«˜çº§é˜¶æ®µ</strong>ï¼ˆ1-2ä¸ªæœˆï¼‰</p><ul><li>ç²¾é€šé‡æ„æ“ä½œï¼ˆ<code>Shift+F6</code> é‡å‘½åã€<code>Ctrl+Alt+M</code> æå–æ–¹æ³•ï¼‰</li><li>æŒæ¡å¤šå…‰æ ‡ç¼–è¾‘å’Œé€‰æ‹©æ‰©å±•ï¼ˆ<code>Ctrl+W</code> æ‰©å±•é€‰æ‹©ï¼‰</li><li>å­¦ä¹ Live Templateså’ŒPostfix Completion</li><li>å½¢æˆè‚Œè‚‰è®°å¿†ï¼Œå®ç°æ— é¼ æ ‡å¼€å‘</li></ul><h4 id="æ•ˆç‡æå‡å»ºè®®"><a href="#æ•ˆç‡æå‡å»ºè®®" class="headerlink" title="æ•ˆç‡æå‡å»ºè®®"></a>æ•ˆç‡æå‡å»ºè®®</h4><ol><li><strong>å®‰è£…Key Promoter X</strong>ï¼šè‡ªåŠ¨æç¤ºå¿«æ·é”®ï¼Œå¸®åŠ©å…»æˆä¹ æƒ¯</li><li><strong>å¾ªåºæ¸è¿›</strong>ï¼šæ¯å¤©å­¦ä¹ 3-5ä¸ªæ–°å¿«æ·é”®ï¼Œä¸è¦è´ªå¤š</li><li><strong>å®æˆ˜åº”ç”¨</strong>ï¼šåœ¨çœŸå®Javaé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯é‡æ„æ—¶</li><li><strong>å®šæœŸå›é¡¾</strong>ï¼šæ¯å‘¨å›é¡¾ä¸€æ¬¡ï¼Œå·©å›ºè®°å¿†</li><li><strong>åˆ†äº«äº¤æµ</strong>ï¼šä¸å›¢é˜Ÿåˆ†äº«å¿«æ·é”®æŠ€å·§ï¼Œäº’ç›¸å­¦ä¹ </li><li><strong>ç¦ç”¨é¼ æ ‡è®­ç»ƒ</strong>ï¼šæ¯å‘¨é€‰ä¸€å¤©åªç”¨é”®ç›˜ï¼Œå¼ºåŒ–è®°å¿†</li></ol><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><blockquote><p>âš ï¸ <strong>é‡è¦æç¤º</strong>ï¼š</p><ul><li>Macå’ŒWindowsçš„å¿«æ·é”®æœ‰è¾ƒå¤§åŒºåˆ«ï¼ˆCmd vs Ctrlï¼‰</li><li>æŸäº›å¿«æ·é”®å¯èƒ½ä¸ç³»ç»Ÿæˆ–è¾“å…¥æ³•å†²çªï¼ˆç‰¹åˆ«æ˜¯ä¸­æ–‡è¾“å…¥æ³•ï¼‰</li><li>IDEAä¸åŒç‰ˆæœ¬å¯èƒ½å¿«æ·é”®ç•¥æœ‰å·®å¼‚</li><li>è‡ªå®šä¹‰å¿«æ·é”®æ—¶è¦é¿å…è¦†ç›–å¸¸ç”¨çš„é»˜è®¤å¿«æ·é”®</li><li>æ¨èä½¿ç”¨é»˜è®¤çš„IntelliJ IDEA Classic keymap</li></ul></blockquote><h4 id="æ¨èèµ„æº"><a href="#æ¨èèµ„æº" class="headerlink" title="æ¨èèµ„æº"></a>æ¨èèµ„æº</h4><p><strong>å®˜æ–¹èµ„æº</strong></p><ul><li><a href="https://www.jetbrains.com/help/idea/mastering-keyboard-shortcuts.html">IntelliJ IDEA Keymap Reference</a> - å®˜æ–¹æ–‡æ¡£</li><li><a href="https://www.jetbrains.com/academy/">JetBrains Academy</a> - å®˜æ–¹å­¦ä¹ å¹³å°</li><li>Help â†’ Keyboard Shortcuts PDF - å†…ç½®å¿«æ·é”®é€ŸæŸ¥è¡¨</li></ul><p><strong>å­¦ä¹ å·¥å…·</strong></p><ul><li><strong>Key Promoter X</strong> - IDEAå†…ç½®æ’ä»¶ï¼Œè‡ªåŠ¨æç¤ºå¿«æ·é”®</li><li><a href="https://www.shortcutfoo.com/">Shortcut Foo</a> - IntelliJ IDEAä¸“é¡¹è®­ç»ƒ</li><li><a href="https://www.youtube.com/c/intellijidea">JetBrainså®˜æ–¹è§†é¢‘æ•™ç¨‹</a> - YouTubeé¢‘é“</li></ul><p><strong>å®ç”¨æŠ€å·§</strong></p><ul><li>ä½¿ç”¨ <code>Ctrl+Shift+A</code> (Find Action) æœç´¢ä»»ä½•æ“ä½œ</li><li>ä½¿ç”¨ <code>Double Shift</code> (Search Everywhere) å…¨å±€æœç´¢</li><li>å¯ç”¨ Presentation Assistant æ’ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå¿«æ·é”®</li></ul><hr><p><strong>æœ€åæ›´æ–°</strong>: 2025-11-10<br><strong>ä½œè€…</strong>: Suo<br><strong>ç‰ˆæœ¬</strong>: v1.1<br><strong>æ ‡ç­¾</strong>: å¿«æ·é”®, å¼€å‘å·¥å…·, IntelliJ IDEA, IDE, æ•ˆç‡æå‡</p><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šæœ¬æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æ”¶è—ã€‚åç»­å°†æ·»åŠ VS Codeã€Chrome DevToolsã€Gitå·¥å…·ç­‰æ›´å¤šå†…å®¹ã€‚</p><p>ğŸ“ <strong>v1.1 æ›´æ–°å†…å®¹</strong>ï¼š</p><ul><li>æ–°å¢é€‰æ‹©æ‰©å±•ç›¸å…³å¿«æ·é”®ï¼ˆ<code>Ctrl+W</code>æ‰©å±•é€‰æ‹©ç­‰ï¼‰</li><li>æ–°å¢æ–‡æœ¬ç¼–è¾‘å¿«æ·é”®ï¼ˆå¤§å°å†™åˆ‡æ¢ã€åˆ é™¤åˆ°è¯é¦–&#x2F;è¯å°¾ç­‰ï¼‰</li><li>å®Œå–„æŸ¥æ‰¾å’Œæœç´¢åˆ†ç±»ï¼ˆå…¨å±€æœç´¢ã€å½“å‰æ–‡ä»¶æŸ¥æ‰¾ç­‰ï¼‰</li><li>æ–°å¢çª—å£å’Œè§†å›¾ç®¡ç†å¿«æ·é”®</li><li>æ–°å¢å·¥å…·çª—å£å¿«æ·é”®ï¼ˆé¡¹ç›®ã€ç»ˆç«¯ã€ç‰ˆæœ¬æ§åˆ¶ç­‰ï¼‰</li><li>è¡¥å……æµ‹è¯•ç›¸å…³å¿«æ·é”®</li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
            <tag> å¿«æ·é”® </tag>
            
            <tag> æ•ˆç‡æå‡ </tag>
            
            <tag> IDE </tag>
            
            <tag> ç¼–è¾‘å™¨ </tag>
            
            <tag> IntelliJ IDEA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LinuxåŸºç¡€å‘½ä»¤ - ä»å…¥é—¨åˆ°ç²¾é€š</title>
      <link href="//linux-basic-commands/"/>
      <url>//linux-basic-commands/</url>
      
        <content type="html"><![CDATA[<h1 id="LinuxåŸºç¡€å‘½ä»¤-ä»å…¥é—¨åˆ°ç²¾é€š-ğŸ§"><a href="#LinuxåŸºç¡€å‘½ä»¤-ä»å…¥é—¨åˆ°ç²¾é€š-ğŸ§" class="headerlink" title="LinuxåŸºç¡€å‘½ä»¤ - ä»å…¥é—¨åˆ°ç²¾é€š ğŸ§"></a>LinuxåŸºç¡€å‘½ä»¤ - ä»å…¥é—¨åˆ°ç²¾é€š ğŸ§</h1><blockquote><p>Linuxæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼ŒæŒæ¡Linuxå‘½ä»¤æ˜¯æ¯ä¸ªå¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚æœ¬æ•™ç¨‹å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œç³»ç»Ÿå­¦ä¹ Linuxçš„åŸºç¡€å‘½ä»¤ï¼ŒåŒ…æ‹¬ç›®å½•æ“ä½œã€æ–‡ä»¶ç®¡ç†ã€æŸ¥æ‰¾å‘½ä»¤ã€viç¼–è¾‘å™¨ã€ç”¨æˆ·æƒé™ç®¡ç†ä»¥åŠç³»ç»Ÿç›‘æ§å’Œå‹ç¼©è§£å‹ç­‰å®ç”¨æ“ä½œã€‚ğŸ’»</p></blockquote><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><ul><li><a href="#1-linux%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">1. Linuxçš„ç›®å½•ç»“æ„</a></li><li><a href="#2-linux%E5%91%BD%E4%BB%A4%E5%85%A5%E9%97%A8">2. Linuxå‘½ä»¤å…¥é—¨</a></li><li><a href="#3-%E7%9B%AE%E5%BD%95%E5%88%87%E6%8D%A2%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4">3. ç›®å½•åˆ‡æ¢ç›¸å…³å‘½ä»¤</a></li><li><a href="#4-%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E5%92%8C%E7%89%B9%E6%AE%8A%E8%B7%AF%E5%BE%84%E7%AC%A6">4. ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„å’Œç‰¹æ®Šè·¯å¾„ç¬¦</a></li><li><a href="#5-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E5%91%BD%E4%BB%A4">5. åˆ›å»ºç›®å½•å‘½ä»¤</a></li><li><a href="#6-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4part1">6. æ–‡ä»¶æ“ä½œå‘½ä»¤Part1</a></li><li><a href="#7-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4part2">7. æ–‡ä»¶æ“ä½œå‘½ä»¤Part2</a></li><li><a href="#8-%E6%9F%A5%E6%89%BE%E5%91%BD%E4%BB%A4">8. æŸ¥æ‰¾å‘½ä»¤</a></li><li><a href="#9-grepwc%E5%92%8C%E7%AE%A1%E9%81%93%E7%AC%A6">9. grepã€wcå’Œç®¡é“ç¬¦</a></li><li><a href="#10-echotail%E5%92%8C%E9%87%8D%E5%AE%9A%E5%90%91%E7%AC%A6">10. echoã€tailå’Œé‡å®šå‘ç¬¦</a></li><li><a href="#11-vi%E7%BC%96%E8%BE%91%E5%99%A8">11. viç¼–è¾‘å™¨</a></li><li><a href="#12-linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86">12. Linuxç”¨æˆ·å’Œæƒé™ç®¡ç†</a></li><li><a href="#13-linux%E5%AE%9E%E7%94%A8%E6%93%8D%E4%BD%9C">13. Linuxå®ç”¨æ“ä½œ</a></li></ul><h2 id="1-Linuxçš„ç›®å½•ç»“æ„-ğŸ“"><a href="#1-Linuxçš„ç›®å½•ç»“æ„-ğŸ“" class="headerlink" title="1. Linuxçš„ç›®å½•ç»“æ„ ğŸ“"></a>1. Linuxçš„ç›®å½•ç»“æ„ ğŸ“</h2><h3 id="1-1-ç›®å½•ç»“æ„æ¦‚è¿°"><a href="#1-1-ç›®å½•ç»“æ„æ¦‚è¿°" class="headerlink" title="1.1 ç›®å½•ç»“æ„æ¦‚è¿°"></a>1.1 ç›®å½•ç»“æ„æ¦‚è¿°</h3><p>Linuxçš„ç›®å½•ç»“æ„æ˜¯ä¸€ä¸ªæ ‘å‹ç»“æ„ï¼š</p><ul><li><strong>Windowsç³»ç»Ÿ</strong>ï¼šå¯ä»¥æ‹¥æœ‰å¤šä¸ªç›˜ç¬¦ï¼Œå¦‚Cç›˜ã€Dç›˜ã€Eç›˜</li><li><strong>Linuxç³»ç»Ÿ</strong>ï¼šæ²¡æœ‰ç›˜ç¬¦æ¦‚å¿µï¼Œåªæœ‰ä¸€ä¸ªæ ¹ç›®å½• <code>/</code>ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨å®ƒä¸‹é¢</li></ul><p><img src="/images/linux/img.png" alt="Linuxç›®å½•ç»“æ„"></p><p><img src="/images/linux/img_1.png" alt="Linuxç›®å½•å±‚æ¬¡"></p><p><img src="/images/linux/img_2.png" alt="Linuxç›®å½•è¯¦è§£"></p><h2 id="2-Linuxå‘½ä»¤å…¥é—¨-ğŸ¯"><a href="#2-Linuxå‘½ä»¤å…¥é—¨-ğŸ¯" class="headerlink" title="2. Linuxå‘½ä»¤å…¥é—¨ ğŸ¯"></a>2. Linuxå‘½ä»¤å…¥é—¨ ğŸ¯</h2><h3 id="2-1-Linuxå‘½ä»¤åŸºç¡€æ ¼å¼"><a href="#2-1-Linuxå‘½ä»¤åŸºç¡€æ ¼å¼" class="headerlink" title="2.1 Linuxå‘½ä»¤åŸºç¡€æ ¼å¼"></a>2.1 Linuxå‘½ä»¤åŸºç¡€æ ¼å¼</h3><p>æ— è®ºæ˜¯ä»€ä¹ˆå‘½ä»¤ï¼Œç”¨äºä»€ä¹ˆç”¨é€”ï¼Œåœ¨Linuxä¸­ï¼Œå‘½ä»¤éƒ½æœ‰å…¶é€šç”¨çš„æ ¼å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> [-options] [parameter]</span><br></pre></td></tr></table></figure><p><strong>æ ¼å¼è¯´æ˜ï¼š</strong></p><ul><li><code>command</code>ï¼šå‘½ä»¤æœ¬èº«</li><li><code>-options</code>ï¼š[å¯é€‰ï¼Œéå¿…å¡«] å‘½ä»¤çš„ä¸€äº›é€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡é€‰é¡¹æ§åˆ¶å‘½ä»¤çš„è¡Œä¸ºç»†èŠ‚</li><li><code>parameter</code>ï¼š[å¯é€‰ï¼Œéå¿…å¡«] å‘½ä»¤çš„å‚æ•°ï¼Œå¤šæ•°ç”¨äºå‘½ä»¤çš„æŒ‡å‘ç›®æ ‡ç­‰</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šè¯­æ³•ä¸­çš„ <code>[]</code> è¡¨ç¤ºå¯é€‰çš„æ„æ€</p></blockquote><h3 id="2-2-lså‘½ä»¤-ğŸ“‹"><a href="#2-2-lså‘½ä»¤-ğŸ“‹" class="headerlink" title="2.2 lså‘½ä»¤ ğŸ“‹"></a>2.2 lså‘½ä»¤ ğŸ“‹</h3><p>lså‘½ä»¤çš„ä½œç”¨æ˜¯åˆ—å‡ºç›®å½•ä¸‹çš„å†…å®¹ï¼Œè¯­æ³•ç»†èŠ‚å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> [-a -l -h] [Linuxè·¯å¾„]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-a</code>ï¼šæ˜¾ç¤ºå…¨éƒ¨æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰</li><li><code>-l</code>ï¼šä»¥åˆ—è¡¨å½¢å¼æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</li><li><code>-h</code>ï¼šä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼ˆéœ€é…åˆ -l ä½¿ç”¨ï¼‰</li></ul><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>Linuxè·¯å¾„</code>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šè¦æŸ¥çœ‹çš„ç›®å½•è·¯å¾„</li></ul><p>å½“ä¸ä½¿ç”¨é€‰é¡¹å’Œå‚æ•°ï¼Œç›´æ¥ä½¿ç”¨lså‘½ä»¤æœ¬ä½“ï¼Œè¡¨ç¤ºï¼šä»¥å¹³é“ºå½¢å¼ï¼Œåˆ—å‡ºå½“å‰å·¥ä½œç›®å½•ä¸‹çš„å†…å®¹</p><p><img src="/images/linux/img_5.png" alt="lså‘½ä»¤ç¤ºä¾‹"></p><h3 id="2-3-HOMEç›®å½•æ¦‚å¿µ-ğŸ "><a href="#2-3-HOMEç›®å½•æ¦‚å¿µ-ğŸ " class="headerlink" title="2.3 HOMEç›®å½•æ¦‚å¿µ ğŸ "></a>2.3 HOMEç›®å½•æ¦‚å¿µ ğŸ </h3><p><strong>å½“å‰å·¥ä½œç›®å½•</strong>ï¼šLinuxç³»ç»Ÿçš„å‘½ä»¤è¡Œç»ˆç«¯åœ¨å¯åŠ¨æ—¶ï¼Œé»˜è®¤ä¼šåŠ è½½å½“å‰ç™»å½•ç”¨æˆ·çš„HOMEç›®å½•ä½œä¸ºå½“å‰å·¥ä½œç›®å½•ã€‚</p><p><strong>HOMEç›®å½•</strong>ï¼šæ¯ä¸ªLinuxæ“ä½œç”¨æˆ·åœ¨Linuxç³»ç»Ÿçš„ä¸ªäººè´¦æˆ·ç›®å½•ï¼Œè·¯å¾„åœ¨ï¼š<code>/home/ç”¨æˆ·å</code></p><p>ä¾‹å¦‚ï¼Œå›¾ä¸­çš„Linuxç”¨æˆ·æ˜¯<code>suoliang</code>ï¼Œå…¶HOMEç›®å½•æ˜¯ï¼š<code>/home/suoliang</code></p><p>Windowsç³»ç»Ÿå’ŒLinuxç³»ç»Ÿï¼Œå‡è®¾æœ‰ç”¨æˆ·çš„HOMEç›®å½•ï¼š</p><p><img src="/images/linux/img_6.png" alt="Windows HOMEç›®å½•"></p><p><img src="/images/linux/img_7.png" alt="Linux HOMEç›®å½•"></p><h3 id="2-4-lså‘½ä»¤çš„å‚æ•°ä½¿ç”¨"><a href="#2-4-lså‘½ä»¤çš„å‚æ•°ä½¿ç”¨" class="headerlink" title="2.4 lså‘½ä»¤çš„å‚æ•°ä½¿ç”¨"></a>2.4 lså‘½ä»¤çš„å‚æ•°ä½¿ç”¨</h3><p><strong>ä¸ä½¿ç”¨å‚æ•°</strong>ï¼šåˆ—å‡ºå½“å‰å·¥ä½œç›®å½•çš„å†…å®¹ï¼ˆå³ç”¨æˆ·çš„HOMEç›®å½•ï¼‰</p><p><strong>ä½¿ç”¨å‚æ•°</strong>ï¼šåˆ—å‡ºæŒ‡å®šè·¯å¾„çš„å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºæ ¹ç›®å½•çš„å†…å®¹</span></span><br><span class="line"><span class="built_in">ls</span> /</span><br></pre></td></tr></table></figure><p>é€šè¿‡ <code>ls /</code> åˆ—å‡ºäº†æ ¹ç›®å½•çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›¾å½¢ç•Œé¢ä¸­å¯¹ç…§æŸ¥çœ‹ï¼š</p><p><img src="/images/linux/img_9.png" alt="å‘½ä»¤è¡ŒæŸ¥çœ‹"></p><p><img src="/images/linux/img_10.png" alt="å›¾å½¢ç•Œé¢å¯¹ç…§"></p><h3 id="2-5-lså‘½ä»¤çš„é€‰é¡¹è¯¦è§£"><a href="#2-5-lså‘½ä»¤çš„é€‰é¡¹è¯¦è§£" class="headerlink" title="2.5 lså‘½ä»¤çš„é€‰é¡¹è¯¦è§£"></a>2.5 lså‘½ä»¤çš„é€‰é¡¹è¯¦è§£</h3><h4 id="a-é€‰é¡¹ï¼šæ˜¾ç¤ºå…¨éƒ¨æ–‡ä»¶"><a href="#a-é€‰é¡¹ï¼šæ˜¾ç¤ºå…¨éƒ¨æ–‡ä»¶" class="headerlink" title="-a é€‰é¡¹ï¼šæ˜¾ç¤ºå…¨éƒ¨æ–‡ä»¶"></a>-a é€‰é¡¹ï¼šæ˜¾ç¤ºå…¨éƒ¨æ–‡ä»¶</h4><p><code>-a</code> é€‰é¡¹è¡¨ç¤º <code>all</code> çš„æ„æ€ï¼Œå³åˆ—å‡ºå…¨éƒ¨æ–‡ä»¶ï¼ˆåŒ…å«éšè—çš„æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼‰</p><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>ls -a</code> å¯¹æ¯” <code>ls</code> åˆ—å‡ºçš„å†…å®¹æ›´å¤šäº†ã€‚å›¾ä¸­ä»¥ <code>.</code> å¼€å¤´çš„ï¼Œè¡¨ç¤ºæ˜¯Linuxç³»ç»Ÿçš„éšè—æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼ˆåªè¦ä»¥<code>.</code>å¼€å¤´ï¼Œå°±èƒ½è‡ªåŠ¨éšè—ï¼‰ï¼Œåªæœ‰é€šè¿‡ <code>-a</code> é€‰é¡¹ï¼Œæ‰èƒ½çœ‹åˆ°è¿™äº›éšè—çš„æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ã€‚</p><h4 id="l-é€‰é¡¹ï¼šåˆ—è¡¨å½¢å¼æ˜¾ç¤º"><a href="#l-é€‰é¡¹ï¼šåˆ—è¡¨å½¢å¼æ˜¾ç¤º" class="headerlink" title="-l é€‰é¡¹ï¼šåˆ—è¡¨å½¢å¼æ˜¾ç¤º"></a>-l é€‰é¡¹ï¼šåˆ—è¡¨å½¢å¼æ˜¾ç¤º</h4><p><code>-l</code> é€‰é¡¹è¡¨ç¤ºï¼šä»¥åˆ—è¡¨ï¼ˆç«–å‘æ’åˆ—ï¼‰çš„å½¢å¼å±•ç¤ºå†…å®¹ï¼Œå¹¶å±•ç¤ºæ›´å¤šä¿¡æ¯ã€‚<code>-l</code> é€‰é¡¹å…¶å®å’Œå›¾å½¢åŒ–ä¸­ï¼Œæ–‡ä»¶å¤¹ä»¥åˆ—è¡¨å½¢å¼æ’åˆ—æ˜¯ä¸€ä¸ªæ„æ€ã€‚</p><h4 id="é€‰é¡¹ç»„åˆä½¿ç”¨"><a href="#é€‰é¡¹ç»„åˆä½¿ç”¨" class="headerlink" title="é€‰é¡¹ç»„åˆä½¿ç”¨"></a>é€‰é¡¹ç»„åˆä½¿ç”¨</h4><p>è¯­æ³•ä¸­çš„é€‰é¡¹æ˜¯å¯ä»¥ç»„åˆä½¿ç”¨çš„ï¼Œæ¯”å¦‚ <code>-a</code> å’Œ <code>-l</code> å¯ä»¥ç»„åˆåº”ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»¥ä¸‹ä¸‰ç§å†™æ³•æ•ˆæœç›¸åŒ</span></span><br><span class="line"><span class="built_in">ls</span> -l -a</span><br><span class="line"><span class="built_in">ls</span> -la</span><br><span class="line"><span class="built_in">ls</span> -al</span><br></pre></td></tr></table></figure><h4 id="h-é€‰é¡¹ï¼šäººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å°"><a href="#h-é€‰é¡¹ï¼šäººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å°" class="headerlink" title="-h é€‰é¡¹ï¼šäººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å°"></a>-h é€‰é¡¹ï¼šäººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å°</h4><p><code>-h</code> è¡¨ç¤ºä»¥æ˜“äºé˜…è¯»çš„å½¢å¼ï¼Œåˆ—å‡ºæ–‡ä»¶å¤§å°ï¼Œå¦‚ Kã€Mã€G</p><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼š<code>-h</code> é€‰é¡¹å¿…é¡»è¦æ­é… <code>-l</code> ä¸€èµ·ä½¿ç”¨</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»¥äººæ€§åŒ–æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°</span></span><br><span class="line"><span class="built_in">ls</span> -lh</span><br></pre></td></tr></table></figure><h2 id="3-ç›®å½•åˆ‡æ¢ç›¸å…³å‘½ä»¤-ğŸ”€"><a href="#3-ç›®å½•åˆ‡æ¢ç›¸å…³å‘½ä»¤-ğŸ”€" class="headerlink" title="3. ç›®å½•åˆ‡æ¢ç›¸å…³å‘½ä»¤ ğŸ”€"></a>3. ç›®å½•åˆ‡æ¢ç›¸å…³å‘½ä»¤ ğŸ”€</h2><h3 id="3-1-cdå‘½ä»¤-Change-Directory"><a href="#3-1-cdå‘½ä»¤-Change-Directory" class="headerlink" title="3.1 cdå‘½ä»¤ - Change Directory"></a>3.1 cdå‘½ä»¤ - Change Directory</h3><p>å½“Linuxç»ˆç«¯ï¼ˆå‘½ä»¤è¡Œï¼‰æ‰“å¼€çš„æ—¶å€™ï¼Œä¼šé»˜è®¤ä»¥ç”¨æˆ·çš„HOMEç›®å½•ä½œä¸ºå½“å‰çš„å·¥ä½œç›®å½•ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>cd</code> å‘½ä»¤ï¼Œæ›´æ”¹å½“å‰æ‰€åœ¨çš„å·¥ä½œç›®å½•ã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> [Linuxè·¯å¾„]</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li><code>cd</code> å‘½ä»¤æ— éœ€é€‰é¡¹ï¼Œåªæœ‰å‚æ•°ï¼Œè¡¨ç¤ºè¦åˆ‡æ¢åˆ°å“ªä¸ªç›®å½•ä¸‹</li><li><code>cd</code> å‘½ä»¤ç›´æ¥æ‰§è¡Œï¼Œä¸å†™å‚æ•°ï¼Œè¡¨ç¤ºå›åˆ°ç”¨æˆ·çš„HOMEç›®å½•</li></ul><h3 id="3-2-pwdå‘½ä»¤-Print-Work-Directory"><a href="#3-2-pwdå‘½ä»¤-Print-Work-Directory" class="headerlink" title="3.2 pwdå‘½ä»¤ - Print Work Directory"></a>3.2 pwdå‘½ä»¤ - Print Work Directory</h3><p>é€šè¿‡ <code>ls</code> æ¥éªŒè¯å½“å‰çš„å·¥ä½œç›®å½•ï¼Œå…¶å®æ˜¯ä¸æ°å½“çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>pwd</code> å‘½ä»¤ï¼Œæ¥æŸ¥çœ‹å½“å‰æ‰€åœ¨çš„å·¥ä½œç›®å½•ã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li><code>pwd</code> å‘½ä»¤æ— é€‰é¡¹ï¼Œæ— å‚æ•°ï¼Œç›´æ¥è¾“å…¥ <code>pwd</code> å³å¯</li></ul><h2 id="4-ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„å’Œç‰¹æ®Šè·¯å¾„ç¬¦-ğŸ“‚"><a href="#4-ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„å’Œç‰¹æ®Šè·¯å¾„ç¬¦-ğŸ“‚" class="headerlink" title="4. ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„å’Œç‰¹æ®Šè·¯å¾„ç¬¦ ğŸ“‚"></a>4. ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„å’Œç‰¹æ®Šè·¯å¾„ç¬¦ ğŸ“‚</h2><h3 id="4-1-ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„"><a href="#4-1-ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„" class="headerlink" title="4.1 ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„"></a>4.1 ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„</h3><p>å¦‚å›¾ï¼Œé€šè¿‡ <code>pwd</code> å¾—çŸ¥å½“å‰æ‰€åœ¨æ˜¯HOMEç›®å½•ï¼š<code>/home/suoliang</code></p><p>ç°åœ¨æƒ³è¦é€šè¿‡ <code>cd</code> å‘½ä»¤ï¼Œåˆ‡æ¢å·¥ä½œç›®å½•åˆ° <code>Desktop</code> æ–‡ä»¶å¤¹ä¸­å»ï¼Œ<code>cd</code> å‘½ä»¤çš„å‚æ•°ï¼ˆLinuxè·¯å¾„ï¼‰å¦‚ä½•å†™å‘¢ï¼Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»å¯¹è·¯å¾„å†™æ³•</span></span><br><span class="line"><span class="built_in">cd</span> /home/suoliang/Desktop</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›¸å¯¹è·¯å¾„å†™æ³•</span></span><br><span class="line"><span class="built_in">cd</span> Desktop</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä¸¤ç§å†™æ³•ï¼Œéƒ½å¯ä»¥æ­£ç¡®çš„åˆ‡æ¢ç›®å½•åˆ°æŒ‡å®šçš„Desktopä¸­ã€‚</p><p><strong>è·¯å¾„ç±»å‹è¯´æ˜ï¼š</strong></p><ul><li><strong>ç»å¯¹è·¯å¾„</strong>ï¼šä»¥æ ¹ç›®å½•ä¸ºèµ·ç‚¹ï¼Œæè¿°è·¯å¾„çš„ä¸€ç§å†™æ³•ï¼Œè·¯å¾„æè¿°ä»¥ <code>/</code> å¼€å¤´</li><li><strong>ç›¸å¯¹è·¯å¾„</strong>ï¼šä»¥å½“å‰ç›®å½•ä¸ºèµ·ç‚¹ï¼Œæè¿°è·¯å¾„çš„ä¸€ç§å†™æ³•ï¼Œè·¯å¾„æè¿°æ— éœ€ä»¥ <code>/</code> å¼€å¤´</li></ul><h3 id="4-2-ç‰¹æ®Šè·¯å¾„ç¬¦"><a href="#4-2-ç‰¹æ®Šè·¯å¾„ç¬¦" class="headerlink" title="4.2 ç‰¹æ®Šè·¯å¾„ç¬¦"></a>4.2 ç‰¹æ®Šè·¯å¾„ç¬¦</h3><table><thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>.</code></td><td>å½“å‰ç›®å½•</td><td><code>cd ./Desktop</code> è¡¨ç¤ºåˆ‡æ¢åˆ°å½“å‰ç›®å½•ä¸‹çš„Desktopç›®å½•å†…ï¼Œå’Œ <code>cd Desktop</code> æ•ˆæœä¸€è‡´</td></tr><tr><td><code>..</code></td><td>ä¸Šä¸€çº§ç›®å½•</td><td><code>cd ..</code> å³å¯åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•ï¼Œ<code>cd ../..</code> åˆ‡æ¢åˆ°ä¸ŠäºŒçº§çš„ç›®å½•</td></tr><tr><td><code>~</code></td><td>HOMEç›®å½•</td><td><code>cd ~</code> å³å¯åˆ‡æ¢åˆ°HOMEç›®å½•æˆ– <code>cd ~/Desktop</code>ï¼Œåˆ‡æ¢åˆ°HOMEå†…çš„Desktopç›®å½•</td></tr></tbody></table><h2 id="5-åˆ›å»ºç›®å½•å‘½ä»¤-ğŸ“"><a href="#5-åˆ›å»ºç›®å½•å‘½ä»¤-ğŸ“" class="headerlink" title="5. åˆ›å»ºç›®å½•å‘½ä»¤ ğŸ“"></a>5. åˆ›å»ºç›®å½•å‘½ä»¤ ğŸ“</h2><h3 id="5-1-mkdirå‘½ä»¤-Make-Directory"><a href="#5-1-mkdirå‘½ä»¤-Make-Directory" class="headerlink" title="5.1 mkdirå‘½ä»¤ - Make Directory"></a>5.1 mkdirå‘½ä»¤ - Make Directory</h3><p>é€šè¿‡ <code>mkdir</code> å‘½ä»¤å¯ä»¥åˆ›å»ºæ–°çš„ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> [-p] Linuxè·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>Linuxè·¯å¾„</code>ï¼šå¿…å¡«ï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„å‡å¯</li><li><code>-p</code> é€‰é¡¹ï¼šå¯é€‰ï¼Œè¡¨ç¤ºè‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„çˆ¶ç›®å½•ï¼Œé€‚ç”¨äºåˆ›å»ºè¿ç»­å¤šå±‚çº§çš„ç›®å½•</li></ul><h3 id="5-2-mkdir-p-é€‰é¡¹ä½¿ç”¨"><a href="#5-2-mkdir-p-é€‰é¡¹ä½¿ç”¨" class="headerlink" title="5.2 mkdir -p é€‰é¡¹ä½¿ç”¨"></a>5.2 mkdir -p é€‰é¡¹ä½¿ç”¨</h3><p>å¦‚æœæƒ³è¦ä¸€æ¬¡æ€§åˆ›å»ºå¤šä¸ªå±‚çº§çš„ç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ä½¿ç”¨ -p é€‰é¡¹ä¼šæŠ¥é”™</span></span><br><span class="line">[suoliang@chad ~]$ <span class="built_in">mkdir</span> <span class="built_in">test</span>/test</span><br><span class="line"><span class="built_in">mkdir</span>: cannot create directory <span class="string">&#x27;test/test&#x27;</span>: No such file or directory</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ -p é€‰é¡¹å¯ä»¥æˆåŠŸåˆ›å»º</span></span><br><span class="line">[suoliang@chad ~]$ <span class="built_in">mkdir</span> -p <span class="built_in">test</span>/test</span><br></pre></td></tr></table></figure><p>ä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸Šçº§ç›®å½• <code>test</code> å¹¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æ— æ³•åˆ›å»º <code>test/test</code> ç›®å½•ã€‚å¯ä»¥é€šè¿‡ <code>-p</code> é€‰é¡¹ï¼Œå°†ä¸€æ•´ä¸ªé“¾æ¡éƒ½åˆ›å»ºå®Œæˆã€‚</p><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šåˆ›å»ºæ–‡ä»¶å¤¹éœ€è¦ä¿®æ”¹æƒé™ï¼Œè¯·ç¡®ä¿æ“ä½œå‡åœ¨HOMEç›®å½•å†…ï¼Œä¸è¦åœ¨HOMEå¤–æ“ä½œã€‚æ¶‰åŠåˆ°æƒé™é—®é¢˜ï¼ŒHOMEå¤–æ— æ³•æˆåŠŸï¼ˆåç»­æˆ‘ä»¬ä¼šè®²è§£æƒé™ç®¡æ§çš„çŸ¥è¯†ï¼‰</p></blockquote><h2 id="6-æ–‡ä»¶æ“ä½œå‘½ä»¤Part1-ğŸ“„"><a href="#6-æ–‡ä»¶æ“ä½œå‘½ä»¤Part1-ğŸ“„" class="headerlink" title="6. æ–‡ä»¶æ“ä½œå‘½ä»¤Part1 ğŸ“„"></a>6. æ–‡ä»¶æ“ä½œå‘½ä»¤Part1 ğŸ“„</h2><h3 id="6-1-touchå‘½ä»¤-åˆ›å»ºæ–‡ä»¶"><a href="#6-1-touchå‘½ä»¤-åˆ›å»ºæ–‡ä»¶" class="headerlink" title="6.1 touchå‘½ä»¤ - åˆ›å»ºæ–‡ä»¶"></a>6.1 touchå‘½ä»¤ - åˆ›å»ºæ–‡ä»¶</h3><p>å¯ä»¥é€šè¿‡ <code>touch</code> å‘½ä»¤åˆ›å»ºæ–‡ä»¶</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> Linuxè·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li><code>touch</code> å‘½ä»¤æ— é€‰é¡¹ï¼Œå‚æ•°å¿…å¡«</li><li>å‚æ•°è¡¨ç¤ºï¼šè¦åˆ›å»ºçš„æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ã€ç»å¯¹ã€ç‰¹æ®Šè·¯å¾„ç¬¦å‡å¯ä»¥ä½¿ç”¨</li></ul><h3 id="6-2-catå‘½ä»¤-æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#6-2-catå‘½ä»¤-æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="6.2 catå‘½ä»¤ - æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>6.2 catå‘½ä»¤ - æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h3><p>æœ‰äº†æ–‡ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>cat</code> å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> Linuxè·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li><code>cat</code> åŒæ ·æ²¡æœ‰é€‰é¡¹ï¼Œåªæœ‰å¿…å¡«å‚æ•°</li><li>å‚æ•°è¡¨ç¤ºï¼šè¢«æŸ¥çœ‹çš„æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ã€ç»å¯¹ã€ç‰¹æ®Šè·¯å¾„ç¬¦éƒ½å¯ä»¥ä½¿ç”¨</li></ul><h3 id="6-3-moreå‘½ä»¤-ç¿»é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#6-3-moreå‘½ä»¤-ç¿»é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="6.3 moreå‘½ä»¤ - ç¿»é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>6.3 moreå‘½ä»¤ - ç¿»é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹</h3><p><code>more</code> å‘½ä»¤åŒæ ·å¯ä»¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼ŒåŒ <code>cat</code> ä¸åŒçš„æ˜¯ï¼š</p><ul><li><code>cat</code> æ˜¯ç›´æ¥å°†å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥</li><li><code>more</code> æ”¯æŒç¿»é¡µï¼Œå¦‚æœæ–‡ä»¶å†…å®¹è¿‡å¤šï¼Œå¯ä»¥ä¸€é¡µé¡µçš„å±•ç¤º</li></ul><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more Linuxè·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li>åŒæ ·æ²¡æœ‰é€‰é¡¹ï¼Œåªæœ‰å¿…å¡«å‚æ•°</li><li>å‚æ•°è¡¨ç¤ºï¼šè¢«æŸ¥çœ‹çš„æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ã€ç»å¯¹ã€ç‰¹æ®Šè·¯å¾„ç¬¦éƒ½å¯ä»¥ä½¿ç”¨</li></ul><p><strong>æ“ä½œç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç³»ç»Ÿå†…ç½®æ–‡ä»¶</span></span><br><span class="line">more /etc/services</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ“ä½œï¼š</strong></p><ul><li>é€šè¿‡ <code>ç©ºæ ¼</code> ç¿»é¡µ</li><li>é€šè¿‡ <code>q</code> é€€å‡ºæŸ¥çœ‹</li></ul><h2 id="7-æ–‡ä»¶æ“ä½œå‘½ä»¤Part2-ğŸ”§"><a href="#7-æ–‡ä»¶æ“ä½œå‘½ä»¤Part2-ğŸ”§" class="headerlink" title="7. æ–‡ä»¶æ“ä½œå‘½ä»¤Part2 ğŸ”§"></a>7. æ–‡ä»¶æ“ä½œå‘½ä»¤Part2 ğŸ”§</h2><h3 id="7-1-cpå‘½ä»¤-å¤åˆ¶æ–‡ä»¶-æ–‡ä»¶å¤¹"><a href="#7-1-cpå‘½ä»¤-å¤åˆ¶æ–‡ä»¶-æ–‡ä»¶å¤¹" class="headerlink" title="7.1 cpå‘½ä»¤ - å¤åˆ¶æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹"></a>7.1 cpå‘½ä»¤ - å¤åˆ¶æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹</h3><p><code>cp</code> å‘½ä»¤å¯ä»¥ç”¨äºå¤åˆ¶æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼Œæ¥è‡ªè‹±æ–‡å•è¯ï¼šcopy</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> [-r] å‚æ•°1 å‚æ•°2</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>-r</code> é€‰é¡¹ï¼šå¯é€‰ï¼Œç”¨äºå¤åˆ¶æ–‡ä»¶å¤¹ä½¿ç”¨ï¼Œè¡¨ç¤ºé€’å½’</li><li><code>å‚æ•°1</code>ï¼šLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¢«å¤åˆ¶çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</li><li><code>å‚æ•°2</code>ï¼šLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¦å¤åˆ¶å»çš„åœ°æ–¹</li></ul><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šå¤åˆ¶æ–‡ä»¶å¤¹ï¼Œå¿…é¡»ä½¿ç”¨ <code>-r</code> é€‰é¡¹ï¼Œå¦åˆ™ä¸ä¼šç”Ÿæ•ˆ</p></blockquote><h3 id="7-2-mvå‘½ä»¤-ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹"><a href="#7-2-mvå‘½ä»¤-ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹" class="headerlink" title="7.2 mvå‘½ä»¤ - ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹"></a>7.2 mvå‘½ä»¤ - ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</h3><p><code>mv</code> å‘½ä»¤å¯ä»¥ç”¨äºç§»åŠ¨æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼Œæ¥è‡ªè‹±æ–‡å•è¯ï¼šmove</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> å‚æ•°1 å‚æ•°2</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>å‚æ•°1</code>ï¼šLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¢«ç§»åŠ¨çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</li><li><code>å‚æ•°2</code>ï¼šLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¦ç§»åŠ¨å»çš„åœ°æ–¹</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå¦‚æœç›®æ ‡ä¸å­˜åœ¨ï¼Œåˆ™è¿›è¡Œæ”¹åï¼Œç¡®ä¿ç›®æ ‡å­˜åœ¨ã€‚ç›®æ ‡ä¸å­˜åœ¨ï¼Œåˆ™æœ‰æ”¹åçš„æ•ˆæœ</p></blockquote><h3 id="7-3-rmå‘½ä»¤-åˆ é™¤æ–‡ä»¶-æ–‡ä»¶å¤¹"><a href="#7-3-rmå‘½ä»¤-åˆ é™¤æ–‡ä»¶-æ–‡ä»¶å¤¹" class="headerlink" title="7.3 rmå‘½ä»¤ - åˆ é™¤æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹"></a>7.3 rmå‘½ä»¤ - åˆ é™¤æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹</h3><p><code>rm</code> å‘½ä»¤å¯ç”¨äºåˆ é™¤æ–‡ä»¶ã€æ–‡ä»¶å¤¹ï¼Œæ¥è‡ªè‹±æ–‡å•è¯ï¼šremove</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> [-r -f] å‚æ•°1 å‚æ•°2 ... å‚æ•°N</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-r</code> é€‰é¡¹ï¼šç”¨äºåˆ é™¤æ–‡ä»¶å¤¹ï¼ˆåŒcpå‘½ä»¤ä¸€æ ·ï¼‰</li><li><code>-f</code> é€‰é¡¹ï¼šè¡¨ç¤ºforceï¼Œå¼ºåˆ¶åˆ é™¤ï¼ˆä¸ä¼šå¼¹å‡ºæç¤ºç¡®è®¤ä¿¡æ¯ï¼‰</li></ul><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>å‚æ•°1ã€å‚æ•°2ã€...ã€å‚æ•°N</code>ï¼šè¡¨ç¤ºè¦åˆ é™¤çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹è·¯å¾„ï¼ŒæŒ‰ç…§ç©ºæ ¼éš”å¼€</li></ul><blockquote><p>âš ï¸ <strong>é‡è¦æç¤º</strong>ï¼š</p><ul><li>æ™®é€šç”¨æˆ·åˆ é™¤å†…å®¹ä¸ä¼šå¼¹å‡ºæç¤ºï¼Œåªæœ‰rootç®¡ç†å‘˜ç”¨æˆ·åˆ é™¤å†…å®¹ä¼šæœ‰æç¤º</li><li>æ‰€ä»¥ä¸€èˆ¬æ™®é€šç”¨æˆ·ç”¨ä¸åˆ° <code>-f</code> é€‰é¡¹</li><li>åˆ é™¤æ–‡ä»¶å¤¹ï¼Œå¿…é¡»ä½¿ç”¨ <code>-r</code> é€‰é¡¹æ‰å¯ä»¥</li></ul></blockquote><h3 id="7-4-rmå‘½ä»¤çš„é€šé…ç¬¦"><a href="#7-4-rmå‘½ä»¤çš„é€šé…ç¬¦" class="headerlink" title="7.4 rmå‘½ä»¤çš„é€šé…ç¬¦"></a>7.4 rmå‘½ä»¤çš„é€šé…ç¬¦</h3><p><code>rm</code> å‘½ä»¤æ”¯æŒé€šé…ç¬¦ <code>*</code>ï¼Œç”¨æ¥åšæ¨¡ç³ŠåŒ¹é…</p><p><strong>é€šé…ç¬¦ç¤ºä¾‹ï¼š</strong></p><ul><li><code>test*</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»ä½•ä»¥ <code>test</code> å¼€å¤´çš„å†…å®¹</li><li><code>*test</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»ä½•ä»¥ <code>test</code> ç»“å°¾çš„å†…å®¹</li><li><code>*test*</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»ä½•åŒ…å« <code>test</code> çš„å†…å®¹</li></ul><h3 id="7-5-å±é™©å‘½ä»¤è­¦å‘Š-âš ï¸"><a href="#7-5-å±é™©å‘½ä»¤è­¦å‘Š-âš ï¸" class="headerlink" title="7.5 å±é™©å‘½ä»¤è­¦å‘Š âš ï¸"></a>7.5 å±é™©å‘½ä»¤è­¦å‘Š âš ï¸</h3><p><code>rm</code> æ˜¯ä¸€ä¸ªå±é™©çš„å‘½ä»¤ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„äºrootï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰ç”¨æˆ·çš„æ—¶å€™ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p><blockquote><p>ğŸš¨ <strong>ä¸¥é‡è­¦å‘Š</strong>ï¼šå¦‚ä¸‹å‘½ä»¤ï¼Œè¯·åƒä¸‡åƒä¸‡ä¸è¦åœ¨rootç®¡ç†å‘˜ç”¨æˆ·ä¸‹æ‰§è¡Œï¼</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /</span><br><span class="line"><span class="built_in">rm</span> -rf /*</span><br></pre></td></tr></table></figure><p>æ•ˆæœç­‰åŒäºåœ¨Windowsä¸Šæ‰§è¡ŒCç›˜æ ¼å¼åŒ–ã€‚</p><blockquote><p>PSï¼šä½ å¿ƒé‡Œç—’ç—’å°±åœ¨è™šæ‹Ÿæœºè¯•è¯•å§ï¼Œå¤§ä¸äº†æ¢å¤å¿«ç…§æˆ–è€…é‡æ–°è£…ä¸ªè™šæ‹Ÿæœºå“¦ ğŸ˜ˆ</p></blockquote><h2 id="8-æŸ¥æ‰¾å‘½ä»¤-ğŸ”"><a href="#8-æŸ¥æ‰¾å‘½ä»¤-ğŸ”" class="headerlink" title="8. æŸ¥æ‰¾å‘½ä»¤ ğŸ”"></a>8. æŸ¥æ‰¾å‘½ä»¤ ğŸ”</h2><h3 id="8-1-whichå‘½ä»¤-æŸ¥æ‰¾å‘½ä»¤ç¨‹åº"><a href="#8-1-whichå‘½ä»¤-æŸ¥æ‰¾å‘½ä»¤ç¨‹åº" class="headerlink" title="8.1 whichå‘½ä»¤ - æŸ¥æ‰¾å‘½ä»¤ç¨‹åº"></a>8.1 whichå‘½ä»¤ - æŸ¥æ‰¾å‘½ä»¤ç¨‹åº</h3><p>æˆ‘ä»¬åœ¨å‰é¢å­¦ä¹ çš„Linuxå‘½ä»¤ï¼Œå…¶å®å®ƒä»¬çš„æœ¬ä½“å°±æ˜¯ä¸€ä¸ªä¸ªçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œç¨‹åºï¼Œå’ŒWindowsç³»ç»Ÿä¸­çš„ <code>.exe</code> æ–‡ä»¶æ˜¯ä¸€ä¸ªæ„æ€ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>which</code> å‘½ä»¤ï¼ŒæŸ¥çœ‹æ‰€ä½¿ç”¨çš„ä¸€ç³»åˆ—å‘½ä»¤çš„ç¨‹åºæ–‡ä»¶å­˜æ”¾åœ¨å“ªé‡Œ</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> å‘½ä»¤åç§°</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">which</span> <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">which</span> <span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><h3 id="8-2-findå‘½ä»¤-æŒ‰æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶"><a href="#8-2-findå‘½ä»¤-æŒ‰æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶" class="headerlink" title="8.2 findå‘½ä»¤ - æŒ‰æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶"></a>8.2 findå‘½ä»¤ - æŒ‰æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶</h3><p>åœ¨å›¾å½¢åŒ–ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„é€šè¿‡ç³»ç»Ÿæä¾›çš„æœç´¢åŠŸèƒ½ï¼Œæœç´¢æŒ‡å®šçš„æ–‡ä»¶ã€‚åŒæ ·ï¼Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>find</code> å‘½ä»¤å»æœç´¢æŒ‡å®šçš„æ–‡ä»¶ã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find èµ·å§‹è·¯å¾„ -name <span class="string">&quot;æ–‡ä»¶å&quot;</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><p>ä¸ºäº†ç¡®ä¿åç»­æ¼”ç¤ºï¼Œæ‹¥æœ‰æœ€å¤§çš„æƒé™ï¼Œå¯ä»¥åœ¨æ•´ä¸ªç³»ç»Ÿå®Œæˆæœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ°rootç”¨æˆ·ä»¥è·å¾—ç®¡ç†å‘˜æƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°rootç”¨æˆ·</span></span><br><span class="line">su - root</span><br><span class="line"><span class="comment"># è¾“å…¥å¯†ç </span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šæŸ¥æ‰¾æ–‡ä»¶åå«åštestçš„æ–‡ä»¶</strong></p><p><img src="/images/linux/img_24.png" alt="findå‘½ä»¤ç¤ºä¾‹"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»æ ¹ç›®å½•å¼€å§‹æœç´¢åä¸ºtestçš„æ–‡ä»¶</span></span><br><span class="line">find / -name <span class="string">&quot;test&quot;</span></span><br></pre></td></tr></table></figure><h3 id="8-3-findå‘½ä»¤çš„é€šé…ç¬¦"><a href="#8-3-findå‘½ä»¤çš„é€šé…ç¬¦" class="headerlink" title="8.3 findå‘½ä»¤çš„é€šé…ç¬¦"></a>8.3 findå‘½ä»¤çš„é€šé…ç¬¦</h3><p>è¢«æŸ¥æ‰¾æ–‡ä»¶åï¼Œæ”¯æŒä½¿ç”¨é€šé…ç¬¦ <code>*</code> æ¥åšæ¨¡ç³ŠæŸ¥è¯¢ï¼š</p><p><strong>é€šé…ç¬¦å«ä¹‰ï¼š</strong></p><ul><li><code>test*</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»ä½•ä»¥ <code>test</code> å¼€å¤´çš„å†…å®¹</li><li><code>*test</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»ä½•ä»¥ <code>test</code> ç»“å°¾çš„å†…å®¹</li><li><code>*test*</code>ï¼šè¡¨ç¤ºåŒ¹é…ä»»ä½•åŒ…å« <code>test</code> çš„å†…å®¹</li></ul><p>åŸºäºé€šé…ç¬¦çš„å«ä¹‰ï¼Œå¯ä»¥ç»“åˆ <code>find</code> å‘½ä»¤åšæ–‡ä»¶çš„æ¨¡ç³ŠæŸ¥è¯¢ã€‚</p><h3 id="8-4-findå‘½ä»¤-æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾"><a href="#8-4-findå‘½ä»¤-æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾" class="headerlink" title="8.4 findå‘½ä»¤ - æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾"></a>8.4 findå‘½ä»¤ - æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾</h3><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find èµ·å§‹è·¯å¾„ -size +|-n[kMG]</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>+</code>ã€<code>-</code> è¡¨ç¤ºå¤§äºå’Œå°äº</li><li><code>n</code> è¡¨ç¤ºå¤§å°æ•°å­—</li><li><code>kMG</code> è¡¨ç¤ºå¤§å°å•ä½ï¼š<ul><li><code>k</code> (å°å†™å­—æ¯) è¡¨ç¤º KB</li><li><code>M</code> è¡¨ç¤º MB</li><li><code>G</code> è¡¨ç¤º GB</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾å°äº10KBçš„æ–‡ä»¶</span></span><br><span class="line">find / -size -10k</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾å¤§äº100MBçš„æ–‡ä»¶</span></span><br><span class="line">find / -size +100M</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾å¤§äº1GBçš„æ–‡ä»¶</span></span><br><span class="line">find / -size +1G</span><br></pre></td></tr></table></figure><h2 id="9-grepã€wcå’Œç®¡é“ç¬¦-ğŸ”§"><a href="#9-grepã€wcå’Œç®¡é“ç¬¦-ğŸ”§" class="headerlink" title="9. grepã€wcå’Œç®¡é“ç¬¦ ğŸ”§"></a>9. grepã€wcå’Œç®¡é“ç¬¦ ğŸ”§</h2><h3 id="9-1-grepå‘½ä»¤-è¿‡æ»¤æ–‡ä»¶å†…å®¹"><a href="#9-1-grepå‘½ä»¤-è¿‡æ»¤æ–‡ä»¶å†…å®¹" class="headerlink" title="9.1 grepå‘½ä»¤ - è¿‡æ»¤æ–‡ä»¶å†…å®¹"></a>9.1 grepå‘½ä»¤ - è¿‡æ»¤æ–‡ä»¶å†…å®¹</h3><p>å¯ä»¥é€šè¿‡ <code>grep</code> å‘½ä»¤ï¼Œä»æ–‡ä»¶ä¸­é€šè¿‡å…³é”®å­—è¿‡æ»¤æ–‡ä»¶è¡Œ</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep [-n] å…³é”®å­— æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>-n</code> é€‰é¡¹ï¼šå¯é€‰ï¼Œè¡¨ç¤ºåœ¨ç»“æœä¸­æ˜¾ç¤ºåŒ¹é…çš„è¡Œçš„è¡Œå·</li><li><code>å…³é”®å­—</code>ï¼šå¿…å¡«ï¼Œè¡¨ç¤ºè¿‡æ»¤çš„å…³é”®å­—ï¼Œå¸¦æœ‰ç©ºæ ¼æˆ–å…¶å®ƒç‰¹æ®Šç¬¦å·ï¼Œå»ºè®®ä½¿ç”¨ <code>&quot;&quot;</code> å°†å…³é”®å­—åŒ…å›´èµ·æ¥</li><li><code>æ–‡ä»¶è·¯å¾„</code>ï¼šå¿…å¡«ï¼Œè¡¨ç¤ºè¦è¿‡æ»¤å†…å®¹çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯ä½œä¸ºå†…å®¹è¾“å…¥ç«¯å£</li></ul><h3 id="9-2-wcå‘½ä»¤-ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯"><a href="#9-2-wcå‘½ä»¤-ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="9.2 wcå‘½ä»¤ - ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯"></a>9.2 wcå‘½ä»¤ - ç»Ÿè®¡æ–‡ä»¶ä¿¡æ¯</h3><p>å¯ä»¥é€šè¿‡ <code>wc</code> å‘½ä»¤ç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•°ã€å•è¯æ•°é‡ç­‰</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wc</span> [-c -m -l -w] æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-c</code>ï¼šç»Ÿè®¡ bytes æ•°é‡</li><li><code>-m</code>ï¼šç»Ÿè®¡å­—ç¬¦æ•°é‡</li><li><code>-l</code>ï¼šç»Ÿè®¡è¡Œæ•°</li><li><code>-w</code>ï¼šç»Ÿè®¡å•è¯æ•°é‡</li></ul><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>æ–‡ä»¶è·¯å¾„</code>ï¼šè¢«ç»Ÿè®¡çš„æ–‡ä»¶ï¼Œå¯ä½œä¸ºå†…å®¹è¾“å…¥ç«¯å£</li></ul><h3 id="9-3-ç®¡é“ç¬¦"><a href="#9-3-ç®¡é“ç¬¦" class="headerlink" title="9.3 ç®¡é“ç¬¦ |"></a>9.3 ç®¡é“ç¬¦ |</h3><p>å­¦ä¹ äº† <code>grep</code> å‘½ä»¤åï¼Œæˆ‘ä»¬åœ¨æ¥å­¦ä¹ ä¸€ä¸ªæ–°çš„ç‰¹æ®Šç¬¦å·ï¼Œç®¡é“ç¬¦ï¼š<code>|</code></p><p><strong>ç®¡é“ç¬¦çš„å«ä¹‰ï¼š</strong> å°†ç®¡é“ç¬¦å·¦è¾¹å‘½ä»¤çš„ç»“æœï¼Œä½œä¸ºå³è¾¹å‘½ä»¤çš„è¾“å…¥</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæµ‹è¯•æ–‡ä»¶</span></span><br><span class="line">[root@chad ~]# vim test.text</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç®¡é“ç¬¦è¿‡æ»¤</span></span><br><span class="line">[root@chad ~]# <span class="built_in">cat</span> test.text | grep chad</span><br><span class="line">chad</span><br></pre></td></tr></table></figure><p><code>cat test.text</code> çš„è¾“å‡ºç»“æœï¼ˆæ–‡ä»¶å†…å®¹ï¼‰ä½œä¸ºå³è¾¹ <code>grep</code> å‘½ä»¤çš„è¾“å…¥ï¼ˆè¢«è¿‡æ»¤æ–‡ä»¶ï¼‰</p><h3 id="9-4-ç®¡é“ç¬¦çš„åº”ç”¨"><a href="#9-4-ç®¡é“ç¬¦çš„åº”ç”¨" class="headerlink" title="9.4 ç®¡é“ç¬¦çš„åº”ç”¨"></a>9.4 ç®¡é“ç¬¦çš„åº”ç”¨</h3><p>ç®¡é“ç¬¦çš„åº”ç”¨éå¸¸å¤šï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿‡æ»¤lsçš„ç»“æœ</span></span><br><span class="line"><span class="built_in">ls</span> | grep Desktop</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿‡æ»¤findç»“æœï¼Œåªæ‰¾è·¯å¾„å¸¦æœ‰/usr/lib64çš„ç»“æœ</span></span><br><span class="line">find / -name <span class="string">&quot;test&quot;</span> | grep <span class="string">&quot;/usr/lib64&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥åµŒå¥—ä½¿ç”¨</span></span><br><span class="line"><span class="built_in">cat</span> itheima.txt | grep itcast | grep itheima</span><br></pre></td></tr></table></figure><h2 id="10-echoã€tailå’Œé‡å®šå‘ç¬¦-ğŸ“¤"><a href="#10-echoã€tailå’Œé‡å®šå‘ç¬¦-ğŸ“¤" class="headerlink" title="10. echoã€tailå’Œé‡å®šå‘ç¬¦ ğŸ“¤"></a>10. echoã€tailå’Œé‡å®šå‘ç¬¦ ğŸ“¤</h2><h3 id="10-1-echoå‘½ä»¤-è¾“å‡ºå†…å®¹"><a href="#10-1-echoå‘½ä»¤-è¾“å‡ºå†…å®¹" class="headerlink" title="10.1 echoå‘½ä»¤ - è¾“å‡ºå†…å®¹"></a>10.1 echoå‘½ä»¤ - è¾“å‡ºå†…å®¹</h3><p>å¯ä»¥ä½¿ç”¨ <code>echo</code> å‘½ä»¤åœ¨å‘½ä»¤è¡Œå†…è¾“å‡ºæŒ‡å®šå†…å®¹</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> è¾“å‡ºçš„å†…å®¹</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li>æ— éœ€é€‰é¡¹ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè¦è¾“å‡ºçš„å†…å®¹</li><li>å¤æ‚å†…å®¹å¯ä»¥ç”¨ <code>&quot;&quot;</code> åŒ…å›´</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºï¼šHello Linux</span></span><br><span class="line">[root@chad ~]# <span class="built_in">echo</span> hello.java</span><br><span class="line">hello.java</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå¸¦æœ‰ç©ºæ ¼æˆ– <code>\</code> ç­‰ç‰¹æ®Šç¬¦å·ï¼Œå»ºè®®ä½¿ç”¨åŒå¼•å·åŒ…å›´ã€‚å› ä¸ºä¸åŒ…å›´çš„è¯ï¼Œç©ºæ ¼åå¾ˆå®¹æ˜“è¢«è¯†åˆ«ä¸ºå‚æ•°2</p></blockquote><h3 id="10-2-echoå‘½ä»¤ä¸åå¼•å·"><a href="#10-2-echoå‘½ä»¤ä¸åå¼•å·" class="headerlink" title="10.2 echoå‘½ä»¤ä¸åå¼•å·"></a>10.2 echoå‘½ä»¤ä¸åå¼•å·</h3><p>çœ‹ä¸€ä¸‹å¦‚ä¸‹å‘½ä»¤ï¼š<code>echo pwd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@chad ~]# <span class="built_in">echo</span> <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><p>æœ¬æ„æ˜¯æƒ³è¾“å‡ºå½“å‰çš„å·¥ä½œè·¯å¾„ï¼Œä½†æ˜¯ <code>pwd</code> è¢«ä½œä¸ºæ™®é€šå­—ç¬¦è¾“å‡ºäº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å‘½ä»¤ç”¨åå¼•å·ï¼ˆé€šå¸¸ä¹Ÿç§°ä¹‹ä¸ºé£˜å·ï¼‰<code>`</code> å°†å…¶åŒ…å›´ï¼Œè¢« <code>`</code> åŒ…å›´çš„å†…å®¹ï¼Œä¼šè¢«ä½œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œè€Œéæ™®é€šå­—ç¬¦ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@chad ~]# <span class="built_in">echo</span> `<span class="built_in">pwd</span>`</span><br><span class="line">/root</span><br></pre></td></tr></table></figure><h3 id="10-3-é‡å®šå‘ç¬¦"><a href="#10-3-é‡å®šå‘ç¬¦" class="headerlink" title="10.3 é‡å®šå‘ç¬¦"></a>10.3 é‡å®šå‘ç¬¦</h3><p>æˆ‘ä»¬å†æ¥å­¦ä¹ ä¸¤ä¸ªç‰¹æ®Šç¬¦å·ï¼Œé‡å®šå‘ç¬¦ï¼š<code>&gt;</code> å’Œ <code>&gt;&gt;</code></p><p><strong>ç¬¦å·è¯´æ˜ï¼š</strong></p><ul><li><code>&gt;</code>ï¼šå°†å·¦ä¾§å‘½ä»¤çš„ç»“æœï¼Œè¦†ç›–å†™å…¥åˆ°ç¬¦å·å³ä¾§æŒ‡å®šçš„æ–‡ä»¶ä¸­</li><li><code>&gt;&gt;</code>ï¼šå°†å·¦ä¾§å‘½ä»¤çš„ç»“æœï¼Œè¿½åŠ å†™å…¥åˆ°ç¬¦å·å³ä¾§æŒ‡å®šçš„æ–‡ä»¶ä¸­</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¦†ç›–å†™å…¥</span></span><br><span class="line">[root@chad ~]# <span class="built_in">echo</span> suolll &gt; test.text </span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿½åŠ å†™å…¥</span></span><br><span class="line">[root@chad ~]# <span class="built_in">echo</span> suolll &gt;&gt; test.text</span><br></pre></td></tr></table></figure><h3 id="10-4-tailå‘½ä»¤-æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨"><a href="#10-4-tailå‘½ä»¤-æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨" class="headerlink" title="10.4 tailå‘½ä»¤ - æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨"></a>10.4 tailå‘½ä»¤ - æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨</h3><p>ä½¿ç”¨ <code>tail</code> å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨å†…å®¹ï¼Œè·Ÿè¸ªæ–‡ä»¶çš„æœ€æ–°æ›´æ”¹</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> [-f -num] Linuxè·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>Linuxè·¯å¾„</code>ï¼šè¡¨ç¤ºè¢«è·Ÿè¸ªçš„æ–‡ä»¶è·¯å¾„</li><li><code>-f</code> é€‰é¡¹ï¼šè¡¨ç¤ºæŒç»­è·Ÿè¸ª</li><li><code>-num</code> é€‰é¡¹ï¼šè¡¨ç¤ºæŸ¥çœ‹å°¾éƒ¨å¤šå°‘è¡Œï¼Œä¸å¡«é»˜è®¤10è¡Œ</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶çš„å°¾éƒ¨10è¡Œ</span></span><br><span class="line"><span class="built_in">tail</span> /var/log/vmware-network.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶çš„å°¾éƒ¨3è¡Œ</span></span><br><span class="line"><span class="built_in">tail</span> -3 /var/log/vmware-network.log</span><br></pre></td></tr></table></figure><h3 id="10-5-tailæŒç»­è·Ÿè¸ªæ–‡ä»¶æ›´æ”¹"><a href="#10-5-tailæŒç»­è·Ÿè¸ªæ–‡ä»¶æ›´æ”¹" class="headerlink" title="10.5 tailæŒç»­è·Ÿè¸ªæ–‡ä»¶æ›´æ”¹"></a>10.5 tailæŒç»­è·Ÿè¸ªæ–‡ä»¶æ›´æ”¹</h3><p>ä½¿ç”¨ <code>-f</code> é€‰é¡¹ï¼Œå¯ä»¥æŒç»­è·Ÿè¸ªæ–‡ä»¶æ›´æ”¹ï¼š</p><p><strong>æ“ä½œæ­¥éª¤ï¼š</strong></p><ol><li>åœ¨ç¬¬ä¸€ä¸ªæ ‡ç­¾ä¸­ï¼Œæ‰§è¡Œï¼š<code>touch test.txt</code>ï¼Œåˆ›å»ºä¸€ä¸ªtest.txtæ–‡ä»¶</li><li>åœ¨ç¬¬ä¸€ä¸ªæ ‡ç­¾ä¸­ï¼Œæ‰§è¡Œï¼š<code>tail -f test.txt</code>ï¼ŒæŒç»­è·Ÿè¸ªæ–‡ä»¶æ›´æ”¹</li><li>åœ¨ç¬¬äºŒä¸ªæ ‡ç­¾ä¸­ï¼Œå¤šæ¬¡æ‰§è¡Œï¼š<code>echo &quot;å†…å®¹&quot; &gt;&gt; test.txt</code>ï¼Œå‘æ–‡ä»¶è¿½åŠ å†…å®¹</li></ol><h2 id="11-viç¼–è¾‘å™¨-âœï¸"><a href="#11-viç¼–è¾‘å™¨-âœï¸" class="headerlink" title="11. viç¼–è¾‘å™¨ âœï¸"></a>11. viç¼–è¾‘å™¨ âœï¸</h2><h3 id="11-1-vi-vimç¼–è¾‘å™¨ä»‹ç»"><a href="#11-1-vi-vimç¼–è¾‘å™¨ä»‹ç»" class="headerlink" title="11.1 vi&#x2F;vimç¼–è¾‘å™¨ä»‹ç»"></a>11.1 vi&#x2F;vimç¼–è¾‘å™¨ä»‹ç»</h3><p><code>vi/vim</code> æ˜¯ visual interface çš„ç®€ç§°ï¼Œæ˜¯Linuxä¸­æœ€ç»å…¸çš„æ–‡æœ¬ç¼–è¾‘å™¨</p><ul><li>åŒå›¾å½¢åŒ–ç•Œé¢ä¸­çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸€æ ·ï¼Œ<code>vi</code> æ˜¯å‘½ä»¤è¡Œä¸‹å¯¹æ–‡æœ¬æ–‡ä»¶è¿›è¡Œç¼–è¾‘çš„ç»ä½³é€‰æ‹©</li><li><code>vim</code> æ˜¯ <code>vi</code> çš„åŠ å¼ºç‰ˆæœ¬ï¼Œå…¼å®¹ <code>vi</code> çš„æ‰€æœ‰æŒ‡ä»¤</li><li><code>vim</code> ä¸ä»…èƒ½ç¼–è¾‘æ–‡æœ¬ï¼Œè€Œä¸”è¿˜å…·æœ‰ shell ç¨‹åºç¼–è¾‘çš„åŠŸèƒ½</li><li>å¯ä»¥ç”¨ä¸åŒé¢œè‰²çš„å­—ä½“æ¥è¾¨åˆ«è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œæå¤§æ–¹ä¾¿äº†ç¨‹åºçš„è®¾è®¡å’Œç¼–è¾‘</li></ul><h3 id="11-2-vi-vimç¼–è¾‘å™¨çš„ä¸‰ç§å·¥ä½œæ¨¡å¼"><a href="#11-2-vi-vimç¼–è¾‘å™¨çš„ä¸‰ç§å·¥ä½œæ¨¡å¼" class="headerlink" title="11.2 vi&#x2F;vimç¼–è¾‘å™¨çš„ä¸‰ç§å·¥ä½œæ¨¡å¼"></a>11.2 vi&#x2F;vimç¼–è¾‘å™¨çš„ä¸‰ç§å·¥ä½œæ¨¡å¼</h3><p><img src="/images/linux/img_29.png" alt="viç¼–è¾‘å™¨å·¥ä½œæ¨¡å¼"></p><h4 id="å‘½ä»¤æ¨¡å¼ï¼ˆCommand-modeï¼‰"><a href="#å‘½ä»¤æ¨¡å¼ï¼ˆCommand-modeï¼‰" class="headerlink" title="å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰"></a>å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰</h4><ul><li>å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œæ‰€æ•²çš„æŒ‰é”®ç¼–è¾‘å™¨éƒ½ç†è§£ä¸ºå‘½ä»¤ï¼Œä»¥å‘½ä»¤é©±åŠ¨æ‰§è¡Œä¸åŒçš„åŠŸèƒ½</li><li>æ­¤æ¨¡å¼ä¸‹ï¼Œä¸èƒ½è‡ªç”±è¿›è¡Œæ–‡æœ¬ç¼–è¾‘</li></ul><h4 id="è¾“å…¥æ¨¡å¼ï¼ˆInsert-modeï¼‰"><a href="#è¾“å…¥æ¨¡å¼ï¼ˆInsert-modeï¼‰" class="headerlink" title="è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰"></a>è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰</h4><ul><li>ä¹Ÿå°±æ˜¯æ‰€è°“çš„ç¼–è¾‘æ¨¡å¼ã€æ’å…¥æ¨¡å¼</li><li>æ­¤æ¨¡å¼ä¸‹ï¼Œå¯ä»¥å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œè‡ªç”±ç¼–è¾‘</li></ul><h4 id="åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast-line-modeï¼‰"><a href="#åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast-line-modeï¼‰" class="headerlink" title="åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰"></a>åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰</h4><ul><li>ä»¥ <code>:</code> å¼€å§‹ï¼Œé€šå¸¸ç”¨äºæ–‡ä»¶çš„ä¿å­˜ã€é€€å‡º</li></ul><h3 id="11-3-ä½¿ç”¨vi-vimç¼–è¾‘å™¨"><a href="#11-3-ä½¿ç”¨vi-vimç¼–è¾‘å™¨" class="headerlink" title="11.3 ä½¿ç”¨vi&#x2F;vimç¼–è¾‘å™¨"></a>11.3 ä½¿ç”¨vi&#x2F;vimç¼–è¾‘å™¨</h3><p>å¦‚æœéœ€è¦é€šè¿‡ <code>vi/vim</code> ç¼–è¾‘å™¨ç¼–è¾‘æ–‡ä»¶ï¼Œè¯·é€šè¿‡å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vimå…¼å®¹å…¨éƒ¨çš„viåŠŸèƒ½ï¼Œåç»­å…¨éƒ¨ä½¿ç”¨vimå‘½ä»¤</span></span><br><span class="line">vim æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li>å¦‚æœæ–‡ä»¶è·¯å¾„è¡¨ç¤ºçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæ­¤å‘½ä»¤ä¼šç”¨äºç¼–è¾‘æ–°æ–‡ä»¶</li><li>å¦‚æœæ–‡ä»¶è·¯å¾„è¡¨ç¤ºçš„æ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆæ­¤å‘½ä»¤ç”¨äºç¼–è¾‘å·²æœ‰æ–‡ä»¶</li></ul><h3 id="11-4-å‘½ä»¤æ¨¡å¼"><a href="#11-4-å‘½ä»¤æ¨¡å¼" class="headerlink" title="11.4 å‘½ä»¤æ¨¡å¼"></a>11.4 å‘½ä»¤æ¨¡å¼</h3><p>é€šè¿‡ <code>vi/vim</code> å‘½ä»¤ç¼–è¾‘æ–‡ä»¶ï¼Œä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£ï¼Œæ­¤æ—¶è¿™ä¸ªçª—å£å°±æ˜¯ï¼š<strong>å‘½ä»¤æ¨¡å¼çª—å£</strong></p><p><img src="/images/linux/img_30.png" alt="å‘½ä»¤æ¨¡å¼"></p><p><strong>æ¨¡å¼åˆ‡æ¢ï¼š</strong></p><ul><li>å‘½ä»¤æ¨¡å¼æ˜¯viç¼–è¾‘å™¨çš„å…¥å£å’Œå‡ºå£</li><li>è¿›å…¥viç¼–è¾‘å™¨ä¼šè¿›å…¥å‘½ä»¤æ¨¡å¼</li><li>é€šè¿‡å‘½ä»¤æ¨¡å¼è¾“å…¥é”®ç›˜æŒ‡ä»¤ï¼Œå¯ä»¥è¿›å…¥è¾“å…¥æ¨¡å¼</li><li>è¾“å…¥æ¨¡å¼éœ€è¦é€€å›åˆ°å‘½ä»¤æ¨¡å¼ï¼Œç„¶åé€šè¿‡å‘½ä»¤å¯ä»¥è¿›å…¥åº•çº¿å‘½ä»¤æ¨¡å¼</li></ul><h3 id="11-5-å‘½ä»¤æ¨¡å¼å¿«æ·é”®"><a href="#11-5-å‘½ä»¤æ¨¡å¼å¿«æ·é”®" class="headerlink" title="11.5 å‘½ä»¤æ¨¡å¼å¿«æ·é”®"></a>11.5 å‘½ä»¤æ¨¡å¼å¿«æ·é”®</h3><h4 id="å¸¸ç”¨ç§»åŠ¨å‘½ä»¤"><a href="#å¸¸ç”¨ç§»åŠ¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨ç§»åŠ¨å‘½ä»¤"></a>å¸¸ç”¨ç§»åŠ¨å‘½ä»¤</h4><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>h</code></td><td>å·¦ç§»å…‰æ ‡</td></tr><tr><td><code>j</code></td><td>ä¸‹ç§»å…‰æ ‡</td></tr><tr><td><code>k</code></td><td>ä¸Šç§»å…‰æ ‡</td></tr><tr><td><code>l</code></td><td>å³ç§»å…‰æ ‡</td></tr><tr><td><code>0</code> æˆ– <code>Home</code></td><td>ç§»åŠ¨åˆ°è¡Œé¦–</td></tr><tr><td><code>$</code> æˆ– <code>End</code></td><td>ç§»åŠ¨åˆ°è¡Œå°¾</td></tr><tr><td><code>gg</code></td><td>ç§»åŠ¨åˆ°æ–‡ä»¶å¼€å¤´</td></tr><tr><td><code>G</code></td><td>ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾</td></tr></tbody></table><h4 id="å¸¸ç”¨ç¼–è¾‘å‘½ä»¤"><a href="#å¸¸ç”¨ç¼–è¾‘å‘½ä»¤" class="headerlink" title="å¸¸ç”¨ç¼–è¾‘å‘½ä»¤"></a>å¸¸ç”¨ç¼–è¾‘å‘½ä»¤</h4><p><img src="/images/linux/img_34.png" alt="å‘½ä»¤æ¨¡å¼å¿«æ·é”®1"></p><p><img src="/images/linux/img_35.png" alt="å‘½ä»¤æ¨¡å¼å¿«æ·é”®2"></p><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>i</code></td><td>åœ¨å…‰æ ‡å‰æ’å…¥</td></tr><tr><td><code>a</code></td><td>åœ¨å…‰æ ‡åæ’å…¥</td></tr><tr><td><code>o</code></td><td>åœ¨å½“å‰è¡Œä¸‹æ–¹æ’å…¥æ–°è¡Œ</td></tr><tr><td><code>O</code></td><td>åœ¨å½“å‰è¡Œä¸Šæ–¹æ’å…¥æ–°è¡Œ</td></tr><tr><td><code>dd</code></td><td>åˆ é™¤å½“å‰è¡Œ</td></tr><tr><td><code>yy</code></td><td>å¤åˆ¶å½“å‰è¡Œ</td></tr><tr><td><code>p</code></td><td>ç²˜è´´</td></tr><tr><td><code>u</code></td><td>æ’¤é”€</td></tr><tr><td><code>Ctrl + r</code></td><td>é‡åš</td></tr></tbody></table><h3 id="11-6-åº•çº¿å‘½ä»¤æ¨¡å¼"><a href="#11-6-åº•çº¿å‘½ä»¤æ¨¡å¼" class="headerlink" title="11.6 åº•çº¿å‘½ä»¤æ¨¡å¼"></a>11.6 åº•çº¿å‘½ä»¤æ¨¡å¼</h3><p>ç¼–è¾‘æ¨¡å¼æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼åï¼Œä»»ä½•å¿«æ·é”®éƒ½æ²¡æœ‰ä½œç”¨ï¼Œå°±æ˜¯æ­£å¸¸è¾“å…¥æ–‡æœ¬è€Œå·²ã€‚</p><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå”¯ä¸€å¤§å®¶éœ€è¦è®°ä½çš„ï¼Œå°±æ˜¯é€šè¿‡ <code>Esc</code>ï¼Œå¯ä»¥é€€å›åˆ°å‘½ä»¤æ¨¡å¼ä¸­å³å¯</p></blockquote><p>åœ¨å‘½ä»¤æ¨¡å¼å†…ï¼Œè¾“å…¥ <code>:</code>ï¼Œå³å¯è¿›å…¥åº•çº¿å‘½ä»¤æ¨¡å¼ï¼Œæ”¯æŒå¦‚ä¸‹å‘½ä»¤ï¼š</p><p><img src="/images/linux/img_36.png" alt="åº•çº¿å‘½ä»¤æ¨¡å¼"></p><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>:w</code></td><td>ä¿å­˜æ–‡ä»¶</td></tr><tr><td><code>:q</code></td><td>é€€å‡ºç¼–è¾‘å™¨</td></tr><tr><td><code>:wq</code></td><td>ä¿å­˜å¹¶é€€å‡º</td></tr><tr><td><code>:q!</code></td><td>å¼ºåˆ¶é€€å‡ºï¼Œä¸ä¿å­˜</td></tr><tr><td><code>:set nu</code></td><td>æ˜¾ç¤ºè¡Œå·</td></tr><tr><td><code>:set nonu</code></td><td>å–æ¶ˆè¡Œå·æ˜¾ç¤º</td></tr><tr><td><code>:/å…³é”®å­—</code></td><td>æœç´¢å…³é”®å­—</td></tr></tbody></table><h2 id="ğŸ“-è¡¥å……è¯´æ˜"><a href="#ğŸ“-è¡¥å……è¯´æ˜" class="headerlink" title="ğŸ“ è¡¥å……è¯´æ˜"></a>ğŸ“ è¡¥å……è¯´æ˜</h2><h3 id="å…³äºå‘½ä»¤é€‰é¡¹"><a href="#å…³äºå‘½ä»¤é€‰é¡¹" class="headerlink" title="å…³äºå‘½ä»¤é€‰é¡¹"></a>å…³äºå‘½ä»¤é€‰é¡¹</h3><p>æˆ‘ä»¬å­¦ä¹ çš„ä¸€ç³»åˆ—Linuxå‘½ä»¤ï¼Œå®ƒä»¬æ‰€æ‹¥æœ‰çš„é€‰é¡¹éƒ½æ˜¯éå¸¸å¤šçš„ã€‚</p><p>æ¯”å¦‚ï¼Œç®€å•çš„ <code>ls</code> å‘½ä»¤å°±æœ‰ï¼š<br><code>-a -A -b -c -C -d -D -f -F -g -G -h -H -i -I -k -l -L -m -n -N -o -p -q -Q -r -R -s -S -t -T -u -U -v -w -x -X -1</code> ç­‰é€‰é¡¹ï¼Œå¯ä»¥å‘ç°é€‰é¡¹æ˜¯æå…¶å¤šçš„ã€‚</p><blockquote><p>ğŸ’¡ <strong>å­¦ä¹ å»ºè®®</strong>ï¼šä¸éœ€è¦è®°ä½æ‰€æœ‰é€‰é¡¹ï¼Œåªéœ€è¦æŒæ¡å¸¸ç”¨çš„å³å¯ã€‚éœ€è¦æ—¶å¯ä»¥é€šè¿‡ <code>man å‘½ä»¤å</code> æˆ– <code>å‘½ä»¤å --help</code> æŸ¥çœ‹å®Œæ•´çš„é€‰é¡¹åˆ—è¡¨ã€‚</p></blockquote><h2 id="12-Linuxç”¨æˆ·å’Œæƒé™ç®¡ç†-ğŸ‘¥"><a href="#12-Linuxç”¨æˆ·å’Œæƒé™ç®¡ç†-ğŸ‘¥" class="headerlink" title="12. Linuxç”¨æˆ·å’Œæƒé™ç®¡ç† ğŸ‘¥"></a>12. Linuxç”¨æˆ·å’Œæƒé™ç®¡ç† ğŸ‘¥</h2><h3 id="12-1-rootç”¨æˆ·ï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰"><a href="#12-1-rootç”¨æˆ·ï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰" class="headerlink" title="12.1 rootç”¨æˆ·ï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰"></a>12.1 rootç”¨æˆ·ï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰</h3><h4 id="ä»€ä¹ˆæ˜¯rootç”¨æˆ·"><a href="#ä»€ä¹ˆæ˜¯rootç”¨æˆ·" class="headerlink" title="ä»€ä¹ˆæ˜¯rootç”¨æˆ·"></a>ä»€ä¹ˆæ˜¯rootç”¨æˆ·</h4><p>æ— è®ºæ˜¯Windowsã€MacOSã€Linuxå‡é‡‡ç”¨å¤šç”¨æˆ·çš„ç®¡ç†æ¨¡å¼è¿›è¡Œæƒé™ç®¡ç†ã€‚</p><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œæ‹¥æœ‰æœ€å¤§æƒé™çš„è´¦æˆ·åä¸ºï¼š<strong>rootï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰</strong></p><p><strong>ç”¨æˆ·æƒé™å¯¹æ¯”ï¼š</strong></p><ul><li><strong>rootç”¨æˆ·</strong>ï¼šæ‹¥æœ‰æœ€å¤§çš„ç³»ç»Ÿæ“ä½œæƒé™</li><li><strong>æ™®é€šç”¨æˆ·</strong>ï¼šåœ¨è®¸å¤šåœ°æ–¹çš„æƒé™æ˜¯å—é™çš„</li></ul><p><img src="/images/linux/img_37.png" alt="rootç”¨æˆ·ç¤ºæ„"></p><h4 id="æ™®é€šç”¨æˆ·ä¸rootç”¨æˆ·æƒé™å¯¹æ¯”"><a href="#æ™®é€šç”¨æˆ·ä¸rootç”¨æˆ·æƒé™å¯¹æ¯”" class="headerlink" title="æ™®é€šç”¨æˆ·ä¸rootç”¨æˆ·æƒé™å¯¹æ¯”"></a>æ™®é€šç”¨æˆ·ä¸rootç”¨æˆ·æƒé™å¯¹æ¯”</h4><p><strong>ä½¿ç”¨æ™®é€šç”¨æˆ·åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">test</span>@chad /]$ <span class="built_in">mkdir</span> testMkDir</span><br><span class="line"><span class="built_in">mkdir</span>: cannot create directory <span class="string">&#x27;testMkDir&#x27;</span>: Permission denied</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_38.png" alt="æ™®é€šç”¨æˆ·æƒé™å—é™"></p><p><strong>åˆ‡æ¢åˆ°rootç”¨æˆ·åï¼Œç»§ç»­å°è¯•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">test</span>@chad /]$ su root</span><br><span class="line">[root@chad /]# <span class="built_in">mkdir</span> testMkDIr</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_39.png" alt="rootç”¨æˆ·æƒé™"></p><blockquote><p>ğŸ’¡ <strong>æƒé™è¯´æ˜</strong>ï¼š</p><ul><li>æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œä¸€èˆ¬åœ¨å…¶HOMEç›®å½•å†…æ˜¯ä¸å—é™çš„</li><li>ä¸€æ—¦å‡ºäº†HOMEç›®å½•ï¼Œå¤§å¤šæ•°åœ°æ–¹ï¼Œæ™®é€šç”¨æˆ·ä»…æœ‰åªè¯»å’Œæ‰§è¡Œæƒé™ï¼Œæ— ä¿®æ”¹æƒé™</li></ul></blockquote><h3 id="12-2-suå‘½ä»¤-ç”¨æˆ·åˆ‡æ¢"><a href="#12-2-suå‘½ä»¤-ç”¨æˆ·åˆ‡æ¢" class="headerlink" title="12.2 suå‘½ä»¤ - ç”¨æˆ·åˆ‡æ¢"></a>12.2 suå‘½ä»¤ - ç”¨æˆ·åˆ‡æ¢</h3><p><code>su</code> å‘½ä»¤ç”¨äºè´¦æˆ·åˆ‡æ¢ï¼Œæ¥è‡ªè‹±æ–‡å•è¯ï¼š<strong>Switch User</strong></p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su [-] [ç”¨æˆ·å]</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>-</code> ç¬¦å·ï¼šå¯é€‰ï¼Œè¡¨ç¤ºæ˜¯å¦åœ¨åˆ‡æ¢ç”¨æˆ·ååŠ è½½ç¯å¢ƒå˜é‡ï¼Œå»ºè®®å¸¦ä¸Š</li><li><code>ç”¨æˆ·å</code>ï¼šè¡¨ç¤ºè¦åˆ‡æ¢çš„ç”¨æˆ·ï¼Œå¯ä»¥çœç•¥ï¼Œçœç•¥è¡¨ç¤ºåˆ‡æ¢åˆ°root</li></ul><p><strong>é€€å‡ºå½“å‰ç”¨æˆ·ï¼š</strong></p><ul><li>ä½¿ç”¨ <code>exit</code> å‘½ä»¤é€€å›ä¸Šä¸€ä¸ªç”¨æˆ·</li><li>ä½¿ç”¨å¿«æ·é”® <code>Ctrl + D</code> é€€å›ä¸Šä¸€ä¸ªç”¨æˆ·</li></ul><p><strong>æƒé™è¯´æ˜ï¼š</strong></p><ul><li>ä½¿ç”¨æ™®é€šç”¨æˆ·åˆ‡æ¢åˆ°å…¶å®ƒç”¨æˆ·éœ€è¦è¾“å…¥å¯†ç </li><li>ä½¿ç”¨rootç”¨æˆ·åˆ‡æ¢åˆ°å…¶å®ƒç”¨æˆ·ï¼Œæ— éœ€å¯†ç </li></ul><blockquote><p>âš ï¸ <strong>é‡è¦æç¤º</strong>ï¼šè™½ç„¶å¯ä»¥é€šè¿‡suå‘½ä»¤åˆ‡æ¢åˆ°rootå¾—åˆ°æœ€å¤§æƒé™ï¼Œä½†ä¸å»ºè®®é•¿æœŸä½¿ç”¨rootç”¨æˆ·ï¼Œé¿å…å¸¦æ¥ç³»ç»ŸæŸå</p></blockquote><h3 id="12-3-sudoå‘½ä»¤-ä¸´æ—¶æˆæƒ"><a href="#12-3-sudoå‘½ä»¤-ä¸´æ—¶æˆæƒ" class="headerlink" title="12.3 sudoå‘½ä»¤ - ä¸´æ—¶æˆæƒ"></a>12.3 sudoå‘½ä»¤ - ä¸´æ—¶æˆæƒ</h3><p><code>sudo</code> å‘½ä»¤å¯ä»¥ä¸ºæ™®é€šå‘½ä»¤æˆæƒï¼Œä¸´æ—¶ä»¥rootèº«ä»½æ‰§è¡Œã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> å…¶ä»–å‘½ä»¤</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li>åœ¨å‘½ä»¤ä¹‹å‰åŠ ä¸Š <code>sudo</code>ï¼Œå³å¯ä¸ºè¿™æ¡å‘½ä»¤ä¸´æ—¶èµ‹äºˆrootæˆæƒ</li><li>å¹¶éæ‰€æœ‰ç”¨æˆ·éƒ½æœ‰æƒä½¿ç”¨sudoï¼Œéœ€è¦ä¸ºæ™®é€šç”¨æˆ·é…ç½®sudoè®¤è¯</li></ul><h4 id="é…ç½®sudoè®¤è¯"><a href="#é…ç½®sudoè®¤è¯" class="headerlink" title="é…ç½®sudoè®¤è¯"></a>é…ç½®sudoè®¤è¯</h4><p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p><ol><li>åˆ‡æ¢åˆ°rootç”¨æˆ·</li><li>æ‰§è¡Œ <code>visudo</code> å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨é€šè¿‡viç¼–è¾‘å™¨æ‰“å¼€ <code>/etc/sudoers</code> æ–‡ä»¶</li><li>åœ¨æ–‡ä»¶çš„æœ€åæ·»åŠ é…ç½®</li></ol><p><img src="/images/linux/img_40.png" alt="é…ç½®sudoè®¤è¯"></p><p><strong>é…ç½®ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·å ALL=(ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>NOPASSWD:ALL</code> è¡¨ç¤ºä½¿ç”¨sudoå‘½ä»¤æ— éœ€è¾“å…¥å¯†ç </p><ol start="4"><li>é€šè¿‡ <code>:wq</code> ä¿å­˜é€€å‡º</li><li>åˆ‡æ¢å›æ™®é€šç”¨æˆ·</li></ol><p><img src="/images/linux/img_41.png" alt="sudoå‘½ä»¤ä½¿ç”¨"></p><p>é…ç½®å®Œæˆåï¼Œæ‰§è¡Œçš„å‘½ä»¤å‡ä»¥rootæƒé™è¿è¡Œã€‚</p><h3 id="12-4-ç”¨æˆ·å’Œç”¨æˆ·ç»„æ¦‚å¿µ"><a href="#12-4-ç”¨æˆ·å’Œç”¨æˆ·ç»„æ¦‚å¿µ" class="headerlink" title="12.4 ç”¨æˆ·å’Œç”¨æˆ·ç»„æ¦‚å¿µ"></a>12.4 ç”¨æˆ·å’Œç”¨æˆ·ç»„æ¦‚å¿µ</h3><h4 id="ç”¨æˆ·ã€ç”¨æˆ·ç»„çš„å…³ç³»"><a href="#ç”¨æˆ·ã€ç”¨æˆ·ç»„çš„å…³ç³»" class="headerlink" title="ç”¨æˆ·ã€ç”¨æˆ·ç»„çš„å…³ç³»"></a>ç”¨æˆ·ã€ç”¨æˆ·ç»„çš„å…³ç³»</h4><p>Linuxç³»ç»Ÿä¸­å¯ä»¥ï¼š</p><ul><li>é…ç½®å¤šä¸ªç”¨æˆ·</li><li>é…ç½®å¤šä¸ªç”¨æˆ·ç»„</li><li>ç”¨æˆ·å¯ä»¥åŠ å…¥å¤šä¸ªç”¨æˆ·ç»„ä¸­</li></ul><p><img src="/images/linux/img_42.png" alt="ç”¨æˆ·å’Œç”¨æˆ·ç»„å…³ç³»"></p><h4 id="æƒé™ç®¡æ§çº§åˆ«"><a href="#æƒé™ç®¡æ§çº§åˆ«" class="headerlink" title="æƒé™ç®¡æ§çº§åˆ«"></a>æƒé™ç®¡æ§çº§åˆ«</h4><p>Linuxä¸­å…³äºæƒé™çš„ç®¡æ§çº§åˆ«æœ‰2ä¸ªçº§åˆ«ï¼š</p><ol><li><strong>é’ˆå¯¹ç”¨æˆ·çš„æƒé™æ§åˆ¶</strong></li><li><strong>é’ˆå¯¹ç”¨æˆ·ç»„çš„æƒé™æ§åˆ¶</strong></li></ol><p>æ¯”å¦‚ï¼Œé’ˆå¯¹æŸæ–‡ä»¶ï¼Œå¯ä»¥æ§åˆ¶ç”¨æˆ·çš„æƒé™ï¼Œä¹Ÿå¯ä»¥æ§åˆ¶ç”¨æˆ·ç»„çš„æƒé™ã€‚</p><h3 id="12-5-ç”¨æˆ·ç»„ç®¡ç†å‘½ä»¤"><a href="#12-5-ç”¨æˆ·ç»„ç®¡ç†å‘½ä»¤" class="headerlink" title="12.5 ç”¨æˆ·ç»„ç®¡ç†å‘½ä»¤"></a>12.5 ç”¨æˆ·ç»„ç®¡ç†å‘½ä»¤</h3><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šä»¥ä¸‹å‘½ä»¤éœ€è¦rootç”¨æˆ·æ‰§è¡Œ</p></blockquote><h4 id="åˆ›å»ºç”¨æˆ·ç»„"><a href="#åˆ›å»ºç”¨æˆ·ç»„" class="headerlink" title="åˆ›å»ºç”¨æˆ·ç»„"></a>åˆ›å»ºç”¨æˆ·ç»„</h4><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd ç”¨æˆ·ç»„å</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªåä¸ºitcastçš„ç”¨æˆ·ç»„</span></span><br><span class="line">groupadd itcast</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤ç”¨æˆ·ç»„"><a href="#åˆ é™¤ç”¨æˆ·ç»„" class="headerlink" title="åˆ é™¤ç”¨æˆ·ç»„"></a>åˆ é™¤ç”¨æˆ·ç»„</h4><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel ç”¨æˆ·ç»„å</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤itcastç”¨æˆ·ç»„</span></span><br><span class="line">groupdel itcast</span><br></pre></td></tr></table></figure><h3 id="12-6-ç”¨æˆ·ç®¡ç†å‘½ä»¤"><a href="#12-6-ç”¨æˆ·ç®¡ç†å‘½ä»¤" class="headerlink" title="12.6 ç”¨æˆ·ç®¡ç†å‘½ä»¤"></a>12.6 ç”¨æˆ·ç®¡ç†å‘½ä»¤</h3><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šä»¥ä¸‹å‘½ä»¤éœ€è¦rootç”¨æˆ·æ‰§è¡Œ</p></blockquote><h4 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="headerlink" title="åˆ›å»ºç”¨æˆ·"></a>åˆ›å»ºç”¨æˆ·</h4><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd [-g -d] ç”¨æˆ·å</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-g</code>ï¼šæŒ‡å®šç”¨æˆ·çš„ç»„<ul><li>ä¸æŒ‡å®š-gï¼šä¼šåˆ›å»ºåŒåç»„å¹¶è‡ªåŠ¨åŠ å…¥</li><li>æŒ‡å®š-gï¼šéœ€è¦ç»„å·²ç»å­˜åœ¨</li><li>å¦‚å·²å­˜åœ¨åŒåç»„ï¼Œå¿…é¡»ä½¿ç”¨-g</li></ul></li><li><code>-d</code>ï¼šæŒ‡å®šç”¨æˆ·HOMEè·¯å¾„<ul><li>ä¸æŒ‡å®šï¼šHOMEç›®å½•é»˜è®¤åœ¨ <code>/home/ç”¨æˆ·å</code></li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·ï¼Œè‡ªåŠ¨åˆ›å»ºåŒåç”¨æˆ·ç»„</span></span><br><span class="line">useradd testuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·å¹¶æŒ‡å®šç”¨æˆ·ç»„</span></span><br><span class="line">useradd -g itcast testuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·å¹¶æŒ‡å®šHOMEç›®å½•</span></span><br><span class="line">useradd -d /home/myuser testuser</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤ç”¨æˆ·"><a href="#åˆ é™¤ç”¨æˆ·" class="headerlink" title="åˆ é™¤ç”¨æˆ·"></a>åˆ é™¤ç”¨æˆ·</h4><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel [-r] ç”¨æˆ·å</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-r</code>ï¼šåˆ é™¤ç”¨æˆ·çš„HOMEç›®å½•</li><li>ä¸ä½¿ç”¨-rï¼šåˆ é™¤ç”¨æˆ·æ—¶ï¼ŒHOMEç›®å½•ä¿ç•™</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤ç”¨æˆ·ä½†ä¿ç•™HOMEç›®å½•</span></span><br><span class="line">userdel testuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ç”¨æˆ·åŒæ—¶åˆ é™¤HOMEç›®å½•</span></span><br><span class="line">userdel -r testuser</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ç”¨æˆ·æ‰€å±ç»„"><a href="#æŸ¥çœ‹ç”¨æˆ·æ‰€å±ç»„" class="headerlink" title="æŸ¥çœ‹ç”¨æˆ·æ‰€å±ç»„"></a>æŸ¥çœ‹ç”¨æˆ·æ‰€å±ç»„</h4><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">id</span> [ç”¨æˆ·å]</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>ç”¨æˆ·å</code>ï¼šè¢«æŸ¥çœ‹çš„ç”¨æˆ·ï¼Œå¦‚æœä¸æä¾›åˆ™æŸ¥çœ‹è‡ªèº«</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŒ‡å®šç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">id</span> root</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹ç”¨æˆ·æ‰€å±ç»„"><a href="#ä¿®æ”¹ç”¨æˆ·æ‰€å±ç»„" class="headerlink" title="ä¿®æ”¹ç”¨æˆ·æ‰€å±ç»„"></a>ä¿®æ”¹ç”¨æˆ·æ‰€å±ç»„</h4><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -aG ç”¨æˆ·ç»„ ç”¨æˆ·å</span><br></pre></td></tr></table></figure><p>**åŠŸèƒ½è¯´æ˜ï¼š**å°†æŒ‡å®šç”¨æˆ·åŠ å…¥æŒ‡å®šç”¨æˆ·ç»„</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†testuserç”¨æˆ·åŠ å…¥itcastç”¨æˆ·ç»„</span></span><br><span class="line">usermod -aG itcast testuser</span><br></pre></td></tr></table></figure><h3 id="12-7-getentå‘½ä»¤-æŸ¥çœ‹ç”¨æˆ·å’Œç»„ä¿¡æ¯"><a href="#12-7-getentå‘½ä»¤-æŸ¥çœ‹ç”¨æˆ·å’Œç»„ä¿¡æ¯" class="headerlink" title="12.7 getentå‘½ä»¤ - æŸ¥çœ‹ç”¨æˆ·å’Œç»„ä¿¡æ¯"></a>12.7 getentå‘½ä»¤ - æŸ¥çœ‹ç”¨æˆ·å’Œç»„ä¿¡æ¯</h3><h4 id="æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·"><a href="#æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·"></a>æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·</h4><p>ä½¿ç”¨ <code>getent</code> å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æœ‰å“ªäº›ç”¨æˆ·</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getent passwd</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_43.png" alt="æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·"></p><p><strong>ä¿¡æ¯æ ¼å¼è¯´æ˜ï¼ˆå…±7ä»½ä¿¡æ¯ï¼‰ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·å:å¯†ç (x):ç”¨æˆ·ID:ç»„ID:æè¿°ä¿¡æ¯:HOMEç›®å½•:æ‰§è¡Œç»ˆç«¯</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ç»„"><a href="#æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ç»„" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ç»„"></a>æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ç»„</h4><p>åŒæ ·å¯ä»¥ä½¿ç”¨ <code>getent</code> å‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æœ‰å“ªäº›ç”¨æˆ·ç»„</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getent group</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_44.png" alt="æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ç»„"></p><p><strong>ä¿¡æ¯æ ¼å¼è¯´æ˜ï¼ˆå…±3ä»½ä¿¡æ¯ï¼‰ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç»„åç§°:ç»„è®¤è¯(æ˜¾ç¤ºä¸ºx):ç»„ID</span><br></pre></td></tr></table></figure><h3 id="12-8-æŸ¥çœ‹æƒé™æ§åˆ¶ä¿¡æ¯"><a href="#12-8-æŸ¥çœ‹æƒé™æ§åˆ¶ä¿¡æ¯" class="headerlink" title="12.8 æŸ¥çœ‹æƒé™æ§åˆ¶ä¿¡æ¯"></a>12.8 æŸ¥çœ‹æƒé™æ§åˆ¶ä¿¡æ¯</h3><h4 id="ä½¿ç”¨ls-læŸ¥çœ‹æƒé™"><a href="#ä½¿ç”¨ls-læŸ¥çœ‹æƒé™" class="headerlink" title="ä½¿ç”¨ls -læŸ¥çœ‹æƒé™"></a>ä½¿ç”¨ls -læŸ¥çœ‹æƒé™</h4><p>é€šè¿‡ <code>ls -l</code> å¯ä»¥ä»¥åˆ—è¡¨å½¢å¼æŸ¥çœ‹å†…å®¹ï¼Œå¹¶æ˜¾ç¤ºæƒé™ç»†èŠ‚</p><p><img src="/images/linux/img_45.png" alt="æƒé™ä¿¡æ¯æ˜¾ç¤º"></p><p><strong>ä¿¡æ¯è¯´æ˜ï¼š</strong></p><ul><li><strong>åºå·1</strong>ï¼šæ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æƒé™æ§åˆ¶ä¿¡æ¯</li><li><strong>åºå·2</strong>ï¼šæ–‡ä»¶ã€æ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·</li><li><strong>åºå·3</strong>ï¼šæ–‡ä»¶ã€æ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·ç»„</li></ul><h4 id="æƒé™ä¿¡æ¯è§£æ"><a href="#æƒé™ä¿¡æ¯è§£æ" class="headerlink" title="æƒé™ä¿¡æ¯è§£æ"></a>æƒé™ä¿¡æ¯è§£æ</h4><p>æƒé™ç»†èŠ‚æ€»å…±åˆ†ä¸º<strong>10ä¸ªæ§½ä½</strong></p><p><img src="/images/linux/img_46.png" alt="æƒé™ä¿¡æ¯è§£æ"></p><p><strong>æƒé™æ ¼å¼ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">d rwx r-x r-x</span><br><span class="line">â†‘  â†‘   â†‘   â†‘</span><br><span class="line">â”‚  â”‚   â”‚   â””â”€ å…¶å®ƒç”¨æˆ·æƒé™</span><br><span class="line">â”‚  â”‚   â””â”€â”€â”€â”€â”€ æ‰€å±ç”¨æˆ·ç»„æƒé™</span><br><span class="line">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ‰€å±ç”¨æˆ·æƒé™</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ–‡ä»¶ç±»å‹</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šdrwxr-xr-x</strong></p><ul><li>é¦–å­—æ¯ <code>d</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆ<code>-</code> è¡¨ç¤ºæ–‡ä»¶ï¼‰</li><li>æ‰€å±ç”¨æˆ·çš„æƒé™æ˜¯ï¼š<code>rwx</code>ï¼ˆå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œï¼‰</li><li>æ‰€å±ç”¨æˆ·ç»„çš„æƒé™æ˜¯ï¼š<code>r-x</code>ï¼ˆå¯è¯»ã€ä¸å¯å†™ã€å¯æ‰§è¡Œï¼‰</li><li>å…¶å®ƒç”¨æˆ·çš„æƒé™æ˜¯ï¼š<code>r-x</code>ï¼ˆå¯è¯»ã€ä¸å¯å†™ã€å¯æ‰§è¡Œï¼‰</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼š<code>-</code> è¡¨ç¤ºæ— æ­¤æƒé™</p></blockquote><h4 id="rwxæƒé™è¯¦è§£"><a href="#rwxæƒé™è¯¦è§£" class="headerlink" title="rwxæƒé™è¯¦è§£"></a>rwxæƒé™è¯¦è§£</h4><table><thead><tr><th>æƒé™</th><th>é’ˆå¯¹æ–‡ä»¶</th><th>é’ˆå¯¹æ–‡ä»¶å¤¹</th></tr></thead><tbody><tr><td><strong>r</strong>ï¼ˆè¯»ï¼‰</td><td>å¯ä»¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹</td><td>å¯ä»¥æŸ¥çœ‹æ–‡ä»¶å¤¹å†…å®¹ï¼ˆå¦‚lså‘½ä»¤ï¼‰</td></tr><tr><td><strong>w</strong>ï¼ˆå†™ï¼‰</td><td>å¯ä»¥ä¿®æ”¹æ­¤æ–‡ä»¶</td><td>å¯ä»¥åœ¨æ–‡ä»¶å¤¹å†…åˆ›å»ºã€åˆ é™¤ã€æ”¹åç­‰æ“ä½œ</td></tr><tr><td><strong>x</strong>ï¼ˆæ‰§è¡Œï¼‰</td><td>å¯ä»¥å°†æ–‡ä»¶ä½œä¸ºç¨‹åºæ‰§è¡Œ</td><td>å¯ä»¥æ›´æ”¹å·¥ä½œç›®å½•åˆ°æ­¤æ–‡ä»¶å¤¹ï¼ˆcdè¿›å…¥ï¼‰</td></tr></tbody></table><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šå½“ç”¨æˆ·éæ–‡ä»¶æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„æˆå‘˜æ—¶ï¼Œä½¿ç”¨æœ€åä¸‰ä½æƒé™ï¼ˆå…¶å®ƒç”¨æˆ·æƒé™ï¼‰</p></blockquote><h3 id="12-9-chmodå‘½ä»¤-ä¿®æ”¹æƒé™"><a href="#12-9-chmodå‘½ä»¤-ä¿®æ”¹æƒé™" class="headerlink" title="12.9 chmodå‘½ä»¤ - ä¿®æ”¹æƒé™"></a>12.9 chmodå‘½ä»¤ - ä¿®æ”¹æƒé™</h3><p><code>chmod</code> å‘½ä»¤å¯ä»¥ä¿®æ”¹æ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æƒé™ä¿¡æ¯ã€‚</p><blockquote><p>âš ï¸ <strong>æƒé™è¦æ±‚</strong>ï¼šåªæœ‰æ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æ‰€å±ç”¨æˆ·æˆ–rootç”¨æˆ·å¯ä»¥ä¿®æ”¹</p></blockquote><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> [-R] æƒé™ä¿¡æ¯ æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-R</code>ï¼šå¯¹æ–‡ä»¶å¤¹å†…çš„å…¨éƒ¨å†…å®¹åº”ç”¨åŒæ ·çš„æ“ä½œ</li></ul><h4 id="å­—æ¯è¡¨ç¤ºæ³•"><a href="#å­—æ¯è¡¨ç¤ºæ³•" class="headerlink" title="å­—æ¯è¡¨ç¤ºæ³•"></a>å­—æ¯è¡¨ç¤ºæ³•</h4><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶æƒé™ä¸º rwxr-x--x</span></span><br><span class="line"><span class="built_in">chmod</span> u=rwx,g=rx,o=x hello.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶å¤¹åŠå…¶å…¨éƒ¨å†…å®¹æƒé™ä¸º rwxr-x--x</span></span><br><span class="line"><span class="built_in">chmod</span> -R u=rwx,g=rx,o=x <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p><strong>å­—æ¯å«ä¹‰ï¼š</strong></p><ul><li><code>u</code> è¡¨ç¤º userï¼ˆæ‰€å±ç”¨æˆ·æƒé™ï¼‰</li><li><code>g</code> è¡¨ç¤º groupï¼ˆç»„æƒé™ï¼‰</li><li><code>o</code> è¡¨ç¤º otherï¼ˆå…¶å®ƒç”¨æˆ·æƒé™ï¼‰</li></ul><h4 id="æ•°å­—è¡¨ç¤ºæ³•"><a href="#æ•°å­—è¡¨ç¤ºæ³•" class="headerlink" title="æ•°å­—è¡¨ç¤ºæ³•"></a>æ•°å­—è¡¨ç¤ºæ³•</h4><p>æƒé™å¯ä»¥ç”¨3ä½æ•°å­—æ¥ä»£è¡¨ï¼š</p><ul><li>ç¬¬ä¸€ä½æ•°å­—è¡¨ç¤ºç”¨æˆ·æƒé™</li><li>ç¬¬äºŒä½è¡¨ç¤ºç”¨æˆ·ç»„æƒé™</li><li>ç¬¬ä¸‰ä½è¡¨ç¤ºå…¶å®ƒç”¨æˆ·æƒé™</li></ul><p><strong>æƒé™æ•°å­—å¯¹ç…§è¡¨ï¼š</strong></p><table><thead><tr><th>æ•°å­—</th><th>æƒé™</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>0</td><td><code>---</code></td><td>æ— ä»»ä½•æƒé™</td></tr><tr><td>1</td><td><code>--x</code></td><td>ä»…æœ‰æ‰§è¡Œæƒé™</td></tr><tr><td>2</td><td><code>-w-</code></td><td>ä»…æœ‰å†™æƒé™</td></tr><tr><td>3</td><td><code>-wx</code></td><td>æœ‰å†™å’Œæ‰§è¡Œæƒé™</td></tr><tr><td>4</td><td><code>r--</code></td><td>ä»…æœ‰è¯»æƒé™</td></tr><tr><td>5</td><td><code>r-x</code></td><td>æœ‰è¯»å’Œæ‰§è¡Œæƒé™</td></tr><tr><td>6</td><td><code>rw-</code></td><td>æœ‰è¯»å’Œå†™æƒé™</td></tr><tr><td>7</td><td><code>rwx</code></td><td>æœ‰å…¨éƒ¨æƒé™</td></tr></tbody></table><p><strong>è®¡ç®—æ–¹å¼ï¼š</strong> r&#x3D;4, w&#x3D;2, x&#x3D;1</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æƒé™ä¿®æ”¹ä¸º 751 (rwxr-x--x)</span></span><br><span class="line"><span class="built_in">chmod</span> 751 hello.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æƒé™ä¿®æ”¹ä¸º 515 (r-x--xr-x)</span></span><br><span class="line"><span class="built_in">chmod</span> 515 hello.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æƒé™ä¿®æ”¹ä¸º 326 (-wx-w-rw-)</span></span><br><span class="line"><span class="built_in">chmod</span> 326 hello.txt</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æƒé™751çš„å«ä¹‰</strong>ï¼š</p><ul><li>7 (rwx) &#x3D; 4+2+1ï¼šç”¨æˆ·æ‹¥æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™</li><li>5 (r-x) &#x3D; 4+1ï¼šç”¨æˆ·ç»„æ‹¥æœ‰è¯»ã€æ‰§è¡Œæƒé™</li><li>1 (â€“x) &#x3D; 1ï¼šå…¶å®ƒç”¨æˆ·ä»…æœ‰æ‰§è¡Œæƒé™</li></ul></blockquote><h3 id="12-10-chownå‘½ä»¤-ä¿®æ”¹æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„"><a href="#12-10-chownå‘½ä»¤-ä¿®æ”¹æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„" class="headerlink" title="12.10 chownå‘½ä»¤ - ä¿®æ”¹æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„"></a>12.10 chownå‘½ä»¤ - ä¿®æ”¹æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„</h3><p><code>chown</code> å‘½ä»¤å¯ä»¥ä¿®æ”¹æ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„</p><blockquote><p>âš ï¸ <strong>æƒé™è¦æ±‚</strong>ï¼šæ™®é€šç”¨æˆ·æ— æ³•ä¿®æ”¹æ‰€å±ä¸ºå…¶å®ƒç”¨æˆ·æˆ–ç»„ï¼Œæ­¤å‘½ä»¤åªé€‚ç”¨äºrootç”¨æˆ·æ‰§è¡Œ</p></blockquote><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> [-R] [ç”¨æˆ·][:ç”¨æˆ·ç»„] æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-R</code>ï¼šåŒchmodï¼Œå¯¹æ–‡ä»¶å¤¹å†…å…¨éƒ¨å†…å®¹åº”ç”¨ç›¸åŒè§„åˆ™</li></ul><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>ç”¨æˆ·</code>ï¼šä¿®æ”¹æ‰€å±ç”¨æˆ·</li><li><code>ç”¨æˆ·ç»„</code>ï¼šä¿®æ”¹æ‰€å±ç”¨æˆ·ç»„</li><li><code>:</code> ç”¨äºåˆ†éš”ç”¨æˆ·å’Œç”¨æˆ·ç»„</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†hello.txtæ‰€å±ç”¨æˆ·ä¿®æ”¹ä¸ºroot</span></span><br><span class="line"><span class="built_in">chown</span> root hello.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†hello.txtæ‰€å±ç”¨æˆ·ç»„ä¿®æ”¹ä¸ºroot</span></span><br><span class="line"><span class="built_in">chown</span> :root hello.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒæ—¶ä¿®æ”¹æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„</span></span><br><span class="line"><span class="built_in">chown</span> root:chad hello.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶å¤¹åŠå…¶å…¨éƒ¨å†…å®¹çš„æ‰€å±ç”¨æˆ·</span></span><br><span class="line"><span class="built_in">chown</span> -R root <span class="built_in">test</span></span><br></pre></td></tr></table></figure><h2 id="13-Linuxå®ç”¨æ“ä½œ-âš™ï¸"><a href="#13-Linuxå®ç”¨æ“ä½œ-âš™ï¸" class="headerlink" title="13. Linuxå®ç”¨æ“ä½œ âš™ï¸"></a>13. Linuxå®ç”¨æ“ä½œ âš™ï¸</h2><h3 id="13-1-å„ç±»å®ç”¨å°æŠ€å·§ï¼ˆå¿«æ·é”®ï¼‰-âŒ¨ï¸"><a href="#13-1-å„ç±»å®ç”¨å°æŠ€å·§ï¼ˆå¿«æ·é”®ï¼‰-âŒ¨ï¸" class="headerlink" title="13.1 å„ç±»å®ç”¨å°æŠ€å·§ï¼ˆå¿«æ·é”®ï¼‰ âŒ¨ï¸"></a>13.1 å„ç±»å®ç”¨å°æŠ€å·§ï¼ˆå¿«æ·é”®ï¼‰ âŒ¨ï¸</h3><p>æŒæ¡Linuxå‘½ä»¤è¡Œçš„å¿«æ·é”®å¯ä»¥å¤§å¤§æé«˜å·¥ä½œæ•ˆç‡ã€‚</p><h4 id="å¼ºåˆ¶åœæ­¢-Ctrl-C"><a href="#å¼ºåˆ¶åœæ­¢-Ctrl-C" class="headerlink" title="å¼ºåˆ¶åœæ­¢ - Ctrl + C"></a>å¼ºåˆ¶åœæ­¢ - Ctrl + C</h4><p>LinuxæŸäº›ç¨‹åºçš„è¿è¡Œï¼Œå¦‚æœæƒ³è¦å¼ºåˆ¶åœæ­¢å®ƒï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”® <code>Ctrl + C</code></p><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>å¼ºåˆ¶åœæ­¢æ­£åœ¨è¿è¡Œçš„ç¨‹åº</li><li>å‘½ä»¤è¾“å…¥é”™è¯¯æ—¶ï¼Œé€€å‡ºå½“å‰è¾“å…¥ï¼Œé‡æ–°è¾“å…¥</li></ul><h4 id="é€€å‡º-ç™»å‡º-Ctrl-D"><a href="#é€€å‡º-ç™»å‡º-Ctrl-D" class="headerlink" title="é€€å‡º&#x2F;ç™»å‡º - Ctrl + D"></a>é€€å‡º&#x2F;ç™»å‡º - Ctrl + D</h4><p>å¯ä»¥é€šè¿‡å¿«æ·é”® <code>Ctrl + D</code>ï¼š</p><ul><li>é€€å‡ºè´¦æˆ·çš„ç™»å½•</li><li>é€€å‡ºæŸäº›ç‰¹å®šç¨‹åºçš„ä¸“å±é¡µé¢</li></ul><h4 id="å†å²å‘½ä»¤æœç´¢"><a href="#å†å²å‘½ä»¤æœç´¢" class="headerlink" title="å†å²å‘½ä»¤æœç´¢"></a>å†å²å‘½ä»¤æœç´¢</h4><p><strong>ä½¿ç”¨historyå‘½ä»¤ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å†å²è¾“å…¥è¿‡çš„å‘½ä»¤</p><p><strong>å¿«é€Ÿæ‰§è¡Œå†å²å‘½ä»¤ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!å‘½ä»¤å‰ç¼€</span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨æ‰§è¡Œä¸Šä¸€æ¬¡åŒ¹é…å‰ç¼€çš„å‘½ä»¤</p><p><strong>äº¤äº’å¼æœç´¢ - Ctrl + Rï¼š</strong></p><p>é€šè¿‡å¿«æ·é”® <code>Ctrl + R</code>ï¼Œè¾“å…¥å†…å®¹å»åŒ¹é…å†å²å‘½ä»¤</p><p>æœç´¢åˆ°å†…å®¹åï¼š</p><ul><li><strong>å›è½¦é”®</strong>ï¼šç›´æ¥æ‰§è¡Œè¯¥å‘½ä»¤</li><li><strong>å·¦å³æ–¹å‘é”®</strong>ï¼šè·å–æ­¤å‘½ä»¤åˆ°å‘½ä»¤è¡Œï¼ˆä¸æ‰§è¡Œï¼‰</li></ul><h4 id="å…‰æ ‡ç§»åŠ¨å¿«æ·é”®"><a href="#å…‰æ ‡ç§»åŠ¨å¿«æ·é”®" class="headerlink" title="å…‰æ ‡ç§»åŠ¨å¿«æ·é”®"></a>å…‰æ ‡ç§»åŠ¨å¿«æ·é”®</h4><table><thead><tr><th>å¿«æ·é”®</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>Ctrl + A</code></td><td>è·³åˆ°å‘½ä»¤å¼€å¤´</td></tr><tr><td><code>Ctrl + E</code></td><td>è·³åˆ°å‘½ä»¤ç»“å°¾</td></tr><tr><td><code>Ctrl + â†</code></td><td>å‘å·¦è·³ä¸€ä¸ªå•è¯</td></tr><tr><td><code>Ctrl + â†’</code></td><td>å‘å³è·³ä¸€ä¸ªå•è¯</td></tr></tbody></table><h4 id="æ¸…å±"><a href="#æ¸…å±" class="headerlink" title="æ¸…å±"></a>æ¸…å±</h4><p><strong>æ–¹å¼ä¸€ï¼š</strong> å¿«æ·é”® <code>Ctrl + L</code></p><p><strong>æ–¹å¼äºŒï¼š</strong> ä½¿ç”¨clearå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br></pre></td></tr></table></figure><h4 id="å¿«æ·é”®æ€»ç»“"><a href="#å¿«æ·é”®æ€»ç»“" class="headerlink" title="å¿«æ·é”®æ€»ç»“"></a>å¿«æ·é”®æ€»ç»“</h4><table><thead><tr><th>åºå·</th><th>å¿«æ·é”®&#x2F;å‘½ä»¤</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td>1</td><td><code>Ctrl + C</code></td><td>å¼ºåˆ¶åœæ­¢ç¨‹åº</td></tr><tr><td>2</td><td><code>Ctrl + D</code></td><td>é€€å‡º&#x2F;ç™»å‡º</td></tr><tr><td>3</td><td><code>history</code></td><td>æŸ¥çœ‹å†å²å‘½ä»¤</td></tr><tr><td>4</td><td><code>!å‘½ä»¤å‰ç¼€</code></td><td>è‡ªåŠ¨åŒ¹é…ä¸Šä¸€ä¸ªå‘½ä»¤</td></tr><tr><td>5</td><td><code>Ctrl + R</code></td><td>æœç´¢å†å²å‘½ä»¤</td></tr><tr><td>6</td><td><code>Ctrl + A</code> &#x2F; <code>Ctrl + E</code></td><td>å…‰æ ‡ç§»åŠ¨åˆ°å‘½ä»¤å¼€å§‹æˆ–ç»“æŸ</td></tr><tr><td>7</td><td><code>Ctrl + â†</code> &#x2F; <code>Ctrl + â†’</code></td><td>å·¦å³è·³å•è¯</td></tr><tr><td>8</td><td><code>Ctrl + L</code> æˆ– <code>clear</code></td><td>æ¸…å±</td></tr></tbody></table><h3 id="13-2-è½¯ä»¶å®‰è£…-ğŸ“¦"><a href="#13-2-è½¯ä»¶å®‰è£…-ğŸ“¦" class="headerlink" title="13.2 è½¯ä»¶å®‰è£… ğŸ“¦"></a>13.2 è½¯ä»¶å®‰è£… ğŸ“¦</h3><h4 id="Linuxç³»ç»Ÿå®‰è£…è½¯ä»¶çš„æ–¹å¼"><a href="#Linuxç³»ç»Ÿå®‰è£…è½¯ä»¶çš„æ–¹å¼" class="headerlink" title="Linuxç³»ç»Ÿå®‰è£…è½¯ä»¶çš„æ–¹å¼"></a>Linuxç³»ç»Ÿå®‰è£…è½¯ä»¶çš„æ–¹å¼</h4><p>æ“ä½œç³»ç»Ÿå®‰è£…è½¯ä»¶æœ‰è®¸å¤šç§æ–¹å¼ï¼Œä¸€èˆ¬åˆ†ä¸ºï¼š</p><p><strong>1. ä¸‹è½½å®‰è£…åŒ…è‡ªè¡Œå®‰è£…</strong></p><ul><li>Windowsç³»ç»Ÿï¼šä½¿ç”¨ <code>.exe</code>ã€<code>.msi</code> æ–‡ä»¶ç­‰</li><li>MacOSç³»ç»Ÿï¼šä½¿ç”¨ <code>.dmg</code>ã€<code>.pkg</code> æ–‡ä»¶ç­‰</li></ul><p><strong>2. ç³»ç»Ÿçš„åº”ç”¨å•†åº—å†…å®‰è£…</strong></p><ul><li>Windowsç³»ç»Ÿï¼šMicrosoft Storeå•†åº—</li><li>MacOSç³»ç»Ÿï¼šAppStoreå•†åº—</li></ul><p>Linuxç³»ç»ŸåŒæ ·æ”¯æŒè¿™ä¸¤ç§æ–¹å¼ã€‚æˆ‘ä»¬é¦–å…ˆå­¦ä¹ ä½¿ç”¨Linuxå‘½ä»¤è¡Œå†…çš„â€åº”ç”¨å•†åº—â€ï¼š<strong>yumå‘½ä»¤å®‰è£…è½¯ä»¶</strong></p><h4 id="yumå‘½ä»¤è¯¦è§£"><a href="#yumå‘½ä»¤è¯¦è§£" class="headerlink" title="yumå‘½ä»¤è¯¦è§£"></a>yumå‘½ä»¤è¯¦è§£</h4><p><strong>yum</strong>ï¼šRPMåŒ…è½¯ä»¶ç®¡ç†å™¨ï¼Œç”¨äºè‡ªåŠ¨åŒ–å®‰è£…é…ç½®Linuxè½¯ä»¶ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨è§£å†³ä¾èµ–é—®é¢˜ã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum [-y] [<span class="built_in">command</span>] [package]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-y</code>ï¼šè‡ªåŠ¨ç¡®è®¤ï¼Œæ— éœ€æ‰‹åŠ¨ç¡®è®¤å®‰è£…æˆ–å¸è½½è¿‡ç¨‹</li></ul><p><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong></p><ul><li><code>install</code>ï¼šå®‰è£…è½¯ä»¶</li><li><code>remove</code>ï¼šå¸è½½è½¯ä»¶</li><li><code>search</code>ï¼šæœç´¢è½¯ä»¶åŒ…</li></ul><blockquote><p>âš ï¸ <strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ul><li>yumå‘½ä»¤éœ€è¦rootæƒé™ï¼Œå¯ä»¥ä½¿ç”¨ <code>su</code> åˆ‡æ¢åˆ°rootï¼Œæˆ–ä½¿ç”¨ <code>sudo</code> ææƒ</li><li>yumå‘½ä»¤éœ€è¦è”ç½‘</li></ul></blockquote><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…wgetç¨‹åº</span></span><br><span class="line">yum [-y] install wget</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸è½½wgetç¨‹åº</span></span><br><span class="line">yum [-y] remove wget</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœç´¢wgetå®‰è£…åŒ…</span></span><br><span class="line">yum search wget</span><br></pre></td></tr></table></figure><h4 id="CentOS-7-é…ç½®é˜¿é‡Œäº‘é•œåƒæº"><a href="#CentOS-7-é…ç½®é˜¿é‡Œäº‘é•œåƒæº" class="headerlink" title="CentOS 7 é…ç½®é˜¿é‡Œäº‘é•œåƒæº"></a>CentOS 7 é…ç½®é˜¿é‡Œäº‘é•œåƒæº</h4><blockquote><p>ğŸ’¡ <strong>é‡è¦æç¤º</strong>ï¼šCentOS 7 å®˜æ–¹æºå·²ç»å½»åº•ä¸‹çº¿ï¼ˆè‡ª 2024 å¹´ 6 æœˆèµ· EOLï¼‰ï¼Œ<code>mirrorlist.centos.org</code> ç°åœ¨æ ¹æœ¬ä¸å­˜åœ¨äº†ã€‚</p></blockquote><p>è¦è®©yumèƒ½æ­£å¸¸å·¥ä½œï¼Œéœ€è¦æŠŠæºåœ°å€æ”¹æˆâ€å½’æ¡£æºï¼ˆvaultï¼‰â€æˆ–å›½å†…é•œåƒã€‚</p><p><strong>é…ç½®é˜¿é‡Œäº‘ CentOS 7 æºï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½é˜¿é‡Œäº‘çš„CentOS 7æºé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">sudo</span> curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†yumç¼“å­˜</span></span><br><span class="line"><span class="built_in">sudo</span> yum clean all</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ–°çš„ç¼“å­˜</span></span><br><span class="line"><span class="built_in">sudo</span> yum makecache</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_47.png" alt="yumé…ç½®ç¤ºä¾‹"></p><h3 id="13-3-systemctlå‘½ä»¤-æœåŠ¡ç®¡ç†-ğŸ”§"><a href="#13-3-systemctlå‘½ä»¤-æœåŠ¡ç®¡ç†-ğŸ”§" class="headerlink" title="13.3 systemctlå‘½ä»¤ - æœåŠ¡ç®¡ç† ğŸ”§"></a>13.3 systemctlå‘½ä»¤ - æœåŠ¡ç®¡ç† ğŸ”§</h3><h4 id="systemctlå‘½ä»¤ä»‹ç»"><a href="#systemctlå‘½ä»¤ä»‹ç»" class="headerlink" title="systemctlå‘½ä»¤ä»‹ç»"></a>systemctlå‘½ä»¤ä»‹ç»</h4><p>Linuxç³»ç»Ÿå¾ˆå¤šè½¯ä»¶ï¼ˆå†…ç½®æˆ–ç¬¬ä¸‰æ–¹ï¼‰å‡æ”¯æŒä½¿ç”¨ <code>systemctl</code> å‘½ä»¤æ§åˆ¶ï¼š<strong>å¯åŠ¨ã€åœæ­¢ã€å¼€æœºè‡ªå¯</strong></p><p>èƒ½å¤Ÿè¢«systemctlç®¡ç†çš„è½¯ä»¶ï¼Œä¸€èˆ¬ä¹Ÿç§°ä¹‹ä¸ºï¼š<strong>æœåŠ¡ï¼ˆserviceï¼‰</strong></p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl [<span class="built_in">command</span>] [unit]</span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong></p><ul><li><code>start</code>ï¼šå¯åŠ¨æœåŠ¡</li><li><code>stop</code>ï¼šåœæ­¢æœåŠ¡</li><li><code>restart</code>ï¼šé‡å¯æœåŠ¡</li><li><code>status</code>ï¼šæŸ¥çœ‹æœåŠ¡çŠ¶æ€</li><li><code>enable</code>ï¼šè®¾ç½®å¼€æœºè‡ªå¯</li><li><code>disable</code>ï¼šå…³é—­å¼€æœºè‡ªå¯</li></ul><h4 id="ç³»ç»Ÿå†…ç½®æœåŠ¡"><a href="#ç³»ç»Ÿå†…ç½®æœåŠ¡" class="headerlink" title="ç³»ç»Ÿå†…ç½®æœåŠ¡"></a>ç³»ç»Ÿå†…ç½®æœåŠ¡</h4><p>ç³»ç»Ÿå†…ç½®çš„æœåŠ¡æ¯”è¾ƒå¤šï¼Œå¸¸è§çš„æœ‰ï¼š</p><table><thead><tr><th>æœåŠ¡å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>NetworkManager</code></td><td>ä¸»ç½‘ç»œæœåŠ¡</td></tr><tr><td><code>network</code></td><td>å‰¯ç½‘ç»œæœåŠ¡</td></tr><tr><td><code>firewalld</code></td><td>é˜²ç«å¢™æœåŠ¡</td></tr><tr><td><code>sshd</code></td><td>SSHæœåŠ¡ï¼ˆFinalShellè¿œç¨‹ç™»å½•Linuxä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªæœåŠ¡ï¼‰</td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨SSHæœåŠ¡</span></span><br><span class="line">systemctl start sshd</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢é˜²ç«å¢™æœåŠ¡</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status sshd</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line">systemctl <span class="built_in">enable</span> sshd</span><br></pre></td></tr></table></figure><h4 id="ç¬¬ä¸‰æ–¹è½¯ä»¶æœåŠ¡"><a href="#ç¬¬ä¸‰æ–¹è½¯ä»¶æœåŠ¡" class="headerlink" title="ç¬¬ä¸‰æ–¹è½¯ä»¶æœåŠ¡"></a>ç¬¬ä¸‰æ–¹è½¯ä»¶æœåŠ¡</h4><p>é™¤äº†å†…ç½®çš„æœåŠ¡ä»¥å¤–ï¼Œéƒ¨åˆ†ç¬¬ä¸‰æ–¹è½¯ä»¶å®‰è£…åä¹Ÿå¯ä»¥ç”¨systemctlè¿›è¡Œæ§åˆ¶ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ntpè½¯ä»¶</span></span><br><span class="line">yum install -y ntp</span><br><span class="line"><span class="comment"># å¯ä»¥é€šè¿‡ntpdæœåŠ¡åï¼Œé…åˆsystemctlè¿›è¡Œæ§åˆ¶</span></span><br><span class="line">systemctl start ntpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…apacheæœåŠ¡å™¨è½¯ä»¶</span></span><br><span class="line">yum install -y httpd</span><br><span class="line"><span class="comment"># å¯ä»¥é€šè¿‡httpdæœåŠ¡åï¼Œé…åˆsystemctlè¿›è¡Œæ§åˆ¶</span></span><br><span class="line">systemctl start httpd</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šéƒ¨åˆ†è½¯ä»¶å®‰è£…åæ²¡æœ‰è‡ªåŠ¨é›†æˆåˆ°systemctlä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ·»åŠ ã€‚</p></blockquote><h3 id="13-4-è½¯è¿æ¥-lnå‘½ä»¤-ğŸ”—"><a href="#13-4-è½¯è¿æ¥-lnå‘½ä»¤-ğŸ”—" class="headerlink" title="13.4 è½¯è¿æ¥ - lnå‘½ä»¤ ğŸ”—"></a>13.4 è½¯è¿æ¥ - lnå‘½ä»¤ ğŸ”—</h3><h4 id="åˆ›å»ºè½¯è¿æ¥"><a href="#åˆ›å»ºè½¯è¿æ¥" class="headerlink" title="åˆ›å»ºè½¯è¿æ¥"></a>åˆ›å»ºè½¯è¿æ¥</h4><p>åœ¨ç³»ç»Ÿä¸­åˆ›å»ºè½¯é“¾æ¥ï¼Œå¯ä»¥å°†æ–‡ä»¶ã€æ–‡ä»¶å¤¹é“¾æ¥åˆ°å…¶å®ƒä½ç½®ã€‚</p><p>ç±»ä¼¼Windowsç³»ç»Ÿä¸­çš„ <strong>å¿«æ·æ–¹å¼</strong></p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s [æºæ–‡ä»¶] [é“¾æ¥æ–‡ä»¶]</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>-s</code> é€‰é¡¹ï¼šåˆ›å»ºè½¯è¿æ¥</li><li><code>æºæ–‡ä»¶</code>ï¼šè¢«é“¾æ¥çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</li><li><code>é“¾æ¥æ–‡ä»¶</code>ï¼šè¦é“¾æ¥å»çš„ç›®çš„åœ°</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†/etc/yum.confé“¾æ¥åˆ°å®¶ç›®å½•</span></span><br><span class="line"><span class="built_in">ln</span> -s /etc/yum.conf ~/yum.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†/etc/yumç›®å½•é“¾æ¥åˆ°å®¶ç›®å½•</span></span><br><span class="line"><span class="built_in">ln</span> -s /etc/yum ~/yum</span><br></pre></td></tr></table></figure><h3 id="13-5-æ—¥æœŸå’Œæ—¶åŒº-ğŸ“…"><a href="#13-5-æ—¥æœŸå’Œæ—¶åŒº-ğŸ“…" class="headerlink" title="13.5 æ—¥æœŸå’Œæ—¶åŒº ğŸ“…"></a>13.5 æ—¥æœŸå’Œæ—¶åŒº ğŸ“…</h3><h4 id="dateå‘½ä»¤-æŸ¥çœ‹æ—¥æœŸæ—¶é—´"><a href="#dateå‘½ä»¤-æŸ¥çœ‹æ—¥æœŸæ—¶é—´" class="headerlink" title="dateå‘½ä»¤ - æŸ¥çœ‹æ—¥æœŸæ—¶é—´"></a>dateå‘½ä»¤ - æŸ¥çœ‹æ—¥æœŸæ—¶é—´</h4><p>é€šè¿‡ <code>date</code> å‘½ä»¤å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æŸ¥çœ‹ç³»ç»Ÿçš„æ—¶é—´</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> [-d] [+format]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-d</code>ï¼šæŒ‰ç…§ç»™å®šçš„å­—ç¬¦ä¸²æ˜¾ç¤ºæ—¥æœŸï¼Œä¸€èˆ¬ç”¨äºæ—¥æœŸè®¡ç®—</li></ul><h4 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h4><p>é€šè¿‡ç‰¹å®šçš„å­—ç¬¦ä¸²æ ‡è®°ï¼Œæ¥æ§åˆ¶æ˜¾ç¤ºçš„æ—¥æœŸæ ¼å¼ï¼š</p><table><thead><tr><th>æ ¼å¼ç¬¦</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>%Y</code></td><td>å¹´ï¼ˆ4ä½ï¼‰</td></tr><tr><td><code>%y</code></td><td>å¹´ä»½åä¸¤ä½æ•°å­— (00..99)</td></tr><tr><td><code>%m</code></td><td>æœˆä»½ (01..12)</td></tr><tr><td><code>%d</code></td><td>æ—¥ (01..31)</td></tr><tr><td><code>%H</code></td><td>å°æ—¶ (00..23)</td></tr><tr><td><code>%M</code></td><td>åˆ†é’Ÿ (00..59)</td></tr><tr><td><code>%S</code></td><td>ç§’ (00..60)</td></tr><tr><td><code>%s</code></td><td>è‡ª 1970-01-01 00:00:00 UTC åˆ°ç°åœ¨çš„ç§’æ•°</td></tr></tbody></table><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰æ—¥æœŸæ—¶é—´</span></span><br><span class="line">[root@chad home]# <span class="built_in">date</span></span><br><span class="line">Sun Nov  9 09:07:45 PST 2025</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¼å¼åŒ–æ˜¾ç¤º</span></span><br><span class="line"><span class="built_in">date</span> <span class="string">&quot;+%Y-%m-%d %H:%M:%S&quot;</span></span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸè®¡ç®—"><a href="#æ—¥æœŸè®¡ç®—" class="headerlink" title="æ—¥æœŸè®¡ç®—"></a>æ—¥æœŸè®¡ç®—</h4><p><code>-d</code> é€‰é¡¹å¯ä»¥æŒ‰ç…§ç»™å®šçš„å­—ç¬¦ä¸²æ˜¾ç¤ºæ—¥æœŸï¼Œä¸€èˆ¬ç”¨äºæ—¥æœŸè®¡ç®—</p><p><strong>æ”¯æŒçš„æ—¶é—´æ ‡è®°ï¼š</strong></p><ul><li><code>year</code>ï¼šå¹´</li><li><code>month</code>ï¼šæœˆ</li><li><code>day</code>ï¼šå¤©</li><li><code>hour</code>ï¼šå°æ—¶</li><li><code>minute</code>ï¼šåˆ†é’Ÿ</li><li><code>second</code>ï¼šç§’</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¾ç¤ºæ˜å¤©çš„æ—¥æœŸ</span></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;+1 day&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºä¸€å‘¨åçš„æ—¥æœŸ</span></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;+7 day&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºä¸€ä¸ªæœˆå‰çš„æ—¥æœŸ</span></span><br><span class="line"><span class="built_in">date</span> -d <span class="string">&quot;-1 month&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼š<code>-d</code> é€‰é¡¹å¯ä»¥å’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²é…åˆä¸€èµ·ä½¿ç”¨</p></blockquote><h3 id="13-6-IPåœ°å€å’Œä¸»æœºå-ğŸŒ"><a href="#13-6-IPåœ°å€å’Œä¸»æœºå-ğŸŒ" class="headerlink" title="13.6 IPåœ°å€å’Œä¸»æœºå ğŸŒ"></a>13.6 IPåœ°å€å’Œä¸»æœºå ğŸŒ</h3><h4 id="IPåœ°å€è¯¦è§£"><a href="#IPåœ°å€è¯¦è§£" class="headerlink" title="IPåœ°å€è¯¦è§£"></a>IPåœ°å€è¯¦è§£</h4><p>æ¯ä¸€å°è”ç½‘çš„ç”µè„‘éƒ½ä¼šæœ‰ä¸€ä¸ªåœ°å€ï¼Œç”¨äºå’Œå…¶å®ƒè®¡ç®—æœºè¿›è¡Œé€šè®¯ã€‚</p><p><strong>IPåœ°å€ç‰ˆæœ¬ï¼š</strong></p><ul><li><strong>IPv4ç‰ˆæœ¬</strong>ï¼šä¸»æµä½¿ç”¨ï¼ˆæœ¬æ•™ç¨‹é‡ç‚¹è®²è§£ï¼‰</li><li><strong>IPv6ç‰ˆæœ¬</strong>ï¼šè¾ƒå°‘ä½¿ç”¨ï¼ˆæš‚ä¸æ¶‰åŠï¼‰</li></ul><p><strong>IPv4åœ°å€æ ¼å¼ï¼š</strong> <code>a.b.c.d</code></p><p>å…¶ä¸­ aã€bã€cã€d è¡¨ç¤º 0~255 çš„æ•°å­—ï¼Œä¾‹å¦‚ï¼š<code>192.168.88.101</code></p><p><strong>æŸ¥çœ‹æœ¬æœºIPåœ°å€ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå¦‚æ— æ³•ä½¿ç”¨ifconfigå‘½ä»¤ï¼Œå¯ä»¥å®‰è£…ï¼š<code>yum -y install net-tools</code></p></blockquote><p><img src="/images/linux/img_48.png" alt="æŸ¥çœ‹IPåœ°å€"></p><h4 id="ç‰¹æ®ŠIPåœ°å€"><a href="#ç‰¹æ®ŠIPåœ°å€" class="headerlink" title="ç‰¹æ®ŠIPåœ°å€"></a>ç‰¹æ®ŠIPåœ°å€</h4><p>é™¤äº†æ ‡å‡†çš„IPåœ°å€ä»¥å¤–ï¼Œè¿˜æœ‰å‡ ä¸ªç‰¹æ®Šçš„IPåœ°å€éœ€è¦äº†è§£ï¼š</p><p><strong>1. 127.0.0.1ï¼ˆæœ¬åœ°å›ç¯åœ°å€ï¼‰</strong></p><p>è¿™ä¸ªIPåœ°å€ç”¨äºæŒ‡ä»£æœ¬æœº</p><p><img src="/images/linux/img_49.png" alt="æœ¬åœ°å›ç¯åœ°å€"></p><p><strong>2. 0.0.0.0ï¼ˆç‰¹æ®ŠIPåœ°å€ï¼‰</strong></p><p>ç”¨é€”ï¼š</p><ul><li>å¯ä»¥ç”¨äºæŒ‡ä»£æœ¬æœº</li><li>å¯ä»¥åœ¨ç«¯å£ç»‘å®šä¸­ç”¨æ¥ç¡®å®šç»‘å®šå…³ç³»</li><li>åœ¨IPåœ°å€é™åˆ¶ä¸­ï¼Œè¡¨ç¤ºæ‰€æœ‰IPçš„æ„æ€ï¼ˆå¦‚æ”¾è¡Œè§„åˆ™è®¾ç½®ä¸º0.0.0.0ï¼Œè¡¨ç¤ºå…è®¸ä»»æ„IPè®¿é—®ï¼‰</li></ul><h4 id="ä¸»æœºå"><a href="#ä¸»æœºå" class="headerlink" title="ä¸»æœºå"></a>ä¸»æœºå</h4><p>æ¯ä¸€å°ç”µè„‘é™¤äº†å¯¹å¤–è”ç»œåœ°å€ï¼ˆIPåœ°å€ï¼‰ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ªåå­—ï¼Œç§°ä¹‹ä¸º<strong>ä¸»æœºå</strong></p><p>æ— è®ºæ˜¯Windowsæˆ–Linuxç³»ç»Ÿï¼Œéƒ½å¯ä»¥ç»™ç³»ç»Ÿè®¾ç½®ä¸»æœºåã€‚</p><p><strong>æŸ¥çœ‹ä¸»æœºåï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@chad home]# hostname</span><br><span class="line">chad</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹ä¸»æœºåï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname æ–°ä¸»æœºå</span><br></pre></td></tr></table></figure><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šä¿®æ”¹ä¸»æœºåéœ€è¦rootæƒé™ï¼Œä¿®æ”¹åé‡æ–°ç™»å½•FinalShellå³å¯çœ‹åˆ°ä¸»æœºåå·²æ­£ç¡®æ˜¾ç¤º</p></blockquote><h4 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h4><p>IPåœ°å€å®åœ¨æ˜¯éš¾ä»¥è®°å¿†ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥é€šè¿‡ä¸»æœºåæˆ–æ›¿ä»£çš„å­—ç¬¦åœ°å€å»ä»£æ›¿æ•°å­—åŒ–çš„IPåœ°å€å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½æ˜¯é€šè¿‡å­—ç¬¦åŒ–çš„åœ°å€å»è®¿é—®æœåŠ¡å™¨ï¼Œå¾ˆå°‘ç›´æ¥æŒ‡å®šIPåœ°å€ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong> åœ¨æµè§ˆå™¨å†…æ‰“å¼€ <code>www.baidu.com</code>ï¼Œä¼šæ‰“å¼€ç™¾åº¦çš„ç½‘å€</p><p>å…¶ä¸­ï¼Œ<code>www.baidu.com</code> æ˜¯ç™¾åº¦çš„ç½‘å€ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºï¼š<strong>åŸŸå</strong></p><h4 id="åŸŸåè§£ææµç¨‹"><a href="#åŸŸåè§£ææµç¨‹" class="headerlink" title="åŸŸåè§£ææµç¨‹"></a>åŸŸåè§£ææµç¨‹</h4><p>è®¿é—® <code>www.baidu.com</code> çš„æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="/images/linux/img_50.png" alt="åŸŸåè§£ææµç¨‹"></p><p><strong>è§£ææ­¥éª¤ï¼š</strong></p><ol><li>å…ˆæŸ¥çœ‹æœ¬æœºçš„è®°å½•ï¼ˆç§äººåœ°å€æœ¬ï¼‰<ul><li>Windowsï¼š<code>C:\Windows\System32\drivers\etc\hosts</code></li><li>Linuxï¼š<code>/etc/hosts</code></li></ul></li><li>å†è”ç½‘å»DNSæœåŠ¡å™¨è¯¢é—®ï¼ˆå¦‚ <code>114.114.114.114</code>ã€<code>8.8.8.8</code> ç­‰ï¼‰</li></ol><h4 id="è™šæ‹Ÿæœºé…ç½®å›ºå®šIP"><a href="#è™šæ‹Ÿæœºé…ç½®å›ºå®šIP" class="headerlink" title="è™šæ‹Ÿæœºé…ç½®å›ºå®šIP"></a>è™šæ‹Ÿæœºé…ç½®å›ºå®šIP</h4><p><strong>ä¸ºä»€ä¹ˆéœ€è¦å›ºå®šIPï¼Ÿ</strong></p><p>å½“å‰è™šæ‹Ÿæœºçš„Linuxæ“ä½œç³»ç»Ÿï¼Œå…¶IPåœ°å€æ˜¯é€šè¿‡DHCPæœåŠ¡è·å–çš„ã€‚</p><p><strong>DHCPï¼š</strong> åŠ¨æ€è·å–IPåœ°å€ï¼Œå³æ¯æ¬¡é‡å¯è®¾å¤‡åéƒ½ä¼šè·å–ä¸€æ¬¡ï¼Œå¯èƒ½å¯¼è‡´IPåœ°å€é¢‘ç¹å˜æ›´</p><p><strong>åŸå› 1ï¼š</strong> è¿œç¨‹è¿æ¥éœ€è¦ç¨³å®šçš„IPåœ°å€ï¼Œå¦‚æœIPåœ°å€ç»å¸¸å˜åŒ–å°±è¦é¢‘ç¹ä¿®æ”¹è¿æ¥é…ç½®</p><p><strong>åŸå› 2ï¼š</strong> é…ç½®äº†IPåœ°å€å’Œä¸»æœºåçš„æ˜ å°„åï¼Œå¦‚æœIPé¢‘ç¹æ›´æ”¹ï¼Œéœ€è¦é¢‘ç¹æ›´æ–°æ˜ å°„å…³ç³»</p><h4 id="åœ¨VMware-Workstationä¸­é…ç½®å›ºå®šIP"><a href="#åœ¨VMware-Workstationä¸­é…ç½®å›ºå®šIP" class="headerlink" title="åœ¨VMware Workstationä¸­é…ç½®å›ºå®šIP"></a>åœ¨VMware Workstationä¸­é…ç½®å›ºå®šIP</h4><p>é…ç½®å›ºå®šIPéœ€è¦2ä¸ªå¤§æ­¥éª¤ï¼š</p><p><strong>æ­¥éª¤1ï¼š</strong> åœ¨VMware Workstationï¼ˆæˆ–Fusionï¼‰ä¸­é…ç½®IPåœ°å€ç½‘å…³å’Œç½‘æ®µ</p><p><img src="/images/linux/img_51.png" alt="VMwareç½‘ç»œé…ç½®"></p><p><strong>æ­¥éª¤2ï¼š</strong> åœ¨Linuxç³»ç»Ÿä¸­æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå›ºå®šIP</p><p>ä½¿ç”¨vimç¼–è¾‘ <code>/etc/sysconfig/network-scripts/ifcfg-ens33</code> æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-ens33</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘å®Œæˆåï¼Œé‡å¯ç½‘å¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ <code>ifconfig</code> å³å¯çœ‹åˆ°IPåœ°å€å·²å›ºå®š</p><p><img src="/images/linux/img_52.png" alt="å›ºå®šIPé…ç½®"></p><blockquote><p>âš ï¸ <strong>é‡è¦</strong>ï¼šè™šæ‹Ÿæœºè®¾ç½®ä¸­çš„ç½‘ç»œé€‚é…å™¨éœ€è¦æ”¹æˆNATæ¨¡å¼</p></blockquote><p><img src="/images/linux/img_53.png" alt="NATæ¨¡å¼è®¾ç½®"></p><h3 id="13-7-ç½‘ç»œä¼ è¾“-ğŸ“¡"><a href="#13-7-ç½‘ç»œä¼ è¾“-ğŸ“¡" class="headerlink" title="13.7 ç½‘ç»œä¼ è¾“ ğŸ“¡"></a>13.7 ç½‘ç»œä¼ è¾“ ğŸ“¡</h3><h4 id="pingå‘½ä»¤-ç½‘ç»œè¿é€šæ€§æµ‹è¯•"><a href="#pingå‘½ä»¤-ç½‘ç»œè¿é€šæ€§æµ‹è¯•" class="headerlink" title="pingå‘½ä»¤ - ç½‘ç»œè¿é€šæ€§æµ‹è¯•"></a>pingå‘½ä»¤ - ç½‘ç»œè¿é€šæ€§æµ‹è¯•</h4><p><code>ping</code> å‘½ä»¤å¯ä»¥æ£€æŸ¥æŒ‡å®šçš„ç½‘ç»œæœåŠ¡å™¨æ˜¯å¦å¯è”é€š</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping [-c num] [host]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-c</code>ï¼šæ£€æŸ¥çš„æ¬¡æ•°ï¼Œä¸ä½¿ç”¨ <code>-c</code> é€‰é¡¹ï¼Œå°†æ— é™æ¬¡æ•°æŒç»­æ£€æŸ¥</li><li><code>host</code>ï¼šIPåœ°å€æˆ–ä¸»æœºå</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥baidu.comæ˜¯å¦è”é€šï¼ˆæ£€æŸ¥3æ¬¡ï¼‰</span></span><br><span class="line">[root@chad home]# ping -c 3 baidu.com</span><br><span class="line">PING baidu.com (220.181.7.203) 56(84) bytes of data.</span><br><span class="line">64 bytes from 220.181.7.203 (220.181.7.203): icmp_seq=1 ttl=128 <span class="keyword">time</span>=34.4 ms</span><br><span class="line">64 bytes from 220.181.7.203 (220.181.7.203): icmp_seq=2 ttl=128 <span class="keyword">time</span>=38.7 ms</span><br><span class="line">64 bytes from 220.181.7.203 (220.181.7.203): icmp_seq=3 ttl=128 <span class="keyword">time</span>=29.9 ms</span><br><span class="line">--- baidu.com ping statistics ---</span><br><span class="line">3 packets transmitted, 3 received, 0% packet loss, <span class="keyword">time</span> 3257ms</span><br><span class="line">rtt min/avg/max/mdev = 29.926/34.375/38.709/3.592 ms</span><br></pre></td></tr></table></figure><h4 id="wgetå‘½ä»¤-æ–‡ä»¶ä¸‹è½½"><a href="#wgetå‘½ä»¤-æ–‡ä»¶ä¸‹è½½" class="headerlink" title="wgetå‘½ä»¤ - æ–‡ä»¶ä¸‹è½½"></a>wgetå‘½ä»¤ - æ–‡ä»¶ä¸‹è½½</h4><p><code>wget</code> æ˜¯éäº¤äº’å¼çš„æ–‡ä»¶ä¸‹è½½å™¨ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œå†…ä¸‹è½½ç½‘ç»œæ–‡ä»¶</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget [-b] [URL]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-b</code>ï¼šå¯é€‰ï¼Œåå°ä¸‹è½½ï¼Œä¼šå°†æ—¥å¿—å†™å…¥åˆ°å½“å‰å·¥ä½œç›®å½•çš„ <code>wget-log</code> æ–‡ä»¶</li><li><code>URL</code>ï¼šä¸‹è½½é“¾æ¥</li></ul><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šæ— è®ºä¸‹è½½æ˜¯å¦å®Œæˆï¼Œéƒ½ä¼šç”Ÿæˆè¦ä¸‹è½½çš„æ–‡ä»¶ï¼Œå¦‚æœä¸‹è½½æœªå®Œæˆï¼Œè¯·åŠæ—¶æ¸…ç†æœªå®Œæˆçš„ä¸å¯ç”¨æ–‡ä»¶ã€‚</p></blockquote><h4 id="curlå‘½ä»¤-HTTPè¯·æ±‚"><a href="#curlå‘½ä»¤-HTTPè¯·æ±‚" class="headerlink" title="curlå‘½ä»¤ - HTTPè¯·æ±‚"></a>curlå‘½ä»¤ - HTTPè¯·æ±‚</h4><p><code>curl</code> å¯ä»¥å‘é€httpç½‘ç»œè¯·æ±‚ï¼Œå¯ç”¨äºï¼šä¸‹è½½æ–‡ä»¶ã€è·å–ä¿¡æ¯ç­‰</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl [-O] [URL]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-O</code>ï¼šç”¨äºä¸‹è½½æ–‡ä»¶ï¼Œå½“URLæ˜¯ä¸‹è½½é“¾æ¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹ä¿å­˜æ–‡ä»¶</li><li><code>URL</code>ï¼šè¦å‘èµ·è¯·æ±‚çš„ç½‘ç»œåœ°å€</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹IPä¿¡æ¯</span></span><br><span class="line">curl cip.cc</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¿é—®ç½‘ç«™</span></span><br><span class="line">curl python.chad.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line">curl -O http://archive.apache.org/dist/hadoop/common/hadoop-3.3.0/hadoop-3.3.0.tar.gz</span><br></pre></td></tr></table></figure><h3 id="13-8-ç«¯å£ç®¡ç†-ğŸ”Œ"><a href="#13-8-ç«¯å£ç®¡ç†-ğŸ”Œ" class="headerlink" title="13.8 ç«¯å£ç®¡ç† ğŸ”Œ"></a>13.8 ç«¯å£ç®¡ç† ğŸ”Œ</h3><h4 id="ç«¯å£æ¦‚å¿µ"><a href="#ç«¯å£æ¦‚å¿µ" class="headerlink" title="ç«¯å£æ¦‚å¿µ"></a>ç«¯å£æ¦‚å¿µ</h4><p>ç«¯å£æ˜¯è®¾å¤‡ä¸å¤–ç•Œé€šè®¯äº¤æµçš„å‡ºå…¥å£ã€‚ç«¯å£å¯ä»¥åˆ†ä¸ºï¼š<strong>ç‰©ç†ç«¯å£</strong>å’Œ<strong>è™šæ‹Ÿç«¯å£</strong>ä¸¤ç±»</p><p><strong>ç‰©ç†ç«¯å£ï¼š</strong></p><ul><li>åˆå¯ç§°ä¹‹ä¸ºæ¥å£</li><li>æ˜¯å¯è§çš„ç«¯å£</li><li>ä¾‹å¦‚ï¼šUSBæ¥å£ã€RJ45ç½‘å£ã€HDMIç«¯å£ç­‰</li></ul><p><img src="/images/linux/img_54.png" alt="ç‰©ç†ç«¯å£"></p><p><strong>è™šæ‹Ÿç«¯å£ï¼š</strong></p><ul><li>æ˜¯æŒ‡è®¡ç®—æœºå†…éƒ¨çš„ç«¯å£</li><li>æ˜¯ä¸å¯è§çš„</li><li>ç”¨æ¥æ“ä½œç³»ç»Ÿå’Œå¤–éƒ¨è¿›è¡Œäº¤äº’ä½¿ç”¨çš„</li></ul><p><img src="/images/linux/img_55.png" alt="è™šæ‹Ÿç«¯å£"></p><h4 id="è™šæ‹Ÿç«¯å£çš„ä½œç”¨"><a href="#è™šæ‹Ÿç«¯å£çš„ä½œç”¨" class="headerlink" title="è™šæ‹Ÿç«¯å£çš„ä½œç”¨"></a>è™šæ‹Ÿç«¯å£çš„ä½œç”¨</h4><p>ç‰©ç†ç«¯å£æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ç»å¸¸è§åˆ°ï¼Œä¹Ÿèƒ½çŸ¥æ™“å®ƒçš„ä½œç”¨ã€‚</p><p>ä½†æ˜¯è™šæ‹Ÿç«¯å£ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒå‘¢ï¼Ÿ</p><p><img src="/images/linux/img_56.png" alt="å•çº¯é€šè¿‡IP"></p><p>è®¡ç®—æœºç¨‹åºä¹‹é—´çš„é€šè®¯ï¼Œé€šè¿‡IPåªèƒ½é”å®šè®¡ç®—æœºï¼Œä½†æ˜¯æ— æ³•é”å®šå…·ä½“çš„ç¨‹åºã€‚</p><p><img src="/images/linux/img_57.png" alt="é€šè¿‡ç«¯å£é”å®šç¨‹åº"></p><p><strong>ç«¯å£çš„ä½œç”¨ï¼š</strong> é€šè¿‡ç«¯å£å¯ä»¥é”å®šè®¡ç®—æœºä¸Šå…·ä½“çš„ç¨‹åºï¼Œç¡®ä¿ç¨‹åºä¹‹é—´è¿›è¡Œæ²Ÿé€š</p><blockquote><p>ğŸ’¡ <strong>ç±»æ¯”</strong>ï¼šIPåœ°å€ç›¸å½“äºå°åŒºåœ°å€ï¼Œåœ¨å°åŒºå†…å¯ä»¥æœ‰è®¸å¤šä½æˆ·ï¼ˆç¨‹åºï¼‰ï¼Œè€Œé—¨ç‰Œå·ï¼ˆç«¯å£ï¼‰å°±æ˜¯å„ä¸ªä½æˆ·ï¼ˆç¨‹åºï¼‰çš„è”ç³»åœ°å€</p></blockquote><h4 id="ç«¯å£èŒƒå›´åˆ’åˆ†"><a href="#ç«¯å£èŒƒå›´åˆ’åˆ†" class="headerlink" title="ç«¯å£èŒƒå›´åˆ’åˆ†"></a>ç«¯å£èŒƒå›´åˆ’åˆ†</h4><p>Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªè¶…å¤§å·å°åŒºï¼Œå¯ä»¥æ”¯æŒ <strong>65535</strong> ä¸ªç«¯å£ï¼Œè¿™6ä¸‡å¤šä¸ªç«¯å£åˆ†ä¸º3ç±»è¿›è¡Œä½¿ç”¨ï¼š</p><table><thead><tr><th>ç«¯å£èŒƒå›´</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>1~1023</td><td>å…¬è®¤ç«¯å£</td><td>é€šå¸¸ç”¨äºä¸€äº›ç³»ç»Ÿå†…ç½®æˆ–çŸ¥åç¨‹åºçš„é¢„ç•™ä½¿ç”¨ï¼Œå¦‚SSHæœåŠ¡çš„22ç«¯å£ï¼ŒHTTPSæœåŠ¡çš„443ç«¯å£ã€‚éç‰¹æ®Šéœ€è¦ï¼Œä¸è¦å ç”¨è¿™ä¸ªèŒƒå›´çš„ç«¯å£</td></tr><tr><td>1024~49151</td><td>æ³¨å†Œç«¯å£</td><td>é€šå¸¸å¯ä»¥éšæ„ä½¿ç”¨ï¼Œç”¨äºæ¾æ•£çš„ç»‘å®šä¸€äº›ç¨‹åº&#x2F;æœåŠ¡</td></tr><tr><td>49152~65535</td><td>åŠ¨æ€ç«¯å£</td><td>é€šå¸¸ä¸ä¼šå›ºå®šç»‘å®šç¨‹åºï¼Œè€Œæ˜¯å½“ç¨‹åºå¯¹å¤–è¿›è¡Œç½‘ç»œé“¾æ¥æ—¶ï¼Œç”¨äºä¸´æ—¶ä½¿ç”¨</td></tr></tbody></table><p><img src="/images/linux/img_58.png" alt="ç«¯å£ä½¿ç”¨ç¤ºæ„"></p><p><strong>ç«¯å£ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><ul><li>è®¡ç®—æœºAçš„å¾®ä¿¡è¿æ¥è®¡ç®—æœºBçš„å¾®ä¿¡</li><li>Aä½¿ç”¨çš„50001å³<strong>åŠ¨æ€ç«¯å£</strong>ï¼Œä¸´æ—¶æ‰¾ä¸€ä¸ªç«¯å£ä½œä¸ºå‡ºå£</li><li>Bçš„å¾®ä¿¡ä½¿ç”¨ç«¯å£5678ï¼Œå³<strong>æ³¨å†Œç«¯å£</strong>ï¼Œé•¿æœŸç»‘å®šæ­¤ç«¯å£ç­‰å¾…åˆ«äººè¿æ¥</li></ul><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šä¸Šè¿°å¾®ä¿¡çš„ç«¯å£ä»…ä¸ºæ¼”ç¤ºï¼Œå…·ä½“å¾®ä¿¡çš„ç«¯å£ä½¿ç”¨éå›¾ä¸­ç¤ºæ„</p></blockquote><h4 id="æŸ¥çœ‹ç«¯å£å ç”¨"><a href="#æŸ¥çœ‹ç«¯å£å ç”¨" class="headerlink" title="æŸ¥çœ‹ç«¯å£å ç”¨"></a>æŸ¥çœ‹ç«¯å£å ç”¨</h4><p><strong>ä½¿ç”¨nmapå‘½ä»¤ï¼š</strong></p><p>é¦–å…ˆå®‰è£…nmapï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install nmap</span><br></pre></td></tr></table></figure><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap è¢«æŸ¥çœ‹çš„IPåœ°å€</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_59.png" alt="nmapæŸ¥çœ‹ç«¯å£"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ¬æœºï¼ˆ127.0.0.1ï¼‰ä¸Šæœ‰å¤šä¸ªç«¯å£è¢«ç¨‹åºå ç”¨ã€‚</p><p>å…¶ä¸­ <strong>22ç«¯å£</strong> ä¸€èˆ¬æ˜¯SSHæœåŠ¡ä½¿ç”¨ï¼Œå³FinalShellè¿œç¨‹è¿æ¥Linuxæ‰€ä½¿ç”¨çš„ç«¯å£ã€‚</p><p><strong>ä½¿ç”¨netstatå‘½ä»¤æŸ¥çœ‹æŒ‡å®šç«¯å£ï¼š</strong></p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -anp | grep ç«¯å£å·</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_60.png" alt="netstatæŸ¥çœ‹ç«¯å£"></p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@chad suoliang]# netstat -anp | grep 1111</span><br><span class="line">[root@chad suoliang]#</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“å‰ç³»ç»Ÿ1111ç«¯å£æ— äººä½¿ç”¨ã€‚</p><h3 id="13-9-è¿›ç¨‹ç®¡ç†-âš¡"><a href="#13-9-è¿›ç¨‹ç®¡ç†-âš¡" class="headerlink" title="13.9 è¿›ç¨‹ç®¡ç† âš¡"></a>13.9 è¿›ç¨‹ç®¡ç† âš¡</h3><h4 id="è¿›ç¨‹çš„æ¦‚å¿µ"><a href="#è¿›ç¨‹çš„æ¦‚å¿µ" class="headerlink" title="è¿›ç¨‹çš„æ¦‚å¿µ"></a>è¿›ç¨‹çš„æ¦‚å¿µ</h4><p>ç¨‹åºè¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ˜¯è¢«æ“ä½œç³»ç»Ÿæ‰€ç®¡ç†çš„ã€‚</p><p>ä¸ºç®¡ç†è¿è¡Œçš„ç¨‹åºï¼Œæ¯ä¸€ä¸ªç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¾¿è¢«æ“ä½œç³»ç»Ÿæ³¨å†Œä¸ºç³»ç»Ÿä¸­çš„ä¸€ä¸ªï¼š<strong>è¿›ç¨‹</strong></p><p>å¹¶ä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½åˆ†é…ä¸€ä¸ªç‹¬æœ‰çš„ï¼š<strong>è¿›ç¨‹IDï¼ˆè¿›ç¨‹å·ï¼‰</strong></p><h4 id="pså‘½ä»¤-æŸ¥çœ‹è¿›ç¨‹"><a href="#pså‘½ä»¤-æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="pså‘½ä»¤ - æŸ¥çœ‹è¿›ç¨‹"></a>pså‘½ä»¤ - æŸ¥çœ‹è¿›ç¨‹</h4><p>å¯ä»¥é€šè¿‡ <code>ps</code> å‘½ä»¤æŸ¥çœ‹Linuxç³»ç»Ÿä¸­çš„è¿›ç¨‹ä¿¡æ¯</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps [-e -f]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-e</code>ï¼šæ˜¾ç¤ºå‡ºå…¨éƒ¨çš„è¿›ç¨‹</li><li><code>-f</code>ï¼šä»¥å®Œå…¨æ ¼å¼åŒ–çš„å½¢å¼å±•ç¤ºä¿¡æ¯ï¼ˆå±•ç¤ºå…¨éƒ¨ä¿¡æ¯ï¼‰</li></ul><p><strong>å¸¸ç”¨ç»„åˆï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef  <span class="comment"># åˆ—å‡ºå…¨éƒ¨è¿›ç¨‹çš„å…¨éƒ¨ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_61.png" alt="pså‘½ä»¤è¾“å‡º"></p><h4 id="pså‘½ä»¤è¾“å‡ºä¿¡æ¯è¯¦è§£"><a href="#pså‘½ä»¤è¾“å‡ºä¿¡æ¯è¯¦è§£" class="headerlink" title="pså‘½ä»¤è¾“å‡ºä¿¡æ¯è¯¦è§£"></a>pså‘½ä»¤è¾“å‡ºä¿¡æ¯è¯¦è§£</h4><p>ä»å·¦åˆ°å³åˆ†åˆ«æ˜¯ï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>UID</td><td>è¿›ç¨‹æ‰€å±çš„ç”¨æˆ·ID</td></tr><tr><td>PID</td><td>è¿›ç¨‹çš„è¿›ç¨‹å·ID</td></tr><tr><td>PPID</td><td>è¿›ç¨‹çš„çˆ¶IDï¼ˆå¯åŠ¨æ­¤è¿›ç¨‹çš„å…¶å®ƒè¿›ç¨‹ï¼‰</td></tr><tr><td>C</td><td>æ­¤è¿›ç¨‹çš„CPUå ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰</td></tr><tr><td>STIME</td><td>è¿›ç¨‹çš„å¯åŠ¨æ—¶é—´</td></tr><tr><td>TTY</td><td>å¯åŠ¨æ­¤è¿›ç¨‹çš„ç»ˆç«¯åºå·ï¼Œå¦‚æ˜¾ç¤º?ï¼Œè¡¨ç¤ºéç»ˆç«¯å¯åŠ¨</td></tr><tr><td>TIME</td><td>è¿›ç¨‹å ç”¨CPUçš„æ—¶é—´</td></tr><tr><td>CMD</td><td>è¿›ç¨‹å¯¹åº”çš„åç§°æˆ–å¯åŠ¨è·¯å¾„æˆ–å¯åŠ¨å‘½ä»¤</td></tr></tbody></table><h4 id="æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹"><a href="#æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹" class="headerlink" title="æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹"></a>æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹</h4><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œ<code>ps -ef</code> ä¼šåˆ—å‡ºå¤§é‡è¿›ç¨‹ä¿¡æ¯ï¼Œå¦‚ä½•å¿«é€Ÿæ‰¾åˆ°æƒ³è¦çš„è¿›ç¨‹ï¼Ÿ</p><p><strong>é—®é¢˜åœºæ™¯ï¼š</strong></p><ol><li>åœ¨FinalShellä¸­ï¼Œæ‰§è¡Œå‘½ä»¤ <code>tail</code>ï¼Œæ­¤å‘½ä»¤ä¼šä¸€ç›´é˜»å¡åœ¨é‚£é‡Œ</li><li>åœ¨FinalShellä¸­ï¼Œå¤åˆ¶ä¸€ä¸ªæ ‡ç­¾é¡µï¼Œæ‰§è¡Œ <code>ps -ef</code> æ‰¾å‡ºtailè¿™ä¸ªç¨‹åºçš„è¿›ç¨‹ä¿¡æ¯</li><li>åˆ—å‡ºçš„ä¿¡æ¯å¤ªå¤šï¼Œæ— æ³•å‡†ç¡®æ‰¾åˆ°æ€ä¹ˆåŠï¼Ÿ</li></ol><p><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ç®¡é“ç¬¦é…åˆgrepè¿›è¡Œè¿‡æ»¤</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿‡æ»¤å‡ºåŒ…å«tailå…³é”®å­—çš„è¿›ç¨‹</span></span><br><span class="line">ps -ef | grep <span class="built_in">tail</span></span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_62.png" alt="grepè¿‡æ»¤è¿›ç¨‹"></p><p><strong>å…¶ä»–è¿‡æ»¤ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡è¿›ç¨‹å·è¿‡æ»¤</span></span><br><span class="line">ps -ef | grep 30001</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡ç”¨æˆ·åè¿‡æ»¤</span></span><br><span class="line">ps -ef | grep root</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿‡æ»¤å¤šä¸ªå…³é”®å­—</span></span><br><span class="line">ps -ef | grep <span class="built_in">tail</span> | grep root</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šè¿‡æ»¤ä¸ä»…ä»…å¯ä»¥è¿‡æ»¤åç§°ï¼Œè¿›ç¨‹å·ã€ç”¨æˆ·IDç­‰ç­‰ï¼Œéƒ½å¯ä»¥è¢«grepè¿‡æ»¤</p></blockquote><h4 id="killå‘½ä»¤-å…³é—­è¿›ç¨‹"><a href="#killå‘½ä»¤-å…³é—­è¿›ç¨‹" class="headerlink" title="killå‘½ä»¤ - å…³é—­è¿›ç¨‹"></a>killå‘½ä»¤ - å…³é—­è¿›ç¨‹</h4><p>åœ¨Windowsç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡ä»»åŠ¡ç®¡ç†å™¨é€‰æ‹©è¿›ç¨‹åï¼Œç‚¹å‡»ç»“æŸè¿›ç¨‹ä»è€Œå…³é—­å®ƒã€‚</p><p>åŒæ ·ï¼Œåœ¨Linuxä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>kill</code> å‘½ä»¤å…³é—­è¿›ç¨‹ã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> [-9] [è¿›ç¨‹å·]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-9</code>ï¼šè¡¨ç¤ºå¼ºåˆ¶å…³é—­è¿›ç¨‹ã€‚ä¸ä½¿ç”¨æ­¤é€‰é¡¹ä¼šå‘è¿›ç¨‹å‘é€ä¿¡å·è¦æ±‚å…¶å…³é—­ï¼Œä½†æ˜¯å¦å…³é—­çœ‹è¿›ç¨‹è‡ªèº«çš„å¤„ç†æœºåˆ¶</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆæŸ¥æ‰¾è¿›ç¨‹</span></span><br><span class="line">ps -ef | grep <span class="built_in">tail</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾æ‰¾åˆ°è¿›ç¨‹å·ä¸º12345</span></span><br><span class="line"><span class="comment"># æ¸©å’Œå…³é—­è¿›ç¨‹</span></span><br><span class="line"><span class="built_in">kill</span> 12345</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶å…³é—­è¿›ç¨‹</span></span><br><span class="line"><span class="built_in">kill</span> -9 12345</span><br></pre></td></tr></table></figure><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼š</p><ul><li>æ™®é€šç”¨æˆ·åªèƒ½å…³é—­è‡ªå·±çš„è¿›ç¨‹</li><li>rootç”¨æˆ·å¯ä»¥å…³é—­ä»»ä½•è¿›ç¨‹</li><li><code>-9</code> é€‰é¡¹ä¼šå¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œè°¨æ…ä½¿ç”¨</li></ul></blockquote><h3 id="13-10-ä¸»æœºçŠ¶æ€ç›‘æ§-ğŸ“Š"><a href="#13-10-ä¸»æœºçŠ¶æ€ç›‘æ§-ğŸ“Š" class="headerlink" title="13.10 ä¸»æœºçŠ¶æ€ç›‘æ§ ğŸ“Š"></a>13.10 ä¸»æœºçŠ¶æ€ç›‘æ§ ğŸ“Š</h3><h4 id="topå‘½ä»¤-æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€"><a href="#topå‘½ä»¤-æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€" class="headerlink" title="topå‘½ä»¤ - æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€"></a>topå‘½ä»¤ - æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€</h4><p>å¯ä»¥é€šè¿‡ <code>top</code> å‘½ä»¤æŸ¥çœ‹CPUã€å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œç±»ä¼¼Windowsçš„ä»»åŠ¡ç®¡ç†å™¨</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p><ul><li>é»˜è®¤æ¯5ç§’åˆ·æ–°ä¸€æ¬¡</li><li>æŒ‰ <code>q</code> æˆ– <code>Ctrl + C</code> é€€å‡º</li></ul><p><img src="/images/linux/img_63.png" alt="topå‘½ä»¤ç•Œé¢"></p><h4 id="topå‘½ä»¤å¤´éƒ¨ä¿¡æ¯è¯¦è§£"><a href="#topå‘½ä»¤å¤´éƒ¨ä¿¡æ¯è¯¦è§£" class="headerlink" title="topå‘½ä»¤å¤´éƒ¨ä¿¡æ¯è¯¦è§£"></a>topå‘½ä»¤å¤´éƒ¨ä¿¡æ¯è¯¦è§£</h4><p><strong>ç¬¬ä¸€è¡Œï¼š</strong></p><ul><li><code>top</code>ï¼šå‘½ä»¤åç§°</li><li><code>14:39:58</code>ï¼šå½“å‰ç³»ç»Ÿæ—¶é—´</li><li><code>up 6 min</code>ï¼šç³»ç»Ÿè¿è¡Œæ—¶é—´</li><li><code>2 users</code>ï¼š2ä¸ªç”¨æˆ·ç™»å½•</li><li><code>load average</code>ï¼š1ã€5ã€15åˆ†é’Ÿå¹³å‡è´Ÿè½½</li></ul><p><strong>ç¬¬äºŒè¡Œï¼ˆTasksï¼‰ï¼š</strong></p><ul><li><code>175 total</code>ï¼š175ä¸ªè¿›ç¨‹</li><li><code>1 running</code>ï¼š1ä¸ªè¿›ç¨‹æ­£åœ¨è¿è¡Œ</li><li><code>174 sleeping</code>ï¼š174ä¸ªè¿›ç¨‹ç¡çœ </li><li><code>0 stopped</code>ï¼š0ä¸ªåœæ­¢è¿›ç¨‹</li><li><code>0 zombie</code>ï¼š0ä¸ªåƒµå°¸è¿›ç¨‹</li></ul><p><strong>ç¬¬ä¸‰è¡Œï¼ˆCPUä½¿ç”¨ç‡ï¼‰ï¼š</strong></p><table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>us</code></td><td>ç”¨æˆ·ç©ºé—´CPUä½¿ç”¨ç‡</td></tr><tr><td><code>sy</code></td><td>ç³»ç»Ÿï¼ˆå†…æ ¸ï¼‰CPUä½¿ç”¨ç‡</td></tr><tr><td><code>ni</code></td><td>é«˜ä¼˜å…ˆçº§è¿›ç¨‹å ç”¨CPUæ—¶é—´ç™¾åˆ†æ¯”</td></tr><tr><td><code>id</code></td><td>ç©ºé—²CPUç‡</td></tr><tr><td><code>wa</code></td><td>IOç­‰å¾…CPUå ç”¨ç‡</td></tr><tr><td><code>hi</code></td><td>CPUç¡¬ä»¶ä¸­æ–­ç‡</td></tr><tr><td><code>si</code></td><td>CPUè½¯ä»¶ä¸­æ–­ç‡</td></tr><tr><td><code>st</code></td><td>è™šæ‹ŸåŒ–ç¯å¢ƒä¸­å¼ºåˆ¶ç­‰å¾…å ç”¨CPUç‡</td></tr></tbody></table><p><strong>ç¬¬å››ã€äº”è¡Œï¼ˆå†…å­˜ä¿¡æ¯ï¼‰ï¼š</strong></p><ul><li><strong>Kib Memï¼ˆç‰©ç†å†…å­˜ï¼‰</strong>ï¼štotalï¼ˆæ€»é‡ï¼‰ã€freeï¼ˆç©ºé—²ï¼‰ã€usedï¼ˆä½¿ç”¨ï¼‰ã€buff&#x2F;cacheï¼ˆç¼“å†²&#x2F;ç¼“å­˜å ç”¨ï¼‰</li><li><strong>KibSwapï¼ˆè™šæ‹Ÿå†…å­˜&#x2F;äº¤æ¢ç©ºé—´ï¼‰</strong>ï¼štotalï¼ˆæ€»é‡ï¼‰ã€freeï¼ˆç©ºé—²ï¼‰ã€usedï¼ˆä½¿ç”¨ï¼‰ã€avail Memï¼ˆå¯ç”¨å†…å­˜ï¼‰</li></ul><h4 id="topå‘½ä»¤è¿›ç¨‹åˆ—è¡¨è¯¦è§£"><a href="#topå‘½ä»¤è¿›ç¨‹åˆ—è¡¨è¯¦è§£" class="headerlink" title="topå‘½ä»¤è¿›ç¨‹åˆ—è¡¨è¯¦è§£"></a>topå‘½ä»¤è¿›ç¨‹åˆ—è¡¨è¯¦è§£</h4><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>PID</td><td>è¿›ç¨‹ID</td></tr><tr><td>USER</td><td>è¿›ç¨‹æ‰€å±ç”¨æˆ·</td></tr><tr><td>PR</td><td>è¿›ç¨‹ä¼˜å…ˆçº§ï¼Œè¶Šå°è¶Šé«˜</td></tr><tr><td>NI</td><td>niceå€¼ï¼Œè´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§</td></tr><tr><td>VIRT</td><td>è¿›ç¨‹ä½¿ç”¨è™šæ‹Ÿå†…å­˜ï¼Œå•ä½KB</td></tr><tr><td>RES</td><td>è¿›ç¨‹ä½¿ç”¨ç‰©ç†å†…å­˜ï¼Œå•ä½KB</td></tr><tr><td>SHR</td><td>è¿›ç¨‹ä½¿ç”¨å…±äº«å†…å­˜ï¼Œå•ä½KB</td></tr><tr><td>S</td><td>è¿›ç¨‹çŠ¶æ€ï¼ˆSä¼‘çœ ï¼ŒRè¿è¡Œï¼ŒZåƒµæ­»ï¼ŒNè´Ÿä¼˜å…ˆçº§ï¼ŒIç©ºé—²ï¼‰</td></tr><tr><td>%CPU</td><td>è¿›ç¨‹å ç”¨CPUç‡</td></tr><tr><td>%MEM</td><td>è¿›ç¨‹å ç”¨å†…å­˜ç‡</td></tr><tr><td>TIME+</td><td>è¿›ç¨‹ä½¿ç”¨CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½10æ¯«ç§’</td></tr><tr><td>COMMAND</td><td>è¿›ç¨‹çš„å‘½ä»¤æˆ–åç§°æˆ–ç¨‹åºæ–‡ä»¶è·¯å¾„</td></tr></tbody></table><h4 id="topå‘½ä»¤é€‰é¡¹"><a href="#topå‘½ä»¤é€‰é¡¹" class="headerlink" title="topå‘½ä»¤é€‰é¡¹"></a>topå‘½ä»¤é€‰é¡¹</h4><p><img src="/images/linux/img_64.png" alt="topå‘½ä»¤é€‰é¡¹"></p><p><strong>å¸¸ç”¨é€‰é¡¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®åˆ·æ–°é—´éš”ä¸º2ç§’</span></span><br><span class="line">top -d 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šåˆ·æ–°æ¬¡æ•°</span></span><br><span class="line">top -n 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¹å¤„ç†æ¨¡å¼ï¼ˆé€‚åˆè„šæœ¬ï¼‰</span></span><br><span class="line">top -b</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›‘æ§æŒ‡å®šè¿›ç¨‹</span></span><br><span class="line">top -p è¿›ç¨‹å·</span><br></pre></td></tr></table></figure><h4 id="topäº¤äº’å¼å‘½ä»¤"><a href="#topäº¤äº’å¼å‘½ä»¤" class="headerlink" title="topäº¤äº’å¼å‘½ä»¤"></a>topäº¤äº’å¼å‘½ä»¤</h4><p>å½“topä»¥äº¤äº’å¼è¿è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ§åˆ¶ï¼š</p><p><img src="/images/linux/img_65.png" alt="topäº¤äº’å¼å‘½ä»¤"></p><table><thead><tr><th>æŒ‰é”®</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>h</code></td><td>æ˜¾ç¤ºå¸®åŠ©</td></tr><tr><td><code>P</code></td><td>æŒ‰CPUä½¿ç”¨ç‡æ’åº</td></tr><tr><td><code>M</code></td><td>æŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åº</td></tr><tr><td><code>N</code></td><td>æŒ‰PIDæ’åº</td></tr><tr><td><code>T</code></td><td>æŒ‰è¿è¡Œæ—¶é—´æ’åº</td></tr><tr><td><code>k</code></td><td>ç»ˆæ­¢è¿›ç¨‹ï¼ˆéœ€è¾“å…¥PIDï¼‰</td></tr><tr><td><code>q</code></td><td>é€€å‡ºtop</td></tr></tbody></table><h4 id="dfå‘½ä»¤-ç£ç›˜ä½¿ç”¨æƒ…å†µ"><a href="#dfå‘½ä»¤-ç£ç›˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="dfå‘½ä»¤ - ç£ç›˜ä½¿ç”¨æƒ…å†µ"></a>dfå‘½ä»¤ - ç£ç›˜ä½¿ç”¨æƒ…å†µ</h4><p>ä½¿ç”¨ <code>df</code> å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ç¡¬ç›˜çš„ä½¿ç”¨æƒ…å†µ</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> [-h]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-h</code>ï¼šä»¥æ›´åŠ äººæ€§åŒ–çš„å•ä½æ˜¾ç¤ºï¼ˆKã€Mã€Gï¼‰</li></ul><p><img src="/images/linux/img_66.png" alt="dfå‘½ä»¤è¾“å‡º"></p><p><strong>è¾“å‡ºä¿¡æ¯è¯´æ˜ï¼š</strong></p><ul><li><code>Filesystem</code>ï¼šæ–‡ä»¶ç³»ç»Ÿ</li><li><code>Size</code>ï¼šæ€»å¤§å°</li><li><code>Used</code>ï¼šå·²ä½¿ç”¨</li><li><code>Avail</code>ï¼šå¯ç”¨ç©ºé—´</li><li><code>Use%</code>ï¼šä½¿ç”¨ç™¾åˆ†æ¯”</li><li><code>Mounted on</code>ï¼šæŒ‚è½½ç‚¹</li></ul><h4 id="iostatå‘½ä»¤-ç£ç›˜IOç»Ÿè®¡"><a href="#iostatå‘½ä»¤-ç£ç›˜IOç»Ÿè®¡" class="headerlink" title="iostatå‘½ä»¤ - ç£ç›˜IOç»Ÿè®¡"></a>iostatå‘½ä»¤ - ç£ç›˜IOç»Ÿè®¡</h4><p>å¯ä»¥ä½¿ç”¨ <code>iostat</code> æŸ¥çœ‹CPUã€ç£ç›˜çš„ç›¸å…³ä¿¡æ¯</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat [-x] [åˆ·æ–°é—´éš”] [åˆ·æ–°æ¬¡æ•°]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-x</code>ï¼šæ˜¾ç¤ºæ›´å¤šè¯¦ç»†ä¿¡æ¯</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ä¸€æ¬¡</span></span><br><span class="line">iostat</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯2ç§’åˆ·æ–°ä¸€æ¬¡ï¼Œå…±3æ¬¡</span></span><br><span class="line">iostat 2 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">iostat -x</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_67.png" alt="iostatå‘½ä»¤è¾“å‡º"></p><p><strong>ä¸»è¦æŒ‡æ ‡è¯´æ˜ï¼š</strong></p><ul><li><code>tps</code>ï¼šè¯¥è®¾å¤‡æ¯ç§’çš„ä¼ è¾“æ¬¡æ•°ï¼ˆI&#x2F;Oè¯·æ±‚æ¬¡æ•°ï¼‰</li><li><code>kB_read/s</code>ï¼šæ¯ç§’ä»è®¾å¤‡è¯»å–çš„æ•°æ®é‡</li><li><code>kB_wrtn/s</code>ï¼šæ¯ç§’å‘è®¾å¤‡å†™å…¥çš„æ•°æ®é‡</li></ul><p><strong>iostat -x è¯¦ç»†æŒ‡æ ‡ï¼š</strong></p><table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>rrqm/s</code></td><td>æ¯ç§’åˆå¹¶çš„è¯»è¯·æ±‚æ•°</td></tr><tr><td><code>wrqm/s</code></td><td>æ¯ç§’åˆå¹¶çš„å†™è¯·æ±‚æ•°</td></tr><tr><td><code>r/s</code></td><td>æ¯ç§’è¯»è¯·æ±‚æ•°</td></tr><tr><td><code>w/s</code></td><td>æ¯ç§’å†™è¯·æ±‚æ•°</td></tr><tr><td><code>rkB/s</code></td><td>æ¯ç§’è¯»å–çš„KBæ•°</td></tr><tr><td><code>wkB/s</code></td><td>æ¯ç§’å†™å…¥çš„KBæ•°</td></tr><tr><td><code>avgrq-sz</code></td><td>å¹³å‡è¯·æ±‚æ‰‡åŒºå¤§å°</td></tr><tr><td><code>avgqu-sz</code></td><td>å¹³å‡è¯·æ±‚é˜Ÿåˆ—é•¿åº¦</td></tr><tr><td><code>await</code></td><td>å¹³å‡æ¯æ¬¡IOè¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td><code>svctm</code></td><td>å¹³å‡æ¯æ¬¡è®¾å¤‡I&#x2F;Oæ“ä½œçš„æœåŠ¡æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td><code>%util</code></td><td>ç£ç›˜åˆ©ç”¨ç‡</td></tr></tbody></table><h4 id="sarå‘½ä»¤-ç½‘ç»œçŠ¶æ€ç›‘æ§"><a href="#sarå‘½ä»¤-ç½‘ç»œçŠ¶æ€ç›‘æ§" class="headerlink" title="sarå‘½ä»¤ - ç½‘ç»œçŠ¶æ€ç›‘æ§"></a>sarå‘½ä»¤ - ç½‘ç»œçŠ¶æ€ç›‘æ§</h4><p>å¯ä»¥ä½¿ç”¨ <code>sar</code> å‘½ä»¤æŸ¥çœ‹ç½‘ç»œçš„ç›¸å…³ç»Ÿè®¡</p><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šsarå‘½ä»¤éå¸¸å¤æ‚ï¼Œè¿™é‡Œä»…ç®€å•ç”¨äºç»Ÿè®¡ç½‘ç»œ</p></blockquote><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -n DEV [åˆ·æ–°é—´éš”] [æŸ¥çœ‹æ¬¡æ•°]</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-n</code>ï¼šæŸ¥çœ‹ç½‘ç»œ</li><li><code>DEV</code>ï¼šè¡¨ç¤ºæŸ¥çœ‹ç½‘ç»œæ¥å£</li><li>åˆ·æ–°é—´éš”ï¼šä¸å¡«å°±æŸ¥çœ‹ä¸€æ¬¡ç»“æŸ</li><li>æŸ¥çœ‹æ¬¡æ•°ï¼šä¸å¡«åˆ™æ— é™æ¬¡æ•°</li></ul><p><img src="/images/linux/img_68.png" alt="sarå‘½ä»¤è¾“å‡º"></p><p><strong>ä¿¡æ¯å­—æ®µè¯´æ˜ï¼š</strong></p><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>IFACE</code></td><td>æœ¬åœ°ç½‘å¡æ¥å£çš„åç§°</td></tr><tr><td><code>rxpck/s</code></td><td>æ¯ç§’é’Ÿæ¥æ”¶çš„æ•°æ®åŒ…</td></tr><tr><td><code>txpck/s</code></td><td>æ¯ç§’é’Ÿå‘é€çš„æ•°æ®åŒ…</td></tr><tr><td><code>rxkB/s</code></td><td>æ¯ç§’é’Ÿæ¥æ”¶çš„æ•°æ®åŒ…å¤§å°ï¼Œå•ä½KB</td></tr><tr><td><code>txkB/s</code></td><td>æ¯ç§’é’Ÿå‘é€çš„æ•°æ®åŒ…å¤§å°ï¼Œå•ä½KB</td></tr><tr><td><code>rxcmp/s</code></td><td>æ¯ç§’é’Ÿæ¥æ”¶çš„å‹ç¼©æ•°æ®åŒ…</td></tr><tr><td><code>txcmp/s</code></td><td>æ¯ç§’é’Ÿå‘é€çš„å‹ç¼©åŒ…</td></tr><tr><td><code>rxmcst/s</code></td><td>æ¯ç§’é’Ÿæ¥æ”¶çš„å¤šæ’­æ•°æ®åŒ…</td></tr></tbody></table><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹2æ¬¡ï¼Œæ¯æ¬¡é—´éš”3ç§’</span></span><br><span class="line">sar -n DEV 3 2</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆä¼šæ±‡æ€»æ˜¾ç¤ºå¹³å‡è®°å½•</p><h3 id="13-11-ç¯å¢ƒå˜é‡-ğŸ”§"><a href="#13-11-ç¯å¢ƒå˜é‡-ğŸ”§" class="headerlink" title="13.11 ç¯å¢ƒå˜é‡ ğŸ”§"></a>13.11 ç¯å¢ƒå˜é‡ ğŸ”§</h3><h4 id="ç¯å¢ƒå˜é‡æ¦‚å¿µ"><a href="#ç¯å¢ƒå˜é‡æ¦‚å¿µ" class="headerlink" title="ç¯å¢ƒå˜é‡æ¦‚å¿µ"></a>ç¯å¢ƒå˜é‡æ¦‚å¿µ</h4><p>åœ¨è®²è§£ <code>which</code> å‘½ä»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“ä½¿ç”¨çš„ä¸€ç³»åˆ—å‘½ä»¤å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªä¸ªçš„å¯æ‰§è¡Œç¨‹åºã€‚</p><p>æ¯”å¦‚ï¼Œ<code>cd</code> å‘½ä»¤çš„æœ¬ä½“å°±æ˜¯ï¼š<code>/usr/bin/cd</code> è¿™ä¸ªç¨‹åºæ–‡ä»¶ã€‚</p><p><strong>é—®é¢˜ï¼š</strong> ä¸ºä½•æ— è®ºå½“å‰å·¥ä½œç›®å½•åœ¨å“ªé‡Œï¼Œéƒ½èƒ½æ‰§è¡Œ <code>/usr/bin/cd</code> è¿™ä¸ªç¨‹åºå‘¢ï¼Ÿ</p><p><strong>ç­”æ¡ˆï¼š</strong> è¿™å°±æ˜¯ç¯å¢ƒå˜é‡çš„ä½œç”¨ï¼</p><p><strong>ç¯å¢ƒå˜é‡å®šä¹‰ï¼š</strong> ç¯å¢ƒå˜é‡æ˜¯æ“ä½œç³»ç»Ÿï¼ˆWindowsã€Linuxã€Macï¼‰åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œè®°å½•çš„ä¸€äº›å…³é”®æ€§ä¿¡æ¯ï¼Œç”¨ä»¥è¾…åŠ©ç³»ç»Ÿè¿è¡Œã€‚</p><h4 id="æŸ¥çœ‹ç¯å¢ƒå˜é‡"><a href="#æŸ¥çœ‹ç¯å¢ƒå˜é‡" class="headerlink" title="æŸ¥çœ‹ç¯å¢ƒå˜é‡"></a>æŸ¥çœ‹ç¯å¢ƒå˜é‡</h4><p>åœ¨Linuxç³»ç»Ÿä¸­æ‰§è¡Œ <code>env</code> å‘½ä»¤å³å¯æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­è®°å½•çš„ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">env</span></span><br></pre></td></tr></table></figure><p>ç¯å¢ƒå˜é‡æ˜¯ä¸€ç§ <strong>KeyValueå‹ç»“æ„</strong>ï¼Œå³åç§°å’Œå€¼</p><p><img src="/images/linux/img_69.png" alt="ç¯å¢ƒå˜é‡åˆ—è¡¨"></p><p><strong>å¸¸è§ç¯å¢ƒå˜é‡ï¼š</strong></p><ul><li><code>HOME</code>ï¼šç”¨æˆ·çš„HOMEè·¯å¾„</li><li><code>USER</code>ï¼šå½“å‰çš„æ“ä½œç”¨æˆ·</li><li><code>PWD</code>ï¼šå½“å‰å·¥ä½œè·¯å¾„</li><li><code>PATH</code>ï¼šå‘½ä»¤æœç´¢è·¯å¾„</li><li><code>SHELL</code>ï¼šå½“å‰ä½¿ç”¨çš„Shell</li></ul><h4 id="PATHç¯å¢ƒå˜é‡"><a href="#PATHç¯å¢ƒå˜é‡" class="headerlink" title="PATHç¯å¢ƒå˜é‡"></a>PATHç¯å¢ƒå˜é‡</h4><p>åœ¨å‰é¢æå‡ºçš„é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬è¯´æ— è®ºå½“å‰å·¥ä½œç›®å½•æ˜¯ä»€ä¹ˆï¼Œéƒ½èƒ½æ‰§è¡Œ <code>/usr/bin/cd</code> è¿™ä¸ªç¨‹åºï¼Œè¿™ä¸ªå°±æ˜¯å€ŸåŠ©ç¯å¢ƒå˜é‡ä¸­ <strong>PATH</strong> è¿™ä¸ªé¡¹ç›®çš„å€¼æ¥åšåˆ°çš„ã€‚</p><p><strong>PATHçš„ä½œç”¨ï¼š</strong> è®°å½•äº†ç³»ç»Ÿæ‰§è¡Œä»»ä½•å‘½ä»¤çš„æœç´¢è·¯å¾„</p><p><strong>PATHçš„å€¼ç¤ºä¾‹</strong>ï¼ˆè·¯å¾„ä¹‹é—´ä»¥ <code>:</code> éš”å¼€ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin</span><br><span class="line">/usr/bin</span><br><span class="line">/usr/local/sbin</span><br><span class="line">/usr/sbin</span><br><span class="line">/home/chad/.local/bin</span><br><span class="line">/home/chad/bin</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œåŸç†ï¼š</strong></p><p>å½“æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œéƒ½ä¼šæŒ‰ç…§é¡ºåºï¼Œä»ä¸Šè¿°è·¯å¾„ä¸­æœç´¢è¦æ‰§è¡Œçš„ç¨‹åºçš„æœ¬ä½“ã€‚</p><p>æ¯”å¦‚æ‰§è¡Œ <code>cd</code> å‘½ä»¤ï¼Œå°±ä»ç¬¬äºŒä¸ªç›®å½• <code>/usr/bin</code> ä¸­æœç´¢åˆ°äº† <code>cd</code> å‘½ä»¤ï¼Œå¹¶æ‰§è¡Œã€‚</p><p><strong>æŸ¥çœ‹PATHï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@chad suoliang]# <span class="built_in">env</span> | grep PATH</span><br><span class="line">PATH=/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/suoliang/.local/bin:/home/suoliang/bin</span><br></pre></td></tr></table></figure><h4 id="ç¬¦å·-å–å˜é‡å€¼"><a href="#ç¬¦å·-å–å˜é‡å€¼" class="headerlink" title="$ç¬¦å· - å–å˜é‡å€¼"></a>$ç¬¦å· - å–å˜é‡å€¼</h4><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œ<code>$</code> ç¬¦å·è¢«ç”¨äºå–â€å˜é‡â€çš„å€¼ã€‚</p><p>ç¯å¢ƒå˜é‡è®°å½•çš„ä¿¡æ¯ï¼Œé™¤äº†ç»™æ“ä½œç³»ç»Ÿè‡ªå·±ä½¿ç”¨å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å–ç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p><p><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ç¯å¢ƒå˜é‡å</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹1ï¼šåŸºæœ¬ç”¨æ³•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¾“å‡ºPATHç¯å¢ƒå˜é‡çš„å€¼</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹2ï¼šæ··åˆä½¿ç”¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“å’Œå…¶å®ƒå†…å®¹æ··åˆåœ¨ä¸€èµ·æ—¶ï¼Œä½¿ç”¨&#123;&#125;æ¥æ ‡æ³¨å–çš„å˜é‡æ˜¯è°</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;PATH&#125;</span>ABC</span><br></pre></td></tr></table></figure><p><strong>å®é™…è¾“å‡ºï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@chad suoliang]# <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/suoliang/.local/bin:/home/suoliang/bin</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½®ç¯å¢ƒå˜é‡"></a>è®¾ç½®ç¯å¢ƒå˜é‡</h4><p>Linuxç¯å¢ƒå˜é‡å¯ä»¥ç”¨æˆ·è‡ªè¡Œè®¾ç½®ï¼Œåˆ†ä¸ºï¼š</p><p><strong>1. ä¸´æ—¶è®¾ç½®</strong></p><p>åªåœ¨å½“å‰ç»ˆç«¯ä¼šè¯æœ‰æ•ˆï¼Œå…³é—­ç»ˆç«¯åå¤±æ•ˆ</p><p><strong>è¯­æ³•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> å˜é‡å=å˜é‡å€¼</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MY_VAR=<span class="string">&quot;Hello World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$MY_VAR</span></span><br></pre></td></tr></table></figure><p><strong>2. æ°¸ä¹…ç”Ÿæ•ˆ</strong></p><p><strong>é’ˆå¯¹å½“å‰ç”¨æˆ·ç”Ÿæ•ˆï¼š</strong> é…ç½®åœ¨ <code>~/.bashrc</code> æ–‡ä»¶ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘.bashrcæ–‡ä»¶</span></span><br><span class="line">vim ~/.bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> MY_VAR=<span class="string">&quot;Hello World&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿é…ç½®ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p><strong>é’ˆå¯¹æ‰€æœ‰ç”¨æˆ·ç”Ÿæ•ˆï¼š</strong> é…ç½®åœ¨ <code>/etc/profile</code> æ–‡ä»¶ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘profileæ–‡ä»¶ï¼ˆéœ€è¦rootæƒé™ï¼‰</span></span><br><span class="line"><span class="built_in">sudo</span> vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> MY_VAR=<span class="string">&quot;Hello World&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿é…ç½®ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><p><img src="/images/linux/img_70.png" alt="ç¯å¢ƒå˜é‡é…ç½®"></p><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šä½¿ç”¨ <code>source</code> å‘½ä»¤å¯ä»¥ç«‹åˆ»ç”Ÿæ•ˆï¼Œæˆ–é‡æ–°ç™»å½•FinalShellä¹Ÿä¼šç”Ÿæ•ˆ</p></blockquote><h4 id="è‡ªå®šä¹‰PATHç¯å¢ƒå˜é‡"><a href="#è‡ªå®šä¹‰PATHç¯å¢ƒå˜é‡" class="headerlink" title="è‡ªå®šä¹‰PATHç¯å¢ƒå˜é‡"></a>è‡ªå®šä¹‰PATHç¯å¢ƒå˜é‡</h4><p>ç¯å¢ƒå˜é‡PATHè®°å½•äº†ç³»ç»Ÿæ‰§è¡Œå‘½ä»¤çš„æœç´¢è·¯å¾„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªè¡Œæ·»åŠ è·¯å¾„åˆ°PATHä¸­ã€‚</p><p><strong>å®è·µåœºæ™¯ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬åœ¨å½“å‰HOMEç›®å½•å†…åˆ›å»ºäº†ä¸€ä¸ªè„šæœ¬ï¼Œå¸Œæœ›åœ¨ä»»ä½•ç›®å½•ä¸‹éƒ½èƒ½æ‰§è¡Œå®ƒã€‚</p><p><strong>æ­¥éª¤1ï¼šåˆ›å»ºæµ‹è¯•è„šæœ¬</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨HOMEç›®å½•åˆ›å»ºmyenvæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">mkdir</span> ~/myenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè„šæœ¬æ–‡ä»¶</span></span><br><span class="line">vim ~/myenv/mkhaha</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤2ï¼šç¼–å†™è„šæœ¬å†…å®¹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å“ˆå“ˆå“ˆå“ˆå“ˆ&quot;</span></span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤3ï¼šæ·»åŠ æ‰§è¡Œæƒé™</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x ~/myenv/mkhaha</span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤4ï¼šæµ‹è¯•ï¼ˆæ­¤æ—¶æ— æ³•æ‰§è¡Œï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éšæ„åˆ‡æ¢å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•æ‰§è¡Œï¼ˆä¼šå¤±è´¥ï¼‰</span></span><br><span class="line">mkhaha</span><br><span class="line"><span class="comment"># æç¤ºï¼šcommand not found</span></span><br></pre></td></tr></table></figure><p><strong>æ­¥éª¤5ï¼šä¿®æ”¹PATH</strong></p><p><strong>ä¸´æ—¶ä¿®æ”¹PATHï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/chad/myenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡æ‰§è¡Œmkhahaï¼Œæ— è®ºåœ¨å“ªé‡Œéƒ½èƒ½æ‰§è¡Œäº†</span></span><br><span class="line">mkhaha</span><br></pre></td></tr></table></figure><p><strong>æ°¸ä¹…ä¿®æ”¹PATHï¼š</strong></p><p>å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ° <code>~/.bashrc</code> æˆ– <code>/etc/profile</code> æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/chad/myenv</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼š<code>$PATH</code> è¡¨ç¤ºä¿ç•™åŸæœ‰çš„PATHå€¼ï¼Œ<code>:</code> ç”¨äºåˆ†éš”å¤šä¸ªè·¯å¾„</p></blockquote><h3 id="13-12-æ–‡ä»¶å‹ç¼©å’Œè§£å‹-ğŸ“¦"><a href="#13-12-æ–‡ä»¶å‹ç¼©å’Œè§£å‹-ğŸ“¦" class="headerlink" title="13.12 æ–‡ä»¶å‹ç¼©å’Œè§£å‹ ğŸ“¦"></a>13.12 æ–‡ä»¶å‹ç¼©å’Œè§£å‹ ğŸ“¦</h3><h4 id="å‹ç¼©æ ¼å¼ä»‹ç»"><a href="#å‹ç¼©æ ¼å¼ä»‹ç»" class="headerlink" title="å‹ç¼©æ ¼å¼ä»‹ç»"></a>å‹ç¼©æ ¼å¼ä»‹ç»</h4><p>å¸‚é¢ä¸Šæœ‰éå¸¸å¤šçš„å‹ç¼©æ ¼å¼ï¼š</p><table><thead><tr><th>æ ¼å¼</th><th>é€‚ç”¨ç³»ç»Ÿ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>zip</strong></td><td>Linuxã€Windowsã€MacOS</td><td>è·¨å¹³å°é€šç”¨ï¼Œæœ€å¸¸ç”¨</td></tr><tr><td><strong>7zip</strong></td><td>Windows</td><td>Windowsç³»ç»Ÿä¸“ç”¨</td></tr><tr><td><strong>rar</strong></td><td>Windows</td><td>Windowsç³»ç»Ÿå¸¸ç”¨</td></tr><tr><td><strong>tar</strong></td><td>Linuxã€MacOS</td><td>Linuxç³»ç»Ÿå½’æ¡£æ ¼å¼</td></tr><tr><td><strong>gzip</strong></td><td>Linuxã€MacOS</td><td>Linuxç³»ç»Ÿå‹ç¼©æ ¼å¼</td></tr></tbody></table><p>åœ¨Windowsç³»ç»Ÿä¸­å¸¸ç”¨çš„è½¯ä»¶å¦‚ï¼šWinRARã€Bandizipç­‰è½¯ä»¶ï¼Œéƒ½æ”¯æŒå„ç±»å¸¸è§çš„å‹ç¼©æ ¼å¼ã€‚</p><p>æœ¬èŠ‚é‡ç‚¹å­¦ä¹ åœ¨Linuxç³»ç»Ÿä¸­æ“ä½œ <strong>tarã€gzipã€zip</strong> è¿™ä¸‰ç§å‹ç¼©æ ¼å¼ã€‚</p><h4 id="tarå‘½ä»¤-å‹ç¼©å’Œè§£å‹"><a href="#tarå‘½ä»¤-å‹ç¼©å’Œè§£å‹" class="headerlink" title="tarå‘½ä»¤ - å‹ç¼©å’Œè§£å‹"></a>tarå‘½ä»¤ - å‹ç¼©å’Œè§£å‹</h4><p>Linuxå’ŒMacç³»ç»Ÿå¸¸ç”¨æœ‰2ç§å‹ç¼©æ ¼å¼ï¼š</p><table><thead><tr><th>æ ¼å¼</th><th>è¯´æ˜</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><code>.tar</code></td><td>tarballå½’æ¡£æ–‡ä»¶</td><td>ç®€å•çš„å°†æ–‡ä»¶ç»„è£…åˆ°ä¸€ä¸ª.taræ–‡ä»¶å†…ï¼Œæ²¡æœ‰å‹ç¼©ï¼Œä»…ä»…æ˜¯å°è£…</td></tr><tr><td><code>.tar.gz</code> æˆ– <code>.tgz</code></td><td>gzipæ ¼å¼å‹ç¼©æ–‡ä»¶</td><td>ä½¿ç”¨gzipå‹ç¼©ç®—æ³•ï¼Œå¯ä»¥æå¤§å‡å°‘æ–‡ä»¶ä½“ç§¯</td></tr></tbody></table><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar [é€‰é¡¹] ç›®æ ‡æ–‡ä»¶ æºæ–‡ä»¶...</span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨é€‰é¡¹ï¼š</strong></p><table><thead><tr><th>é€‰é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>-c</code></td><td>åˆ›å»ºå‹ç¼©æ–‡ä»¶ï¼ˆCreateï¼‰</td></tr><tr><td><code>-x</code></td><td>è§£å‹æ–‡ä»¶ï¼ˆeXtractï¼‰</td></tr><tr><td><code>-v</code></td><td>æ˜¾ç¤ºå‹ç¼©&#x2F;è§£å‹è¿‡ç¨‹ï¼ˆVerboseï¼‰</td></tr><tr><td><code>-f</code></td><td>æŒ‡å®šæ–‡ä»¶åï¼ˆFileï¼‰ï¼Œå¿…é¡»åœ¨é€‰é¡¹æœ€å</td></tr><tr><td><code>-z</code></td><td>ä½¿ç”¨gzipå‹ç¼©&#x2F;è§£å‹</td></tr><tr><td><code>-C</code></td><td>æŒ‡å®šè§£å‹ç›®å½•</td></tr></tbody></table><h4 id="tarå‹ç¼©ç¤ºä¾‹"><a href="#tarå‹ç¼©ç¤ºä¾‹" class="headerlink" title="tarå‹ç¼©ç¤ºä¾‹"></a>tarå‹ç¼©ç¤ºä¾‹</h4><p><strong>å‹ç¼©ä¸º.taræ–‡ä»¶ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†1.txtã€2.txtã€3.txtå‹ç¼©åˆ°test.taræ–‡ä»¶å†…</span></span><br><span class="line">tar -cvf test.tar 1.txt 2.txt 3.txt</span><br></pre></td></tr></table></figure><p><strong>å‹ç¼©ä¸º.tar.gzæ–‡ä»¶ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨gzipæ¨¡å¼å‹ç¼©</span></span><br><span class="line">tar -zcvf test.tar.gz 1.txt 2.txt 3.txt</span><br></pre></td></tr></table></figure><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼š</p><ul><li><code>-z</code> é€‰é¡¹å¦‚æœä½¿ç”¨ï¼Œä¸€èˆ¬å¤„äºé€‰é¡¹ä½ç¬¬ä¸€ä¸ª</li><li><code>-f</code> é€‰é¡¹å¿…é¡»åœ¨é€‰é¡¹ä½æœ€åä¸€ä¸ª</li></ul></blockquote><h4 id="tarè§£å‹ç¤ºä¾‹"><a href="#tarè§£å‹ç¤ºä¾‹" class="headerlink" title="tarè§£å‹ç¤ºä¾‹"></a>tarè§£å‹ç¤ºä¾‹</h4><p><strong>è§£å‹.taræ–‡ä»¶åˆ°å½“å‰ç›®å½•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf test.tar</span><br></pre></td></tr></table></figure><p><strong>è§£å‹åˆ°æŒ‡å®šç›®å½•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å‹åˆ°/home/itheimaç›®å½•</span></span><br><span class="line">tar -xvf test.tar -C /home/itheima</span><br></pre></td></tr></table></figure><p><strong>è§£å‹.tar.gzæ–‡ä»¶ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»¥gzipæ¨¡å¼è§£å‹åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line">tar -zxvf test.tar.gz -C /home/itheima</span><br></pre></td></tr></table></figure><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼š</p><ul><li><code>-f</code> é€‰é¡¹å¿…é¡»åœ¨é€‰é¡¹ç»„åˆä½“çš„æœ€åä¸€ä½</li><li><code>-z</code> é€‰é¡¹å»ºè®®åœ¨å¼€å¤´ä½ç½®</li><li><code>-C</code> é€‰é¡¹å•ç‹¬ä½¿ç”¨ï¼Œå’Œè§£å‹æ‰€éœ€çš„å…¶å®ƒå‚æ•°åˆ†å¼€</li></ul></blockquote><h4 id="tarå‘½ä»¤å¸¸ç”¨ç»„åˆ"><a href="#tarå‘½ä»¤å¸¸ç”¨ç»„åˆ" class="headerlink" title="tarå‘½ä»¤å¸¸ç”¨ç»„åˆ"></a>tarå‘½ä»¤å¸¸ç”¨ç»„åˆ</h4><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>tar -cvf file.tar files</code></td><td>åˆ›å»ºtarå½’æ¡£</td></tr><tr><td><code>tar -zcvf file.tar.gz files</code></td><td>åˆ›å»ºgzipå‹ç¼©åŒ…</td></tr><tr><td><code>tar -xvf file.tar</code></td><td>è§£å‹tarå½’æ¡£</td></tr><tr><td><code>tar -zxvf file.tar.gz</code></td><td>è§£å‹gzipå‹ç¼©åŒ…</td></tr><tr><td><code>tar -zxvf file.tar.gz -C /path</code></td><td>è§£å‹åˆ°æŒ‡å®šç›®å½•</td></tr></tbody></table><h4 id="zipå‘½ä»¤-å‹ç¼©æ–‡ä»¶"><a href="#zipå‘½ä»¤-å‹ç¼©æ–‡ä»¶" class="headerlink" title="zipå‘½ä»¤ - å‹ç¼©æ–‡ä»¶"></a>zipå‘½ä»¤ - å‹ç¼©æ–‡ä»¶</h4><p><code>zip</code> å‘½ä»¤å¯ä»¥å‹ç¼©æ–‡ä»¶ä¸ºzipæ ¼å¼ï¼Œè·¨å¹³å°é€šç”¨</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip [-r] å‹ç¼©åŒ…åç§° è¢«å‹ç¼©æ–‡ä»¶...</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-r</code>ï¼šé€’å½’å‹ç¼©æ–‡ä»¶å¤¹ï¼Œå’Œrmã€cpç­‰å‘½ä»¤çš„-ræ•ˆæœä¸€è‡´</li></ul><p><strong>å‹ç¼©æ–‡ä»¶ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‹ç¼©å¤šä¸ªæ–‡ä»¶</span></span><br><span class="line">zip test.zip a.txt b.txt c.txt</span><br></pre></td></tr></table></figure><p><strong>å‹ç¼©æ–‡ä»¶å¤¹ç¤ºä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‹ç¼©æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼ˆéœ€è¦ä½¿ç”¨-ré€‰é¡¹ï¼‰</span></span><br><span class="line">zip -r test.zip <span class="built_in">test</span> itheima a.txt</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå‹ç¼©æ–‡ä»¶å¤¹æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ <code>-r</code> é€‰é¡¹</p></blockquote><h4 id="unzipå‘½ä»¤-è§£å‹æ–‡ä»¶"><a href="#unzipå‘½ä»¤-è§£å‹æ–‡ä»¶" class="headerlink" title="unzipå‘½ä»¤ - è§£å‹æ–‡ä»¶"></a>unzipå‘½ä»¤ - è§£å‹æ–‡ä»¶</h4><p>ä½¿ç”¨ <code>unzip</code> å‘½ä»¤ï¼Œå¯ä»¥æ–¹ä¾¿çš„è§£å‹zipå‹ç¼©åŒ…</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip [-d ç›®æ ‡ç›®å½•] å‹ç¼©åŒ…æ–‡ä»¶</span><br></pre></td></tr></table></figure><p><strong>é€‰é¡¹è¯´æ˜ï¼š</strong></p><ul><li><code>-d</code>ï¼šæŒ‡å®šè¦è§£å‹çš„ç›®æ ‡ç›®å½•ï¼Œç±»ä¼¼tarçš„-Cé€‰é¡¹</li></ul><p><strong>è§£å‹åˆ°å½“å‰ç›®å½•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip test.zip</span><br></pre></td></tr></table></figure><p><strong>è§£å‹åˆ°æŒ‡å®šç›®å½•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip test.zip -d /home/itheima</span><br></pre></td></tr></table></figure><p><strong>å…¶ä»–å¸¸ç”¨é€‰é¡¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å‹ç¼©åŒ…å†…å®¹ï¼ˆä¸è§£å‹ï¼‰</span></span><br><span class="line">unzip -l test.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å‹æ—¶è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶ï¼ˆä¸æç¤ºï¼‰</span></span><br><span class="line">unzip -o test.zip</span><br></pre></td></tr></table></figure><h4 id="å‹ç¼©è§£å‹å‘½ä»¤å¯¹æ¯”"><a href="#å‹ç¼©è§£å‹å‘½ä»¤å¯¹æ¯”" class="headerlink" title="å‹ç¼©è§£å‹å‘½ä»¤å¯¹æ¯”"></a>å‹ç¼©è§£å‹å‘½ä»¤å¯¹æ¯”</h4><table><thead><tr><th>æ ¼å¼</th><th>å‹ç¼©å‘½ä»¤</th><th>è§£å‹å‘½ä»¤</th></tr></thead><tbody><tr><td><code>.tar</code></td><td><code>tar -cvf file.tar files</code></td><td><code>tar -xvf file.tar</code></td></tr><tr><td><code>.tar.gz</code></td><td><code>tar -zcvf file.tar.gz files</code></td><td><code>tar -zxvf file.tar.gz</code></td></tr><tr><td><code>.zip</code></td><td><code>zip file.zip files</code></td><td><code>unzip file.zip</code></td></tr></tbody></table><blockquote><p>ğŸ’¡ <strong>å»ºè®®</strong>ï¼š</p><ul><li>åœ¨Linuxç³»ç»Ÿé—´ä¼ è¾“ï¼Œæ¨èä½¿ç”¨ <code>.tar.gz</code> æ ¼å¼ï¼ˆå‹ç¼©ç‡é«˜ï¼‰</li><li>è·¨å¹³å°ä¼ è¾“ï¼ˆLinux&#x2F;Windows&#x2F;Macï¼‰ï¼Œæ¨èä½¿ç”¨ <code>.zip</code> æ ¼å¼ï¼ˆå…¼å®¹æ€§å¥½ï¼‰</li></ul></blockquote><hr><p><strong>æœ€åæ›´æ–°</strong>: 2025-11-09<br><strong>ä½œè€…</strong>: Suo<br><strong>æ ‡ç­¾</strong>: Linux, å‘½ä»¤è¡Œ, Shell, viç¼–è¾‘å™¨, ç”¨æˆ·ç®¡ç†, æƒé™æ§åˆ¶, ç³»ç»Ÿç›‘æ§, å‹ç¼©è§£å‹, å¼€å‘å·¥å…·</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
            <tag> Linux </tag>
            
            <tag> å‘½ä»¤è¡Œ </tag>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MCPä½¿ç”¨æ•™ç¨‹ - æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ä»å…¥é—¨åˆ°ç²¾é€š</title>
      <link href="//mcp-tutorial/"/>
      <url>//mcp-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="MCPä½¿ç”¨æ•™ç¨‹-æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ä»å…¥é—¨åˆ°ç²¾é€š-ğŸš€"><a href="#MCPä½¿ç”¨æ•™ç¨‹-æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ä»å…¥é—¨åˆ°ç²¾é€š-ğŸš€" class="headerlink" title="MCPä½¿ç”¨æ•™ç¨‹ - æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ä»å…¥é—¨åˆ°ç²¾é€š ğŸš€"></a>MCPä½¿ç”¨æ•™ç¨‹ - æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ä»å…¥é—¨åˆ°ç²¾é€š ğŸš€</h1><blockquote><p>2025å¹´æ˜¯æ™ºèƒ½ä½“çš„å…ƒå¹´ï¼Œä¹Ÿæ³¨å®šæ˜¯æ™ºèƒ½ä½“é›†ä¸­çˆ†å‘çš„ä¸€å¹´ï¼MCPï¼ˆModel Context Protocolï¼‰ä½œä¸ºè¿æ¥AIä¸å¤–éƒ¨ä¸–ç•Œçš„æ¡¥æ¢ï¼Œæ­£åœ¨é©å‘½æ€§åœ°æ”¹å˜æˆ‘ä»¬ä¸AIäº¤äº’çš„æ–¹å¼ã€‚æœ¬æ•™ç¨‹å°†å¸¦æ‚¨æ·±å…¥äº†è§£MCPçš„æ ¸å¿ƒæ¦‚å¿µã€åº”ç”¨åœºæ™¯å’Œå®æˆ˜æŠ€å·§ã€‚ğŸ¤–</p></blockquote><p><img src="/images/mcp/LLM%E4%B8%8EMCP.png" alt="MCPæ¦‚è§ˆ"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><ul><li><p><a href="#1-mcp%E7%AE%80%E4%BB%8B%E4%B8%8E%E6%A6%82%E8%BF%B0">1. MCPç®€ä»‹ä¸æ¦‚è¿°</a></p><ul><li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AFmcp">1.1 ä»€ä¹ˆæ˜¯MCP</a></li><li><a href="#12-%E6%A0%B8%E5%BF%83%E4%BB%B7%E5%80%BC">1.2 æ ¸å¿ƒä»·å€¼</a></li><li><a href="#13-%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B">1.3 å‘å±•å†ç¨‹</a></li></ul></li><li><p><a href="#2-mcp%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">2. MCPåº”ç”¨åœºæ™¯</a></p><ul><li><a href="#21-%E7%A8%8B%E5%BA%8F%E5%91%98%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">2.1 ç¨‹åºå‘˜åº”ç”¨åœºæ™¯</a></li><li><a href="#22-%E5%A4%A7%E4%BC%97%E7%94%A8%E6%88%B7%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">2.2 å¤§ä¼—ç”¨æˆ·åº”ç”¨åœºæ™¯</a></li><li><a href="#23-%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B%E5%B1%95%E7%A4%BA">2.3 å®é™…æ¡ˆä¾‹å±•ç¤º</a></li></ul></li><li><p><a href="#3-mcp%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86">3. MCPæŠ€æœ¯åŸç†</a></p><ul><li><a href="#31-%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6">3.1 é€šä¿¡æœºåˆ¶</a></li><li><a href="#32-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">3.2 æ¶æ„è®¾è®¡</a></li><li><a href="#33-%E5%8D%8F%E8%AE%AE%E8%A7%84%E8%8C%83">3.3 åè®®è§„èŒƒ</a></li></ul></li><li><p><a href="#4-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E5%AE%89%E8%A3%85">4. ç¯å¢ƒé…ç½®ä¸å®‰è£…</a></p><ul><li><a href="#41-%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">4.1 æœ¬åœ°ç¯å¢ƒå‡†å¤‡</a></li><li><a href="#42-%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F%E9%80%89%E6%8B%A9">4.2 é€šä¿¡æ–¹å¼é€‰æ‹©</a></li><li><a href="#43-%E5%B9%B3%E5%8F%B0%E6%94%AF%E6%8C%81%E6%83%85%E5%86%B5">4.3 å¹³å°æ”¯æŒæƒ…å†µ</a></li></ul></li><li><p><a href="#5-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C">5. å®æˆ˜æ¡ˆä¾‹ï¼šæ•°æ®åº“æ“ä½œ</a></p><ul><li><a href="#51-%E9%A1%B9%E7%9B%AE%E5%87%86%E5%A4%87">5.1 é¡¹ç›®å‡†å¤‡</a></li><li><a href="#52-%E9%85%8D%E7%BD%AEmcp%E6%9C%8D%E5%8A%A1">5.2 é…ç½®MCPæœåŠ¡</a></li><li><a href="#53-%E5%8A%9F%E8%83%BD%E9%AA%8C%E8%AF%81">5.3 åŠŸèƒ½éªŒè¯</a></li></ul></li><li><p><a href="#6-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8Bexa-mcp-server">6. å®æˆ˜æ¡ˆä¾‹ï¼šExa MCP Server</a></p><ul><li><a href="#61-exa-mcp-server%E7%AE%80%E4%BB%8B">6.1 Exa MCP Serverç®€ä»‹</a></li><li><a href="#62-cursor%E8%BF%9C%E7%A8%8B%E9%85%8D%E7%BD%AE">6.2 Cursorè¿œç¨‹é…ç½®</a></li><li><a href="#63-%E5%8A%9F%E8%83%BD%E9%AA%8C%E8%AF%81">6.3 åŠŸèƒ½éªŒè¯</a></li></ul></li><li><p><a href="#7-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8Bmcp%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%99%A8">7. å®æˆ˜æ¡ˆä¾‹ï¼šMCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨</a></p><ul><li><a href="#71-mcp%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%80%E4%BB%8B">7.1 MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ç®€ä»‹</a></li><li><a href="#72-cursor%E9%85%8D%E7%BD%AE">7.2 Cursoré…ç½®</a></li><li><a href="#73-%E5%8A%9F%E8%83%BD%E9%AA%8C%E8%AF%81">7.3 åŠŸèƒ½éªŒè¯</a></li></ul></li><li><p><a href="#8-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8Bmcp-git%E6%9C%8D%E5%8A%A1%E5%99%A8">8. å®æˆ˜æ¡ˆä¾‹ï¼šMCP GitæœåŠ¡å™¨</a></p><ul><li><a href="#81-mcp-git%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%80%E4%BB%8B">8.1 MCP GitæœåŠ¡å™¨ç®€ä»‹</a></li><li><a href="#82-cursor%E9%85%8D%E7%BD%AE">8.2 Cursoré…ç½®</a></li><li><a href="#83-%E5%8A%9F%E8%83%BD%E9%AA%8C%E8%AF%81">8.3 åŠŸèƒ½éªŒè¯</a></li></ul></li><li><p><a href="#9-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%B8%8E%E8%BF%9B%E9%98%B6%E6%8A%80%E5%B7%A7">9. æœ€ä½³å®è·µä¸è¿›é˜¶æŠ€å·§</a></p><ul><li><a href="#91-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">9.1 æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="#92-%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91">9.2 å®‰å…¨è€ƒè™‘</a></li><li><a href="#93-%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4">9.3 æ•…éšœæ’é™¤</a></li></ul></li></ul><h2 id="1-MCPç®€ä»‹ä¸æ¦‚è¿°-ğŸ¯"><a href="#1-MCPç®€ä»‹ä¸æ¦‚è¿°-ğŸ¯" class="headerlink" title="1. MCPç®€ä»‹ä¸æ¦‚è¿° ğŸ¯"></a>1. MCPç®€ä»‹ä¸æ¦‚è¿° ğŸ¯</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯MCP"><a href="#1-1-ä»€ä¹ˆæ˜¯MCP" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯MCP"></a>1.1 ä»€ä¹ˆæ˜¯MCP</h3><p>MCPï¼ˆModel Context Protocolï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰æ˜¯ç”±Anthropicåœ¨2024å¹´11æœˆåº•æ¨å‡ºçš„ä¸€ç§å¼€æ”¾æ ‡å‡†ã€‚å®ƒæ—¨åœ¨ä¸ºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æä¾›ç»Ÿä¸€çš„ã€æ ‡å‡†åŒ–æ–¹å¼ä¸å¤–éƒ¨æ•°æ®æºå’Œå·¥å…·ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</p><p><img src="/images/mcp/MCP%E7%90%86%E8%A7%A3.png" alt="MCPç†è§£"></p><p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p><ul><li>ğŸ”— <strong>ç»Ÿä¸€æ¥å£</strong>ï¼šæä¾›æ ‡å‡†åŒ–çš„è¿æ¥æ–¹å¼</li><li>ğŸš€ <strong>ç®€åŒ–é›†æˆ</strong>ï¼šå¤§å¹…é™ä½AIåº”ç”¨å¼€å‘å¤æ‚åº¦</li><li>ğŸŒ <strong>å¼€æ”¾æ ‡å‡†</strong>ï¼šæ”¯æŒå¤šç§å¹³å°å’ŒæœåŠ¡</li><li>âš¡ <strong>é«˜æ•ˆé€šä¿¡</strong>ï¼šä¼˜åŒ–çš„æ•°æ®ä¼ è¾“æœºåˆ¶</li></ul><h3 id="1-2-æ ¸å¿ƒä»·å€¼"><a href="#1-2-æ ¸å¿ƒä»·å€¼" class="headerlink" title="1.2 æ ¸å¿ƒä»·å€¼"></a>1.2 æ ¸å¿ƒä»·å€¼</h3><h4 id="1-2-1-è§£å†³ä¼ ç»ŸAIé›†æˆé—®é¢˜"><a href="#1-2-1-è§£å†³ä¼ ç»ŸAIé›†æˆé—®é¢˜" class="headerlink" title="1.2.1 è§£å†³ä¼ ç»ŸAIé›†æˆé—®é¢˜"></a>1.2.1 è§£å†³ä¼ ç»ŸAIé›†æˆé—®é¢˜</h4><p><img src="/images/mcp/%E6%9C%89%E6%97%A0MCP%E5%AF%B9%E6%AF%94.png" alt="æœ‰æ— MCPå¯¹æ¯”"></p><p><strong>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š</strong></p><ul><li>æ¶æ„ç¢ç‰‡åŒ–ï¼Œéš¾ä»¥æ‰©å±•</li><li>æ¯ä¸ªæ•°æ®æºéœ€è¦ç‹¬ç«‹è¿æ¥</li><li>é™åˆ¶äº†AIè·å–å¿…è¦ä¸Šä¸‹æ–‡ä¿¡æ¯çš„èƒ½åŠ›</li><li>å¼€å‘æˆæœ¬é«˜ï¼Œç»´æŠ¤å›°éš¾</li></ul><p><strong>MCPè§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>æä¾›ç»Ÿä¸€ä¸”å¯é çš„æ•°æ®è®¿é—®æ–¹å¼</li><li>å…‹æœäº†ä»¥å¾€é›†æˆæ–¹æ³•çš„å±€é™æ€§</li><li>å¤§å¹…ç®€åŒ–å¼€å‘æµç¨‹</li><li>æé«˜ç³»ç»Ÿå¯ç»´æŠ¤æ€§</li></ul><h4 id="1-2-2-æŠ€æœ¯ä¼˜åŠ¿"><a href="#1-2-2-æŠ€æœ¯ä¼˜åŠ¿" class="headerlink" title="1.2.2 æŠ€æœ¯ä¼˜åŠ¿"></a>1.2.2 æŠ€æœ¯ä¼˜åŠ¿</h4><p><img src="/images/mcp/MCP%E5%AF%B9%E6%AF%94.png" alt="MCPå¯¹æ¯”"></p><table><thead><tr><th><strong>å¯¹æ¯”ç»´åº¦</strong></th><th><strong>ä¼ ç»Ÿæ–¹å¼</strong></th><th><strong>MCPæ–¹å¼</strong></th></tr></thead><tbody><tr><td><strong>é›†æˆå¤æ‚åº¦</strong></td><td>é«˜ï¼ˆMÃ—Né—®é¢˜ï¼‰</td><td>ä½ï¼ˆç»Ÿä¸€åè®®ï¼‰</td></tr><tr><td><strong>å¼€å‘æ•ˆç‡</strong></td><td>æ…¢</td><td>å¿«</td></tr><tr><td><strong>ç»´æŠ¤æˆæœ¬</strong></td><td>é«˜</td><td>ä½</td></tr><tr><td><strong>æ‰©å±•æ€§</strong></td><td>å·®</td><td>ä¼˜ç§€</td></tr><tr><td><strong>æ ‡å‡†åŒ–</strong></td><td>æ— </td><td>æœ‰</td></tr></tbody></table><h3 id="1-3-å‘å±•å†ç¨‹"><a href="#1-3-å‘å±•å†ç¨‹" class="headerlink" title="1.3 å‘å±•å†ç¨‹"></a>1.3 å‘å±•å†ç¨‹</h3><p><strong>é‡è¦æ—¶é—´èŠ‚ç‚¹ï¼š</strong></p><ul><li><strong>2024å¹´11æœˆåº•</strong>ï¼šAnthropicæ¨å‡ºMCPæ ‡å‡†</li><li><strong>2025å¹´2æœˆ</strong>ï¼šCursoræ­£å¼å®£å¸ƒæ”¯æŒMCPåŠŸèƒ½</li><li><strong>2025å¹´3æœˆ27æ—¥</strong>ï¼šOpenAIæ™ºèƒ½ä½“æ”¯æŒMCP</li></ul><blockquote><p>ğŸ’¡ <strong>æ„Ÿæ…¨ä¸€å¥</strong>ï¼šæ²¡æƒ³åˆ°åƒå¸†è¿‡å¢ƒçš„å¤§æ¨¡å‹ä¹‹äº‰ï¼Œç«Ÿç„¶è¢«ä¸€ä¸ªMCPæ ‡å‡†åè®®ç»Ÿä¸€äº†ã€‚</p></blockquote><h2 id="2-MCPåº”ç”¨åœºæ™¯-ğŸŒŸ"><a href="#2-MCPåº”ç”¨åœºæ™¯-ğŸŒŸ" class="headerlink" title="2. MCPåº”ç”¨åœºæ™¯ ğŸŒŸ"></a>2. MCPåº”ç”¨åœºæ™¯ ğŸŒŸ</h2><h3 id="2-1-ç¨‹åºå‘˜åº”ç”¨åœºæ™¯"><a href="#2-1-ç¨‹åºå‘˜åº”ç”¨åœºæ™¯" class="headerlink" title="2.1 ç¨‹åºå‘˜åº”ç”¨åœºæ™¯"></a>2.1 ç¨‹åºå‘˜åº”ç”¨åœºæ™¯</h3><h4 id="2-1-1-å¼€å‘éƒ¨ç½²åœºæ™¯"><a href="#2-1-1-å¼€å‘éƒ¨ç½²åœºæ™¯" class="headerlink" title="2.1.1 å¼€å‘éƒ¨ç½²åœºæ™¯"></a>2.1.1 å¼€å‘éƒ¨ç½²åœºæ™¯</h4><p><strong>æ™ºèƒ½CI&#x2F;CDæµæ°´çº¿</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Javaè¯­è¨€ + Spring AI / LangChain / LangChain4J + MCP ==&gt; AIæ™ºèƒ½è½åœ°é¡¹ç›®</span><br></pre></td></tr></table></figure><p><strong>å®é™…æ¡ˆä¾‹ï¼š</strong><br>å¼€å‘è€…é€šè¿‡è‡ªç„¶è¯­è¨€æŒ‡ä»¤â€éƒ¨ç½²æ–°ç‰ˆæœ¬åˆ°æµ‹è¯•ç¯å¢ƒâ€ï¼Œè§¦å‘MCPé“¾å¼è°ƒç”¨ï¼š</p><ul><li>GitLab APIï¼ˆä»£ç åˆå¹¶ï¼‰</li><li>Jenkins APIï¼ˆæ„å»ºé•œåƒï¼‰</li><li>Slack APIï¼ˆé€šçŸ¥å›¢é˜Ÿï¼‰</li></ul><h4 id="2-1-2-æ•°æ®åº“æ“ä½œåœºæ™¯"><a href="#2-1-2-æ•°æ®åº“æ“ä½œåœºæ™¯" class="headerlink" title="2.1.2 æ•°æ®åº“æ“ä½œåœºæ™¯"></a>2.1.2 æ•°æ®åº“æ“ä½œåœºæ™¯</h4><p><strong>æ™ºèƒ½SQLæŸ¥è¯¢</strong></p><ul><li>å¼€å‘è€…é€šè¿‡è‡ªç„¶è¯­è¨€è¾“å…¥ï¼šâ€æŸ¥è¯¢æŸé›†å›¢éƒ¨é—¨ä¸Šä¸ªå­£åº¦é”€å”®é¢â€</li><li>MCPè‡ªåŠ¨è½¬æ¢ä¸ºç²¾å‡†SQLè¯­å¥å¹¶æ‰§è¡Œ</li><li>ç»“åˆå¤§æ¨¡å‹è¿›è¡Œæ™ºèƒ½åˆ†æå’Œå›ç­”</li></ul><h4 id="2-1-3-æ™ºèƒ½ä½“å¼€å‘åœºæ™¯"><a href="#2-1-3-æ™ºèƒ½ä½“å¼€å‘åœºæ™¯" class="headerlink" title="2.1.3 æ™ºèƒ½ä½“å¼€å‘åœºæ™¯"></a>2.1.3 æ™ºèƒ½ä½“å¼€å‘åœºæ™¯</h4><p><strong>Manusæ™ºèƒ½ä½“æ¡ˆä¾‹</strong><br>Manusçš„æ¯ä¸€æ¬¡ä»»åŠ¡å¤„ç†éƒ½éœ€è¦è°ƒç”¨ï¼š</p><ul><li>ç½‘é¡µæœç´¢</li><li>ç½‘é¡µè®¿é—®</li><li>ç½‘é¡µä¿¡æ¯è·å–</li><li>æœ¬åœ°æ–‡ä»¶åˆ›å»º</li><li>ä»£ç è§£é‡Šå™¨</li><li>ç­‰å‡ åä¸ªå¤–éƒ¨å·¥å…·</li></ul><p><strong>æš´éœ²çš„é—®é¢˜ï¼š</strong></p><ol><li>å¯ä¾›å¤§æ¨¡å‹è°ƒç”¨çš„å·¥å…·ä¸è¶³</li><li>è°ƒç”¨å·¥ä½œé‡å¾ˆå¤§</li></ol><p><strong>MCPè§£å†³æ–¹æ¡ˆï¼š</strong><br>å€ŸåŠ©MCPï¼Œåªè¦æ”¯æŒäº†è¯¥åè®®ï¼Œå°±èƒ½è½»æ¾å°†å„ç§æ•°æ®æºå’Œå·¥å…·è¿æ¥åˆ°LLMã€‚</p><h3 id="2-2-å¤§ä¼—ç”¨æˆ·åº”ç”¨åœºæ™¯"><a href="#2-2-å¤§ä¼—ç”¨æˆ·åº”ç”¨åœºæ™¯" class="headerlink" title="2.2 å¤§ä¼—ç”¨æˆ·åº”ç”¨åœºæ™¯"></a>2.2 å¤§ä¼—ç”¨æˆ·åº”ç”¨åœºæ™¯</h3><h4 id="2-2-1-æ—…æ¸¸è§„åˆ’åœºæ™¯"><a href="#2-2-1-æ—…æ¸¸è§„åˆ’åœºæ™¯" class="headerlink" title="2.2.1 æ—…æ¸¸è§„åˆ’åœºæ™¯"></a>2.2.1 æ—…æ¸¸è§„åˆ’åœºæ™¯</h4><p><strong>æ™ºèƒ½è¡Œç¨‹è§„åˆ’</strong><br>å½“ç”¨æˆ·è¦æ—…è¡Œæ—¶ï¼Œæ—…è¡Œè§„åˆ’åŠ©æ‰‹é€šè¿‡MCPåŒæ—¶è°ƒç”¨ï¼š</p><ul><li>å¤©æ°”APIï¼ˆè·å–ç›®çš„åœ°æ°”è±¡ï¼‰</li><li>äº¤é€šAPIï¼ˆæŸ¥è¯¢èˆªç­åŠ¨æ€ï¼‰</li><li>åœ°å›¾APIï¼ˆè§„åˆ’è·¯çº¿ï¼‰</li></ul><p>AIè‡ªåŠ¨ç”Ÿæˆå¸¦å®æ—¶æ•°æ®çš„è¡Œç¨‹æ–¹æ¡ˆã€‚</p><h4 id="2-2-2-è”ç½‘æœç´¢åœºæ™¯"><a href="#2-2-2-è”ç½‘æœç´¢åœºæ™¯" class="headerlink" title="2.2.2 è”ç½‘æœç´¢åœºæ™¯"></a>2.2.2 è”ç½‘æœç´¢åœºæ™¯</h4><p><strong>é—®é¢˜åˆ†æï¼š</strong><br><img src="/images/mcp/%E6%97%A0MCP%E6%83%85%E5%86%B5.png" alt="æ— MCPæƒ…å†µ"></p><p><strong>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š</strong></p><ol><li>å¹¶éæ‰€æœ‰èŠå¤©æœºå™¨äººéƒ½æ”¯æŒè”ç½‘åŠŸèƒ½</li><li>å³ä½¿æ”¯æŒè”ç½‘ï¼Œä¹Ÿå¯èƒ½ä¸åŒ…å«ä½ ä¹ æƒ¯ä½¿ç”¨çš„æœç´¢å¼•æ“</li><li>ç”¨æˆ·åªèƒ½ç­‰å¾…å¼€å‘è€…æ·»åŠ ç‰¹å®šæœç´¢å¼•æ“çš„æ”¯æŒ</li></ol><p><strong>MCPè§£å†³æ–¹æ¡ˆï¼š</strong><br><img src="/images/mcp/%E6%9C%89MCP%E6%83%85%E5%86%B5.png" alt="æœ‰MCPæƒ…å†µ"></p><p>æœ‰äº†MCPåï¼Œåªéœ€ç®€å•é…ç½®ï¼Œå°±èƒ½å°†æ‰€éœ€æœåŠ¡æ¥å…¥å½“å‰ä½¿ç”¨çš„èŠå¤©æœºå™¨äººã€‚</p><h4 id="2-2-3-ä¸šåŠ¡æŸ¥è¯¢åœºæ™¯"><a href="#2-2-3-ä¸šåŠ¡æŸ¥è¯¢åœºæ™¯" class="headerlink" title="2.2.3 ä¸šåŠ¡æŸ¥è¯¢åœºæ™¯"></a>2.2.3 ä¸šåŠ¡æŸ¥è¯¢åœºæ™¯</h4><p><strong>ä¸šç»©æŸ¥è¯¢æ¡ˆä¾‹</strong><br>ç”¨æˆ·è¯¢é—®â€æŸ¥è¯¢ä¸Šå­£åº¦è¥ä¸šé¢â€ï¼ŒMCPè‡ªåŠ¨ç»„åˆè°ƒç”¨ï¼š</p><ul><li>CRMç³»ç»ŸAPIï¼ˆè·å–å®¢æˆ·æ•°æ®ï¼‰</li><li>è´¢åŠ¡ç³»ç»ŸAPIï¼ˆè°ƒå–æŠ¥è¡¨ï¼‰</li><li>é‚®ä»¶APIï¼ˆå‘é€æ€»ç»“æŠ¥å‘Šï¼‰</li></ul><h3 id="2-3-å®é™…æ¡ˆä¾‹å±•ç¤º"><a href="#2-3-å®é™…æ¡ˆä¾‹å±•ç¤º" class="headerlink" title="2.3 å®é™…æ¡ˆä¾‹å±•ç¤º"></a>2.3 å®é™…æ¡ˆä¾‹å±•ç¤º</h3><p><img src="/images/mcp/%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF.png" alt="åº”ç”¨åœºæ™¯"></p><p><strong>å„è¡Œä¸šåº”ç”¨åœºæ™¯ï¼š</strong></p><p><strong>ç”µå•†åœºæ™¯ï¼š</strong></p><ul><li>æ™ºèƒ½æ¨èç³»ç»Ÿï¼šå•†å“æ¨èã€ç”¨æˆ·è¡Œä¸ºåˆ†æã€ä¸ªæ€§åŒ–æ¨é€</li><li>æ™ºèƒ½å®¢æœä¸è®¢å•ç®¡ç†ï¼šè‡ªåŠ¨é—®ç­”ã€è®¢å•ä¿¡æ¯æ•æ‰ã€éœ€æ±‚åˆ†æ</li><li>åº“å­˜é¢„æµ‹ä¸åŠ¨æ€å®šä»·ï¼šåº“å­˜ç›‘æ§ã€éœ€æ±‚é¢„æµ‹ã€ä»·æ ¼ç­–ç•¥ä¼˜åŒ–</li></ul><p><strong>ç¤¾äº¤åœºæ™¯ï¼š</strong></p><ul><li>å†…å®¹å®¡æ ¸ä¸æƒ…æ„Ÿåˆ†æï¼šæ•æ„Ÿè¯è¿‡æ»¤ã€å›¾ç‰‡&#x2F;è§†é¢‘è¿è§„æ£€æµ‹ã€ç”¨æˆ·æƒ…ç»ªè¯†åˆ«</li><li>ç¤¾äº¤å…³ç³»æ¨èï¼šå¥½å‹æ¨èã€ç¤¾ç¾¤åŒ¹é…ã€å…´è¶£èšç±»</li><li>èŠå¤©æœºå™¨äººï¼šè‡ªåŠ¨å›å¤ã€ä¸Šä¸‹æ–‡ç†è§£ã€å¤šè½®å¯¹è¯</li></ul><p><strong>ç‰©æµåœºæ™¯ï¼š</strong></p><ul><li>æ™ºèƒ½ä»“å‚¨ç®¡ç†ï¼šåº“å­˜åˆ†æ‹£ã€è·¯å¾„è§„åˆ’ã€å¼‚å¸¸æ£€æµ‹</li><li>é…é€è·¯çº¿ä¼˜åŒ–ï¼šå®æ—¶è·¯å¾„è®¡ç®—ã€äº¤é€šé¢„æµ‹ã€æˆæœ¬æ§åˆ¶</li><li>éœ€æ±‚é¢„æµ‹ä¸èµ„æºè°ƒåº¦ï¼šè¿åŠ›åˆ†é…ã€ä»“åº“é€‰å€ã€å³°å€¼é¢„æµ‹</li></ul><p><strong>é‡‘èåœºæ™¯ï¼š</strong></p><ul><li>é£é™©è¯„ä¼°ä¸ä¿¡è´·å®¡æ‰¹ï¼šä¿¡ç”¨è¯„åˆ†ã€åæ¬ºè¯ˆã€è´·æ¬¾å†³ç­–</li><li>æ™ºèƒ½æŠ•é¡¾ä¸è´¢å¯Œç®¡ç†ï¼šèµ„äº§é…ç½®ã€å¸‚åœºé¢„æµ‹ã€ä¸ªæ€§åŒ–ç†è´¢å»ºè®®</li><li>äº¤æ˜“ç›‘æ§ä¸åæ´—é’±ï¼šå¼‚å¸¸äº¤æ˜“æ£€æµ‹ã€åˆè§„å®¡æŸ¥ã€æ¨¡å¼è¯†åˆ«</li></ul><h2 id="3-MCPæŠ€æœ¯åŸç†-ğŸ”§"><a href="#3-MCPæŠ€æœ¯åŸç†-ğŸ”§" class="headerlink" title="3. MCPæŠ€æœ¯åŸç† ğŸ”§"></a>3. MCPæŠ€æœ¯åŸç† ğŸ”§</h2><h3 id="3-1-é€šä¿¡æœºåˆ¶"><a href="#3-1-é€šä¿¡æœºåˆ¶" class="headerlink" title="3.1 é€šä¿¡æœºåˆ¶"></a>3.1 é€šä¿¡æœºåˆ¶</h3><p>æ ¹æ®MCPçš„è§„èŒƒï¼Œå½“å‰æ”¯æŒä¸¤ç§é€šä¿¡æœºåˆ¶ï¼ˆä¼ è¾“æ–¹å¼ï¼‰ï¼š</p><h4 id="3-1-1-stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼‰"><a href="#3-1-1-stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼‰" class="headerlink" title="3.1.1 stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼‰"></a>3.1.1 stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼‰</h4><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ä¸»è¦ç”¨åœ¨æœ¬åœ°æœåŠ¡ä¸Š</li><li>æ“ä½œæœ¬åœ°è½¯ä»¶æˆ–æœ¬åœ°æ–‡ä»¶</li><li>å¦‚Blenderç­‰æœ¬åœ°åº”ç”¨</li><li>MCPé»˜è®¤é€šä¿¡æ–¹å¼</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é€‚ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œçš„åœºæ™¯</li><li>æ— éœ€å¤–éƒ¨ç½‘ç»œä¾èµ–ï¼Œé€šä¿¡é€Ÿåº¦å¿«</li><li>å¯é æ€§é«˜ï¼Œä¸”æ˜“äºè°ƒè¯•</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦æå‰å®‰è£…å‘½ä»¤è¡Œå·¥å…·</li><li>å•è¿›ç¨‹é€šä¿¡ï¼Œæ— æ³•å¹¶è¡Œå¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚</li><li>è¿›ç¨‹èµ„æºå¼€é”€è¾ƒå¤§ï¼Œä¸é€‚åˆåœ¨æœ¬åœ°è¿è¡Œå¤§é‡æœåŠ¡</li></ul><h4 id="3-1-2-SSEï¼ˆServer-Sent-Eventsï¼‰"><a href="#3-1-2-SSEï¼ˆServer-Sent-Eventsï¼‰" class="headerlink" title="3.1.2 SSEï¼ˆServer-Sent Eventsï¼‰"></a>3.1.2 SSEï¼ˆServer-Sent Eventsï¼‰</h4><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ä¸»è¦ç”¨åœ¨è¿œç¨‹é€šä¿¡æœåŠ¡ä¸Š</li><li>æœåŠ¡æœ¬èº«æœ‰åœ¨çº¿API</li><li>å¦‚è®¿é—®è°·æ­Œé‚®ä»¶ã€å¤©æ°”æƒ…å†µç­‰</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é…ç½®æ–¹å¼éå¸¸ç®€å•ï¼ŒåŸºæœ¬ä¸Šå°±ä¸€ä¸ªé“¾æ¥å°±è¡Œ</li><li>é€‚ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä½äºä¸åŒç‰©ç†ä½ç½®çš„åœºæ™¯</li><li>é€‚ç”¨äºå®æ—¶æ•°æ®æ›´æ–°ã€æ¶ˆæ¯æ¨é€ã€è½»é‡çº§ç›‘æ§å’Œå®æ—¶æ—¥å¿—æµç­‰åœºæ™¯</li></ul><h3 id="3-2-æ¶æ„è®¾è®¡"><a href="#3-2-æ¶æ„è®¾è®¡" class="headerlink" title="3.2 æ¶æ„è®¾è®¡"></a>3.2 æ¶æ„è®¾è®¡</h3><p><img src="/images/mcp/MCP%E4%BD%9C%E4%B8%BA%E5%80%9F%E5%8F%A3.png" alt="MCPä½œä¸ºæ¥å£"></p><p><strong>æ¶æ„ç‰¹ç‚¹ï¼š</strong></p><ul><li>æ ‡å‡†åŒ–åè®®å±‚</li><li>ç»Ÿä¸€çš„æ•°æ®äº¤æ¢æ ¼å¼</li><li>å¯æ‰©å±•çš„æœåŠ¡æ¥å£</li><li>å®‰å…¨çš„æ•°æ®ä¼ è¾“æœºåˆ¶</li></ul><h3 id="3-3-åè®®è§„èŒƒ"><a href="#3-3-åè®®è§„èŒƒ" class="headerlink" title="3.3 åè®®è§„èŒƒ"></a>3.3 åè®®è§„èŒƒ</h3><p><strong>å®˜æ–¹æ–‡æ¡£ï¼š</strong> <a href="https://modelcontextprotocol.io/introduction">https://modelcontextprotocol.io/introduction</a></p><p><strong>æ ¸å¿ƒè§„èŒƒï¼š</strong></p><ul><li>æ ‡å‡†åŒ–çš„æ¶ˆæ¯æ ¼å¼</li><li>ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶</li><li>å¯æ‰©å±•çš„å…ƒæ•°æ®æ”¯æŒ</li><li>å®‰å…¨è®¤è¯å’Œæˆæƒæœºåˆ¶</li></ul><h2 id="4-ç¯å¢ƒé…ç½®ä¸å®‰è£…-âš™ï¸"><a href="#4-ç¯å¢ƒé…ç½®ä¸å®‰è£…-âš™ï¸" class="headerlink" title="4. ç¯å¢ƒé…ç½®ä¸å®‰è£… âš™ï¸"></a>4. ç¯å¢ƒé…ç½®ä¸å®‰è£… âš™ï¸</h2><h3 id="4-1-æœ¬åœ°ç¯å¢ƒå‡†å¤‡"><a href="#4-1-æœ¬åœ°ç¯å¢ƒå‡†å¤‡" class="headerlink" title="4.1 æœ¬åœ°ç¯å¢ƒå‡†å¤‡"></a>4.1 æœ¬åœ°ç¯å¢ƒå‡†å¤‡</h3><h4 id="4-1-1-Pythonç¯å¢ƒï¼ˆuvxï¼‰"><a href="#4-1-1-Pythonç¯å¢ƒï¼ˆuvxï¼‰" class="headerlink" title="4.1.1 Pythonç¯å¢ƒï¼ˆuvxï¼‰"></a>4.1.1 Pythonç¯å¢ƒï¼ˆuvxï¼‰</h4><p><strong>å®‰è£…æ–¹å¼1ï¼š</strong> è‹¥å·²é…ç½®Pythonç¯å¢ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install uv</span><br></pre></td></tr></table></figure><p><strong>å®‰è£…æ–¹å¼2ï¼š</strong> Windows PowerShellå®‰è£…</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="literal">-ExecutionPolicy</span> ByPass <span class="literal">-c</span> <span class="string">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span></span><br></pre></td></tr></table></figure><h4 id="4-1-2-TypeScriptç¯å¢ƒï¼ˆnpxï¼‰"><a href="#4-1-2-TypeScriptç¯å¢ƒï¼ˆnpxï¼‰" class="headerlink" title="4.1.2 TypeScriptç¯å¢ƒï¼ˆnpxï¼‰"></a>4.1.2 TypeScriptç¯å¢ƒï¼ˆnpxï¼‰</h4><p><strong>å‰ç½®æ¡ä»¶ï¼š</strong></p><ul><li>å®‰è£…Node.jsç¯å¢ƒ</li><li>ç¡®ä¿npmå¯ç”¨</li></ul><p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx -y @package-name</span><br></pre></td></tr></table></figure><h3 id="4-2-é€šä¿¡æ–¹å¼é€‰æ‹©"><a href="#4-2-é€šä¿¡æ–¹å¼é€‰æ‹©" class="headerlink" title="4.2 é€šä¿¡æ–¹å¼é€‰æ‹©"></a>4.2 é€šä¿¡æ–¹å¼é€‰æ‹©</h3><p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p><table><thead><tr><th><strong>åœºæ™¯</strong></th><th><strong>æ¨èæ–¹å¼</strong></th><th><strong>åŸå› </strong></th></tr></thead><tbody><tr><td><strong>æœ¬åœ°å¼€å‘</strong></td><td>stdio</td><td>é€Ÿåº¦å¿«ï¼Œè°ƒè¯•æ–¹ä¾¿</td></tr><tr><td><strong>è¿œç¨‹æœåŠ¡</strong></td><td>SSE</td><td>é…ç½®ç®€å•ï¼Œæ”¯æŒåˆ†å¸ƒå¼</td></tr><tr><td><strong>æ··åˆç¯å¢ƒ</strong></td><td>æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©</td><td>çµæ´»é…ç½®</td></tr></tbody></table><h3 id="4-3-å¹³å°æ”¯æŒæƒ…å†µ"><a href="#4-3-å¹³å°æ”¯æŒæƒ…å†µ" class="headerlink" title="4.3 å¹³å°æ”¯æŒæƒ…å†µ"></a>4.3 å¹³å°æ”¯æŒæƒ…å†µ</h3><p><img src="/images/mcp/%E6%94%AF%E6%8C%81MCP.png" alt="æ”¯æŒMCP"></p><p><strong>ä¸»è¦å¹³å°æ”¯æŒï¼š</strong></p><p><strong>å®˜æ–¹èµ„æºï¼š</strong></p><ul><li>MCPå®˜æ–¹èµ„æºï¼š<a href="https://github.com/modelcontextprotocol/servers">https://github.com/modelcontextprotocol/servers</a></li><li>MCPçƒ­é—¨èµ„æºï¼š<a href="https://github.com/punkpeye/awesome-mcp-servers">https://github.com/punkpeye/awesome-mcp-servers</a></li></ul><p><strong>å…¶ä»–å¹³å°ï¼š</strong></p><ul><li>Glamaï¼š<a href="https://glama.ai/mcp/servers">https://glama.ai/mcp/servers</a></li><li>Smitheryï¼š<a href="https://smithery.ai/">https://smithery.ai</a></li><li>Cursorï¼š<a href="https://cursor.directory/">https://cursor.directory</a></li><li>MCP.soï¼š<a href="https://mcp.so/zh">https://mcp.so/zh</a></li><li>é˜¿é‡Œäº‘ç™¾ç‚¼ï¼š<a href="https://bailian.console.aliyun.com/?tab=mcp#/mcp-market">https://bailian.console.aliyun.com/?tab=mcp#/mcp-market</a></li></ul><h2 id="5-å®æˆ˜æ¡ˆä¾‹ï¼šæ•°æ®åº“æ“ä½œ-ğŸ—„ï¸"><a href="#5-å®æˆ˜æ¡ˆä¾‹ï¼šæ•°æ®åº“æ“ä½œ-ğŸ—„ï¸" class="headerlink" title="5. å®æˆ˜æ¡ˆä¾‹ï¼šæ•°æ®åº“æ“ä½œ ğŸ—„ï¸"></a>5. å®æˆ˜æ¡ˆä¾‹ï¼šæ•°æ®åº“æ“ä½œ ğŸ—„ï¸</h2><h3 id="5-1-é¡¹ç›®å‡†å¤‡"><a href="#5-1-é¡¹ç›®å‡†å¤‡" class="headerlink" title="5.1 é¡¹ç›®å‡†å¤‡"></a>5.1 é¡¹ç›®å‡†å¤‡</h3><h4 id="5-1-1-æŸ¥æ‰¾MCPæœåŠ¡"><a href="#5-1-1-æŸ¥æ‰¾MCPæœåŠ¡" class="headerlink" title="5.1.1 æŸ¥æ‰¾MCPæœåŠ¡"></a>5.1.1 æŸ¥æ‰¾MCPæœåŠ¡</h4><p><strong>æ­¥éª¤1ï¼š</strong> è®¿é—®Smitheryå¹³å°</p><ul><li>ç½‘å€ï¼š<a href="https://smithery.ai/server/@f4ww4z/mcp-mysql-server">https://smithery.ai/server/@f4ww4z/mcp-mysql-server</a></li><li>æŸ¥æ‰¾MySQLç›¸å…³çš„MCPæœåŠ¡</li></ul><p><img src="/images/mcp/mysql_server.png" alt="MySQLæœåŠ¡"></p><h4 id="5-1-2-æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£"><a href="#5-1-2-æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£" class="headerlink" title="5.1.2 æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£"></a>5.1.2 æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£</h4><p><strong>æ­¥éª¤2ï¼š</strong> æŸ¥è¯¢GitHubå®˜æ–¹æ–‡æ¡£<br><strong>GitHubä»“åº“ï¼š</strong> <a href="https://github.com/f4ww4z/mcp-mysql-server">exa-labs&#x2F;exa-mcp-server</a><br><img src="/images/mcp/%E6%9F%A5%E8%AF%A2%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3.png" alt="æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£"></p><p>äº†è§£å¦‚ä½•è®¾ç½®å’Œé…ç½®MySQL MCPæœåŠ¡ã€‚</p><h3 id="5-2-é…ç½®MCPæœåŠ¡"><a href="#5-2-é…ç½®MCPæœåŠ¡" class="headerlink" title="5.2 é…ç½®MCPæœåŠ¡"></a>5.2 é…ç½®MCPæœåŠ¡</h3><h4 id="5-2-1-å®‰è£…MCPæœåŠ¡"><a href="#5-2-1-å®‰è£…MCPæœåŠ¡" class="headerlink" title="5.2.1 å®‰è£…MCPæœåŠ¡"></a>5.2.1 å®‰è£…MCPæœåŠ¡</h4><p><strong>æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx -y @smithery/cli install @f4ww4z/mcp-mysql-server --client claude</span><br></pre></td></tr></table></figure><h4 id="5-2-2-é…ç½®æ•°æ®åº“è¿æ¥"><a href="#5-2-2-é…ç½®æ•°æ®åº“è¿æ¥" class="headerlink" title="5.2.2 é…ç½®æ•°æ®åº“è¿æ¥"></a>5.2.2 é…ç½®æ•°æ®åº“è¿æ¥</h4><p><strong>é…ç½®Cursorçš„MCPï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;mysql&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;-y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;@f4ww4z/mcp-mysql-server&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;MYSQL_HOST&quot;</span><span class="punctuation">:</span> <span class="string">&quot;your_host&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;MYSQL_USER&quot;</span><span class="punctuation">:</span> <span class="string">&quot;your_username&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;MYSQL_PASSWORD&quot;</span><span class="punctuation">:</span> <span class="string">&quot;your_password&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;MYSQL_DATABASE&quot;</span><span class="punctuation">:</span> <span class="string">&quot;your_database&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="5-3-åŠŸèƒ½éªŒè¯"><a href="#5-3-åŠŸèƒ½éªŒè¯" class="headerlink" title="5.3 åŠŸèƒ½éªŒè¯"></a>5.3 åŠŸèƒ½éªŒè¯</h3><h4 id="5-3-1-æŸ¥è¯¢æ•°æ®åº“è¡¨"><a href="#5-3-1-æŸ¥è¯¢æ•°æ®åº“è¡¨" class="headerlink" title="5.3.1 æŸ¥è¯¢æ•°æ®åº“è¡¨"></a>5.3.1 æŸ¥è¯¢æ•°æ®åº“è¡¨</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æŸ¥ä¸‹ç›®å‰æ•°æ®åº“ä¸­æœ‰å¤šå°‘å¼ è¡¨</span><br></pre></td></tr></table></figure><p><img src="/images/mcp/%E6%9F%A5%E8%A1%A8%E4%BF%A1%E6%81%AF1png.png" alt="æŸ¥è¡¨ä¿¡æ¯1"></p><h4 id="5-3-2-æ’å…¥æ•°æ®è®°å½•"><a href="#5-3-2-æ’å…¥æ•°æ®è®°å½•" class="headerlink" title="5.3.2 æ’å…¥æ•°æ®è®°å½•"></a>5.3.2 æ’å…¥æ•°æ®è®°å½•</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_data_address è¿™ä¸ªè¡¨æ’å…¥ä¸€æ¡è®°å½•</span><br></pre></td></tr></table></figure><p><img src="/images/mcp/%E6%9F%A5%E8%A1%A8%E4%BF%A1%E6%81%AF2.png" alt="æŸ¥è¡¨ä¿¡æ¯2"></p><h2 id="6-å®æˆ˜æ¡ˆä¾‹ï¼šExa-MCP-Server-ğŸ”"><a href="#6-å®æˆ˜æ¡ˆä¾‹ï¼šExa-MCP-Server-ğŸ”" class="headerlink" title="6. å®æˆ˜æ¡ˆä¾‹ï¼šExa MCP Server ğŸ”"></a>6. å®æˆ˜æ¡ˆä¾‹ï¼šExa MCP Server ğŸ”</h2><h3 id="6-1-Exa-MCP-Serverç®€ä»‹"><a href="#6-1-Exa-MCP-Serverç®€ä»‹" class="headerlink" title="6.1 Exa MCP Serverç®€ä»‹"></a>6.1 Exa MCP Serverç®€ä»‹</h3><p>Exa MCP Serveræ˜¯ä¸€ä¸ªå¼ºå¤§çš„MCPæœåŠ¡å™¨ï¼Œä¸“é—¨ä¸ºAIåŠ©æ‰‹æä¾›ç½‘ç»œæœç´¢å’Œç½‘é¡µçˆ¬å–åŠŸèƒ½ã€‚å®ƒåŸºäºExa AIçš„æœç´¢èƒ½åŠ›ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¸°å¯Œçš„å·¥å…·é›†ã€‚</p><p><img src="/images/mcp/exa-mcp-server.png" alt="Exa MCP Server"></p><p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p><ul><li>ğŸ” <strong>æ™ºèƒ½ç½‘ç»œæœç´¢</strong>ï¼šå®æ—¶ç½‘ç»œæœç´¢ï¼Œä¼˜åŒ–ç»“æœå’Œå†…å®¹æå–</li><li>ğŸ’» <strong>ä»£ç æœç´¢</strong>ï¼šæœç´¢GitHubä»“åº“ã€æ–‡æ¡£é¡µé¢ã€Stack Overflowç­‰ä»£ç èµ„æº</li><li>ğŸ¢ <strong>å…¬å¸ç ”ç©¶</strong>ï¼šå…¨é¢çš„å…¬å¸ç ”ç©¶å·¥å…·ï¼Œçˆ¬å–å…¬å¸ç½‘ç«™è·å–è¯¦ç»†ä¿¡æ¯</li><li>ğŸ”— <strong>LinkedInæœç´¢</strong>ï¼šä½¿ç”¨Exa AIæœç´¢LinkedInä¸Šçš„å…¬å¸å’Œäººå‘˜</li><li>ğŸ§  <strong>æ·±åº¦ç ”ç©¶</strong>ï¼šæ™ºèƒ½AIç ”ç©¶å‘˜ï¼Œè¿›è¡Œå¤æ‚é—®é¢˜çš„æ·±åº¦ç ”ç©¶</li></ul><p><strong>GitHubä»“åº“ï¼š</strong> <a href="https://github.com/exa-labs/exa-mcp-server">exa-labs&#x2F;exa-mcp-server</a></p><h3 id="6-2-Cursorè¿œç¨‹é…ç½®"><a href="#6-2-Cursorè¿œç¨‹é…ç½®" class="headerlink" title="6.2 Cursorè¿œç¨‹é…ç½®"></a>6.2 Cursorè¿œç¨‹é…ç½®</h3><h4 id="6-2-1-æ— éœ€APIå¯†é’¥ï¼ˆæ¨èï¼‰"><a href="#6-2-1-æ— éœ€APIå¯†é’¥ï¼ˆæ¨èï¼‰" class="headerlink" title="6.2.1 æ— éœ€APIå¯†é’¥ï¼ˆæ¨èï¼‰"></a>6.2.1 æ— éœ€APIå¯†é’¥ï¼ˆæ¨èï¼‰</h4><p><strong>æœ€ç®€å•çš„æ–¹å¼ï¼š</strong> ç›´æ¥ä½¿ç”¨è¿œç¨‹MCPæœåŠ¡ï¼Œæ— éœ€æ³¨å†Œæˆ–è·å–APIå¯†é’¥</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;exa&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.exa.ai/mcp&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;Remove-Me&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Disable web_search_exa tool if you&#x27;re just coding. To 100% call exa-code, say &#x27;use exa-code&#x27;.&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®è¯´æ˜ï¼š</strong></p><ul><li><code>type: &quot;http&quot;</code>ï¼šä½¿ç”¨HTTPé€šä¿¡æ–¹å¼</li><li><code>url</code>ï¼šè¿œç¨‹MCPæœåŠ¡åœ°å€ï¼Œæ— éœ€APIå¯†é’¥</li><li><code>headers</code>ï¼šå¯é€‰å¤´éƒ¨ä¿¡æ¯ï¼Œç”¨äºç¦ç”¨ç‰¹å®šå·¥å…·</li></ul><h4 id="6-2-2-ä½¿ç”¨APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰"><a href="#6-2-2-ä½¿ç”¨APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="6.2.2 ä½¿ç”¨APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰"></a>6.2.2 ä½¿ç”¨APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰</h4><p><strong>å¦‚æœæ‚¨éœ€è¦æ›´é«˜çš„ä½¿ç”¨é™åˆ¶æˆ–æ›´å¤šåŠŸèƒ½ï¼Œå¯ä»¥è·å–APIå¯†é’¥ï¼š</strong></p><p><strong>æ­¥éª¤1ï¼š</strong> è®¿é—®Exa AIæ§åˆ¶å°</p><ul><li>ç½‘å€ï¼š<a href="https://dashboard.exa.ai/api-keys">https://dashboard.exa.ai/api-keys</a></li><li>æ³¨å†Œè´¦å·å¹¶è·å–APIå¯†é’¥</li></ul><p><strong>æ­¥éª¤2ï¼š</strong> åœ¨é…ç½®ä¸­æ·»åŠ APIå¯†é’¥</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;exa&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.exa.ai/mcp?exaApiKey=YOUR_API_KEY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;Remove-Me&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Disable web_search_exa tool if you&#x27;re just coding. To 100% call exa-code, say &#x27;use exa-code&#x27;.&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="6-2-3-æŒ‡å®šå·¥å…·é…ç½®"><a href="#6-2-3-æŒ‡å®šå·¥å…·é…ç½®" class="headerlink" title="6.2.3 æŒ‡å®šå·¥å…·é…ç½®"></a>6.2.3 æŒ‡å®šå·¥å…·é…ç½®</h4><p>å¦‚æœæ‚¨åªæƒ³å¯ç”¨ç‰¹å®šå·¥å…·ï¼Œå¯ä»¥åœ¨URLä¸­æ·»åŠ <code>enabledTools</code>å‚æ•°ï¼š</p><p><strong>æ— éœ€APIå¯†é’¥ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;exa&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.exa.ai/mcp?enabledTools=%5B%22get_code_context_exa%22%2C%22web_search_exa%22%5D&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨APIå¯†é’¥ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;exa&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.exa.ai/mcp?exaApiKey=YOUR_API_KEY&amp;enabledTools=%5B%22get_code_context_exa%22%2C%22web_search_exa%22%5D&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>å¯ç”¨å·¥å…·åˆ—è¡¨ï¼š</strong></p><ul><li><code>get_code_context_exa</code>ï¼šä»£ç æœç´¢</li><li><code>web_search_exa</code>ï¼šç½‘ç»œæœç´¢</li><li><code>company_research</code>ï¼šå…¬å¸ç ”ç©¶</li><li><code>crawling</code>ï¼šç½‘é¡µçˆ¬å–</li><li><code>linkedin_search</code>ï¼šLinkedInæœç´¢</li><li><code>deep_researcher_start</code>ï¼šæ·±åº¦ç ”ç©¶å¼€å§‹</li><li><code>deep_researcher_check</code>ï¼šæ·±åº¦ç ”ç©¶æ£€æŸ¥</li></ul><h4 id="6-2-4-ä½¿ç”¨åŒºåˆ«è¯´æ˜"><a href="#6-2-4-ä½¿ç”¨åŒºåˆ«è¯´æ˜" class="headerlink" title="6.2.4 ä½¿ç”¨åŒºåˆ«è¯´æ˜"></a>6.2.4 ä½¿ç”¨åŒºåˆ«è¯´æ˜</h4><blockquote><p>âš ï¸ <strong>é‡è¦è¯´æ˜</strong>ï¼šExaå®˜æ–¹æ–‡æ¡£ä¸­æœªæ˜ç¡®è¯´æ˜ä½¿ç”¨APIå¯†é’¥å’Œä¸ä½¿ç”¨APIå¯†é’¥çš„å…·ä½“åŒºåˆ«ã€‚ä»¥ä¸‹ä¿¡æ¯åŸºäºå®˜æ–¹æä¾›çš„é…ç½®æ–¹å¼ã€‚</p></blockquote><p><strong>ä¸¤ç§é…ç½®æ–¹å¼ï¼š</strong></p><p><strong>æ— éœ€APIå¯†é’¥ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;exa&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.exa.ai/mcp&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨APIå¯†é’¥ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;exa&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.exa.ai/mcp?exaApiKey=YOUR_API_KEY&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>å»ºè®®ä½¿ç”¨ç­–ç•¥ï¼š</strong></p><ol><li><strong>å…ˆè¯•ç”¨å…è´¹æ–¹å¼</strong>ï¼šç›´æ¥ä½¿ç”¨ <code>https://mcp.exa.ai/mcp</code> è¿›è¡Œæµ‹è¯•</li><li><strong>æ ¹æ®å®é™…ä½“éªŒå†³å®š</strong>ï¼šå¦‚æœä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é™åˆ¶æˆ–é—®é¢˜ï¼Œå†è€ƒè™‘è·å–APIå¯†é’¥</li><li><strong>è·å–APIå¯†é’¥</strong>ï¼šè®¿é—® <a href="https://dashboard.exa.ai/api-keys">https://dashboard.exa.ai/api-keys</a> æ³¨å†Œè·å–</li></ol><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šç”±äºå®˜æ–¹æ–‡æ¡£æœªæ˜ç¡®è¯´æ˜å…·ä½“åŒºåˆ«ï¼Œå»ºè®®ç”¨æˆ·å…ˆå°è¯•æ— éœ€APIå¯†é’¥çš„æ–¹å¼ï¼Œæ ¹æ®å®é™…ä½¿ç”¨ä½“éªŒæ¥å†³å®šæ˜¯å¦éœ€è¦è·å–APIå¯†é’¥ã€‚</p></blockquote><h3 id="6-3-åŠŸèƒ½éªŒè¯"><a href="#6-3-åŠŸèƒ½éªŒè¯" class="headerlink" title="6.3 åŠŸèƒ½éªŒè¯"></a>6.3 åŠŸèƒ½éªŒè¯</h3><h4 id="6-3-1-ç½‘ç»œæœç´¢åŠŸèƒ½"><a href="#6-3-1-ç½‘ç»œæœç´¢åŠŸèƒ½" class="headerlink" title="6.3.1 ç½‘ç»œæœç´¢åŠŸèƒ½"></a>6.3.1 ç½‘ç»œæœç´¢åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æœç´¢æœ€æ–°çš„React 18æ–°ç‰¹æ€§</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>è·å–æœ€æ–°çš„React 18ç›¸å…³ä¿¡æ¯</li><li>åŒ…å«å®˜æ–¹æ–‡æ¡£é“¾æ¥å’Œç¤¾åŒºè®¨è®º</li><li>æä¾›è¯¦ç»†çš„æŠ€æœ¯ç‰¹æ€§è¯´æ˜</li></ul><h4 id="6-3-2-ä»£ç æœç´¢åŠŸèƒ½"><a href="#6-3-2-ä»£ç æœç´¢åŠŸèƒ½" class="headerlink" title="6.3.2 ä»£ç æœç´¢åŠŸèƒ½"></a>6.3.2 ä»£ç æœç´¢åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exa-code æœç´¢å¦‚ä½•åœ¨Pythonä¸­ä½¿ç”¨Exaæœç´¢API</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ‰¾åˆ°ç›¸å…³çš„ä»£ç ç¤ºä¾‹</li><li>æä¾›å®Œæ•´çš„APIä½¿ç”¨æ•™ç¨‹</li><li>åŒ…å«æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹</li></ul><h4 id="6-3-3-å…¬å¸ç ”ç©¶åŠŸèƒ½"><a href="#6-3-3-å…¬å¸ç ”ç©¶åŠŸèƒ½" class="headerlink" title="6.3.3 å…¬å¸ç ”ç©¶åŠŸèƒ½"></a>6.3.3 å…¬å¸ç ”ç©¶åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·ç ”ç©¶ä¸€ä¸‹OpenAIå…¬å¸çš„åŸºæœ¬ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>è·å–å…¬å¸å®˜ç½‘ä¿¡æ¯</li><li>åŒ…å«å…¬å¸ç®€ä»‹ã€äº§å“æœåŠ¡</li><li>æä¾›è”ç³»æ–¹å¼å’Œæœ€æ–°åŠ¨æ€</li></ul><h4 id="6-3-4-æ·±åº¦ç ”ç©¶åŠŸèƒ½"><a href="#6-3-4-æ·±åº¦ç ”ç©¶åŠŸèƒ½" class="headerlink" title="6.3.4 æ·±åº¦ç ”ç©¶åŠŸèƒ½"></a>6.3.4 æ·±åº¦ç ”ç©¶åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹æ·±åº¦ç ”ç©¶ï¼šäººå·¥æ™ºèƒ½åœ¨åŒ»ç–—é¢†åŸŸçš„åº”ç”¨ç°çŠ¶å’Œæœªæ¥è¶‹åŠ¿</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>å¯åŠ¨æ™ºèƒ½ç ”ç©¶ä»»åŠ¡</li><li>è‡ªåŠ¨æœç´¢å¤šä¸ªç›¸å…³èµ„æº</li><li>ç”Ÿæˆç»¼åˆç ”ç©¶æŠ¥å‘Š</li></ul><p><strong>æ£€æŸ¥ç ”ç©¶è¿›åº¦ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ£€æŸ¥æ·±åº¦ç ”ç©¶ä»»åŠ¡çš„å®Œæˆæƒ…å†µ</span><br></pre></td></tr></table></figure><h2 id="7-å®æˆ˜æ¡ˆä¾‹ï¼šMCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨-ğŸ“"><a href="#7-å®æˆ˜æ¡ˆä¾‹ï¼šMCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨-ğŸ“" class="headerlink" title="7. å®æˆ˜æ¡ˆä¾‹ï¼šMCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ ğŸ“"></a>7. å®æˆ˜æ¡ˆä¾‹ï¼šMCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ ğŸ“</h2><h3 id="7-1-MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ç®€ä»‹"><a href="#7-1-MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ç®€ä»‹" class="headerlink" title="7.1 MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ç®€ä»‹"></a>7.1 MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ç®€ä»‹</h3><p>MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨æ˜¯ä¸€ä¸ªå¼ºå¤§çš„MCPæœåŠ¡å™¨ï¼Œä¸“é—¨ä¸ºAIåŠ©æ‰‹æä¾›æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæ“ä½œåŠŸèƒ½ã€‚å®ƒå…è®¸AIç›´æ¥è¯»å†™ã€ç®¡ç†æœ¬åœ°æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œæå¤§æå‡äº†AIåŠ©æ‰‹åœ¨æ–‡ä»¶ç®¡ç†æ–¹é¢çš„èƒ½åŠ›ã€‚</p><p><img src="/images/mcp/filesystem-server.png" alt="MCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨"></p><p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p><ul><li>ğŸ“– <strong>æ–‡ä»¶è¯»å–</strong>ï¼šè¯»å–ä»»æ„æ–‡ä»¶çš„å†…å®¹</li><li>âœï¸ <strong>æ–‡ä»¶å†™å…¥</strong>ï¼šåˆ›å»ºå’Œç¼–è¾‘æ–‡ä»¶</li><li>ğŸ“ <strong>ç›®å½•ç®¡ç†</strong>ï¼šåˆ—å‡ºã€åˆ›å»ºã€ç®¡ç†ç›®å½•</li><li>ğŸ” <strong>æ–‡ä»¶æœç´¢</strong>ï¼šæ ¹æ®æ¨¡å¼æœç´¢æ–‡ä»¶</li><li>ğŸ“Š <strong>æ–‡ä»¶ä¿¡æ¯</strong>ï¼šè·å–æ–‡ä»¶è¯¦ç»†ä¿¡æ¯å’Œç»Ÿè®¡</li><li>ğŸ–¼ï¸ <strong>å›¾ç‰‡å¤„ç†</strong>ï¼šè¯»å–å’Œå¤„ç†å›¾ç‰‡æ–‡ä»¶</li><li>ğŸ”„ <strong>æ–‡ä»¶æ“ä½œ</strong>ï¼šç§»åŠ¨ã€é‡å‘½åã€åˆ é™¤æ–‡ä»¶</li></ul><p><strong>GitHubä»“åº“ï¼š</strong> <a href="https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem">modelcontextprotocol&#x2F;servers&#x2F;filesystem</a></p><h3 id="7-2-Cursoré…ç½®"><a href="#7-2-Cursoré…ç½®" class="headerlink" title="7.2 Cursoré…ç½®"></a>7.2 Cursoré…ç½®</h3><h4 id="7-2-1-åŸºç¡€é…ç½®"><a href="#7-2-1-åŸºç¡€é…ç½®" class="headerlink" title="7.2.1 åŸºç¡€é…ç½®"></a>7.2.1 åŸºç¡€é…ç½®</h4><p>åœ¨Cursorçš„MCPé…ç½®ä¸­æ·»åŠ æ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;filesystem&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;-y&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;@modelcontextprotocol/server-filesystem&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®è¯´æ˜ï¼š</strong></p><ul><li><code>command: &quot;npx&quot;</code>ï¼šä½¿ç”¨npxè¿è¡ŒMCPæœåŠ¡å™¨</li><li><code>&quot;-y&quot;</code>ï¼šè‡ªåŠ¨ç¡®è®¤å®‰è£…ï¼Œæ— éœ€æ‰‹åŠ¨ç¡®è®¤</li><li><code>&quot;@modelcontextprotocol/server-filesystem&quot;</code>ï¼šMCPæ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨åŒ…å</li><li><code>&quot;D:\\&quot;</code>ï¼šæŒ‡å®šå…è®¸è®¿é—®çš„ç›®å½•è·¯å¾„</li></ul><h4 id="7-2-2-å®‰å…¨é…ç½®å»ºè®®"><a href="#7-2-2-å®‰å…¨é…ç½®å»ºè®®" class="headerlink" title="7.2.2 å®‰å…¨é…ç½®å»ºè®®"></a>7.2.2 å®‰å…¨é…ç½®å»ºè®®</h4><p><strong>è®¿é—®æ•´ä¸ªDç›˜ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;filesystem&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;-y&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;@modelcontextprotocol/server-filesystem&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶è®¿é—®ç‰¹å®šç›®å½•ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;filesystem&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;-y&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;@modelcontextprotocol/server-filesystem&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\Projects&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>å¤šç›®å½•è®¿é—®ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;filesystem&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;-y&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;@modelcontextprotocol/server-filesystem&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\Projects&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\Documents&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\Downloads&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="7-3-åŠŸèƒ½éªŒè¯"><a href="#7-3-åŠŸèƒ½éªŒè¯" class="headerlink" title="7.3 åŠŸèƒ½éªŒè¯"></a>7.3 åŠŸèƒ½éªŒè¯</h3><h4 id="7-3-1-ç›®å½•æµè§ˆåŠŸèƒ½"><a href="#7-3-1-ç›®å½•æµè§ˆåŠŸèƒ½" class="headerlink" title="7.3.1 ç›®å½•æµè§ˆåŠŸèƒ½"></a>7.3.1 ç›®å½•æµè§ˆåŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ—å‡ºDç›˜æ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ˜¾ç¤ºDç›˜æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤¹</li><li>åŒ…å«æ–‡ä»¶å¤¹åç§°ã€å¤§å°ã€ä¿®æ”¹æ—¶é—´ç­‰ä¿¡æ¯</li><li>æä¾›è¯¦ç»†çš„ç›®å½•ç»“æ„</li></ul><h4 id="7-3-2-æ–‡ä»¶è¯»å–åŠŸèƒ½"><a href="#7-3-2-æ–‡ä»¶è¯»å–åŠŸèƒ½" class="headerlink" title="7.3.2 æ–‡ä»¶è¯»å–åŠŸèƒ½"></a>7.3.2 æ–‡ä»¶è¯»å–åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘è¯»å–D:\æŸä¸ªæ–‡ä»¶.txtçš„å†…å®¹</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æˆåŠŸè¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹</li><li>æ˜¾ç¤ºæ–‡ä»¶çš„å®Œæ•´æ–‡æœ¬å†…å®¹</li><li>æä¾›æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯</li></ul><h4 id="7-3-3-æ–‡ä»¶æœç´¢åŠŸèƒ½"><a href="#7-3-3-æ–‡ä»¶æœç´¢åŠŸèƒ½" class="headerlink" title="7.3.3 æ–‡ä»¶æœç´¢åŠŸèƒ½"></a>7.3.3 æ–‡ä»¶æœç´¢åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æœç´¢Dç›˜ä¸­æ‰€æœ‰åŒ…å«&quot;config&quot;çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ‰¾åˆ°æ‰€æœ‰åŒ…å«â€configâ€å…³é”®è¯çš„æ–‡ä»¶</li><li>æ˜¾ç¤ºæ–‡ä»¶è·¯å¾„å’ŒåŒ¹é…å†…å®¹</li><li>æä¾›æœç´¢ç»“æœç»Ÿè®¡</li></ul><h4 id="7-3-4-æ–‡ä»¶åˆ›å»ºåŠŸèƒ½"><a href="#7-3-4-æ–‡ä»¶åˆ›å»ºåŠŸèƒ½" class="headerlink" title="7.3.4 æ–‡ä»¶åˆ›å»ºåŠŸèƒ½"></a>7.3.4 æ–‡ä»¶åˆ›å»ºåŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åœ¨D:\testç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º&quot;example.txt&quot;çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º&quot;Hello World&quot;</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æˆåŠŸåˆ›å»ºæŒ‡å®šæ–‡ä»¶</li><li>æ–‡ä»¶å†…å®¹æ­£ç¡®å†™å…¥</li><li>ç¡®è®¤æ–‡ä»¶åˆ›å»ºæˆåŠŸ</li></ul><h4 id="7-3-5-ç›®å½•ç®¡ç†åŠŸèƒ½"><a href="#7-3-5-ç›®å½•ç®¡ç†åŠŸèƒ½" class="headerlink" title="7.3.5 ç›®å½•ç®¡ç†åŠŸèƒ½"></a>7.3.5 ç›®å½•ç®¡ç†åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åœ¨Dç›˜åˆ›å»ºä¸€ä¸ªåä¸º&quot;AI_Projects&quot;çš„æ–°æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æˆåŠŸåˆ›å»ºæ–°ç›®å½•</li><li>ç¡®è®¤ç›®å½•åˆ›å»ºæˆåŠŸ</li><li>å¯ä»¥ç»§ç»­åœ¨è¯¥ç›®å½•ä¸‹æ“ä½œ</li></ul><h4 id="7-3-6-æ–‡ä»¶ä¿¡æ¯è·å–"><a href="#7-3-6-æ–‡ä»¶ä¿¡æ¯è·å–" class="headerlink" title="7.3.6 æ–‡ä»¶ä¿¡æ¯è·å–"></a>7.3.6 æ–‡ä»¶ä¿¡æ¯è·å–</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘è·å–D:\æŸä¸ªæ–‡ä»¶å¤¹çš„å¤§å°å’Œæ–‡ä»¶æ•°é‡ç»Ÿè®¡</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ˜¾ç¤ºæ–‡ä»¶å¤¹çš„æ€»å¤§å°</li><li>ç»Ÿè®¡æ–‡ä»¶æ•°é‡</li><li>æä¾›è¯¦ç»†çš„å­˜å‚¨ä¿¡æ¯</li></ul><h3 id="7-4-å®é™…åº”ç”¨åœºæ™¯"><a href="#7-4-å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="7.4 å®é™…åº”ç”¨åœºæ™¯"></a>7.4 å®é™…åº”ç”¨åœºæ™¯</h3><h4 id="7-4-1-ä»£ç é¡¹ç›®ç®¡ç†"><a href="#7-4-1-ä»£ç é¡¹ç›®ç®¡ç†" class="headerlink" title="7.4.1 ä»£ç é¡¹ç›®ç®¡ç†"></a>7.4.1 ä»£ç é¡¹ç›®ç®¡ç†</h4><p><strong>é¡¹ç›®æ–‡ä»¶æ•´ç†ï¼š</strong></p><ul><li>è‡ªåŠ¨æ•´ç†é¡¹ç›®æ–‡ä»¶ç»“æ„</li><li>æ‰¹é‡é‡å‘½åæ–‡ä»¶</li><li>æœç´¢å’Œæ›¿æ¢ä»£ç å†…å®¹</li><li>ç”Ÿæˆé¡¹ç›®æ–‡æ¡£</li></ul><p><strong>ä»£ç åˆ†æï¼š</strong></p><ul><li>ç»Ÿè®¡ä»£ç è¡Œæ•°</li><li>åˆ†ææ–‡ä»¶ä¾èµ–å…³ç³»</li><li>æŸ¥æ‰¾é‡å¤ä»£ç </li><li>ç”Ÿæˆä»£ç æŠ¥å‘Š</li></ul><h4 id="7-4-2-æ–‡æ¡£ç®¡ç†"><a href="#7-4-2-æ–‡æ¡£ç®¡ç†" class="headerlink" title="7.4.2 æ–‡æ¡£ç®¡ç†"></a>7.4.2 æ–‡æ¡£ç®¡ç†</h4><p><strong>æ–‡æ¡£å¤„ç†ï¼š</strong></p><ul><li>æ‰¹é‡å¤„ç†markdownæ–‡ä»¶</li><li>è‡ªåŠ¨ç”Ÿæˆç›®å½•ç»“æ„</li><li>æ–‡æ¡£æ ¼å¼è½¬æ¢</li><li>å†…å®¹æ‰¹é‡æ›¿æ¢</li></ul><p><strong>æ–‡ä»¶ç»„ç»‡ï¼š</strong></p><ul><li>æŒ‰ç±»å‹åˆ†ç±»æ–‡ä»¶</li><li>åˆ›å»ºæ ‡å‡†ç›®å½•ç»“æ„</li><li>æ‰¹é‡ç§»åŠ¨æ–‡ä»¶</li><li>æ¸…ç†é‡å¤æ–‡ä»¶</li></ul><h4 id="7-4-3-æ•°æ®å¤„ç†"><a href="#7-4-3-æ•°æ®å¤„ç†" class="headerlink" title="7.4.3 æ•°æ®å¤„ç†"></a>7.4.3 æ•°æ®å¤„ç†</h4><p><strong>æ•°æ®æ–‡ä»¶æ“ä½œï¼š</strong></p><ul><li>è¯»å–CSVã€JSONç­‰æ•°æ®æ–‡ä»¶</li><li>æ‰¹é‡å¤„ç†æ•°æ®æ–‡ä»¶</li><li>æ•°æ®æ ¼å¼è½¬æ¢</li><li>ç”Ÿæˆæ•°æ®æŠ¥å‘Š</li></ul><p><strong>æ–‡ä»¶å¤‡ä»½ï¼š</strong></p><ul><li>è‡ªåŠ¨å¤‡ä»½é‡è¦æ–‡ä»¶</li><li>åˆ›å»ºæ–‡ä»¶å¿«ç…§</li><li>åŒæ­¥æ–‡ä»¶åˆ°ä¸åŒä½ç½®</li><li>æ¸…ç†ä¸´æ—¶æ–‡ä»¶</li></ul><h3 id="7-5-é«˜çº§ä½¿ç”¨æŠ€å·§"><a href="#7-5-é«˜çº§ä½¿ç”¨æŠ€å·§" class="headerlink" title="7.5 é«˜çº§ä½¿ç”¨æŠ€å·§"></a>7.5 é«˜çº§ä½¿ç”¨æŠ€å·§</h3><h4 id="7-5-1-æ‰¹é‡æ“ä½œ"><a href="#7-5-1-æ‰¹é‡æ“ä½œ" class="headerlink" title="7.5.1 æ‰¹é‡æ“ä½œ"></a>7.5.1 æ‰¹é‡æ“ä½œ</h4><p><strong>æ‰¹é‡æ–‡ä»¶å¤„ç†ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æ‰¹é‡é‡å‘½åD:\photosç›®å½•ä¸‹æ‰€æœ‰.jpgæ–‡ä»¶ï¼Œæ·»åŠ &quot;2024_&quot;å‰ç¼€</span><br><span class="line">è¯·å¸®æˆ‘ç»Ÿè®¡D:\codeç›®å½•ä¸‹æ‰€æœ‰.pyæ–‡ä»¶çš„æ€»è¡Œæ•°</span><br><span class="line">è¯·å¸®æˆ‘æŸ¥æ‰¾D:\documentsç›®å½•ä¸‹æ‰€æœ‰åŒ…å«&quot;é‡è¦&quot;çš„æ–‡æ¡£</span><br></pre></td></tr></table></figure><h4 id="7-5-2-æ™ºèƒ½æ–‡ä»¶ç®¡ç†"><a href="#7-5-2-æ™ºèƒ½æ–‡ä»¶ç®¡ç†" class="headerlink" title="7.5.2 æ™ºèƒ½æ–‡ä»¶ç®¡ç†"></a>7.5.2 æ™ºèƒ½æ–‡ä»¶ç®¡ç†</h4><p><strong>è‡ªåŠ¨åˆ†ç±»ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘å°†D:\downloadsç›®å½•ä¸‹çš„æ–‡ä»¶æŒ‰ç±»å‹åˆ†ç±»åˆ°ä¸åŒæ–‡ä»¶å¤¹</span><br><span class="line">è¯·å¸®æˆ‘æ¸…ç†D:\tempç›®å½•ä¸‹è¶…è¿‡30å¤©çš„ä¸´æ—¶æ–‡ä»¶</span><br><span class="line">è¯·å¸®æˆ‘æ•´ç†D:\photosç›®å½•ä¸‹çš„ç…§ç‰‡ï¼ŒæŒ‰æ—¥æœŸåˆ›å»ºå­æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><h4 id="7-5-3-é¡¹ç›®è‡ªåŠ¨åŒ–"><a href="#7-5-3-é¡¹ç›®è‡ªåŠ¨åŒ–" class="headerlink" title="7.5.3 é¡¹ç›®è‡ªåŠ¨åŒ–"></a>7.5.3 é¡¹ç›®è‡ªåŠ¨åŒ–</h4><p><strong>é¡¹ç›®åˆå§‹åŒ–ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ›å»ºä¸€ä¸ªæ–°çš„Reacté¡¹ç›®ç›®å½•ç»“æ„</span><br><span class="line">è¯·å¸®æˆ‘ç”Ÿæˆé¡¹ç›®çš„README.mdæ–‡ä»¶</span><br><span class="line">è¯·å¸®æˆ‘è®¾ç½®é¡¹ç›®çš„.gitignoreæ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="7-6-å®‰å…¨æ³¨æ„äº‹é¡¹"><a href="#7-6-å®‰å…¨æ³¨æ„äº‹é¡¹" class="headerlink" title="7.6 å®‰å…¨æ³¨æ„äº‹é¡¹"></a>7.6 å®‰å…¨æ³¨æ„äº‹é¡¹</h3><h4 id="7-6-1-æƒé™ç®¡ç†"><a href="#7-6-1-æƒé™ç®¡ç†" class="headerlink" title="7.6.1 æƒé™ç®¡ç†"></a>7.6.1 æƒé™ç®¡ç†</h4><p><strong>é‡è¦æé†’ï¼š</strong></p><ul><li>ç¡®ä¿Cursoræœ‰è¶³å¤Ÿçš„æ–‡ä»¶ç³»ç»Ÿæƒé™</li><li>é¿å…è®¿é—®ç³»ç»Ÿæ•æ„Ÿç›®å½•</li><li>å®šæœŸæ£€æŸ¥AIå¯¹æ–‡ä»¶çš„æ“ä½œè®°å½•</li><li>é‡è¦æ–‡ä»¶æ“ä½œå‰å…ˆå¤‡ä»½</li></ul><h4 id="7-6-2-æœ€ä½³å®è·µ"><a href="#7-6-2-æœ€ä½³å®è·µ" class="headerlink" title="7.6.2 æœ€ä½³å®è·µ"></a>7.6.2 æœ€ä½³å®è·µ</h4><p><strong>å®‰å…¨å»ºè®®ï¼š</strong></p><ul><li>ä»ç‰¹å®šé¡¹ç›®ç›®å½•å¼€å§‹ï¼Œé€æ­¥æ‰©å¤§è®¿é—®èŒƒå›´</li><li>ä½¿ç”¨ç›¸å¯¹è·¯å¾„è€Œéç»å¯¹è·¯å¾„</li><li>å®šæœŸæ¸…ç†AIåˆ›å»ºçš„æ–‡ä»¶</li><li>è®¾ç½®æ–‡ä»¶æ“ä½œæ—¥å¿—è®°å½•</li></ul><h2 id="8-å®æˆ˜æ¡ˆä¾‹ï¼šMCP-GitæœåŠ¡å™¨-ğŸŒ¿"><a href="#8-å®æˆ˜æ¡ˆä¾‹ï¼šMCP-GitæœåŠ¡å™¨-ğŸŒ¿" class="headerlink" title="8. å®æˆ˜æ¡ˆä¾‹ï¼šMCP GitæœåŠ¡å™¨ ğŸŒ¿"></a>8. å®æˆ˜æ¡ˆä¾‹ï¼šMCP GitæœåŠ¡å™¨ ğŸŒ¿</h2><h3 id="8-1-MCP-GitæœåŠ¡å™¨ç®€ä»‹"><a href="#8-1-MCP-GitæœåŠ¡å™¨ç®€ä»‹" class="headerlink" title="8.1 MCP GitæœåŠ¡å™¨ç®€ä»‹"></a>8.1 MCP GitæœåŠ¡å™¨ç®€ä»‹</h3><p>MCP GitæœåŠ¡å™¨æ˜¯ä¸€ä¸ªå¼ºå¤§çš„MCPæœåŠ¡å™¨ï¼Œä¸“é—¨ä¸ºAIåŠ©æ‰‹æä¾›Gitç‰ˆæœ¬æ§åˆ¶æ“ä½œåŠŸèƒ½ã€‚å®ƒå…è®¸AIç›´æ¥ä¸Gitä»“åº“äº¤äº’ï¼Œæ‰§è¡Œå„ç§ç‰ˆæœ¬æ§åˆ¶æ“ä½œï¼Œæå¤§æå‡äº†å¼€å‘è€…åœ¨Gitç®¡ç†æ–¹é¢çš„æ•ˆç‡ã€‚</p><p><img src="/images/mcp/git-server.png" alt="MCP GitæœåŠ¡å™¨"></p><p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p><ul><li>ğŸ“ <strong>æäº¤ç®¡ç†</strong>ï¼šåˆ›å»ºã€æŸ¥çœ‹ã€ä¿®æ”¹ã€æ’¤é”€æäº¤</li><li>ğŸŒ¿ <strong>åˆ†æ”¯ç®¡ç†</strong>ï¼šåˆ›å»ºã€åˆ‡æ¢ã€åˆå¹¶ã€åˆ é™¤åˆ†æ”¯</li><li>ğŸ“Š <strong>çŠ¶æ€æŸ¥çœ‹</strong>ï¼šæŸ¥çœ‹ä»“åº“çŠ¶æ€ã€å·®å¼‚ã€å†å²è®°å½•</li><li>ğŸ”„ <strong>è¿œç¨‹æ“ä½œ</strong>ï¼šæ¨é€ã€æ‹‰å–ã€åŒæ­¥è¿œç¨‹ä»“åº“</li><li>ğŸ·ï¸ <strong>æ ‡ç­¾ç®¡ç†</strong>ï¼šåˆ›å»ºã€åˆ é™¤ã€ç®¡ç†ç‰ˆæœ¬æ ‡ç­¾</li><li>ğŸ“‹ <strong>æ—¥å¿—åˆ†æ</strong>ï¼šæŸ¥çœ‹æäº¤å†å²ã€æ–‡ä»¶å˜æ›´è®°å½•</li><li>ğŸ” <strong>å·®å¼‚å¯¹æ¯”</strong>ï¼šæ¯”è¾ƒä¸åŒç‰ˆæœ¬é—´çš„å·®å¼‚</li></ul><p><strong>GitHubä»“åº“ï¼š</strong> <a href="https://github.com/modelcontextprotocol/servers/tree/main/src/git">modelcontextprotocol&#x2F;servers&#x2F;git</a></p><h3 id="8-2-Cursoré…ç½®"><a href="#8-2-Cursoré…ç½®" class="headerlink" title="8.2 Cursoré…ç½®"></a>8.2 Cursoré…ç½®</h3><h4 id="8-2-1-åŸºç¡€é…ç½®"><a href="#8-2-1-åŸºç¡€é…ç½®" class="headerlink" title="8.2.1 åŸºç¡€é…ç½®"></a>8.2.1 åŸºç¡€é…ç½®</h4><p>åœ¨Cursorçš„MCPé…ç½®ä¸­æ·»åŠ GitæœåŠ¡å™¨ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;git&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uvx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;mcp-server-git&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½®è¯´æ˜ï¼š</strong></p><ul><li><code>command: &quot;uvx&quot;</code>ï¼šä½¿ç”¨uvxè¿è¡ŒMCPæœåŠ¡å™¨ï¼ˆPythonåŒ…è¿è¡Œå·¥å…·ï¼‰</li><li><code>args: [&quot;mcp-server-git&quot;]</code>ï¼šæŒ‡å®šè¦è¿è¡Œçš„MCP GitæœåŠ¡å™¨åŒ…</li></ul><h4 id="8-2-2-å‰ç½®æ¡ä»¶"><a href="#8-2-2-å‰ç½®æ¡ä»¶" class="headerlink" title="8.2.2 å‰ç½®æ¡ä»¶"></a>8.2.2 å‰ç½®æ¡ä»¶</h4><p><strong>å®‰è£…uvxï¼ˆå¦‚æœç³»ç»Ÿæ²¡æœ‰ï¼‰ï¼š</strong></p><p><strong>Windows PowerShellï¼š</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="literal">-ExecutionPolicy</span> ByPass <span class="literal">-c</span> <span class="string">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span></span><br></pre></td></tr></table></figure><p><strong>æˆ–è€…ä½¿ç”¨pipå®‰è£…ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install uv</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯å®‰è£…ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uvx --version</span><br></pre></td></tr></table></figure><h4 id="8-2-3-å¤‡é€‰é…ç½®æ–¹æ¡ˆ"><a href="#8-2-3-å¤‡é€‰é…ç½®æ–¹æ¡ˆ" class="headerlink" title="8.2.3 å¤‡é€‰é…ç½®æ–¹æ¡ˆ"></a>8.2.3 å¤‡é€‰é…ç½®æ–¹æ¡ˆ</h4><p><strong>Dockerå®‰è£…æ–¹å¼ï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;git&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;docker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;run&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;--rm&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;-i&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;--mount&quot;</span><span class="punctuation">,</span> <span class="string">&quot;type=bind,src=$&#123;workspaceFolder&#125;,dst=/workspace&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;mcp/git&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>å¦‚æœuvxä¸å¯ç”¨ï¼Œå¯ä»¥ä½¿ç”¨npxï¼š</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;git&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;-y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;@modelcontextprotocol/server-git&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="8-3-åŠŸèƒ½éªŒè¯"><a href="#8-3-åŠŸèƒ½éªŒè¯" class="headerlink" title="8.3 åŠŸèƒ½éªŒè¯"></a>8.3 åŠŸèƒ½éªŒè¯</h3><h4 id="8-3-1-ä»“åº“çŠ¶æ€æŸ¥çœ‹"><a href="#8-3-1-ä»“åº“çŠ¶æ€æŸ¥çœ‹" class="headerlink" title="8.3.1 ä»“åº“çŠ¶æ€æŸ¥çœ‹"></a>8.3.1 ä»“åº“çŠ¶æ€æŸ¥çœ‹</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æŸ¥çœ‹å½“å‰Gitä»“åº“çš„çŠ¶æ€</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ˜¾ç¤ºå½“å‰åˆ†æ”¯ä¿¡æ¯</li><li>åˆ—å‡ºå·²ä¿®æ”¹ã€å·²æš‚å­˜ã€æœªè·Ÿè¸ªçš„æ–‡ä»¶</li><li>æä¾›ä»“åº“çŠ¶æ€æ¦‚è§ˆ</li></ul><h4 id="8-3-2-åˆ†æ”¯ç®¡ç†åŠŸèƒ½"><a href="#8-3-2-åˆ†æ”¯ç®¡ç†åŠŸèƒ½" class="headerlink" title="8.3.2 åˆ†æ”¯ç®¡ç†åŠŸèƒ½"></a>8.3.2 åˆ†æ”¯ç®¡ç†åŠŸèƒ½</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ—å‡ºæ‰€æœ‰åˆ†æ”¯</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ˜¾ç¤ºæœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯åˆ—è¡¨</li><li>æ ‡è¯†å½“å‰æ‰€åœ¨åˆ†æ”¯</li><li>æä¾›åˆ†æ”¯è¯¦ç»†ä¿¡æ¯</li></ul><h4 id="8-3-3-æäº¤å†å²æŸ¥çœ‹"><a href="#8-3-3-æäº¤å†å²æŸ¥çœ‹" class="headerlink" title="8.3.3 æäº¤å†å²æŸ¥çœ‹"></a>8.3.3 æäº¤å†å²æŸ¥çœ‹</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æŸ¥çœ‹æœ€è¿‘çš„æäº¤å†å²</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ˜¾ç¤ºæœ€è¿‘çš„æäº¤è®°å½•</li><li>åŒ…å«æäº¤å“ˆå¸Œã€ä½œè€…ã€æ—¶é—´ã€æäº¤ä¿¡æ¯</li><li>æä¾›æäº¤çš„è¯¦ç»†å˜æ›´ä¿¡æ¯</li></ul><h4 id="8-3-4-æ–‡ä»¶å·®å¼‚å¯¹æ¯”"><a href="#8-3-4-æ–‡ä»¶å·®å¼‚å¯¹æ¯”" class="headerlink" title="8.3.4 æ–‡ä»¶å·®å¼‚å¯¹æ¯”"></a>8.3.4 æ–‡ä»¶å·®å¼‚å¯¹æ¯”</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æŸ¥çœ‹å½“å‰å·¥ä½œåŒºä¸ä¸Šæ¬¡æäº¤çš„å·®å¼‚</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æ˜¾ç¤ºæ–‡ä»¶çš„å…·ä½“å˜æ›´å†…å®¹</li><li>æ ‡è¯†æ–°å¢ã€åˆ é™¤ã€ä¿®æ”¹çš„è¡Œ</li><li>æä¾›è¯¦ç»†çš„å·®å¼‚å¯¹æ¯”</li></ul><h4 id="8-3-5-æäº¤æ“ä½œ"><a href="#8-3-5-æäº¤æ“ä½œ" class="headerlink" title="8.3.5 æäº¤æ“ä½œ"></a>8.3.5 æäº¤æ“ä½œ</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘æäº¤æ‰€æœ‰æ›´æ”¹ï¼Œæäº¤ä¿¡æ¯ä¸º&quot;æ·»åŠ æ–°åŠŸèƒ½&quot;</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æˆåŠŸæš‚å­˜æ‰€æœ‰æ›´æ”¹</li><li>åˆ›å»ºæ–°çš„æäº¤è®°å½•</li><li>ç¡®è®¤æäº¤æˆåŠŸ</li></ul><h4 id="8-3-6-åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢"><a href="#8-3-6-åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢" class="headerlink" title="8.3.6 åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢"></a>8.3.6 åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢</h4><p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ›å»ºä¸€ä¸ªåä¸º&quot;feature-new&quot;çš„æ–°åˆ†æ”¯å¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span><br></pre></td></tr></table></figure><p><strong>é¢„æœŸç»“æœï¼š</strong></p><ul><li>æˆåŠŸåˆ›å»ºæ–°åˆ†æ”¯</li><li>åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</li><li>ç¡®è®¤åˆ†æ”¯æ“ä½œæˆåŠŸ</li></ul><h3 id="8-4-å®é™…åº”ç”¨åœºæ™¯"><a href="#8-4-å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="8.4 å®é™…åº”ç”¨åœºæ™¯"></a>8.4 å®é™…åº”ç”¨åœºæ™¯</h3><h4 id="8-4-1-ä»£ç å¼€å‘æµç¨‹"><a href="#8-4-1-ä»£ç å¼€å‘æµç¨‹" class="headerlink" title="8.4.1 ä»£ç å¼€å‘æµç¨‹"></a>8.4.1 ä»£ç å¼€å‘æµç¨‹</h4><p><strong>æ—¥å¸¸å¼€å‘æ“ä½œï¼š</strong></p><ul><li>è‡ªåŠ¨ç”Ÿæˆè§„èŒƒçš„æäº¤ä¿¡æ¯</li><li>æ™ºèƒ½åˆ†æ”¯å‘½åå»ºè®®</li><li>ä»£ç å˜æ›´å½±å“åˆ†æ</li><li>è‡ªåŠ¨è§£å†³ç®€å•å†²çª</li></ul><p><strong>ä»£ç å®¡æŸ¥ï¼š</strong></p><ul><li>ç”Ÿæˆå˜æ›´æ‘˜è¦æŠ¥å‘Š</li><li>åˆ†æä»£ç è´¨é‡æŒ‡æ ‡</li><li>æ£€æŸ¥ä»£ç è§„èŒƒåˆè§„æ€§</li><li>æä¾›æ”¹è¿›å»ºè®®</li></ul><h4 id="8-4-2-ç‰ˆæœ¬ç®¡ç†"><a href="#8-4-2-ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="8.4.2 ç‰ˆæœ¬ç®¡ç†"></a>8.4.2 ç‰ˆæœ¬ç®¡ç†</h4><p><strong>å‘å¸ƒç®¡ç†ï¼š</strong></p><ul><li>è‡ªåŠ¨åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾</li><li>ç”Ÿæˆå‘å¸ƒè¯´æ˜</li><li>ç®¡ç†å‘å¸ƒåˆ†æ”¯</li><li>ç‰ˆæœ¬å›æ»šæ“ä½œ</li></ul><p><strong>åˆ†æ”¯ç­–ç•¥ï¼š</strong></p><ul><li>æ™ºèƒ½åˆå¹¶ç­–ç•¥å»ºè®®</li><li>åˆ†æ”¯ä¿æŠ¤è§„åˆ™è®¾ç½®</li><li>ä»£ç å®¡æŸ¥æµç¨‹ç®¡ç†</li><li>å‘å¸ƒæµç¨‹è‡ªåŠ¨åŒ–</li></ul><h4 id="8-4-3-å›¢é˜Ÿåä½œ"><a href="#8-4-3-å›¢é˜Ÿåä½œ" class="headerlink" title="8.4.3 å›¢é˜Ÿåä½œ"></a>8.4.3 å›¢é˜Ÿåä½œ</h4><p><strong>åä½œæµç¨‹ï¼š</strong></p><ul><li>åŒæ­¥å›¢é˜Ÿä»£ç å˜æ›´</li><li>ç®¡ç†Pull Request</li><li>ä»£ç å®¡æŸ¥æµç¨‹ä¼˜åŒ–</li><li>å†²çªè§£å†³å»ºè®®</li></ul><p><strong>é¡¹ç›®ç®¡ç†ï¼š</strong></p><ul><li>é¡¹ç›®è¿›åº¦è·Ÿè¸ª</li><li>ä»£ç è´¡çŒ®ç»Ÿè®¡</li><li>å›¢é˜Ÿåä½œåˆ†æ</li><li>é¡¹ç›®å¥åº·åº¦ç›‘æ§</li></ul><h3 id="8-5-é«˜çº§ä½¿ç”¨æŠ€å·§"><a href="#8-5-é«˜çº§ä½¿ç”¨æŠ€å·§" class="headerlink" title="8.5 é«˜çº§ä½¿ç”¨æŠ€å·§"></a>8.5 é«˜çº§ä½¿ç”¨æŠ€å·§</h3><h4 id="8-5-1-æ™ºèƒ½æäº¤"><a href="#8-5-1-æ™ºèƒ½æäº¤" class="headerlink" title="8.5.1 æ™ºèƒ½æäº¤"></a>8.5.1 æ™ºèƒ½æäº¤</h4><p><strong>è‡ªåŠ¨æäº¤ä¿¡æ¯ç”Ÿæˆï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ†æä»£ç å˜æ›´å¹¶ç”Ÿæˆåˆé€‚çš„æäº¤ä¿¡æ¯</span><br><span class="line">è¯·å¸®æˆ‘å°†å¤šä¸ªå°æäº¤åˆå¹¶ä¸ºä¸€ä¸ªæœ‰æ„ä¹‰çš„æäº¤</span><br><span class="line">è¯·å¸®æˆ‘ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤çš„ä¿¡æ¯</span><br></pre></td></tr></table></figure><h4 id="8-5-2-åˆ†æ”¯ç®¡ç†"><a href="#8-5-2-åˆ†æ”¯ç®¡ç†" class="headerlink" title="8.5.2 åˆ†æ”¯ç®¡ç†"></a>8.5.2 åˆ†æ”¯ç®¡ç†</h4><p><strong>æ™ºèƒ½åˆ†æ”¯æ“ä½œï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ›å»ºä¸€ä¸ªåŸºäºmainåˆ†æ”¯çš„æ–°åŠŸèƒ½åˆ†æ”¯</span><br><span class="line">è¯·å¸®æˆ‘å°†featureåˆ†æ”¯åˆå¹¶åˆ°mainåˆ†æ”¯</span><br><span class="line">è¯·å¸®æˆ‘æ¸…ç†å·²åˆå¹¶çš„æœ¬åœ°åˆ†æ”¯</span><br><span class="line">è¯·å¸®æˆ‘åŒæ­¥è¿œç¨‹åˆ†æ”¯ä¿¡æ¯</span><br></pre></td></tr></table></figure><h4 id="8-5-3-å†å²åˆ†æ"><a href="#8-5-3-å†å²åˆ†æ" class="headerlink" title="8.5.3 å†å²åˆ†æ"></a>8.5.3 å†å²åˆ†æ</h4><p><strong>ä»£ç å†å²åˆ†æï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¯·å¸®æˆ‘åˆ†ææŸä¸ªæ–‡ä»¶çš„ä¿®æ”¹å†å²</span><br><span class="line">è¯·å¸®æˆ‘æ‰¾å‡ºå¼•å…¥bugçš„æäº¤</span><br><span class="line">è¯·å¸®æˆ‘ç»Ÿè®¡ä»£ç è´¡çŒ®æƒ…å†µ</span><br><span class="line">è¯·å¸®æˆ‘ç”Ÿæˆé¡¹ç›®å˜æ›´æŠ¥å‘Š</span><br></pre></td></tr></table></figure><h3 id="8-6-å®‰å…¨æ³¨æ„äº‹é¡¹"><a href="#8-6-å®‰å…¨æ³¨æ„äº‹é¡¹" class="headerlink" title="8.6 å®‰å…¨æ³¨æ„äº‹é¡¹"></a>8.6 å®‰å…¨æ³¨æ„äº‹é¡¹</h3><h4 id="8-6-1-æ“ä½œå®‰å…¨"><a href="#8-6-1-æ“ä½œå®‰å…¨" class="headerlink" title="8.6.1 æ“ä½œå®‰å…¨"></a>8.6.1 æ“ä½œå®‰å…¨</h4><p><strong>é‡è¦æé†’ï¼š</strong></p><ul><li>è°¨æ…ä½¿ç”¨å¼ºåˆ¶æ¨é€æ“ä½œ</li><li>é‡è¦æ“ä½œå‰å…ˆå¤‡ä»½ä»“åº“</li><li>é¿å…åœ¨å…±äº«åˆ†æ”¯ä¸Šç›´æ¥æ“ä½œ</li><li>å®šæœŸæ£€æŸ¥Gitæ“ä½œæ—¥å¿—</li></ul><h4 id="8-6-2-æœ€ä½³å®è·µ"><a href="#8-6-2-æœ€ä½³å®è·µ" class="headerlink" title="8.6.2 æœ€ä½³å®è·µ"></a>8.6.2 æœ€ä½³å®è·µ</h4><p><strong>å®‰å…¨å»ºè®®ï¼š</strong></p><ul><li>ä½¿ç”¨æè¿°æ€§çš„æäº¤ä¿¡æ¯</li><li>ä¿æŒåˆ†æ”¯å‘½åè§„èŒƒ</li><li>å®šæœŸåŒæ­¥è¿œç¨‹ä»“åº“</li><li>è®¾ç½®åˆé€‚çš„Gité’©å­</li></ul><p><strong>æƒé™ç®¡ç†ï¼š</strong></p><ul><li>ç¡®ä¿æœ‰è¶³å¤Ÿçš„ä»“åº“æƒé™</li><li>é¿å…åœ¨æ•æ„Ÿä»“åº“ä¸­ä½¿ç”¨</li><li>å®šæœŸæ£€æŸ¥è®¿é—®æƒé™</li><li>ä½¿ç”¨SSHå¯†é’¥è®¤è¯</li></ul><h3 id="8-7-æ•…éšœæ’é™¤"><a href="#8-7-æ•…éšœæ’é™¤" class="headerlink" title="8.7 æ•…éšœæ’é™¤"></a>8.7 æ•…éšœæ’é™¤</h3><h4 id="8-7-1-å¸¸è§é—®é¢˜"><a href="#8-7-1-å¸¸è§é—®é¢˜" class="headerlink" title="8.7.1 å¸¸è§é—®é¢˜"></a>8.7.1 å¸¸è§é—®é¢˜</h4><p><strong>é…ç½®é—®é¢˜ï¼š</strong></p><ul><li>uvxå‘½ä»¤ä¸å¯ç”¨ï¼šå®‰è£…uvæˆ–ä½¿ç”¨npxå¤‡é€‰æ–¹æ¡ˆ</li><li>æƒé™ä¸è¶³ï¼šæ£€æŸ¥Gitä»“åº“è®¿é—®æƒé™</li><li>ç½‘ç»œé—®é¢˜ï¼šç¡®ä¿å¯ä»¥è®¿é—®åŒ…ä»“åº“</li><li>è·¯å¾„é”™è¯¯ï¼šéªŒè¯Gitä»“åº“è·¯å¾„</li></ul><h4 id="8-7-2-è°ƒè¯•æŠ€å·§"><a href="#8-7-2-è°ƒè¯•æŠ€å·§" class="headerlink" title="8.7.2 è°ƒè¯•æŠ€å·§"></a>8.7.2 è°ƒè¯•æŠ€å·§</h4><p><strong>é—®é¢˜æ’æŸ¥ï¼š</strong></p><ul><li>æ£€æŸ¥Cursorçš„MCPæœåŠ¡å™¨çŠ¶æ€</li><li>éªŒè¯Gitå’ŒPythonç¯å¢ƒ</li><li>æµ‹è¯•åŸºæœ¬çš„Gitå‘½ä»¤</li><li>æŸ¥çœ‹MCPæœåŠ¡å™¨æ—¥å¿—</li></ul><p><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong></p><ul><li>é¿å…åœ¨å¤§å‹ä»“åº“ä¸­é¢‘ç¹æ“ä½œ</li><li>ä½¿ç”¨åˆé€‚çš„Gité…ç½®</li><li>å®šæœŸæ¸…ç†Gitå¯¹è±¡</li><li>ä¼˜åŒ–ä»“åº“å¤§å°</li></ul><h2 id="9-æœ€ä½³å®è·µä¸è¿›é˜¶æŠ€å·§-ğŸš€"><a href="#9-æœ€ä½³å®è·µä¸è¿›é˜¶æŠ€å·§-ğŸš€" class="headerlink" title="9. æœ€ä½³å®è·µä¸è¿›é˜¶æŠ€å·§ ğŸš€"></a>9. æœ€ä½³å®è·µä¸è¿›é˜¶æŠ€å·§ ğŸš€</h2><h3 id="9-1-æ€§èƒ½ä¼˜åŒ–"><a href="#9-1-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="9.1 æ€§èƒ½ä¼˜åŒ–"></a>9.1 æ€§èƒ½ä¼˜åŒ–</h3><h4 id="9-1-1-è¿æ¥æ± ç®¡ç†"><a href="#9-1-1-è¿æ¥æ± ç®¡ç†" class="headerlink" title="9.1.1 è¿æ¥æ± ç®¡ç†"></a>9.1.1 è¿æ¥æ± ç®¡ç†</h4><ul><li>åˆç†é…ç½®è¿æ¥æ± å¤§å°</li><li>åŠæ—¶é‡Šæ”¾ä¸ç”¨çš„è¿æ¥</li><li>ç›‘æ§è¿æ¥ä½¿ç”¨æƒ…å†µ</li></ul><h4 id="9-1-2-ç¼“å­˜ç­–ç•¥"><a href="#9-1-2-ç¼“å­˜ç­–ç•¥" class="headerlink" title="9.1.2 ç¼“å­˜ç­–ç•¥"></a>9.1.2 ç¼“å­˜ç­–ç•¥</h4><ul><li>å¯¹é¢‘ç¹è®¿é—®çš„æ•°æ®è¿›è¡Œç¼“å­˜</li><li>è®¾ç½®åˆç†çš„ç¼“å­˜è¿‡æœŸæ—¶é—´</li><li>ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜æé«˜æ€§èƒ½</li></ul><h4 id="9-1-3-å¼‚æ­¥å¤„ç†"><a href="#9-1-3-å¼‚æ­¥å¤„ç†" class="headerlink" title="9.1.3 å¼‚æ­¥å¤„ç†"></a>9.1.3 å¼‚æ­¥å¤„ç†</h4><ul><li>ä½¿ç”¨å¼‚æ­¥æ–¹å¼å¤„ç†è€—æ—¶æ“ä½œ</li><li>é¿å…é˜»å¡ä¸»çº¿ç¨‹</li><li>åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´</li></ul><h3 id="9-2-å®‰å…¨è€ƒè™‘"><a href="#9-2-å®‰å…¨è€ƒè™‘" class="headerlink" title="9.2 å®‰å…¨è€ƒè™‘"></a>9.2 å®‰å…¨è€ƒè™‘</h3><h4 id="9-2-1-æ•°æ®å®‰å…¨"><a href="#9-2-1-æ•°æ®å®‰å…¨" class="headerlink" title="9.2.1 æ•°æ®å®‰å…¨"></a>9.2.1 æ•°æ®å®‰å…¨</h4><ul><li>æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨</li><li>ä½¿ç”¨HTTPSä¼ è¾“</li><li>å®šæœŸæ›´æ–°APIå¯†é’¥</li></ul><h4 id="9-2-2-è®¿é—®æ§åˆ¶"><a href="#9-2-2-è®¿é—®æ§åˆ¶" class="headerlink" title="9.2.2 è®¿é—®æ§åˆ¶"></a>9.2.2 è®¿é—®æ§åˆ¶</h4><ul><li>å®æ–½ä¸¥æ ¼çš„æƒé™ç®¡ç†</li><li>ä½¿ç”¨OAuthç­‰æ ‡å‡†è®¤è¯</li><li>è®°å½•æ‰€æœ‰è®¿é—®æ—¥å¿—</li></ul><h4 id="9-2-3-è¾“å…¥éªŒè¯"><a href="#9-2-3-è¾“å…¥éªŒè¯" class="headerlink" title="9.2.3 è¾“å…¥éªŒè¯"></a>9.2.3 è¾“å…¥éªŒè¯</h4><ul><li>éªŒè¯æ‰€æœ‰è¾“å…¥å‚æ•°</li><li>é˜²æ­¢SQLæ³¨å…¥ç­‰æ”»å‡»</li><li>é™åˆ¶è¾“å…¥é•¿åº¦å’Œæ ¼å¼</li></ul><h3 id="9-3-æ•…éšœæ’é™¤"><a href="#9-3-æ•…éšœæ’é™¤" class="headerlink" title="9.3 æ•…éšœæ’é™¤"></a>9.3 æ•…éšœæ’é™¤</h3><h4 id="9-3-1-å¸¸è§é—®é¢˜"><a href="#9-3-1-å¸¸è§é—®é¢˜" class="headerlink" title="9.3.1 å¸¸è§é—®é¢˜"></a>9.3.1 å¸¸è§é—®é¢˜</h4><ul><li>è¿æ¥è¶…æ—¶ï¼šæ£€æŸ¥ç½‘ç»œå’ŒæœåŠ¡å™¨çŠ¶æ€</li><li>è®¤è¯å¤±è´¥ï¼šéªŒè¯APIå¯†é’¥å’Œæƒé™</li><li>æ•°æ®æ ¼å¼é”™è¯¯ï¼šæ£€æŸ¥æ•°æ®ç»“æ„å’Œç±»å‹</li></ul><h4 id="9-3-2-è°ƒè¯•æŠ€å·§"><a href="#9-3-2-è°ƒè¯•æŠ€å·§" class="headerlink" title="9.3.2 è°ƒè¯•æŠ€å·§"></a>9.3.2 è°ƒè¯•æŠ€å·§</h4><ul><li>å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•</li><li>ä½¿ç”¨æµ‹è¯•ç¯å¢ƒéªŒè¯</li><li>åˆ†æ­¥éª¤æ’æŸ¥é—®é¢˜</li></ul><h4 id="9-3-3-ç›‘æ§å‘Šè­¦"><a href="#9-3-3-ç›‘æ§å‘Šè­¦" class="headerlink" title="9.3.3 ç›‘æ§å‘Šè­¦"></a>9.3.3 ç›‘æ§å‘Šè­¦</h4><ul><li>è®¾ç½®å…³é”®æŒ‡æ ‡ç›‘æ§</li><li>é…ç½®å¼‚å¸¸å‘Šè­¦æœºåˆ¶</li><li>å®šæœŸæ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€</li></ul><h2 id="ğŸ“š-å»¶ä¼¸é˜…è¯»"><a href="#ğŸ“š-å»¶ä¼¸é˜…è¯»" class="headerlink" title="ğŸ“š å»¶ä¼¸é˜…è¯»"></a>ğŸ“š å»¶ä¼¸é˜…è¯»</h2><ul><li><a href="/cursor-tutorial/">Cursorä½¿ç”¨æ•™ç¨‹</a> - å­¦ä¹ AIç¼–ç¨‹åŠ©æ‰‹çš„ä½¿ç”¨</li><li><a href="/git%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97/">Gitæ“ä½œæŒ‡å—</a> - æŒæ¡ç‰ˆæœ¬æ§åˆ¶åŸºç¡€</li><li><a href="/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">å‡½æ•°å¼ç¼–ç¨‹</a> - æå‡ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§</li></ul><h2 id="ğŸ’¡-å­¦ä¹ å»ºè®®"><a href="#ğŸ’¡-å­¦ä¹ å»ºè®®" class="headerlink" title="ğŸ’¡ å­¦ä¹ å»ºè®®"></a>ğŸ’¡ å­¦ä¹ å»ºè®®</h2><ol><li><p><strong>å¾ªåºæ¸è¿›</strong></p><ul><li>å…ˆç†è§£MCPçš„åŸºæœ¬æ¦‚å¿µ</li><li>å†å­¦ä¹ é€šä¿¡æœºåˆ¶å’Œåè®®è§„èŒƒ</li><li>æœ€åè¿›è¡Œå®æˆ˜é¡¹ç›®ç»ƒä¹ </li></ul></li><li><p><strong>å®è·µä¸ºä¸»</strong></p><ul><li>å¤šåŠ¨æ‰‹é…ç½®å’Œæµ‹è¯•</li><li>ä»ç®€å•çš„æœ¬åœ°æœåŠ¡å¼€å§‹</li><li>é€æ­¥å°è¯•å¤æ‚çš„è¿œç¨‹æœåŠ¡</li></ul></li><li><p><strong>å…³æ³¨æ›´æ–°</strong></p><ul><li>å®šæœŸæŸ¥çœ‹å®˜æ–¹æ–‡æ¡£æ›´æ–°</li><li>å…³æ³¨æ–°å¹³å°çš„æ”¯æŒæƒ…å†µ</li><li>å‚ä¸ç¤¾åŒºè®¨è®ºå’Œåˆ†äº«</li></ul></li><li><p><strong>å®‰å…¨ç¬¬ä¸€</strong></p><ul><li>å§‹ç»ˆè€ƒè™‘å®‰å…¨æ€§</li><li>ä½¿ç”¨æœ€ä½³å®è·µ</li><li>å®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡</li></ul></li></ol><h2 id="ğŸ”—-ç›¸å…³èµ„æº"><a href="#ğŸ”—-ç›¸å…³èµ„æº" class="headerlink" title="ğŸ”— ç›¸å…³èµ„æº"></a>ğŸ”— ç›¸å…³èµ„æº</h2><ol><li><p><strong>å®˜æ–¹èµ„æº</strong></p><ul><li><a href="https://modelcontextprotocol.io/">MCPå®˜æ–¹ç½‘ç«™</a></li><li><a href="https://github.com/modelcontextprotocol">GitHubä»“åº“</a></li><li><a href="https://modelcontextprotocol.io/docs">å®˜æ–¹æ–‡æ¡£</a></li></ul></li><li><p><strong>ç¤¾åŒºèµ„æº</strong></p><ul><li><a href="https://discord.gg/modelcontextprotocol">Discordç¤¾åŒº</a></li><li><a href="https://www.reddit.com/r/MCP/">Redditè®ºå›</a></li><li><a href="https://stackoverflow.com/questions/tagged/mcp">Stack Overflow</a></li></ul></li><li><p><strong>ä¸­æ–‡èµ„æº</strong></p><ul><li><a href="https://juejin.cn/tag/MCP">æ˜é‡‘ä¸“æ </a></li><li><a href="https://www.zhihu.com/topic/mcp">çŸ¥ä¹è¯é¢˜</a></li><li><a href="https://search.bilibili.com/all?keyword=mcp%20ai">Bç«™æ•™ç¨‹</a></li></ul></li></ol><h2 id="ğŸ“-æ›´æ–°è®°å½•"><a href="#ğŸ“-æ›´æ–°è®°å½•" class="headerlink" title="ğŸ“ æ›´æ–°è®°å½•"></a>ğŸ“ æ›´æ–°è®°å½•</h2><ul><li>2025-10-04: åˆå§‹ç‰ˆæœ¬å‘å¸ƒ</li></ul>]]></content>
      
      
      <categories>
          
          <category> AIå·¥å…·æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> AIç¼–ç¨‹ </tag>
            
            <tag> MCP </tag>
            
            <tag> æ™ºèƒ½ä½“ </tag>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cursorä½¿ç”¨æ•™ç¨‹ - AIç¼–ç¨‹åŠ©æ‰‹ä»å…¥é—¨åˆ°ç²¾é€š</title>
      <link href="//cursor-tutorial/"/>
      <url>//cursor-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="Cursorä½¿ç”¨æ•™ç¨‹-AIç¼–ç¨‹åŠ©æ‰‹ä»å…¥é—¨åˆ°ç²¾é€š-ğŸš€"><a href="#Cursorä½¿ç”¨æ•™ç¨‹-AIç¼–ç¨‹åŠ©æ‰‹ä»å…¥é—¨åˆ°ç²¾é€š-ğŸš€" class="headerlink" title="Cursorä½¿ç”¨æ•™ç¨‹ - AIç¼–ç¨‹åŠ©æ‰‹ä»å…¥é—¨åˆ°ç²¾é€š ğŸš€"></a>Cursorä½¿ç”¨æ•™ç¨‹ - AIç¼–ç¨‹åŠ©æ‰‹ä»å…¥é—¨åˆ°ç²¾é€š ğŸš€</h1><blockquote><p>ç®€å•å·¥ä½œä¸æƒ³åšï¼Ÿå¤æ‚å·¥ä½œä¸ä¼šåšï¼Ÿå‡ºç°é”™è¯¯ä¸ä¼šè§£å†³ï¼Ÿåç«¯ç¨‹åºå‘˜ä¸ä¼šå†™å‰ç«¯ï¼Ÿå‰ç«¯ç¨‹åºå‘˜ä¸ä¼šå†™åç«¯ï¼Ÿå¯çˆ±çš„å¤§å­¦ç”Ÿè¦å†™æœŸæœ«ä½œä¸šï¼ŸCursoræ¥å¸®ä½ ï¼æœ¬æ•™ç¨‹å°†å¸¦æ‚¨ä»é›¶å¼€å§‹ï¼Œå…¨é¢æŒæ¡è¿™æ¬¾é©å‘½æ€§çš„AIç¼–ç¨‹åŠ©æ‰‹ã€‚ğŸ“š</p></blockquote><p><img src="/images/cursor/1749179465178.png" alt="Cursoræ¦‚è§ˆ"></p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><ul><li><p><a href="#1-cursor%E7%AE%80%E4%BB%8B%E4%B8%8E%E6%A6%82%E8%BF%B0">1. Cursorç®€ä»‹ä¸æ¦‚è¿°</a></p><ul><li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AFcursor">1.1 ä»€ä¹ˆæ˜¯Cursor</a></li><li><a href="#12-%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E7%89%B9%E7%82%B9">1.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹ç‚¹</a></li><li><a href="#13-%E5%AF%B9%E6%AF%94%E5%85%B6%E4%BB%96%E5%B7%A5%E5%85%B7">1.3 å¯¹æ¯”å…¶ä»–å·¥å…·</a></li></ul></li><li><p><a href="#2-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE">2. å®‰è£…ä¸é…ç½®</a></p><ul><li><a href="#21-%E5%AE%89%E8%A3%85%E5%92%8C%E7%99%BB%E5%BD%95-%F0%9F%92%BF">2.1 å®‰è£…å’Œç™»å½• ğŸ’¿</a></li><li><a href="#22-%E6%97%A0%E9%99%90%E7%BB%AD%E6%9D%AF%E6%8A%80%E5%B7%A7-%E2%99%BE%EF%B8%8F">2.2 æ— é™ç»­æ¯æŠ€å·§ â™¾ï¸</a></li><li><a href="#23-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E-%E2%9A%99%EF%B8%8F">2.3 åŸºç¡€é…ç½®è¯´æ˜ âš™ï¸</a></li><li><a href="#24-vs-code%E9%85%8D%E7%BD%AE%E8%BF%81%E7%A7%BB-%F0%9F%94%84">2.4 VS Codeé…ç½®è¿ç§» ğŸ”„</a></li><li><a href="#25-java%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-%E2%98%95">2.5 Javaç¯å¢ƒé…ç½® â˜•</a></li></ul></li><li><p><a href="#3-%E4%B8%89%E5%A4%A7%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD">3. ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½</a></p><ul><li><a href="#31-tab%E9%94%AE%E6%99%BA%E8%83%BD%E8%A1%A5%E5%85%A8-%E2%8C%A8%EF%B8%8F">3.1 Tabé”®æ™ºèƒ½è¡¥å…¨ âŒ¨ï¸</a></li><li><a href="#32-chat%E5%AF%B9%E8%AF%9D%E6%A8%A1%E5%BC%8F-%F0%9F%92%AC">3.2 Chatå¯¹è¯æ¨¡å¼ ğŸ’¬</a></li><li><a href="#33-ctrlk%E5%86%85%E8%81%94%E7%BC%96%E8%BE%91-%E2%9C%8F%EF%B8%8F">3.3 Ctrl+Kå†…è”ç¼–è¾‘ âœï¸</a></li></ul></li><li><p><a href="#4-%E7%B2%BE%E5%87%86%E4%B8%8A%E4%B8%8B%E6%96%87%E6%8C%87%E5%AE%9A">4. ç²¾å‡†ä¸Šä¸‹æ–‡æŒ‡å®š</a></p><ul><li><a href="#41-%E4%BB%A3%E7%A0%81%E5%BA%93%E7%B4%A2%E5%BC%95-%F0%9F%93%9A">4.1 ä»£ç åº“ç´¢å¼• ğŸ“š</a></li><li><a href="#42-rules%E8%A7%84%E5%88%99%E9%85%8D%E7%BD%AE-%F0%9F%93%8B">4.2 Rulesè§„åˆ™é…ç½® ğŸ“‹</a></li><li><a href="#43-%E7%AC%A6%E5%8F%B7%E4%BD%BF%E7%94%A8-%F0%9F%94%8D">4.3 @ç¬¦å·ä½¿ç”¨ ğŸ”</a></li></ul></li><li><p><a href="#5-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8Bchrome%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91">5. å®æˆ˜æ¡ˆä¾‹ï¼šChromeæ’ä»¶å¼€å‘</a></p><ul><li><a href="#51-%E6%8F%92%E4%BB%B6%E8%AE%BE%E8%AE%A1-%F0%9F%8E%A8">5.1 æ’ä»¶è®¾è®¡ ğŸ¨</a></li><li><a href="#52-%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0-%E2%9A%A1">5.2 åŠŸèƒ½å®ç° âš¡</a></li><li><a href="#53-%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%91%E5%B8%83-%F0%9F%9A%80">5.3 è°ƒè¯•ä¸å‘å¸ƒ ğŸš€</a></li></ul></li></ul><h2 id="1-Cursorç®€ä»‹ä¸æ¦‚è¿°-ğŸ¯"><a href="#1-Cursorç®€ä»‹ä¸æ¦‚è¿°-ğŸ¯" class="headerlink" title="1. Cursorç®€ä»‹ä¸æ¦‚è¿° ğŸ¯"></a>1. Cursorç®€ä»‹ä¸æ¦‚è¿° ğŸ¯</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Cursor"><a href="#1-1-ä»€ä¹ˆæ˜¯Cursor" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Cursor"></a>1.1 ä»€ä¹ˆæ˜¯Cursor</h3><p>Cursor æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ AI ä¼˜å…ˆä»£ç ç¼–è¾‘å™¨ï¼Œå¯å¢å¼ºæˆ‘ä»¬çš„å¼€å‘å·¥ä½œæµç¨‹ã€‚ä¸»è¦æä¾›ä¸‰ä¸ªæ ¸å¿ƒæ–¹å‘ï¼Œè¿™äº›åŠŸèƒ½å¯ä»¥æ— ç¼åœ°ååŒå·¥ä½œï¼Œä»è€Œæé«˜å·¥ä½œæ•ˆç‡ï¼š</p><ul><li>ğŸ¤– <strong>æ·±åº¦é›†æˆAIæ¨¡å‹</strong>ï¼šä¸æ˜¯ç®€å•åœ°æ¥å…¥æ¨¡å‹ï¼Œè€Œæ˜¯è®©AIå……å½“äº†ç¼–è¯‘å™¨çš„æ ¸å¿ƒäº¤äº’æ–¹å¼ã€‚æ”¯æŒä»£ç å—å¯¹è¯ã€é¡¹ç›®çº§å¯¹è¯ã€æ¨¡å‹è‡ªç”±é€‰æ‹©ã€‚</li><li>ğŸ’¬ <strong>å¼ºä¸Šä¸‹æ–‡ç†è§£</strong>ï¼šå¯ä»¥è‡ªåŠ¨è¯†åˆ«é¡¹ç›®æ–‡ä»¶ã€ä»£ç å—ã€é”™è¯¯ä¿¡æ¯ç­‰ç­‰ï¼Œæä¾›æ›´ç›´è§‚å‡†ç¡®çš„AIä¿®æ”¹èƒ½åŠ›ã€‚</li><li>ğŸ“š <strong>å¯¹è¯å¼å¼€å‘ä½“éªŒ</strong>ï¼šä»…éœ€ç”¨è‡ªç„¶è¯­è¨€æ²Ÿé€šï¼ŒCursorå°±ä¼šæ ¹æ®æŒ‡ä»¤å®Œæˆå¸ƒç½®çš„ä»»åŠ¡ï¼Œä½¿ç”¨è€…å¯ä»¥è½»æ¾æ‰®æ¼”äº§å“ç»ç†ï¼Œè®©Cursorç†è§£ä½ çš„å‘½ä»¤è‡ªè¡Œå·¥ä½œã€‚</li></ul><h3 id="1-2-æ ¸å¿ƒåŠŸèƒ½ç‰¹ç‚¹"><a href="#1-2-æ ¸å¿ƒåŠŸèƒ½ç‰¹ç‚¹" class="headerlink" title="1.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹ç‚¹"></a>1.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹ç‚¹</h3><ol><li><p><strong>æ™ºèƒ½ä»£ç è¡¥å…¨ï¼ˆTabï¼‰</strong></p><ul><li>å•è¡Œ&#x2F;å¤šè¡Œä»£ç æ™ºèƒ½è¡¥å…¨</li><li>ä»£ç é‡æ„å’Œä¼˜åŒ–å»ºè®®</li><li>å¤šè¡ŒååŒä¼˜åŒ–èƒ½åŠ›</li><li>æ™ºèƒ½å…‰æ ‡ä½ç½®é¢„æµ‹</li></ul></li><li><p><strong>AIå¯¹è¯åŠ©æ‰‹ï¼ˆChatï¼‰</strong></p><ul><li>Agentä»£ç†æ¨¡å¼ï¼šè‡ªä¸»æ¢ç´¢å’Œä¿®æ”¹ä»£ç </li><li>Aské—®ç­”æ¨¡å¼ï¼šè·å–è§£é‡Šå’Œå»ºè®®</li><li>Manualæ‰‹åŠ¨æ¨¡å¼ï¼šç²¾å‡†ç¼–è¾‘æ§åˆ¶</li><li>æ”¯æŒå¤šç§ä¸Šä¸‹æ–‡å¼•ç”¨</li></ul></li><li><p><strong>å†…è”ç¼–è¾‘ï¼ˆCtrl+Kï¼‰</strong></p><ul><li>å¿«é€Ÿä»£ç ç”Ÿæˆå’Œä¿®æ”¹</li><li>è‡ªç„¶è¯­è¨€æè¿°è½¬ä»£ç </li><li>ç»ˆç«¯å‘½ä»¤æ™ºèƒ½ç”Ÿæˆ</li><li>å®æ—¶ç¼–è¾‘é¢„è§ˆ</li></ul></li></ol><h3 id="1-3-å¯¹æ¯”å…¶ä»–å·¥å…·"><a href="#1-3-å¯¹æ¯”å…¶ä»–å·¥å…·" class="headerlink" title="1.3 å¯¹æ¯”å…¶ä»–å·¥å…·"></a>1.3 å¯¹æ¯”å…¶ä»–å·¥å…·</h3><p><strong>å¯¹æ¯”VS Code</strong></p><ul><li>åŸºäºVisual Studio Codeæ‰“é€ è€Œæˆçš„AIç¼–ç¨‹å·¥å…·</li><li>ç•Œé¢å’ŒåŸºç¡€æ“ä½œä¸VS Codeé«˜åº¦ç›¸ä¼¼ï¼Œæ— ç¼è¡”æ¥</li><li>å¢åŠ äº†å¼ºå¤§çš„AIåŠŸèƒ½ï¼Œæå‡å¼€å‘æ•ˆç‡</li></ul><p><strong>å¯¹æ¯”JetBrains IDEA</strong></p><ul><li>æä¾›AIé©±åŠ¨çš„ç°ä»£ç¼–ç ä½“éªŒ</li><li>å¯ä»¥å–ä»£JetBrains IDEçš„å¤§éƒ¨åˆ†åŠŸèƒ½</li><li>æ›´è½»é‡çº§ï¼Œå¯åŠ¨æ›´å¿«ï¼Œèµ„æºå ç”¨æ›´å°‘</li></ul><p><strong>å¯¹æ¯”å…¶ä»–AIå·¥å…·</strong></p><ul><li>åŸç”Ÿé›†æˆï¼Œæ— éœ€é¢å¤–é…ç½®</li><li>æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶</li><li>å¼ºå¤§çš„ä¸Šä¸‹æ–‡ç®¡ç†èƒ½åŠ›</li><li>çµæ´»çš„è§„åˆ™é…ç½®ç³»ç»Ÿ</li></ul><h2 id="2-å®‰è£…ä¸é…ç½®-âš™ï¸"><a href="#2-å®‰è£…ä¸é…ç½®-âš™ï¸" class="headerlink" title="2. å®‰è£…ä¸é…ç½® âš™ï¸"></a>2. å®‰è£…ä¸é…ç½® âš™ï¸</h2><h3 id="2-1-å®‰è£…å’Œç™»å½•-ğŸ’¿"><a href="#2-1-å®‰è£…å’Œç™»å½•-ğŸ’¿" class="headerlink" title="2.1 å®‰è£…å’Œç™»å½• ğŸ’¿"></a>2.1 å®‰è£…å’Œç™»å½• ğŸ’¿</h3><h4 id="2-1-1-å®‰è£…æ­¥éª¤"><a href="#2-1-1-å®‰è£…æ­¥éª¤" class="headerlink" title="2.1.1 å®‰è£…æ­¥éª¤"></a>2.1.1 å®‰è£…æ­¥éª¤</h4><ol><li><strong>ä¸‹è½½å®‰è£…åŒ…</strong><ul><li>è®¿é—® <a href="https://cursor.com/">cursor.com</a> å¹¶ç‚¹å‡» â€œä¸‹è½½â€ æŒ‰é’®</li><li>é€‰æ‹©å¯¹åº”æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼š</li></ul></li></ol><ul><li>Windows: cursor-setup.exe</li><li>macOS: cursor.dmg</li><li>Linux: cursor.AppImage</li></ul><ol start="2"><li><strong>å®‰è£…è¿‡ç¨‹</strong><ul><li>è¿è¡Œå®‰è£…ç¨‹åºå¹¶ç­‰å¾…å®‰è£…å®Œæˆ</li><li>é€šè¿‡æ¡Œé¢å¿«æ·æ–¹å¼æˆ–ä»åº”ç”¨èœå•å¯åŠ¨Cursor</li></ul></li></ol><h4 id="2-1-2-ç™»å½•è´¦å·"><a href="#2-1-2-ç™»å½•è´¦å·" class="headerlink" title="2.1.2 ç™»å½•è´¦å·"></a>2.1.2 ç™»å½•è´¦å·</h4><ol><li><p><strong>è´¦å·æ³¨å†Œ</strong></p><ul><li>ç‚¹å‡» â€œæ³¨å†Œâ€ æˆ– â€œç™»å½•â€ æŒ‰é’®</li><li>å¯ä»¥é€‰æ‹©ä½¿ç”¨é‚®ä»¶ï¼Œæˆ–è€…æ³¨å†ŒGoogleæˆ–GitHubè´¦å·</li><li>æ–°ç”¨æˆ·å°†è·å¾—14å¤©å…è´¹è¯•ç”¨æœŸ</li></ul></li><li><p><strong>è´¦å·éªŒè¯</strong></p><ul><li>éªŒè¯é‚®ç®±åœ°å€</li><li>å®Œæˆåˆå§‹è®¾ç½®å‘å¯¼</li><li>å¼€å§‹ä½¿ç”¨Cursor</li></ul></li></ol><h3 id="2-2-åŸºç¡€é…ç½®è¯´æ˜-âš™ï¸"><a href="#2-2-åŸºç¡€é…ç½®è¯´æ˜-âš™ï¸" class="headerlink" title="2.2 åŸºç¡€é…ç½®è¯´æ˜ âš™ï¸"></a>2.2 åŸºç¡€é…ç½®è¯´æ˜ âš™ï¸</h3><h4 id="2-2-1-é…ç½®å…¥å£å¯¹æ¯”"><a href="#2-2-1-é…ç½®å…¥å£å¯¹æ¯”" class="headerlink" title="2.2.1 é…ç½®å…¥å£å¯¹æ¯”"></a>2.2.1 é…ç½®å…¥å£å¯¹æ¯”</h4><table><thead><tr><th><strong>å¯¹æ¯”é¡¹</strong></th><th><strong>Cursor Settings</strong></th><th><strong>Editor Settings</strong></th></tr></thead><tbody><tr><td><strong>åŠŸèƒ½å®šä½</strong></td><td>ç®¡ç† AI ç›¸å…³åŠŸèƒ½å’Œ Cursor ç‰¹æœ‰è®¾ç½®</td><td>è°ƒæ•´ç¼–è¾‘å™¨åŸºç¡€è¡Œä¸ºå’Œå¤–è§‚</td></tr><tr><td><strong>ç»§æ‰¿æ€§</strong></td><td>ä¸ VS Code å·®å¼‚è¾ƒå¤§ï¼ˆCursor ç‹¬æœ‰åŠŸèƒ½ï¼‰</td><td>å¤§éƒ¨åˆ†ç»§æ‰¿è‡ª VS Codeï¼ˆå¦‚ä¸»é¢˜è®¾ç½®ï¼‰</td></tr><tr><td><strong>å½±å“èŒƒå›´</strong></td><td>å½±å“ AI ä»£ç ç”Ÿæˆã€åˆ†æã€å¯¹è¯çš„æ•ˆæœ</td><td>å½±å“ä»£ç ç¼–è¾‘ä½“éªŒï¼ˆå¦‚æ’ç‰ˆã€é¢œè‰²ï¼‰</td></tr><tr><td><strong>å…¸å‹é…ç½®ç¤ºä¾‹</strong></td><td>è°ƒæ•´ AI æ¨¡å‹å‚æ•°ã€ä»£ç åº“ç´¢å¼•è·¯å¾„</td><td>ä¿®æ”¹å­—ä½“ã€å¯ç”¨è‡ªåŠ¨ä¿å­˜ã€æ›´æ”¹ä¸»é¢˜</td></tr></tbody></table><h4 id="2-2-2-Cursor-AIç›¸å…³è®¾ç½®"><a href="#2-2-2-Cursor-AIç›¸å…³è®¾ç½®" class="headerlink" title="2.2.2 Cursor AIç›¸å…³è®¾ç½®"></a>2.2.2 Cursor AIç›¸å…³è®¾ç½®</h4><p>é€šè¿‡é½¿è½®å›¾æ ‡æˆ– <code>Cmd/Ctrl + Shift + J</code> å¼€å¯Cursorè®¾ç½®ï¼Œå¯è¿›è¡Œä»¥ä¸‹é…ç½®ï¼š</p><ol><li><p><strong>Generalï¼ˆå¸¸è§„ï¼‰</strong></p><ul><li>è´¦æˆ·ç›¸å…³è®¾ç½®å’Œé…ç½®åŒæ­¥</li><li>VS Codeé…ç½®å¯¼å…¥</li><li>éšç§é…ç½®ç®¡ç†</li></ul></li><li><p><strong>Featuresï¼ˆåŠŸèƒ½ï¼‰</strong></p><ul><li>AIä»£ç è¡¥å…¨å¼€å…³</li><li>å¯¹è¯æ¨¡å¼ï¼ˆAskã€Editã€Agentï¼‰è®¾ç½®</li><li>åŠŸèƒ½å‚æ•°å¾®è°ƒ</li></ul></li><li><p><strong>Modelsï¼ˆæ¨¡å‹ï¼‰</strong></p><ul><li>AIæ¨¡å‹é€‰æ‹©ï¼ˆClaude 3.5 Sonnetï¼‰</li><li>API Keyé…ç½®</li><li>æ¨¡å‹å‚æ•°è°ƒæ•´</li></ul></li><li><p><strong>Rulesï¼ˆè§„åˆ™ï¼‰</strong></p><ul><li>ä»£ç æ£€æŸ¥è§„åˆ™</li><li>ä»£ç æ ¼å¼è§„èŒƒ</li><li>æ“ä½œè§„åˆ™è®¾ç½®</li></ul></li><li><p><strong>Indexingï¼ˆç´¢å¼•)</strong></p><ul><li>ä»£ç åº“ç´¢å¼•è·¯å¾„</li><li>æ’é™¤è§„åˆ™è®¾ç½®</li><li>ç´¢å¼•ä¼˜åŒ–é…ç½®</li></ul></li></ol><h4 id="2-2-3-ç¼–è¾‘å™¨åŸºç¡€è®¾ç½®"><a href="#2-2-3-ç¼–è¾‘å™¨åŸºç¡€è®¾ç½®" class="headerlink" title="2.2.3 ç¼–è¾‘å™¨åŸºç¡€è®¾ç½®"></a>2.2.3 ç¼–è¾‘å™¨åŸºç¡€è®¾ç½®</h4><ol><li><p><strong>è®¿é—®è®¾ç½®</strong></p><ul><li>é€šè¿‡å‘½ä»¤é¢æ¿ï¼š<code>Cmd/Ctrl + Shift + P</code></li><li>è¾“å…¥ï¼šâ€Preferences: Open Settings (UI)â€</li><li>æˆ–ç›´æ¥ä½¿ç”¨å¿«æ·é”®ï¼š<code>Cmd/Ctrl + ,</code></li></ul></li><li><p><strong>å¸¸ç”¨è®¾ç½®é¡¹</strong><br><img src="/images/cursor/1748935489544.png" alt="ç¼–è¾‘å™¨è®¾ç½®"></p><ul><li>ä¸»é¢˜å’Œå¤–è§‚</li><li>å­—ä½“å’Œé¢œè‰²</li><li>ç¼–è¾‘å™¨è¡Œä¸º</li><li>æ–‡ä»¶å¤„ç†</li></ul></li><li><p><strong>è®¾ç½®ä½œç”¨åŸŸ</strong></p><ul><li><strong>Userï¼ˆç”¨æˆ·ï¼‰</strong>ï¼šå…¨å±€æ€§è®¾ç½®ï¼Œé€‚ç”¨äºæ‰€æœ‰å·¥ä½œç©ºé—´</li><li><strong>Workspaceï¼ˆå·¥ä½œç©ºé—´ï¼‰</strong>ï¼šä»…å¯¹å½“å‰é¡¹ç›®ç”Ÿæ•ˆ</li></ul></li></ol><h3 id="2-3-VS-Codeé…ç½®è¿ç§»-ğŸ”„"><a href="#2-3-VS-Codeé…ç½®è¿ç§»-ğŸ”„" class="headerlink" title="2.3 VS Codeé…ç½®è¿ç§» ğŸ”„"></a>2.3 VS Codeé…ç½®è¿ç§» ğŸ”„</h3><h4 id="2-3-1-ä¸€é”®å¯¼å…¥é…ç½®"><a href="#2-3-1-ä¸€é”®å¯¼å…¥é…ç½®" class="headerlink" title="2.3.1 ä¸€é”®å¯¼å…¥é…ç½®"></a>2.3.1 ä¸€é”®å¯¼å…¥é…ç½®</h4><ol><li><p><strong>å¯¼å…¥æ­¥éª¤</strong></p><ul><li>æ‰“å¼€Cursorè®¾ç½®ï¼ˆ<code>Cmd/Ctrl + Shift + J</code>ï¼‰</li><li>å¯¼èˆªåˆ°ï¼šå¸¸è§„ &gt; å¸æˆ·</li><li>ç‚¹å‡»â€VS Code Importâ€ä¸‹çš„â€å¯¼å…¥â€æŒ‰é’®<br><img src="/images/cursor/1748919880700.png" alt="VS Codeå¯¼å…¥"></li></ul></li><li><p><strong>å¯¼å…¥å†…å®¹</strong></p><ul><li>Extensionsï¼ˆæ‰©å±•ï¼‰</li><li>Themesï¼ˆä¸»é¢˜ï¼‰</li><li>Settingsï¼ˆè®¾ç½®ï¼‰</li><li>Keybindingsï¼ˆé”®ç»‘å®šï¼‰</li></ul></li></ol><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¹¶éæ‰€æœ‰VS Codeæ‰©å±•éƒ½ä¸Cursorå…¼å®¹ã€‚ä¸€äº›ä¾èµ–VS Codeç‰¹å®šAPIçš„æ’ä»¶å¯èƒ½å¯¼è‡´å¯¼å…¥å¤±è´¥ã€‚</p></blockquote><h4 id="2-3-2-æ‰‹åŠ¨é…ç½®è¿ç§»"><a href="#2-3-2-æ‰‹åŠ¨é…ç½®è¿ç§»" class="headerlink" title="2.3.2 æ‰‹åŠ¨é…ç½®è¿ç§»"></a>2.3.2 æ‰‹åŠ¨é…ç½®è¿ç§»</h4><ol><li><p><strong>å¯¼å‡ºVS Codeé…ç½®</strong></p><ul><li>æ‰“å¼€å‘½ä»¤é¢æ¿ï¼š<code>Cmd/Ctrl + Shift + P</code></li><li>æœç´¢ï¼šâ€Preferences: Open Profiles (UI)â€</li><li>é€‰æ‹©è¦å¯¼å‡ºçš„é…ç½®æ–‡ä»¶</li><li>å¯¼å‡ºåˆ°æœ¬åœ°æˆ–GitHub Gist</li></ul></li><li><p><strong>å¯¼å…¥åˆ°Cursor</strong></p><ul><li>æ‰“å¼€å‘½ä»¤é¢æ¿ï¼š<code>Cmd/Ctrl + Shift + P</code></li><li>æœç´¢ï¼šâ€Preferences: Open Profiles (UI)â€</li><li>é€‰æ‹©â€Import Profileâ€</li><li>é€‰æ‹©æœ¬åœ°æ–‡ä»¶æˆ–ç²˜è´´Gist URL</li></ul></li></ol><h3 id="2-4-Javaç¯å¢ƒé…ç½®-â˜•"><a href="#2-4-Javaç¯å¢ƒé…ç½®-â˜•" class="headerlink" title="2.4 Javaç¯å¢ƒé…ç½® â˜•"></a>2.4 Javaç¯å¢ƒé…ç½® â˜•</h3><h4 id="2-4-1-ç¯å¢ƒé…ç½®æ–¹å¼"><a href="#2-4-1-ç¯å¢ƒé…ç½®æ–¹å¼" class="headerlink" title="2.4.1 ç¯å¢ƒé…ç½®æ–¹å¼"></a>2.4.1 ç¯å¢ƒé…ç½®æ–¹å¼</h4><ol><li><p><strong>è‡ªåŠ¨è¯»å–é…ç½®</strong></p><ul><li>ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„<code>JAVA_HOME</code>å’Œ<code>MAVEN_HOME</code></li><li>è‡ªåŠ¨è¯†åˆ«å¹¶åº”ç”¨é…ç½®</li><li>ç”¨äºä»£ç ç¼–è¯‘å’Œé¡¹ç›®æ„å»º</li></ul></li><li><p><strong>æ‰‹åŠ¨é…ç½®</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;java.home&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C:/Program Files/Java/jdk-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;java.configuration.maven.userSettings&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/maven/apache-maven-3.8.8-bin/apache-maven-3.8.8/conf/settings.xml&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="2-4-2-Javaå¼€å‘æ’ä»¶"><a href="#2-4-2-Javaå¼€å‘æ’ä»¶" class="headerlink" title="2.4.2 Javaå¼€å‘æ’ä»¶"></a>2.4.2 Javaå¼€å‘æ’ä»¶</h4><ol><li><p><strong>å®‰è£…æ–¹å¼</strong><br><img src="/images/cursor/1748938160832.png" alt="Javaæ’ä»¶"></p><ul><li>æŒ‰<code>Ctrl + Shift + X</code>æ‰“å¼€æ‰©å±•é¢æ¿</li><li>æœç´¢å¹¶å®‰è£…â€Extension Pack for Javaâ€</li></ul></li><li><p><strong>åŒ…å«æ’ä»¶</strong></p><ul><li>Language Support for Java(TM) by Red Hat</li><li>Debugger for Java</li><li>Maven for Java</li><li>Test Runner for Java</li><li>Project Manager for Java</li><li>Gradle for Java</li></ul></li></ol><h2 id="3-ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½-ğŸš€"><a href="#3-ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½-ğŸš€" class="headerlink" title="3. ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ ğŸš€"></a>3. ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ ğŸš€</h2><h3 id="3-1-Tabé”®æ™ºèƒ½è¡¥å…¨-âŒ¨ï¸"><a href="#3-1-Tabé”®æ™ºèƒ½è¡¥å…¨-âŒ¨ï¸" class="headerlink" title="3.1 Tabé”®æ™ºèƒ½è¡¥å…¨ âŒ¨ï¸"></a>3.1 Tabé”®æ™ºèƒ½è¡¥å…¨ âŒ¨ï¸</h3><h4 id="3-1-1-åŠŸèƒ½æ¦‚è¿°"><a href="#3-1-1-åŠŸèƒ½æ¦‚è¿°" class="headerlink" title="3.1.1 åŠŸèƒ½æ¦‚è¿°"></a>3.1.1 åŠŸèƒ½æ¦‚è¿°</h4><p>Tabé”®åœ¨Cursorä¸­å…·æœ‰å¼ºå¤§çš„ä»£ç è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼ŒåŸºäºé€‰å®šæ¨¡å‹ï¼Œèƒ½æ ¹æ®ä»£ç ä¸Šä¸‹æ–‡è‡ªåŠ¨é¢„æµ‹å¹¶ç”Ÿæˆä»£ç è¡¥å…¨å»ºè®®å’Œä»£ç ä¿®å¤é‡æ„ã€‚</p><blockquote><p>æç¤ºï¼š<code>Tab</code>é”®æ¥å—å»ºè®®ï¼Œ<code>Esc</code>é”®æ‹’ç»å»ºè®®ã€‚è¦é€å­—éƒ¨åˆ†æ¥å—å»ºè®®ï¼Œè¯·æŒ‰<code>Ctrl/âŒ˜ + â†’</code>ã€‚</p></blockquote><h4 id="3-1-2-ä¸»è¦åŠŸèƒ½"><a href="#3-1-2-ä¸»è¦åŠŸèƒ½" class="headerlink" title="3.1.2 ä¸»è¦åŠŸèƒ½"></a>3.1.2 ä¸»è¦åŠŸèƒ½</h4><ol><li><p><strong>å•è¡Œ&#x2F;å¤šè¡Œä»£ç è¡¥å…¨</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éœ€æ±‚ï¼šå†™ä¸€ä¸ªå·¥å…·ç±»è®¡ç®—æ•°ç»„å¹³å‡å€¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayUtils</span> &#123;</span><br><span class="line">    <span class="comment">// æŒ‰tabä¼šå®Œæˆè¡¥å…¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¡¥å…¨åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayUtils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] nums = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line">        System.out.println(average(nums));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">average</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            sum += num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">double</span>) sum / nums.length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ™ºèƒ½ä»£ç é‡å†™</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨Streamé‡æ„</span></span><br><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">List&lt;Integer&gt; evenNumbers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> num : numbers) &#123;</span><br><span class="line">    <span class="keyword">if</span> (num % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        evenNumbers.add(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ„åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; evenNumbers = numbers.stream()</span><br><span class="line">    .filter(num -&gt; num % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    .collect(Collectors.toList());</span><br></pre></td></tr></table></figure></li><li><p><strong>å¤šè¡ŒååŒä¼˜åŒ–</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> count; <span class="comment">// æ™®é€šå˜é‡</span></span><br><span class="line">String name; <span class="comment">// å§“å</span></span><br><span class="line"><span class="type">boolean</span> isValid; <span class="comment">// æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line"><span class="type">double</span> price; <span class="comment">// ä»·æ ¼</span></span><br><span class="line"><span class="comment">//tab ä¼šç»§ç»­è”æƒ³å˜é‡ç±»å‹</span></span><br></pre></td></tr></table></figure></li><li><p><strong>å…‰æ ‡ä½ç½®é¢„æµ‹</strong><br><img src="/images/cursor/1749222927512.png" alt="å…‰æ ‡é¢„æµ‹"></p></li></ol><h4 id="3-1-3-Tabç›¸å…³é…ç½®"><a href="#3-1-3-Tabç›¸å…³é…ç½®" class="headerlink" title="3.1.3 Tabç›¸å…³é…ç½®"></a>3.1.3 Tabç›¸å…³é…ç½®</h4><p>é…ç½®ä½ç½®ï¼š<code>cursor settings &gt; features &gt; tab</code></p><ol><li><p><strong>åŸºç¡€åŠŸèƒ½å¼€å…³</strong></p><ul><li>å¯ç”¨&#x2F;ç¦ç”¨Cursor TabåŠŸèƒ½</li><li>æ§åˆ¶æ˜¯å¦åœ¨æ³¨é‡Šä¸­æä¾›å»ºè®®</li><li>æ˜¾ç¤ºç©ºç™½å»ºè®®çš„æ§åˆ¶</li></ul></li><li><p><strong>æ¥å—æ–¹å¼è®¾ç½®</strong></p><ul><li>å®Œæ•´æ¥å—ï¼š<code>Tab</code>é”®</li><li>éƒ¨åˆ†æ¥å—ï¼š<code>Ctrl+â†’</code></li><li>æ‹’ç»å»ºè®®ï¼š<code>Esc</code>é”®</li></ul></li><li><p><strong>ç‰¹æ®ŠåŠŸèƒ½é…ç½®</strong></p><ul><li>TypeScriptè‡ªåŠ¨å¯¼å…¥</li><li>Pythonè‡ªåŠ¨å¯¼å…¥ï¼ˆæµ‹è¯•ç‰ˆï¼‰</li><li>ç©ºç™½å»ºè®®æ˜¾ç¤ºæ§åˆ¶</li></ul></li></ol><h3 id="3-2-Chatå¯¹è¯æ¨¡å¼-ğŸ’¬"><a href="#3-2-Chatå¯¹è¯æ¨¡å¼-ğŸ’¬" class="headerlink" title="3.2 Chatå¯¹è¯æ¨¡å¼ ğŸ’¬"></a>3.2 Chatå¯¹è¯æ¨¡å¼ ğŸ’¬</h3><h4 id="3-2-1-åŠŸèƒ½æ¦‚è¿°"><a href="#3-2-1-åŠŸèƒ½æ¦‚è¿°" class="headerlink" title="3.2.1 åŠŸèƒ½æ¦‚è¿°"></a>3.2.1 åŠŸèƒ½æ¦‚è¿°</h4><p>Chatæ˜¯Cursorçš„AIåŠ©æ‰‹ï¼Œä½äºä¾§è¾¹æ ä¸­ï¼Œå¯è®©æ‚¨é€šè¿‡è‡ªç„¶è¯­è¨€ä¸ä»£ç åº“è¿›è¡Œäº¤äº’ã€‚æ‚¨å¯ä»¥æå‡ºé—®é¢˜ã€è¯·æ±‚ä»£ç ç¼–è¾‘ã€è·å–ç»ˆç«¯å‘½ä»¤å»ºè®®ç­‰ã€‚</p><p><img src="/images/cursor/overview.mp4" alt="Chatæ¦‚è§ˆ"></p><p><strong>ä¸»è¦åŠŸèƒ½ï¼š</strong></p><ul><li>æ·±å…¥ç†è§£ä»£ç åº“å¹¶è¿›è¡Œä¿®æ”¹</li><li>å¸®åŠ©é‡æ„å’Œä¼˜åŒ–ä»£ç </li><li>ä»é›¶å¼€å§‹æ­å»ºé¡¹ç›®</li><li>é”™è¯¯å®šä½å’Œä¿®å¤</li></ul><h4 id="3-2-2-ä¸¤ç§å¯¹è¯æ¨¡å¼"><a href="#3-2-2-ä¸¤ç§å¯¹è¯æ¨¡å¼" class="headerlink" title="3.2.2 ä¸¤ç§å¯¹è¯æ¨¡å¼"></a>3.2.2 ä¸¤ç§å¯¹è¯æ¨¡å¼</h4><ol><li><p><strong>Agentä»£ç†æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</strong><br><img src="/images/cursor/agent.png" alt="Agentæ¨¡å¼"></p><ul><li>è‡ªä¸»æ¢ç´¢å’Œç†è§£é¡¹ç›®ä»£ç </li><li>å¯ä»¥ç›´æ¥è¿›è¡Œä»£ç ä¿®æ”¹</li><li>å¯ç”¨æ‰€æœ‰å·¥å…·æƒé™</li><li>è¯†åˆ«å®Œæ•´é¡¹ç›®ç»“æ„</li></ul></li><li><p><strong>Aské—®ç­”æ¨¡å¼</strong><br><img src="/images/cursor/ask.png" alt="Askæ¨¡å¼"></p><ul><li>â€œåªè¯»â€æ¨¡å¼ï¼Œä¸ä¿®æ”¹ä»£ç </li><li>è·å–ä»£ç è§£é‡Šå’Œå»ºè®®</li><li>ç†è§£é¡¹ç›®ç»“æ„</li><li>é€‚åˆå­¦ä¹ å’Œæ¢ç´¢</li></ul></li></ol><h4 id="3-2-3-ä½¿ç”¨æŠ€å·§"><a href="#3-2-3-ä½¿ç”¨æŠ€å·§" class="headerlink" title="3.2.3 ä½¿ç”¨æŠ€å·§"></a>3.2.3 ä½¿ç”¨æŠ€å·§</h4><ol><li><p><strong>å¿«é€Ÿè®¿é—®</strong></p><ul><li>ä½¿ç”¨<code>âŒ˜+L</code>ï¼ˆMacï¼‰æˆ–<code>Ctrl+L</code>ï¼ˆWindows&#x2F;Linuxï¼‰</li><li>ä½¿ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚</li><li>æä¾›æ¸…æ™°çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li></ul></li><li><p><strong>ä»£ç ç¼–è¾‘é€‰é¡¹</strong></p><ul><li><p><strong>Review</strong>ï¼šæŸ¥çœ‹å·®å¼‚<br><img src="/images/cursor/1749005624183.png" alt="å·®å¼‚æŸ¥çœ‹"></p></li><li><p><strong>Apply</strong>ï¼šåº”ç”¨æ›´æ”¹<br><img src="/images/cursor/1749005659532.png" alt="åº”ç”¨æ›´æ”¹"></p></li><li><p><strong>Accept&#x2F;Reject</strong>ï¼šç¡®è®¤æˆ–æ”¾å¼ƒ<br><img src="/images/cursor/1749005825535.png" alt="ç¡®è®¤ä¿®æ”¹"></p></li></ul></li><li><p><strong>å†å²å’Œæ£€æŸ¥ç‚¹</strong></p><ul><li><p>æŸ¥çœ‹å†å²è®°å½•<br><img src="/images/cursor/1749006388841.png" alt="å†å²è®°å½•"></p></li><li><p>åˆ›å»ºæ–°ä¼šè¯<br><img src="/images/cursor/1749006447983.png" alt="æ–°ä¼šè¯"></p></li><li><p>æ¢å¤æ£€æŸ¥ç‚¹<br><img src="/images/cursor/1749006156466.png" alt="æ£€æŸ¥ç‚¹"></p></li></ul></li></ol><h4 id="3-2-4-é…ç½®è¯´æ˜"><a href="#3-2-4-é…ç½®è¯´æ˜" class="headerlink" title="3.2.4 é…ç½®è¯´æ˜"></a>3.2.4 é…ç½®è¯´æ˜</h4><ol><li><p><strong>åŸºç¡€è®¾ç½®</strong></p><ul><li>é»˜è®¤å¯¹è¯æ¨¡å¼é€‰æ‹©</li><li>æ–‡å­—å¤§å°è°ƒæ•´</li><li>è‡ªåŠ¨åˆ·æ–°å’Œæ»šåŠ¨</li></ul></li><li><p><strong>Agentæ¨¡å¼è®¾ç½®</strong></p><ul><li>è‡ªåŠ¨è¿è¡Œå‘½ä»¤</li><li>æ–‡ä»¶ä¿æŠ¤æœºåˆ¶</li><li>å‘½ä»¤ç™½åå•&#x2F;é»‘åå•</li></ul></li><li><p><strong>å®‰å…¨è®¾ç½®</strong></p><ul><li>æ–‡ä»¶åˆ é™¤ä¿æŠ¤</li><li>å·¥ä½œåŒºå¤–ä¿æŠ¤</li><li>ç‚¹æ–‡ä»¶ä¿æŠ¤</li></ul></li></ol><h3 id="3-3-Ctrl-Kå†…è”ç¼–è¾‘-âœï¸"><a href="#3-3-Ctrl-Kå†…è”ç¼–è¾‘-âœï¸" class="headerlink" title="3.3 Ctrl+Kå†…è”ç¼–è¾‘ âœï¸"></a>3.3 Ctrl+Kå†…è”ç¼–è¾‘ âœï¸</h3><h4 id="3-3-1-åŠŸèƒ½æ¦‚è¿°"><a href="#3-3-1-åŠŸèƒ½æ¦‚è¿°" class="headerlink" title="3.3.1 åŠŸèƒ½æ¦‚è¿°"></a>3.3.1 åŠŸèƒ½æ¦‚è¿°</h4><p>å†…è”ç¼–è¾‘ï¼ˆCmd&#x2F;Ctrl+Kï¼‰å…è®¸ç›´æ¥åœ¨ç¼–è¾‘å™¨çª—å£ä¸­ç”Ÿæˆæ–°ä»£ç æˆ–ç¼–è¾‘ç°æœ‰ä»£ç ï¼Œç‰¹åˆ«é€‚åˆå·²çŸ¥å¹¶éœ€è¦ç²¾å‡†ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„åœºæ™¯ã€‚</p><p><img src="/images/cursor/regular.png" alt="å†…è”ç¼–è¾‘"></p><h4 id="3-3-2-ä½¿ç”¨æ¨¡å¼"><a href="#3-3-2-ä½¿ç”¨æ¨¡å¼" class="headerlink" title="3.3.2 ä½¿ç”¨æ¨¡å¼"></a>3.3.2 ä½¿ç”¨æ¨¡å¼</h4><ol><li><p><strong>å†…è”ç”Ÿæˆ</strong></p><ul><li>æ— é€‰ä¸­ä»£ç æ—¶æŒ‰<code>Ctrl/Cmd K</code></li><li>åœ¨æç¤ºæ è¾“å…¥éœ€æ±‚</li><li>AIç›´æ¥ç”Ÿæˆç›¸åº”ä»£ç </li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”Ÿæˆä¸€ä¸ªå¸¦ç‚¹å‡»åŠ¨ç”»çš„æŒ‰é’®ç»„ä»¶ï¼Œç”¨JavaScriptå®ç°ï¼Œç‚¹å‡»åæ§åˆ¶å°æ‰“å°æ¬¡æ•°</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749009173764.png" alt="ç”Ÿæˆæ•ˆæœ"></p></li><li><p><strong>å†…è”ç¼–è¾‘</strong></p><ul><li>é€‰ä¸­è¦ä¿®æ”¹çš„ä»£ç </li><li>æŒ‰<code>Ctrl/Cmd K</code></li><li>åœ¨æç¤ºæ æè¿°ä¿®æ”¹éœ€æ±‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•æ·»åŠ æ³¨é‡Šå’Œæ¯è¡Œä»£ç æ·»åŠ æ³¨é‡Šè¯´æ˜</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749009465994.png" alt="ç¼–è¾‘å‰"><br><img src="/images/cursor/1749009494441.png" alt="ç¼–è¾‘å"></p></li></ol><h4 id="3-3-3-ç»ˆç«¯å‘½ä»¤ç”Ÿæˆ"><a href="#3-3-3-ç»ˆç«¯å‘½ä»¤ç”Ÿæˆ" class="headerlink" title="3.3.3 ç»ˆç«¯å‘½ä»¤ç”Ÿæˆ"></a>3.3.3 ç»ˆç«¯å‘½ä»¤ç”Ÿæˆ</h4><p>åœ¨Cursorç»ˆç«¯ä¸­ä½¿ç”¨<code>Cmd/Ctrl K</code>å¯ä»¥ï¼š</p><ul><li>é€šè¿‡è‡ªç„¶è¯­è¨€ç”Ÿæˆå‘½ä»¤</li><li>æŒ‰<code>Esc</code>æ¥å—å‘½ä»¤</li><li>ä½¿ç”¨<code>Ctrl/âŒ˜ + Enter</code>ç›´æ¥è¿è¡Œ</li></ul><p><img src="/images/cursor/1749009824073.png" alt="ç»ˆç«¯å‘½ä»¤"></p><h4 id="3-3-4-æœ€ä½³å®è·µ"><a href="#3-3-4-æœ€ä½³å®è·µ" class="headerlink" title="3.3.4 æœ€ä½³å®è·µ"></a>3.3.4 æœ€ä½³å®è·µ</h4><ol><li><p><strong>æç¤ºè¯æŠ€å·§</strong></p><ul><li>æä¾›æ˜ç¡®çš„ä»»åŠ¡ç±»å‹</li><li>åŒ…å«å…·ä½“çš„æŠ€æœ¯è¦æ±‚</li><li>è¯´æ˜ä»£ç é£æ ¼åå¥½</li><li>æŒ‡å®šæ€§èƒ½æˆ–å…¶ä»–çº¦æŸ</li></ul></li><li><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><ul><li>ç”Ÿæˆæ–°çš„ä»£ç ç‰‡æ®µ</li><li>é‡æ„ç°æœ‰ä»£ç </li><li>æ·»åŠ æ³¨é‡Šå’Œæ–‡æ¡£</li><li>ä¿®å¤ä»£ç é—®é¢˜</li><li>ä¼˜åŒ–ä»£ç æ€§èƒ½</li></ul></li><li><p><strong>æ³¨æ„äº‹é¡¹</strong></p><ul><li>æ£€æŸ¥ç”Ÿæˆä»£ç çš„æ­£ç¡®æ€§</li><li>ç¡®ä¿ä»£ç é£æ ¼ä¸€è‡´æ€§</li><li>éªŒè¯åŠŸèƒ½å®Œæ•´æ€§</li><li>è€ƒè™‘æ€§èƒ½å½±å“</li></ul></li></ol><h2 id="4-ç²¾å‡†ä¸Šä¸‹æ–‡æŒ‡å®š-ğŸ¯"><a href="#4-ç²¾å‡†ä¸Šä¸‹æ–‡æŒ‡å®š-ğŸ¯" class="headerlink" title="4. ç²¾å‡†ä¸Šä¸‹æ–‡æŒ‡å®š ğŸ¯"></a>4. ç²¾å‡†ä¸Šä¸‹æ–‡æŒ‡å®š ğŸ¯</h2><h3 id="4-1-ä»£ç åº“ç´¢å¼•-ğŸ“š"><a href="#4-1-ä»£ç åº“ç´¢å¼•-ğŸ“š" class="headerlink" title="4.1 ä»£ç åº“ç´¢å¼• ğŸ“š"></a>4.1 ä»£ç åº“ç´¢å¼• ğŸ“š</h3><h4 id="4-1-1-æ¦‚å¿µå’Œä½œç”¨"><a href="#4-1-1-æ¦‚å¿µå’Œä½œç”¨" class="headerlink" title="4.1.1 æ¦‚å¿µå’Œä½œç”¨"></a>4.1.1 æ¦‚å¿µå’Œä½œç”¨</h4><p>ä»£ç åº“ç´¢å¼•æ˜¯Cursorç†è§£é¡¹ç›®çš„åŸºç¡€ã€‚æ¯ä¸ªCursorå®ä¾‹åœ¨æ‰“å¼€é¡¹ç›®æ—¶éƒ½ä¼šåˆå§‹åŒ–è¯¥å·¥ä½œåŒºçš„ç´¢å¼•ï¼Œå¹¶åœ¨æ·»åŠ æ–°æ–‡ä»¶æ—¶è‡ªåŠ¨æ›´æ–°ç´¢å¼•ã€‚</p><p>ä¸»è¦ä½œç”¨ï¼š</p><ul><li>å¿«é€Ÿâ€è¯»æ‡‚â€é¡¹ç›®ç»“æ„</li><li>å®šä½ç›¸å…³ä»£ç </li><li>ç†è§£ä»£ç å…³ç³»</li><li>ç”Ÿæˆæ›´è´´åˆé¡¹ç›®çš„ä»£ç </li></ul><h4 id="4-1-2-ç´¢å¼•é…ç½®"><a href="#4-1-2-ç´¢å¼•é…ç½®" class="headerlink" title="4.1.2 ç´¢å¼•é…ç½®"></a>4.1.2 ç´¢å¼•é…ç½®</h4><p><img src="/images/cursor/codebase-indexing.png" alt="ç´¢å¼•é…ç½®"></p><p>é…ç½®ä½ç½®ï¼š<code>cursor settings &gt; indexing</code></p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹å½“å‰é¡¹ç›®ç»“æ„ï¼Œå¹¶ä½¿ç”¨æ–‡å­—å›¾å½¢å½¢å¼ç½—åˆ—å‡ºæ¥ï¼</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749018096565.png" alt="ç´¢å¼•æ•ˆæœ"></p><h4 id="4-1-3-å¿½ç•¥æ–‡ä»¶é…ç½®"><a href="#4-1-3-å¿½ç•¥æ–‡ä»¶é…ç½®" class="headerlink" title="4.1.3 å¿½ç•¥æ–‡ä»¶é…ç½®"></a>4.1.3 å¿½ç•¥æ–‡ä»¶é…ç½®</h4><ol><li><p><strong>é…ç½®æ–¹å¼</strong></p><ul><li>åˆ›å»º<code>.cursorignore</code>æ–‡ä»¶</li><li>ä½¿ç”¨é…ç½®ç•Œé¢åˆ›å»º<br><img src="/images/cursor/1749020017720.png" alt="å¿½ç•¥é…ç½®"></li></ul></li><li><p><strong>é…ç½®ç¤ºä¾‹</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Add directories or file patterns to ignore during indexing</span><br><span class="line">index.html</span><br><span class="line">style.css</span><br><span class="line">main.js</span><br></pre></td></tr></table></figure></li><li><p><strong>æ•ˆæœéªŒè¯</strong><br><img src="/images/cursor/1749020220373.png" alt="å¿½ç•¥æ•ˆæœ"></p></li></ol><h3 id="4-2-Rulesè§„åˆ™é…ç½®-ğŸ“‹"><a href="#4-2-Rulesè§„åˆ™é…ç½®-ğŸ“‹" class="headerlink" title="4.2 Rulesè§„åˆ™é…ç½® ğŸ“‹"></a>4.2 Rulesè§„åˆ™é…ç½® ğŸ“‹</h3><h4 id="4-2-1-è§„åˆ™ä»‹ç»"><a href="#4-2-1-è§„åˆ™ä»‹ç»" class="headerlink" title="4.2.1 è§„åˆ™ä»‹ç»"></a>4.2.1 è§„åˆ™ä»‹ç»</h4><p>Rulesç”¨äºç»™Cursor AIåŠŸèƒ½æ·»åŠ è§„åˆ™å’Œé™åˆ¶ï¼Œç¡®ä¿ç”Ÿæˆçš„ä»£ç ç¬¦åˆå›¢é˜Ÿè§„èŒƒã€‚</p><p><strong>ä¸»è¦ä½œç”¨ï¼š</strong></p><ul><li>çº¦æŸä»£ç é£æ ¼</li><li>é™å®šæŠ€æœ¯é€‰å‹</li><li>æŒ‡å®šæ ¸å¿ƒå‚æ•°</li></ul><p><strong>è§„åˆ™ç±»å‹å¯¹æ¯”ï¼š</strong></p><table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>é¡¹ç›®è§„åˆ™ï¼ˆProject Rulesï¼‰</strong></th><th><strong>ç”¨æˆ·è§„åˆ™ï¼ˆUser Rulesï¼‰</strong></th></tr></thead><tbody><tr><td><strong>ä½œç”¨èŒƒå›´</strong></td><td>ä»…å¯¹å½“å‰é¡¹ç›®ç”Ÿæ•ˆï¼Œå›¢é˜Ÿæˆå‘˜å…±äº«ç›¸åŒè§„åˆ™</td><td>å¯¹æ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆï¼Œä¸ªäººä¸“å±é…ç½®</td></tr><tr><td><strong>å­˜å‚¨ä½ç½®</strong></td><td>é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>.cursor/rules/éšæ„.mdc</code> æ–‡ä»¶</td><td>ç”¨æˆ·é…ç½®ç›®å½•ï¼ˆå¦‚ <code>~/.cursor/rules</code>ï¼‰</td></tr><tr><td><strong>åŒæ­¥æ–¹å¼</strong></td><td>éšé¡¹ç›®ä»£ç æäº¤åˆ°ç‰ˆæœ¬åº“ï¼ˆå¦‚ Gitï¼‰ï¼Œå›¢é˜Ÿå…±äº«</td><td>ä»…æœ¬åœ°ç”Ÿæ•ˆï¼Œä¸éšé¡¹ç›®åŒæ­¥</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç»Ÿä¸€å›¢é˜Ÿç¼–ç è§„èŒƒï¼ˆå¦‚å‡½æ•°æ³¨é‡Šæ ¼å¼ã€ä¾èµ–ç‰ˆæœ¬ï¼‰</td><td>ä¸ªäººä¹ æƒ¯ï¼ˆå¦‚å¿«æ·é”®ã€AI å“åº”é£æ ¼ï¼‰</td></tr></tbody></table><h4 id="4-2-2-è§„åˆ™é…ç½®ç¤ºä¾‹"><a href="#4-2-2-è§„åˆ™é…ç½®ç¤ºä¾‹" class="headerlink" title="4.2.2 è§„åˆ™é…ç½®ç¤ºä¾‹"></a>4.2.2 è§„åˆ™é…ç½®ç¤ºä¾‹</h4><ol><li><p><strong>åˆ›å»ºè§„åˆ™æ–‡ä»¶</strong><br><img src="/images/cursor/1749025679441.png" alt="åˆ›å»ºè§„åˆ™"></p></li><li><p><strong>ç¼–å†™è§„åˆ™å†…å®¹</strong></p></li></ol><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">description: &quot;å›¢é˜Ÿå‰ç«¯é¡¹ç›®è§„èŒƒ&quot;</span><br><span class="line"><span class="section">priority: 1000</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section"># ä»£ç é£æ ¼</span></span><br><span class="line"><span class="bullet">1.</span> å‡½æ•°å¿…é¡»åŒ…å« JSDoc æ³¨é‡Š</span><br><span class="line"><span class="bullet">2.</span> ç¦æ­¢ä½¿ç”¨ <span class="code">`var`</span>ï¼Œç»Ÿä¸€ç”¨ <span class="code">`const`</span>/<span class="code">`let`</span></span><br><span class="line"><span class="bullet">3.</span> å‡½æ•°å‘½åå¿…é¡»æ·»åŠ  zwf<span class="emphasis">_å‰ç¼€ï¼Œ ä¾‹å¦‚ï¼šzwf_</span>login</span><br><span class="line"></span><br><span class="line"><span class="section"># ä¾èµ–ç®¡ç†</span></span><br><span class="line"><span class="bullet">-</span> ä¼˜å…ˆä½¿ç”¨é¡¹ç›®å†…å·²æœ‰çš„å·¥å…·å‡½æ•°</span><br><span class="line"><span class="bullet">-</span> ç¦æ­¢å¼•å…¥ä½ç‰ˆæœ¬çš„ lodashï¼ˆ&lt;4.0.0ï¼‰</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>è§„åˆ™ç”Ÿæ•ˆæ•ˆæœ</strong><br><img src="/images/cursor/1749026002745.png" alt="è§„åˆ™æ•ˆæœ"></li></ol><h4 id="4-2-3-RIPER-5-é«˜çº§è§„åˆ™æ¡†æ¶"><a href="#4-2-3-RIPER-5-é«˜çº§è§„åˆ™æ¡†æ¶" class="headerlink" title="4.2.3 RIPER-5 é«˜çº§è§„åˆ™æ¡†æ¶"></a>4.2.3 RIPER-5 é«˜çº§è§„åˆ™æ¡†æ¶</h4><p><strong>RIPER-5</strong> æ˜¯ä¸€å¥—ä¸ºé«˜çº§AIåŠ©æ‰‹è®¾è®¡çš„ä¸¥æ ¼è¡Œä¸ºåè®®å’Œå·¥ä½œæµæ¡†æ¶ï¼Œç‰¹åˆ«é€‚åˆåœ¨Cursorä¸­ä½¿ç”¨ã€‚å®ƒé€šè¿‡å¼ºåˆ¶æ€§çš„ã€åˆ†é˜¶æ®µçš„æµç¨‹æ¥çº¦æŸAIçš„è¡Œä¸ºï¼Œç¡®ä¿æ‰§è¡Œå¤æ‚ç¼–ç ä»»åŠ¡æ—¶çš„æ¯ä¸€æ­¥æ“ä½œéƒ½å®‰å…¨ã€å¯æ§ä¸”ç¬¦åˆé¢„æœŸã€‚</p><p><strong>GitHubä»“åº“ï¼š</strong> <a href="https://github.com/NeekChaw/RIPER-5">NeekChaw&#x2F;RIPER-5</a></p><p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p><ul><li>ğŸ¯ <strong>è¡Œä¸ºçº¦æŸ</strong>ï¼šé€šè¿‡ä¸¥æ ¼çš„å·¥ä½œæµçº¦æŸAIè¡Œä¸º</li><li>ğŸ”’ <strong>å®‰å…¨å¯æ§</strong>ï¼šç¡®ä¿AIæ“ä½œçš„å®‰å…¨æ€§å’Œå¯é¢„æµ‹æ€§</li><li>ğŸ“‹ <strong>åˆ†é˜¶æ®µæ‰§è¡Œ</strong>ï¼šå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¯ç®¡ç†çš„æ­¥éª¤</li><li>ğŸ›¡ï¸ <strong>é”™è¯¯é¢„é˜²</strong>ï¼šé¿å…AIéšæ„åˆ›å»ºæ–‡ä»¶ã€å¿½è§†ç°æœ‰æ¶æ„ç­‰é—®é¢˜</li></ul><p><strong>RIPER-5 è§„åˆ™é…ç½®ç¤ºä¾‹ï¼š</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">description: &quot;RIPER-5 AIç¼–ç è¡Œä¸ºåè®®&quot;</span><br><span class="line"><span class="section">priority: 2000</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section"># RIPER-5 è¡Œä¸ºåè®®</span></span><br><span class="line"></span><br><span class="line"><span class="section">## æ ¸å¿ƒåŸåˆ™</span></span><br><span class="line"><span class="bullet">1.</span> åœ¨æ‰§è¡Œä»»ä½•ç¼–ç ä»»åŠ¡å‰ï¼Œå¿…é¡»å…ˆè¿›è¡Œéœ€æ±‚åˆ†æå’Œæ¶æ„è®¾è®¡</span><br><span class="line"><span class="bullet">2.</span> ä¸¥æ ¼éµå¾ªäº”é˜¶æ®µå·¥ä½œæµï¼šåˆ†æ(Research) â†’ è§„åˆ’(Plan) â†’ å®æ–½(Implement) â†’ éªŒè¯(Verify) â†’ ä¼˜åŒ–(Optimize)</span><br><span class="line"><span class="bullet">3.</span> ç¦æ­¢éšæ„åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå¿…é¡»å…ˆæ£€æŸ¥ç°æœ‰ä»£ç ç»“æ„</span><br><span class="line"><span class="bullet">4.</span> æ‰€æœ‰ä»£ç ä¿®æ”¹å¿…é¡»åŒ…å«è¯¦ç»†çš„æ³¨é‡Šå’Œæ–‡æ¡£</span><br><span class="line"></span><br><span class="line"><span class="section">## å·¥ä½œæµè¦æ±‚</span></span><br><span class="line"><span class="bullet">-</span> åˆ†æé˜¶æ®µï¼šæ·±å…¥ç†è§£éœ€æ±‚å’Œç°æœ‰ä»£ç ç»“æ„</span><br><span class="line"><span class="bullet">-</span> è§„åˆ’é˜¶æ®µï¼šåˆ¶å®šè¯¦ç»†çš„å®æ–½è®¡åˆ’å’ŒæŠ€æœ¯æ–¹æ¡ˆ</span><br><span class="line"><span class="bullet">-</span> å®æ–½é˜¶æ®µï¼šä¸¥æ ¼æŒ‰ç…§è§„åˆ’æ‰§è¡Œï¼Œé¿å…åç¦»ç›®æ ‡</span><br><span class="line"><span class="bullet">-</span> éªŒè¯é˜¶æ®µï¼šå…¨é¢æµ‹è¯•å’Œä»£ç å®¡æŸ¥</span><br><span class="line"><span class="bullet">-</span> ä¼˜åŒ–é˜¶æ®µï¼šæ€§èƒ½ä¼˜åŒ–å’Œä»£ç é‡æ„</span><br><span class="line"></span><br><span class="line"><span class="section">## ä»£ç è§„èŒƒ</span></span><br><span class="line"><span class="bullet">-</span> æ‰€æœ‰å‡½æ•°å¿…é¡»åŒ…å«JSDocæ³¨é‡Š</span><br><span class="line"><span class="bullet">-</span> å˜é‡å‘½åå¿…é¡»å…·æœ‰æè¿°æ€§</span><br><span class="line"><span class="bullet">-</span> ä»£ç ç»“æ„å¿…é¡»æ¸…æ™°ï¼Œé¿å…è¿‡åº¦åµŒå¥—</span><br><span class="line"><span class="bullet">-</span> å¿…é¡»è€ƒè™‘é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ</span><br></pre></td></tr></table></figure><p><strong>Claude Code ä¸“ç”¨æç¤ºè¯é›†åˆï¼š</strong></p><p>RIPER-5ä»“åº“è¿˜åŒ…å«å¤šä¸ªé’ˆå¯¹ç‰¹å®šåœºæ™¯çš„ä¼˜åŒ–æç¤ºè¯ï¼š</p><table><thead><tr><th>æ¨¡å—</th><th>æè¿°</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Kiroéœ€æ±‚æ”¶é›†ä¸è§„åˆ’</strong></td><td>ä¸‰é˜¶æ®µå·¥ä½œæµï¼Œå°†æ¨¡ç³Šæƒ³æ³•è½¬åŒ–ä¸ºå®Œæ•´å¼€å‘æ–‡æ¡£</td><td>é¡¹ç›®è§„åˆ’å’Œéœ€æ±‚åˆ†æ</td></tr><tr><td><strong>Linuxä¹‹çˆ¶å¸®ä½ é‡æ„ä»£ç </strong></td><td>æ¨¡æ‹ŸLinus Torvaldsçš„æ€ç»´æ¨¡å¼å®¡æŸ¥ä»£ç </td><td>ä»£ç å®¡æŸ¥å’Œé‡æ„</td></tr><tr><td><strong>è®©Claudeæ›´é è°±çš„Workflow</strong></td><td>äº”æ­¥å·¥ä½œæµçº¦æŸAIè¡Œä¸º</td><td>æ—¥å¸¸å¼€å‘ä»»åŠ¡</td></tr><tr><td><strong>ä¸“ä¸šé«˜æ•ˆæäº¤Git</strong></td><td>Commit-as-Promptç†å¿µï¼Œç»“æ„åŒ–æäº¤ä¿¡æ¯</td><td>Gitç‰ˆæœ¬ç®¡ç†</td></tr><tr><td><strong>è¶…æ·±åº¦æ€è€ƒ</strong></td><td>å¤šä»£ç†åä½œå·¥ä½œæµï¼Œæ¨¡æ‹Ÿä¸“å®¶å›¢é˜Ÿ</td><td>å¤æ‚é—®é¢˜è§£å†³</td></tr></tbody></table><p><strong>ä½¿ç”¨å»ºè®®ï¼š</strong></p><ol><li>å°†RIPER-5è§„åˆ™è®¾ç½®ä¸ºé¡¹ç›®è§„åˆ™ï¼Œç¡®ä¿å›¢é˜Ÿç»Ÿä¸€ä½¿ç”¨</li><li>æ ¹æ®å…·ä½“ä»»åŠ¡é€‰æ‹©åˆé€‚çš„Claude Codeæç¤ºè¯</li><li>å®šæœŸæ›´æ–°å’Œä¼˜åŒ–è§„åˆ™å†…å®¹</li><li>ç»“åˆå›¢é˜Ÿå®é™…æƒ…å†µè°ƒæ•´è§„åˆ™ç»†èŠ‚</li></ol><h3 id="4-3-ç¬¦å·ä½¿ç”¨-ğŸ”"><a href="#4-3-ç¬¦å·ä½¿ç”¨-ğŸ”" class="headerlink" title="4.3 @ç¬¦å·ä½¿ç”¨ ğŸ”"></a>4.3 @ç¬¦å·ä½¿ç”¨ ğŸ”</h3><h4 id="4-3-1-ç¬¦å·ç±»å‹"><a href="#4-3-1-ç¬¦å·ç±»å‹" class="headerlink" title="4.3.1 ç¬¦å·ç±»å‹"></a>4.3.1 ç¬¦å·ç±»å‹</h4><p><img src="/images/cursor/@-symbols-basics.png" alt="ç¬¦å·åŸºç¡€"></p><p>æ”¯æŒçš„@ç¬¦å·ï¼š</p><ul><li>@Files - å¼•ç”¨ç‰¹å®šæ–‡ä»¶</li><li>@Folders - å¼•ç”¨æ•´ä¸ªæ–‡ä»¶å¤¹</li><li>@Code - å¼•ç”¨ä»£ç ç‰‡æ®µ</li><li>@Docs - è®¿é—®æ–‡æ¡£</li><li>@Git - è®¿é—®gitå†å²</li><li>@Web - å‚è€ƒç½‘ç»œèµ„æº</li><li>@Lint Errors - å¼•ç”¨linté”™è¯¯</li></ul><h4 id="4-3-2-ä½¿ç”¨ç¤ºä¾‹"><a href="#4-3-2-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="4.3.2 ä½¿ç”¨ç¤ºä¾‹"></a>4.3.2 ä½¿ç”¨ç¤ºä¾‹</h4><ol><li><p><strong>@Filesä½¿ç”¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¸®æˆ‘æ€»ç»“ä¸‹ @main.js ä¸­åŒ…å«å“ªäº›æ–¹æ³•ï¼Ÿ</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749032749858.png" alt="Filesä½¿ç”¨"></p></li><li><p><strong>@Codeä½¿ç”¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¸®æˆ‘é€è¡Œè§£é‡Šä¸‹ @zwf_register ä»£ç çš„å«ä¹‰ï¼</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749033073362.png" alt="Codeä½¿ç”¨"></p></li><li><p><strong>@Docsä½¿ç”¨</strong><br><img src="/images/cursor/@docs-add.png" alt="Docsé…ç½®"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŸºäº @MyBatis-plus æŸ¥è¯¢ä¸‹ä¹è§‚é”æ’ä»¶å¦‚ä½•ä½¿ç”¨</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749088442648.png" alt="Docsä½¿ç”¨"></p></li><li><p><strong>@Webä½¿ç”¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Web React 19 çš„æœ€æ–°æ€§èƒ½ä¼˜åŒ–</span><br></pre></td></tr></table></figure><p><img src="/images/cursor/1749089800111.png" alt="Webä½¿ç”¨"></p></li></ol><h4 id="4-3-3-æœ€ä½³å®è·µ"><a href="#4-3-3-æœ€ä½³å®è·µ" class="headerlink" title="4.3.3 æœ€ä½³å®è·µ"></a>4.3.3 æœ€ä½³å®è·µ</h4><ol><li><p><strong>é€‰æ‹©åˆé€‚çš„ç¬¦å·</strong></p><ul><li>@Filesï¼šéœ€è¦è®¿é—®å®Œæ•´æ–‡ä»¶</li><li>@Codeï¼šå¼•ç”¨ç‰¹å®šä»£ç ç‰‡æ®µ</li><li>@Docsï¼šæŸ¥è¯¢å®˜æ–¹æ–‡æ¡£</li><li>@Webï¼šè·å–æœ€æ–°ä¿¡æ¯</li></ul></li><li><p><strong>æä¾›å‡†ç¡®ä¸Šä¸‹æ–‡</strong></p><ul><li>æŒ‡å®šæ­£ç¡®çš„æ–‡ä»¶è·¯å¾„</li><li>é€‰æ‹©ç›¸å…³çš„ä»£ç ç‰‡æ®µ</li><li>å¼•ç”¨é€‚å½“çš„æ–‡æ¡£</li><li>ä½¿ç”¨ç²¾ç¡®çš„æœç´¢è¯</li></ul></li><li><p><strong>ç»„åˆä½¿ç”¨æŠ€å·§</strong></p><ul><li>å¤šä¸ªç¬¦å·é…åˆä½¿ç”¨</li><li>æŒ‰éœ€æä¾›ä¸Šä¸‹æ–‡</li><li>é¿å…è¿‡åº¦å¼•ç”¨</li><li>ä¿æŒæç¤ºç®€æ´</li></ul></li></ol><h2 id="5-å®æˆ˜æ¡ˆä¾‹ï¼šChromeæ’ä»¶å¼€å‘-ğŸš€"><a href="#5-å®æˆ˜æ¡ˆä¾‹ï¼šChromeæ’ä»¶å¼€å‘-ğŸš€" class="headerlink" title="5. å®æˆ˜æ¡ˆä¾‹ï¼šChromeæ’ä»¶å¼€å‘ ğŸš€"></a>5. å®æˆ˜æ¡ˆä¾‹ï¼šChromeæ’ä»¶å¼€å‘ ğŸš€</h2><h3 id="5-1-æ’ä»¶è®¾è®¡-ğŸ¨"><a href="#5-1-æ’ä»¶è®¾è®¡-ğŸ¨" class="headerlink" title="5.1 æ’ä»¶è®¾è®¡ ğŸ¨"></a>5.1 æ’ä»¶è®¾è®¡ ğŸ¨</h3><h4 id="5-1-1-éœ€æ±‚åˆ†æ"><a href="#5-1-1-éœ€æ±‚åˆ†æ" class="headerlink" title="5.1.1 éœ€æ±‚åˆ†æ"></a>5.1.1 éœ€æ±‚åˆ†æ</h4><p><strong>åŠŸèƒ½éœ€æ±‚ï¼š</strong></p><ol><li>è§£é‡Šé€‰ä¸­çš„æ®µè½æˆ–å…³é”®è¯</li><li>ç¿»è¯‘é€‰ä¸­çš„æ®µè½æˆ–å…³é”®è¯ï¼ˆä¸­è‹±äº’è¯‘ï¼‰</li><li>æœ—è¯»é€‰ä¸­çš„æ®µè½æˆ–å…³é”®å­—</li><li>æ¶¦è‰²å’Œæ›¿æ¢é€‰ä¸­çš„æ–‡æœ¬æ–‡æ¡ˆ</li></ol><p><strong>ç»†èŠ‚è¦æ±‚ï¼š</strong></p><ol><li>é€‰ä¸­æ–‡æœ¬æ—¶æ˜¾ç¤ºæ‚¬æµ®æ’ä»¶</li><li>ç»“æœæ˜¾ç¤ºåœ¨æ‚¬æµ®çª—å£ä¸‹æ–¹</li><li>ç¿»è¯‘æ”¯æŒè¯­è¨€é€‰æ‹©</li><li>æ¶¦è‰²ç»“æœå¯ç¼–è¾‘å’Œæ›¿æ¢</li><li>ä½¿ç”¨Kimi APIå®ç°æ ¸å¿ƒåŠŸèƒ½</li><li>ä½¿ç”¨Chromeå†…ç½®APIå®ç°æœ—è¯»</li></ol><h4 id="5-1-2-UIè®¾è®¡"><a href="#5-1-2-UIè®¾è®¡" class="headerlink" title="5.1.2 UIè®¾è®¡"></a>5.1.2 UIè®¾è®¡</h4><p><strong>åŸºç¡€æ‚¬æµ®èœå•ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------------------------+</span><br><span class="line">|     åŠŸèƒ½æŒ‰é’®ç»„         |</span><br><span class="line">+------------------------+</span><br><span class="line">| [è§£é‡Š] [ç¿»è¯‘] [æœ—è¯»] [æ¶¦è‰²] |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure><p><strong>åŠŸèƒ½å±•ç¤ºåŒºåŸŸï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------------------------+</span><br><span class="line">|     åŠŸèƒ½æŒ‰é’®ç»„         |</span><br><span class="line">+------------------------+</span><br><span class="line">| [è§£é‡Š] [ç¿»è¯‘] [æœ—è¯»] [æ¶¦è‰²] |</span><br><span class="line">+------------------------+</span><br><span class="line">|     ç»“æœå±•ç¤ºåŒºåŸŸ        |</span><br><span class="line">|                        |</span><br><span class="line">|                        |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure><h3 id="5-2-åŠŸèƒ½å®ç°-âš¡"><a href="#5-2-åŠŸèƒ½å®ç°-âš¡" class="headerlink" title="5.2 åŠŸèƒ½å®ç° âš¡"></a>5.2 åŠŸèƒ½å®ç° âš¡</h3><h4 id="5-2-1-é¡¹ç›®åˆå§‹åŒ–"><a href="#5-2-1-é¡¹ç›®åˆå§‹åŒ–" class="headerlink" title="5.2.1 é¡¹ç›®åˆå§‹åŒ–"></a>5.2.1 é¡¹ç›®åˆå§‹åŒ–</h4><ol><li><p><strong>åˆ›å»ºé¡¹ç›®ç»“æ„</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">chrome-plugin/</span><br><span class="line">â”œâ”€â”€ manifest.json</span><br><span class="line">â”œâ”€â”€ popup/</span><br><span class="line">â”‚   â”œâ”€â”€ popup.html</span><br><span class="line">â”‚   â”œâ”€â”€ popup.css</span><br><span class="line">â”‚   â””â”€â”€ popup.js</span><br><span class="line">â”œâ”€â”€ content/</span><br><span class="line">â”‚   â”œâ”€â”€ content.css</span><br><span class="line">â”‚   â””â”€â”€ content.js</span><br><span class="line">â”œâ”€â”€ background/</span><br><span class="line">â”‚   â””â”€â”€ background.js</span><br><span class="line">â””â”€â”€ config.js</span><br></pre></td></tr></table></figure></li><li><p><strong>é…ç½®manifest.json</strong></p></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;manifest_version&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;AIæ–‡æœ¬åŠ©æ‰‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä¸€æ¬¾å¼ºå¤§çš„æ–‡æœ¬å¤„ç†Chromeæ’ä»¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;permissions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;activeTab&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;storage&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;tts&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;action&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;default_popup&quot;</span><span class="punctuation">:</span> <span class="string">&quot;popup/popup.html&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;content_scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;matches&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;all_urls&gt;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;css&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;content/content.css&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;js&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;content/content.js&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;background&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;service_worker&quot;</span><span class="punctuation">:</span> <span class="string">&quot;background/background.js&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="5-2-2-æ ¸å¿ƒåŠŸèƒ½å®ç°"><a href="#5-2-2-æ ¸å¿ƒåŠŸèƒ½å®ç°" class="headerlink" title="5.2.2 æ ¸å¿ƒåŠŸèƒ½å®ç°"></a>5.2.2 æ ¸å¿ƒåŠŸèƒ½å®ç°</h4><ol><li><p><strong>Kimi APIé…ç½®</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">kimi</span>: &#123;</span><br><span class="line">        <span class="attr">apiUrl</span>: <span class="string">&#x27;https://api.moonshot.cn/v1&#x27;</span>,</span><br><span class="line">        <span class="attr">apiKey</span>: <span class="string">&#x27;YOUR_KIMI_API_KEY&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">defaults</span>: &#123;</span><br><span class="line">        <span class="attr">translationTarget</span>: <span class="string">&#x27;zh&#x27;</span>,</span><br><span class="line">        <span class="attr">speechLanguage</span>: <span class="string">&#x27;zh&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ–‡æœ¬é€‰æ‹©ç›‘å¬</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// content.js</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> selectedText = <span class="variable language_">window</span>.<span class="title function_">getSelection</span>().<span class="title function_">toString</span>().<span class="title function_">trim</span>();</span><br><span class="line">    <span class="keyword">if</span> (selectedText) &#123;</span><br><span class="line">        <span class="title function_">showToolbar</span>(e.<span class="property">pageX</span>, e.<span class="property">pageY</span>, selectedText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p><strong>åŠŸèƒ½å®ç°ç¤ºä¾‹</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–‡æœ¬è§£é‡Š</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">explainText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`<span class="subst">$&#123;config.kimi.apiUrl&#125;</span>/explain`</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">`Bearer <span class="subst">$&#123;config.kimi.apiKey&#125;</span>`</span>,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; text &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="5-3-è°ƒè¯•ä¸å‘å¸ƒ-ğŸš€"><a href="#5-3-è°ƒè¯•ä¸å‘å¸ƒ-ğŸš€" class="headerlink" title="5.3 è°ƒè¯•ä¸å‘å¸ƒ ğŸš€"></a>5.3 è°ƒè¯•ä¸å‘å¸ƒ ğŸš€</h3><h4 id="5-3-1-æœ¬åœ°è°ƒè¯•"><a href="#5-3-1-æœ¬åœ°è°ƒè¯•" class="headerlink" title="5.3.1 æœ¬åœ°è°ƒè¯•"></a>5.3.1 æœ¬åœ°è°ƒè¯•</h4><ol><li><p><strong>åŠ è½½æ’ä»¶</strong></p><ul><li>æ‰“å¼€Chromeæ‰©å±•ç¨‹åºé¡µé¢</li><li>å¯ç”¨å¼€å‘è€…æ¨¡å¼</li><li>åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº</li><li>é€‰æ‹©æ’ä»¶ç›®å½•</li></ul></li><li><p><strong>è°ƒè¯•æŠ€å·§</strong></p><ul><li>ä½¿ç”¨Chrome DevTools</li><li>æŸ¥çœ‹Consoleè¾“å‡º</li><li>æµ‹è¯•å„é¡¹åŠŸèƒ½</li><li>æ£€æŸ¥APIå“åº”</li></ul></li></ol><h4 id="5-3-2-é—®é¢˜ä¿®å¤"><a href="#5-3-2-é—®é¢˜ä¿®å¤" class="headerlink" title="5.3.2 é—®é¢˜ä¿®å¤"></a>5.3.2 é—®é¢˜ä¿®å¤</h4><ol><li><p><strong>å›¾ç‰‡èµ„æºé—®é¢˜</strong><br><img src="/images/cursor/1749113898720.png" alt="å›¾ç‰‡é”™è¯¯"></p><ul><li>æ·»åŠ å¿…è¦çš„å›¾æ ‡æ–‡ä»¶</li><li>ç¡®ä¿è·¯å¾„æ­£ç¡®</li></ul></li><li><p><strong>æ¨¡å—å¯¼å…¥é”™è¯¯</strong><br><img src="/images/cursor/1749114738303.png" alt="å¯¼å…¥é”™è¯¯"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¿®æ”¹ä¸º</span></span><br><span class="line"><span class="keyword">import</span> &#123; config &#125; <span class="keyword">from</span> <span class="string">&#x27;./config.js&#x27;</span>;</span><br><span class="line"><span class="comment">// æ”¹ä¸º</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="variable language_">window</span>.<span class="property">config</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>åŠŸèƒ½éªŒè¯</strong><br><img src="/images/cursor/1749114867360.png" alt="åŠŸèƒ½æµ‹è¯•"></p><ul><li>æµ‹è¯•æ–‡æœ¬é€‰æ‹©</li><li>éªŒè¯APIè°ƒç”¨</li><li>æ£€æŸ¥UIæ˜¾ç¤º</li><li>ç¡®è®¤åŠŸèƒ½æ­£å¸¸</li></ul></li></ol><h2 id="ğŸ“š-å»¶ä¼¸é˜…è¯»"><a href="#ğŸ“š-å»¶ä¼¸é˜…è¯»" class="headerlink" title="ğŸ“š å»¶ä¼¸é˜…è¯»"></a>ğŸ“š å»¶ä¼¸é˜…è¯»</h2><ul><li><a href="/git%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97/">Gitæ“ä½œæŒ‡å—</a> - å­¦ä¹ ç‰ˆæœ¬æ§åˆ¶åŸºç¡€</li><li><a href="/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">å‡½æ•°å¼ç¼–ç¨‹</a> - æå‡ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§</li><li><a href="/20251002%E8%BF%91%E6%9C%9F%E8%A7%84%E5%88%92_%E6%96%B0/">è¿‘æœŸè§„åˆ’</a> - äº†è§£å­¦ä¹ è·¯çº¿å›¾</li></ul><h2 id="ğŸ’¡-å­¦ä¹ å»ºè®®"><a href="#ğŸ’¡-å­¦ä¹ å»ºè®®" class="headerlink" title="ğŸ’¡ å­¦ä¹ å»ºè®®"></a>ğŸ’¡ å­¦ä¹ å»ºè®®</h2><ol><li><p><strong>å¾ªåºæ¸è¿›</strong></p><ul><li>å…ˆæŒæ¡åŸºç¡€åŠŸèƒ½(Tabè¡¥å…¨ã€Chatå¯¹è¯)</li><li>å†å­¦ä¹ é«˜çº§ç‰¹æ€§(Rulesã€@ç¬¦å·)</li><li>æœ€åå°è¯•å®æˆ˜é¡¹ç›®</li></ul></li><li><p><strong>å®è·µä¸ºä¸»</strong></p><ul><li>åœ¨æ—¥å¸¸å¼€å‘ä¸­å¤šä½¿ç”¨</li><li>ä»ç®€å•ä»»åŠ¡å¼€å§‹</li><li>é€æ­¥æŒ‘æˆ˜å¤æ‚é¡¹ç›®</li></ul></li><li><p><strong>å–„ç”¨æ–‡æ¡£</strong></p><ul><li>ç»å¸¸æŸ¥é˜…å®˜æ–¹æ–‡æ¡£</li><li>å…³æ³¨ç‰ˆæœ¬æ›´æ–°</li><li>å‚ä¸ç¤¾åŒºè®¨è®º</li></ul></li><li><p><strong>çŸ¥è¯†æ•´åˆ</strong></p><ul><li>ç»“åˆç‰ˆæœ¬æ§åˆ¶(Git)</li><li>é…åˆå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³</li><li>èå…¥å¼€å‘å·¥ä½œæµ</li></ul></li></ol><h2 id="ğŸ”—-ç›¸å…³èµ„æº"><a href="#ğŸ”—-ç›¸å…³èµ„æº" class="headerlink" title="ğŸ”— ç›¸å…³èµ„æº"></a>ğŸ”— ç›¸å…³èµ„æº</h2><ol><li><p><strong>å®˜æ–¹èµ„æº</strong></p><ul><li><a href="https://cursor.sh/">Cursorå®˜ç½‘</a></li><li><a href="https://cursor.sh/docs">Cursoræ–‡æ¡£</a></li><li><a href="https://github.com/getcursor/cursor">GitHubä»“åº“</a></li></ul></li><li><p><strong>ç¤¾åŒºèµ„æº</strong></p><ul><li><a href="https://discord.gg/cursor">Discordç¤¾åŒº</a></li><li><a href="https://www.reddit.com/r/cursor">Redditè®ºå›</a></li><li><a href="https://stackoverflow.com/questions/tagged/cursor-editor">Stack Overflow</a></li></ul></li><li><p><strong>ä¸­æ–‡èµ„æº</strong></p><ul><li><a href="https://juejin.cn/tag/Cursor">æ˜é‡‘ä¸“æ </a></li><li><a href="https://www.zhihu.com/topic/cursor">çŸ¥ä¹è¯é¢˜</a></li><li><a href="https://search.bilibili.com/all?keyword=cursor%20ai">Bç«™æ•™ç¨‹</a></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> AIå·¥å…·æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
            <tag> Cursor </tag>
            
            <tag> AIç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå‡½æ•°å¼ç¼–ç¨‹è¯¦è§£ï¼šä»Lambdaåˆ°Streamçš„å®Œæ•´æŒ‡å—</title>
      <link href="//java-functional-programming-guide/"/>
      <url>//java-functional-programming-guide/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸ“š-å‚è€ƒèµ„æº"><a href="#ğŸ“š-å‚è€ƒèµ„æº" class="headerlink" title="ğŸ“š å‚è€ƒèµ„æº"></a>ğŸ“š å‚è€ƒèµ„æº</h1><p>æœ¬æ–‡æ¡£åœ¨ç¼–å†™è¿‡ç¨‹ä¸­å‚è€ƒäº†ä»¥ä¸‹ä¼˜è´¨èµ„æºï¼Œæ„Ÿè°¢è¿™äº›ä½œè€…å’Œå¹³å°çš„åˆ†äº«ï¼š</p><h2 id="ğŸ¥-è§†é¢‘æ•™ç¨‹"><a href="#ğŸ¥-è§†é¢‘æ•™ç¨‹" class="headerlink" title="ğŸ¥ è§†é¢‘æ•™ç¨‹"></a>ğŸ¥ è§†é¢‘æ•™ç¨‹</h2><ul><li><strong><a href="https://www.bilibili.com/video/BV1fz421C7tj/?spm_id_from=333.337.search-card.all.click&vd_source=2d617d5367ab8a8bf8a5ed469356eb71">Javaå‡½æ•°å¼ç¼–ç¨‹å®Œæ•´æ•™ç¨‹</a></strong> - Bç«™ä¼˜è´¨Javaå‡½æ•°å¼ç¼–ç¨‹æ•™ç¨‹ï¼Œç³»ç»Ÿè®²è§£äº†Lambdaè¡¨è¾¾å¼å’ŒStream APIçš„ä½¿ç”¨</li></ul><h2 id="ğŸ“–-æŠ€æœ¯åšå®¢"><a href="#ğŸ“–-æŠ€æœ¯åšå®¢" class="headerlink" title="ğŸ“– æŠ€æœ¯åšå®¢"></a>ğŸ“– æŠ€æœ¯åšå®¢</h2><ul><li><strong><a href="https://mofan212.github.io/posts/Java-Lambda-Expression-And-Functional-Programming/index.html">Java Lambda Expression And Functional Programming</a></strong> - é»˜çƒ¦çš„æŠ€æœ¯åšå®¢ï¼Œæ·±å…¥åˆ†æäº†Lambdaè¡¨è¾¾å¼çš„åº•å±‚å®ç°åŸç†</li></ul><h2 id="ğŸ“š-æ¨èé˜…è¯»"><a href="#ğŸ“š-æ¨èé˜…è¯»" class="headerlink" title="ğŸ“š æ¨èé˜…è¯»"></a>ğŸ“š æ¨èé˜…è¯»</h2><h2 id="ğŸ”—-ç›¸å…³é“¾æ¥"><a href="#ğŸ”—-ç›¸å…³é“¾æ¥" class="headerlink" title="ğŸ”— ç›¸å…³é“¾æ¥"></a>ğŸ”— ç›¸å…³é“¾æ¥</h2><ul><li><a href="https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html">Oracleå®˜æ–¹Lambdaè¡¨è¾¾å¼æ•™ç¨‹</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html">Oracleå®˜æ–¹Stream APIæ–‡æ¡£</a></li><li><a href="https://tech.meituan.com/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html">ç¾å›¢æŠ€æœ¯å›¢é˜Ÿå‡½æ•°å¼ç¼–ç¨‹ç³»åˆ—</a></li></ul><hr><h1 id="ğŸš€-å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€"><a href="#ğŸš€-å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€" class="headerlink" title="ğŸš€ å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€"></a>ğŸš€ å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€</h1><h2 id="ğŸ“–-ä»€ä¹ˆæ˜¯å‡½æ•°"><a href="#ğŸ“–-ä»€ä¹ˆæ˜¯å‡½æ•°" class="headerlink" title="ğŸ“– ä»€ä¹ˆæ˜¯å‡½æ•°"></a>ğŸ“– ä»€ä¹ˆæ˜¯å‡½æ•°</h2><p>å‡½æ•°å³è§„åˆ™ã€‚åœ¨æ•°å­¦ä¸Šï¼Œå‡½æ•°æ˜¯ä¸€ç§æ˜ å°„å…³ç³»ï¼Œå°†è¾“å…¥å€¼æ˜ å°„åˆ°è¾“å‡ºå€¼ã€‚</p><h3 id="ğŸ”¢-æ•°å­¦å‡½æ•°ç¤ºä¾‹"><a href="#ğŸ”¢-æ•°å­¦å‡½æ•°ç¤ºä¾‹" class="headerlink" title="ğŸ”¢ æ•°å­¦å‡½æ•°ç¤ºä¾‹"></a>ğŸ”¢ æ•°å­¦å‡½æ•°ç¤ºä¾‹</h3><p>è€ƒè™‘å‡½æ•° $f(x) &#x3D; x^2$ï¼š</p><table><thead><tr><th>INPUT</th><th>f(x) &#x3D; xÂ²</th><th>OUTPUT</th></tr></thead><tbody><tr><td>1</td><td>1Â²</td><td>1</td></tr><tr><td>2</td><td>2Â²</td><td>4</td></tr><tr><td>3</td><td>3Â²</td><td>9</td></tr><tr><td>4</td><td>4Â²</td><td>16</td></tr><tr><td>5</td><td>5Â²</td><td>25</td></tr><tr><td>â€¦</td><td>â€¦</td><td>â€¦</td></tr></tbody></table><h3 id="å‡½æ•°çš„æ ¸å¿ƒç‰¹æ€§"><a href="#å‡½æ•°çš„æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="å‡½æ•°çš„æ ¸å¿ƒç‰¹æ€§"></a>å‡½æ•°çš„æ ¸å¿ƒç‰¹æ€§</h3><ol><li><strong>ç¡®å®šæ€§</strong>ï¼šç›¸åŒçš„è¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡º</li><li><strong>æ— å‰¯ä½œç”¨</strong>ï¼šå‡½æ•°æ‰§è¡Œä¸ä¼šæ”¹å˜å¤–éƒ¨çŠ¶æ€</li><li><strong>ä¸å˜æ€§</strong>ï¼šå‡½æ•°çš„æ‰§è¡Œè§„åˆ™æ°¸è¿œä¸å˜</li></ol><blockquote><p>ğŸ’¡ <strong>ç¼–ç¨‹å¯ç¤º</strong>ï¼šåœ¨Javaä¸­ï¼Œæ–¹æ³•æœ¬è´¨ä¸Šä¹Ÿæ˜¯å‡½æ•°ï¼Œä½†ç»‘å®šåœ¨å¯¹è±¡ä¹‹ä¸Šã€‚å‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒä¸å˜æ€§ï¼Œè¿™åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­æ„å‘³ç€çº¿ç¨‹å®‰å…¨ã€‚</p></blockquote><h1 id="ğŸ¯-Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼æ¥å£"><a href="#ğŸ¯-Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼æ¥å£" class="headerlink" title="ğŸ¯ Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼æ¥å£"></a>ğŸ¯ Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼æ¥å£</h1><h2 id="ğŸ“-Lambdaè¡¨è¾¾å¼åŸºç¡€"><a href="#ğŸ“-Lambdaè¡¨è¾¾å¼åŸºç¡€" class="headerlink" title="ğŸ“ Lambdaè¡¨è¾¾å¼åŸºç¡€"></a>ğŸ“ Lambdaè¡¨è¾¾å¼åŸºç¡€</h2><p>åœ¨Javaä¸­ï¼ŒLambdaè¡¨è¾¾å¼æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒè¯­æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</p><h3 id="ğŸ”„-Lambdaè¡¨è¾¾å¼çš„ä¸¤ç§å½¢å¼"><a href="#ğŸ”„-Lambdaè¡¨è¾¾å¼çš„ä¸¤ç§å½¢å¼" class="headerlink" title="ğŸ”„ Lambdaè¡¨è¾¾å¼çš„ä¸¤ç§å½¢å¼"></a>ğŸ”„ Lambdaè¡¨è¾¾å¼çš„ä¸¤ç§å½¢å¼</h3><ol><li><strong>Lambdaè¡¨è¾¾å¼</strong>ï¼š<code>(å‚æ•°) -&gt; è¡¨è¾¾å¼</code></li><li><strong>æ–¹æ³•å¼•ç”¨</strong>ï¼š<code>ç±»å::æ–¹æ³•å</code> æˆ– <code>å¯¹è±¡::æ–¹æ³•å</code></li></ol><h3 id="ğŸ“‹-Lambdaè¡¨è¾¾å¼è¯­æ³•è§„åˆ™"><a href="#ğŸ“‹-Lambdaè¡¨è¾¾å¼è¯­æ³•è§„åˆ™" class="headerlink" title="ğŸ“‹ Lambdaè¡¨è¾¾å¼è¯­æ³•è§„åˆ™"></a>ğŸ“‹ Lambdaè¡¨è¾¾å¼è¯­æ³•è§„åˆ™</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å•è¡Œè¡¨è¾¾å¼ï¼Œå¯ä»¥çœç•¥å¤§æ‹¬å·å’Œreturn</span></span><br><span class="line">(<span class="type">int</span> a, <span class="type">int</span> b) -&gt; a + b</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å¤šè¡Œä»£ç ï¼Œå¿…é¡»ä½¿ç”¨å¤§æ‹¬å·å’Œreturn</span></span><br><span class="line">(<span class="type">int</span> a, <span class="type">int</span> b) -&gt; &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> a + b;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å‚æ•°ç±»å‹å¯ä»¥çœç•¥ï¼ˆç±»å‹æ¨æ–­ï¼‰</span></span><br><span class="line">(a, b) -&gt; a + b</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. å•ä¸ªå‚æ•°å¯ä»¥çœç•¥æ‹¬å·</span></span><br><span class="line">a -&gt; a * <span class="number">2</span></span><br></pre></td></tr></table></figure><h3 id="ğŸ”Œ-å‡½æ•°å¼æ¥å£"><a href="#ğŸ”Œ-å‡½æ•°å¼æ¥å£" class="headerlink" title="ğŸ”Œ å‡½æ•°å¼æ¥å£"></a>ğŸ”Œ å‡½æ•°å¼æ¥å£</h3><p>Lambdaè¡¨è¾¾å¼çš„ç±»å‹ç”±<strong>å‡½æ•°å¼æ¥å£</strong>å†³å®šã€‚å‡½æ•°å¼æ¥å£æ˜¯åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ’»-å®é™…ä»£ç ç¤ºä¾‹"><a href="#ğŸ’»-å®é™…ä»£ç ç¤ºä¾‹" class="headerlink" title="ğŸ’» å®é™…ä»£ç ç¤ºä¾‹"></a>ğŸ’» å®é™…ä»£ç ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LambdaExamples</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</span></span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IntCalculator</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DoubleCalculator</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="title function_">calculate</span><span class="params">(<span class="type">double</span> a, <span class="type">double</span> b)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ˜ç¡®æŒ‡å®šå‚æ•°ç±»å‹</span></span><br><span class="line">        <span class="type">IntCalculator</span> <span class="variable">lambda1</span> <span class="operator">=</span> (<span class="type">int</span> a, <span class="type">int</span> b) -&gt; a + b;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. ä½¿ç”¨ç±»å‹æ¨æ–­ï¼ˆæ¨èï¼‰</span></span><br><span class="line">        <span class="type">IntCalculator</span> <span class="variable">lambda2</span> <span class="operator">=</span> (a, b) -&gt; a + b;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. å¤šè¡Œä»£ç </span></span><br><span class="line">        <span class="type">IntCalculator</span> <span class="variable">lambda3</span> <span class="operator">=</span> (a, b) -&gt; &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> a + b;</span><br><span class="line">        <span class="keyword">return</span> c + <span class="number">1</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. ä¸åŒè¿”å›ç±»å‹</span></span><br><span class="line">        <span class="type">DoubleCalculator</span> <span class="variable">lambda4</span> <span class="operator">=</span> (a, b) -&gt; a + b;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æµ‹è¯•</span></span><br><span class="line">        System.out.println(lambda1.calculate(<span class="number">5</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º: 8</span></span><br><span class="line">        System.out.println(lambda2.calculate(<span class="number">5</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º: 8</span></span><br><span class="line">        System.out.println(lambda3.calculate(<span class="number">5</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º: 9</span></span><br><span class="line">        System.out.println(lambda4.calculate(<span class="number">5.5</span>, <span class="number">3.2</span>)); <span class="comment">// è¾“å‡º: 8.7</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ”—-æ–¹æ³•å¼•ç”¨"><a href="#ğŸ”—-æ–¹æ³•å¼•ç”¨" class="headerlink" title="ğŸ”— æ–¹æ³•å¼•ç”¨"></a>ğŸ”— æ–¹æ³•å¼•ç”¨</h2><p>æ–¹æ³•å¼•ç”¨æ˜¯Lambdaè¡¨è¾¾å¼çš„ç®€åŒ–å†™æ³•ï¼Œå½“Lambdaè¡¨è¾¾å¼åªæ˜¯è°ƒç”¨ä¸€ä¸ªå·²å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ã€‚</p><h3 id="ğŸ“š-æ–¹æ³•å¼•ç”¨çš„å››ç§ç±»å‹"><a href="#ğŸ“š-æ–¹æ³•å¼•ç”¨çš„å››ç§ç±»å‹" class="headerlink" title="ğŸ“š æ–¹æ³•å¼•ç”¨çš„å››ç§ç±»å‹"></a>ğŸ“š æ–¹æ³•å¼•ç”¨çš„å››ç§ç±»å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MethodReferenceExamples</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å­¦ç”Ÿç±»</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">        <span class="keyword">private</span> String sex;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age, String sex)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">            <span class="built_in">this</span>.sex = sex;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123; <span class="keyword">return</span> age; &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123; <span class="keyword">return</span> sex; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. ç±»å::é™æ€æ–¹æ³•</span></span><br><span class="line">        <span class="type">IntBinaryOperator</span> <span class="variable">max</span> <span class="operator">=</span> Math::max;</span><br><span class="line">        System.out.println(max.applyAsInt(<span class="number">5</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡º: 5</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. ç±»å::å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Function&lt;Student, String&gt; getName = Student::getName;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        System.out.println(getName.apply(student)); <span class="comment">// è¾“å‡º: å¼ ä¸‰</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. å¯¹è±¡::å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Consumer&lt;String&gt; printer = System.out::println;</span><br><span class="line">        printer.accept(<span class="string">&quot;Hello World&quot;</span>); <span class="comment">// è¾“å‡º: Hello World</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. ç±»å::new (æ„é€ æ–¹æ³•å¼•ç”¨)</span></span><br><span class="line">        Supplier&lt;Student&gt; studentCreator = Student::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">newStudent</span> <span class="operator">=</span> studentCreator.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="âš–ï¸-æ–¹æ³•å¼•ç”¨ä¸Lambdaè¡¨è¾¾å¼å¯¹æ¯”"><a href="#âš–ï¸-æ–¹æ³•å¼•ç”¨ä¸Lambdaè¡¨è¾¾å¼å¯¹æ¯”" class="headerlink" title="âš–ï¸ æ–¹æ³•å¼•ç”¨ä¸Lambdaè¡¨è¾¾å¼å¯¹æ¯”"></a>âš–ï¸ æ–¹æ³•å¼•ç”¨ä¸Lambdaè¡¨è¾¾å¼å¯¹æ¯”</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MethodReferenceComparison</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name)</span> &#123; <span class="built_in">this</span>.name = name; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123; <span class="built_in">this</span>.name = name; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// æ–¹æ³•å¼•ç”¨ vs Lambdaè¡¨è¾¾å¼å¯¹æ¯”</span></span><br><span class="line">        <span class="comment">// 1. é™æ€æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Supplier&lt;Double&gt; random1 = Math::random;           <span class="comment">// æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Supplier&lt;Double&gt; random2 = () -&gt; Math.random();  <span class="comment">// Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">        <span class="comment">// 2. å®ä¾‹æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Function&lt;Student, String&gt; getName1 = Student::getName;           <span class="comment">// æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Function&lt;Student, String&gt; getName2 = student -&gt; student.getName(); <span class="comment">// Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">        <span class="comment">// 3. å¯¹è±¡æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Consumer&lt;String&gt; print1 = System.out::println;           <span class="comment">// æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Consumer&lt;String&gt; print2 = str -&gt; System.out.println(str); <span class="comment">// Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">        <span class="comment">// 4. æ„é€ æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Supplier&lt;Student&gt; create1 = Student::<span class="keyword">new</span>;           <span class="comment">// æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        Supplier&lt;Student&gt; create2 = () -&gt; <span class="keyword">new</span> <span class="title class_">Student</span>();     <span class="comment">// Lambdaè¡¨è¾¾å¼        </span></span><br><span class="line">        <span class="comment">// æµ‹è¯•</span></span><br><span class="line">        System.out.println(random1.get());</span><br><span class="line">        System.out.println(getName1.apply(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>)));</span><br><span class="line">        print1.accept(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">        System.out.println(create1.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>é€‰æ‹©å»ºè®®</strong>ï¼šå½“Lambdaè¡¨è¾¾å¼åªæ˜¯ç®€å•è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä½¿ç”¨æ–¹æ³•å¼•ç”¨æ›´ç®€æ´ï¼›å½“éœ€è¦å¤æ‚é€»è¾‘æ—¶ï¼Œä½¿ç”¨Lambdaè¡¨è¾¾å¼ã€‚</p></blockquote><h1 id="ğŸ› ï¸-Javaå†…ç½®å‡½æ•°å¼æ¥å£"><a href="#ğŸ› ï¸-Javaå†…ç½®å‡½æ•°å¼æ¥å£" class="headerlink" title="ğŸ› ï¸ Javaå†…ç½®å‡½æ•°å¼æ¥å£"></a>ğŸ› ï¸ Javaå†…ç½®å‡½æ•°å¼æ¥å£</h1><h2 id="ğŸ¨-è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£"><a href="#ğŸ¨-è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£" class="headerlink" title="ğŸ¨ è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£"></a>ğŸ¨ è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</h2><p>åœ¨Java 8ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å®šä¹‰å‡½æ•°å¼æ¥å£ã€‚ç°åœ¨è™½ç„¶æœ‰äº†å†…ç½®æ¥å£ï¼Œä½†äº†è§£è‡ªå®šä¹‰æ¥å£æœ‰åŠ©äºç†è§£å‡½æ•°å¼ç¼–ç¨‹çš„æœ¬è´¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomFunctionalInterfaces</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£ç¤ºä¾‹</span></span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IntPredicate</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IntCalculator</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StudentExtractor</span>&lt;T&gt; &#123;</span><br><span class="line">        T <span class="title function_">getInfo</span><span class="params">(Student student)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TriFunction</span>&lt;T, U, V, R&gt; &#123;</span><br><span class="line">        R <span class="title function_">apply</span><span class="params">(T t, U u, V v)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">IntPredicate</span> <span class="variable">isEven</span> <span class="operator">=</span> a -&gt; (a &amp; <span class="number">1</span>) == <span class="number">0</span>;</span><br><span class="line">        <span class="type">IntCalculator</span> <span class="variable">add</span> <span class="operator">=</span> (a, b) -&gt; a + b;</span><br><span class="line">        StudentExtractor&lt;String&gt; getName = Student::getName;</span><br><span class="line">        TriFunction&lt;Integer, Integer, Integer, Integer&gt; addThree = (a, b, c) -&gt; a + b + c;</span><br><span class="line">        </span><br><span class="line">        System.out.println(isEven.test(<span class="number">4</span>));        <span class="comment">// true</span></span><br><span class="line">        System.out.println(add.calculate(<span class="number">3</span>, <span class="number">5</span>));   <span class="comment">// 8</span></span><br><span class="line">        System.out.println(addThree.apply(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// 6</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ—ï¸-Javaå†…ç½®å‡½æ•°å¼æ¥å£"><a href="#ğŸ—ï¸-Javaå†…ç½®å‡½æ•°å¼æ¥å£" class="headerlink" title="ğŸ—ï¸ Javaå†…ç½®å‡½æ•°å¼æ¥å£"></a>ğŸ—ï¸ Javaå†…ç½®å‡½æ•°å¼æ¥å£</h2><p>Java 8æä¾›äº†ä¸°å¯Œçš„å†…ç½®å‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬ä¸éœ€è¦é‡å¤é€ è½®å­ï¼š</p><h3 id="â­-æ ¸å¿ƒå‡½æ•°å¼æ¥å£"><a href="#â­-æ ¸å¿ƒå‡½æ•°å¼æ¥å£" class="headerlink" title="â­ æ ¸å¿ƒå‡½æ•°å¼æ¥å£"></a>â­ æ ¸å¿ƒå‡½æ•°å¼æ¥å£</h3><table><thead><tr><th>æ¥å£</th><th>å‚æ•°</th><th>è¿”å›å€¼</th><th>ç”¨é€”</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>Function&lt;T,R&gt;</code></td><td>1ä¸ªT</td><td>R</td><td>è½¬æ¢</td><td><code>Function&lt;String,Integer&gt; f = Integer::parseInt</code></td></tr><tr><td><code>BiFunction&lt;T,U,R&gt;</code></td><td>2ä¸ª(T,U)</td><td>R</td><td>äºŒå…ƒè½¬æ¢</td><td><code>BiFunction&lt;String,String,Integer&gt; f = (a,b) -&gt; a.length() + b.length()</code></td></tr><tr><td><code>Consumer&lt;T&gt;</code></td><td>1ä¸ªT</td><td>void</td><td>æ¶ˆè´¹</td><td><code>Consumer&lt;String&gt; c = System.out::println</code></td></tr><tr><td><code>BiConsumer&lt;T,U&gt;</code></td><td>2ä¸ª(T,U)</td><td>void</td><td>äºŒå…ƒæ¶ˆè´¹</td><td><code>BiConsumer&lt;String,Integer&gt; c = (s,i) -&gt; System.out.println(s + i)</code></td></tr><tr><td><code>Predicate&lt;T&gt;</code></td><td>1ä¸ªT</td><td>boolean</td><td>åˆ¤æ–­</td><td><code>Predicate&lt;String&gt; p = s -&gt; s.length() &gt; 5</code></td></tr><tr><td><code>BiPredicate&lt;T,U&gt;</code></td><td>2ä¸ª(T,U)</td><td>boolean</td><td>äºŒå…ƒåˆ¤æ–­</td><td><code>BiPredicate&lt;String,String&gt; p = (a,b) -&gt; a.equals(b)</code></td></tr><tr><td><code>Supplier&lt;T&gt;</code></td><td>æ— </td><td>T</td><td>æä¾›</td><td><code>Supplier&lt;String&gt; s = () -&gt; &quot;Hello&quot;</code></td></tr></tbody></table><h3 id="ğŸ¯-ç‰¹æ®ŠåŒ–æ¥å£"><a href="#ğŸ¯-ç‰¹æ®ŠåŒ–æ¥å£" class="headerlink" title="ğŸ¯ ç‰¹æ®ŠåŒ–æ¥å£"></a>ğŸ¯ ç‰¹æ®ŠåŒ–æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuiltInFunctionalInterfaces</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. Functionç³»åˆ— - æœ‰å‚æœ‰è¿”å›å€¼</span></span><br><span class="line">        Function&lt;String, Integer&gt; stringToInt = Integer::parseInt;</span><br><span class="line">        BiFunction&lt;String, String, Integer&gt; addLengths = (a, b) -&gt; a.length() + b.length();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. Consumerç³»åˆ— - æœ‰å‚æ— è¿”å›å€¼</span></span><br><span class="line">        Consumer&lt;String&gt; printer = System.out::println;</span><br><span class="line">        BiConsumer&lt;String, Integer&gt; printWithNumber = (s, i) -&gt; System.out.println(s + <span class="string">&quot;: &quot;</span> + i);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. Predicateç³»åˆ— - æœ‰å‚è¿”å›boolean</span></span><br><span class="line">        Predicate&lt;Integer&gt; isEven = n -&gt; n % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">        BiPredicate&lt;String, String&gt; isEqual = String::equals;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. Supplierç³»åˆ— - æ— å‚æœ‰è¿”å›å€¼</span></span><br><span class="line">        Supplier&lt;String&gt; greeting = () -&gt; <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">        Supplier&lt;LocalDateTime&gt; now = LocalDateTime::now;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æµ‹è¯•</span></span><br><span class="line">        System.out.println(stringToInt.apply(<span class="string">&quot;123&quot;</span>));     <span class="comment">// 123</span></span><br><span class="line">        System.out.println(addLengths.apply(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>)); <span class="comment">// 10</span></span><br><span class="line">        printer.accept(<span class="string">&quot;Hello&quot;</span>);                          <span class="comment">// Hello</span></span><br><span class="line">        printWithNumber.accept(<span class="string">&quot;Count&quot;</span>, <span class="number">5</span>);              <span class="comment">// Count: 5</span></span><br><span class="line">        System.out.println(isEven.test(<span class="number">4</span>));               <span class="comment">// true</span></span><br><span class="line">        System.out.println(isEqual.test(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;hello&quot;</span>)); <span class="comment">// true</span></span><br><span class="line">        System.out.println(greeting.get());               <span class="comment">// Hello World</span></span><br><span class="line">        System.out.println(now.get());                   <span class="comment">// å½“å‰æ—¶é—´</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸš€-åŸå§‹ç±»å‹ç‰¹åŒ–æ¥å£"><a href="#ğŸš€-åŸå§‹ç±»å‹ç‰¹åŒ–æ¥å£" class="headerlink" title="ğŸš€ åŸå§‹ç±»å‹ç‰¹åŒ–æ¥å£"></a>ğŸš€ åŸå§‹ç±»å‹ç‰¹åŒ–æ¥å£</h3><p>Javaè¿˜æä¾›äº†åŸå§‹ç±»å‹çš„ç‰¹åŒ–æ¥å£ï¼Œé¿å…è£…ç®±æ‹†ç®±ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IntFunction, LongFunction, DoubleFunction</span></span><br><span class="line">IntFunction&lt;String&gt; intToString = String::valueOf;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IntConsumer, LongConsumer, DoubleConsumer  </span></span><br><span class="line"><span class="type">IntConsumer</span> <span class="variable">intPrinter</span> <span class="operator">=</span> System.out::println;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IntPredicate, LongPredicate, DoublePredicate</span></span><br><span class="line"><span class="type">IntPredicate</span> <span class="variable">isPositive</span> <span class="operator">=</span> n -&gt; n &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IntSupplier, LongSupplier, DoubleSupplier</span></span><br><span class="line"><span class="type">IntSupplier</span> <span class="variable">randomInt</span> <span class="operator">=</span> () -&gt; <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">100</span>);</span><br></pre></td></tr></table></figure><h2 id="ğŸª-å®é™…åº”ç”¨ç¤ºä¾‹"><a href="#ğŸª-å®é™…åº”ç”¨ç¤ºä¾‹" class="headerlink" title="ğŸª å®é™…åº”ç”¨ç¤ºä¾‹"></a>ğŸª å®é™…åº”ç”¨ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FunctionalInterfaceExamples</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">        <span class="keyword">private</span> String sex;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age, String sex)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">            <span class="built_in">this</span>.sex = sex;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123; <span class="keyword">return</span> age; &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123; <span class="keyword">return</span> sex; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Student&#123;name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;, age=&quot;</span> + age + <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&quot;&#x27;&#125;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. Predicate - æ¡ä»¶åˆ¤æ–­</span></span><br><span class="line">        Predicate&lt;Integer&gt; isEven = a -&gt; (a &amp; <span class="number">1</span>) == <span class="number">0</span>;</span><br><span class="line">        Predicate&lt;Integer&gt; isPrime = a -&gt; BigDecimal.valueOf(a).toBigInteger().isProbablePrime(<span class="number">100</span>);</span><br><span class="line">        Predicate&lt;Student&gt; isAdult = student -&gt; student.getAge() &gt; <span class="number">18</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. Function - æ•°æ®è½¬æ¢</span></span><br><span class="line">        Function&lt;Student, String&gt; getName = Student::getName;</span><br><span class="line">        Function&lt;Student, Integer&gt; getAge = Student::getAge;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. BiFunction - äºŒå…ƒæ“ä½œ</span></span><br><span class="line">        BiFunction&lt;Integer, Integer, Integer&gt; add = Integer::sum;</span><br><span class="line">        BiFunction&lt;Integer, Integer, Integer&gt; subtract = (a, b) -&gt; a - b;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. TriFunction - ä¸‰å…ƒæ“ä½œï¼ˆè‡ªå®šä¹‰ï¼‰</span></span><br><span class="line">        TriFunction&lt;Integer, Integer, Integer, Integer&gt; addThree = (a, b, c) -&gt; a + b + c;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5. Supplier - æ•°æ®æä¾›</span></span><br><span class="line">        Supplier&lt;Student&gt; studentSupplier = () -&gt; <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>, <span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        Supplier&lt;List&lt;Student&gt;&gt; studentListSupplier = () -&gt; &#123;</span><br><span class="line">            List&lt;Student&gt; students = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>, <span class="string">&quot;ç”·&quot;</span>));</span><br><span class="line">            students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;æå››&quot;</span>, <span class="number">20</span>, <span class="string">&quot;å¥³&quot;</span>));</span><br><span class="line">            students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;ç‹äº”&quot;</span>, <span class="number">16</span>, <span class="string">&quot;ç”·&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> students;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æµ‹è¯•</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å¶æ•°åˆ¤æ–­: &quot;</span> + isEven.test(<span class="number">4</span>));           <span class="comment">// true</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ç´ æ•°åˆ¤æ–­: &quot;</span> + isPrime.test(<span class="number">17</span>));         <span class="comment">// true</span></span><br><span class="line">        System.out.println(<span class="string">&quot;åŠ æ³•è¿ç®—: &quot;</span> + add.apply(<span class="number">3</span>, <span class="number">5</span>));         <span class="comment">// 8</span></span><br><span class="line">        System.out.println(<span class="string">&quot;å‡æ³•è¿ç®—: &quot;</span> + subtract.apply(<span class="number">10</span>, <span class="number">3</span>));   <span class="comment">// 7</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‰å…ƒåŠ æ³•: &quot;</span> + addThree.apply(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// 6</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> studentSupplier.get();</span><br><span class="line">        System.out.println(<span class="string">&quot;å­¦ç”Ÿä¿¡æ¯: &quot;</span> + student);</span><br><span class="line">        System.out.println(<span class="string">&quot;å­¦ç”Ÿå§“å: &quot;</span> + getName.apply(student));</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦æˆå¹´: &quot;</span> + isAdult.test(student));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é«˜é˜¶å‡½æ•°ç¤ºä¾‹</span></span><br><span class="line">        List&lt;Student&gt; students = studentListSupplier.get();</span><br><span class="line">        students.stream()</span><br><span class="line">                .filter(isAdult)</span><br><span class="line">                .map(getName)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é«˜é˜¶å‡½æ•°ï¼šæ¥å—å‡½æ•°ä½œä¸ºå‚æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testPredicate</span><span class="params">(Student student, Predicate&lt;Student&gt; predicate)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (predicate.test(student)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¡ä»¶æ»¡è¶³: &quot;</span> + student);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¡ä»¶ä¸æ»¡è¶³: &quot;</span> + student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># ğŸ” æ–¹æ³•å¼•ç”¨è¯¦è§£</span><br><span class="line"></span><br><span class="line">æ–¹æ³•å¼•ç”¨æ˜¯Lambdaè¡¨è¾¾å¼çš„ç®€åŒ–å½¢å¼ï¼Œå½“Lambdaè¡¨è¾¾å¼åªæ˜¯è°ƒç”¨ä¸€ä¸ªå·²å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ã€‚</span><br><span class="line">## ğŸ­ å…­ç§æ–¹æ³•å¼•ç”¨ç±»å‹</span><br><span class="line"></span><br><span class="line">### 1ï¸âƒ£ ç±»å::é™æ€æ–¹æ³•</span><br><span class="line">è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•ï¼Œå‚æ•°ç±»å‹å’Œæ•°é‡å¿…é¡»åŒ¹é…ã€‚</span><br><span class="line">```java</span><br><span class="line">public class StaticMethodReference &#123;</span><br><span class="line">    </span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        // Mathç±»çš„é™æ€æ–¹æ³•</span><br><span class="line">        Function&lt;Double, Double&gt; abs = Math::abs;</span><br><span class="line">        BiFunction&lt;Integer, Integer, Integer&gt; max = Math::max;</span><br><span class="line">        </span><br><span class="line">        // è‡ªå®šä¹‰é™æ€æ–¹æ³•</span><br><span class="line">        Function&lt;String, String&gt; toUpperCase = StringUtils::toUpperCase;</span><br><span class="line">        </span><br><span class="line">        System.out.println(abs.apply(-5.5));        // 5.5</span><br><span class="line">        System.out.println(max.apply(10, 20));      // 20</span><br><span class="line">        System.out.println(toUpperCase.apply(&quot;hello&quot;)); // HELLO</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    static class StringUtils &#123;</span><br><span class="line">        public static String toUpperCase(String str) &#123;</span><br><span class="line">            return str.toUpperCase();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-ç±»å-å®ä¾‹æ–¹æ³•"><a href="#2ï¸âƒ£-ç±»å-å®ä¾‹æ–¹æ³•" class="headerlink" title="2ï¸âƒ£ ç±»å::å®ä¾‹æ–¹æ³•"></a>2ï¸âƒ£ ç±»å::å®ä¾‹æ–¹æ³•</h3><p>è°ƒç”¨å®ä¾‹æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ–¹æ³•è°ƒç”¨çš„å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InstanceMethodReference</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Stringçš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Function&lt;String, Integer&gt; getLength = String::length;</span><br><span class="line">        BiFunction&lt;String, String, String&gt; concat = String::concat;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰ç±»çš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Function&lt;Student, String&gt; getName = Student::getName;</span><br><span class="line">        </span><br><span class="line">        System.out.println(getLength.apply(<span class="string">&quot;Hello&quot;</span>));           <span class="comment">// 5</span></span><br><span class="line">        System.out.println(concat.apply(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>));     <span class="comment">// HelloWorld</span></span><br><span class="line">        System.out.println(getName.apply(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>))); <span class="comment">// å¼ ä¸‰</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ï¸âƒ£-å¯¹è±¡-å®ä¾‹æ–¹æ³•"><a href="#3ï¸âƒ£-å¯¹è±¡-å®ä¾‹æ–¹æ³•" class="headerlink" title="3ï¸âƒ£ å¯¹è±¡::å®ä¾‹æ–¹æ³•"></a>3ï¸âƒ£ å¯¹è±¡::å®ä¾‹æ–¹æ³•</h3><p>è°ƒç”¨ç‰¹å®šå¯¹è±¡çš„å®ä¾‹æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectMethodReference</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// System.outçš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Consumer&lt;String&gt; printer = System.out::println;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰å¯¹è±¡çš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        Consumer&lt;String&gt; append = sb::append;</span><br><span class="line">        </span><br><span class="line">        printer.accept(<span class="string">&quot;Hello World&quot;</span>);  <span class="comment">// Hello World</span></span><br><span class="line">        append.accept(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">        append.accept(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        append.accept(<span class="string">&quot;World&quot;</span>);</span><br><span class="line">        System.out.println(sb.toString()); <span class="comment">// Hello World</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ï¸âƒ£-ç±»å-new-æ„é€ æ–¹æ³•å¼•ç”¨"><a href="#4ï¸âƒ£-ç±»å-new-æ„é€ æ–¹æ³•å¼•ç”¨" class="headerlink" title="4ï¸âƒ£ ç±»å::new (æ„é€ æ–¹æ³•å¼•ç”¨)"></a>4ï¸âƒ£ ç±»å::new (æ„é€ æ–¹æ³•å¼•ç”¨)</h3><p>è°ƒç”¨æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorReference</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="built_in">this</span>.age = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Person&#123;name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;, age=&quot;</span> + age + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// æ— å‚æ„é€ æ–¹æ³•</span></span><br><span class="line">        Supplier&lt;Person&gt; createDefault = Person::<span class="keyword">new</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å•å‚æ„é€ æ–¹æ³•</span></span><br><span class="line">        Function&lt;String, Person&gt; createWithName = Person::<span class="keyword">new</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åŒå‚æ„é€ æ–¹æ³•</span></span><br><span class="line">        BiFunction&lt;String, Integer, Person&gt; createWithNameAndAge = Person::<span class="keyword">new</span>;</span><br><span class="line">        </span><br><span class="line">        System.out.println(createDefault.get());                           <span class="comment">// Person&#123;name=&#x27;Unknown&#x27;, age=0&#125;</span></span><br><span class="line">        System.out.println(createWithName.apply(<span class="string">&quot;å¼ ä¸‰&quot;</span>));                 <span class="comment">// Person&#123;name=&#x27;å¼ ä¸‰&#x27;, age=0&#125;</span></span><br><span class="line">        System.out.println(createWithNameAndAge.apply(<span class="string">&quot;æå››&quot;</span>, <span class="number">25</span>));        <span class="comment">// Person&#123;name=&#x27;æå››&#x27;, age=25&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ï¸âƒ£-this-å®ä¾‹æ–¹æ³•"><a href="#5ï¸âƒ£-this-å®ä¾‹æ–¹æ³•" class="headerlink" title="5ï¸âƒ£ this::å®ä¾‹æ–¹æ³•"></a>5ï¸âƒ£ this::å®ä¾‹æ–¹æ³•</h3><p>åœ¨ç±»å†…éƒ¨å¼•ç”¨å½“å‰å¯¹è±¡çš„å®ä¾‹æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThisMethodReference</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processStudents</span><span class="params">(List&lt;Student&gt; students)</span> &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨this::isAdultä½œä¸ºè¿‡æ»¤å™¨</span></span><br><span class="line">        students.stream()</span><br><span class="line">                .filter(<span class="built_in">this</span>::isAdult)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isAdult</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> student.getAge() &gt;= <span class="number">18</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ThisMethodReference</span> <span class="variable">processor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThisMethodReference</span>();</span><br><span class="line">        List&lt;Student&gt; students = Arrays.asList(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;æå››&quot;</span>, <span class="number">16</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;ç‹äº”&quot;</span>, <span class="number">22</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">        processor.processStudents(students);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ï¸âƒ£-super-å®ä¾‹æ–¹æ³•"><a href="#6ï¸âƒ£-super-å®ä¾‹æ–¹æ³•" class="headerlink" title="6ï¸âƒ£ super::å®ä¾‹æ–¹æ³•"></a>6ï¸âƒ£ super::å®ä¾‹æ–¹æ³•</h3><p>åœ¨å­ç±»ä¸­å¼•ç”¨çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuperMethodReference</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">printInfo</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Parent: &quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">printInfo</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Child: &quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processData</span><span class="params">(List&lt;String&gt; data)</span> &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨super::printInfoè°ƒç”¨çˆ¶ç±»æ–¹æ³•</span></span><br><span class="line">            data.forEach(<span class="built_in">super</span>::printInfo);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Child</span> <span class="variable">child</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>();</span><br><span class="line">        List&lt;String&gt; data = Arrays.asList(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>, <span class="string">&quot;Java&quot;</span>);</span><br><span class="line">        child.processData(data);</span><br><span class="line">        <span class="comment">// è¾“å‡º:</span></span><br><span class="line">        <span class="comment">// Parent: Hello</span></span><br><span class="line">        <span class="comment">// Parent: World  </span></span><br><span class="line">        <span class="comment">// Parent: Java</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ“–-æ–¹æ³•å¼•ç”¨é€‰æ‹©æŒ‡å—"><a href="#ğŸ“–-æ–¹æ³•å¼•ç”¨é€‰æ‹©æŒ‡å—" class="headerlink" title="ğŸ“– æ–¹æ³•å¼•ç”¨é€‰æ‹©æŒ‡å—"></a>ğŸ“– æ–¹æ³•å¼•ç”¨é€‰æ‹©æŒ‡å—</h2><table><thead><tr><th>åœºæ™¯</th><th>æ–¹æ³•å¼•ç”¨ç±»å‹</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>è°ƒç”¨é™æ€æ–¹æ³•</td><td><code>ç±»å::é™æ€æ–¹æ³•</code></td><td><code>Math::max</code></td></tr><tr><td>è°ƒç”¨å®ä¾‹æ–¹æ³•</td><td><code>ç±»å::å®ä¾‹æ–¹æ³•</code></td><td><code>String::length</code></td></tr><tr><td>è°ƒç”¨å¯¹è±¡æ–¹æ³•</td><td><code>å¯¹è±¡::å®ä¾‹æ–¹æ³•</code></td><td><code>System.out::println</code></td></tr><tr><td>åˆ›å»ºå¯¹è±¡</td><td><code>ç±»å::new</code></td><td><code>ArrayList::new</code></td></tr><tr><td>ç±»å†…éƒ¨å¼•ç”¨</td><td><code>this::æ–¹æ³•</code></td><td><code>this::isValid</code></td></tr><tr><td>å­ç±»å¼•ç”¨çˆ¶ç±»</td><td><code>super::æ–¹æ³•</code></td><td><code>super::toString</code></td></tr></tbody></table><blockquote><p>ğŸ’¡ <strong>æœ€ä½³å®è·µ</strong>ï¼šä¼˜å…ˆä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼Œå®ƒæ¯”Lambdaè¡¨è¾¾å¼æ›´ç®€æ´ï¼Œæ„å›¾æ›´æ˜ç¡®ã€‚</p></blockquote><h1 id="ğŸ”-é—­åŒ…ä¸æŸ¯é‡ŒåŒ–"><a href="#ğŸ”-é—­åŒ…ä¸æŸ¯é‡ŒåŒ–" class="headerlink" title="ğŸ” é—­åŒ…ä¸æŸ¯é‡ŒåŒ–"></a>ğŸ” é—­åŒ…ä¸æŸ¯é‡ŒåŒ–</h1><h2 id="ğŸª-é—­åŒ…ï¼ˆClosureï¼‰"><a href="#ğŸª-é—­åŒ…ï¼ˆClosureï¼‰" class="headerlink" title="ğŸª é—­åŒ…ï¼ˆClosureï¼‰"></a>ğŸª é—­åŒ…ï¼ˆClosureï¼‰</h2><p>é—­åŒ…æ˜¯æŒ‡<strong>å‡½æ•°å¯¹è±¡</strong>ä¸<strong>å¤–éƒ¨å˜é‡</strong>ç»‘å®šåœ¨ä¸€èµ·å½¢æˆçš„æ•´ä½“ã€‚åœ¨Javaä¸­ï¼ŒLambdaè¡¨è¾¾å¼å¯ä»¥æ•è·å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚</p><h3 id="ğŸ§©-é—­åŒ…çš„åŸºæœ¬æ¦‚å¿µ"><a href="#ğŸ§©-é—­åŒ…çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ğŸ§© é—­åŒ…çš„åŸºæœ¬æ¦‚å¿µ"></a>ğŸ§© é—­åŒ…çš„åŸºæœ¬æ¦‚å¿µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosureExample</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">10</span>; <span class="comment">// å¤–éƒ¨å˜é‡</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Lambdaè¡¨è¾¾å¼æ•è·äº†å¤–éƒ¨å˜é‡xï¼Œå½¢æˆé—­åŒ…</span></span><br><span class="line">        Function&lt;Integer, Integer&gt; addX = y -&gt; x + y;</span><br><span class="line">        </span><br><span class="line">        System.out.println(addX.apply(<span class="number">5</span>)); <span class="comment">// è¾“å‡º: 15</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="âš ï¸-é—­åŒ…çš„é™åˆ¶"><a href="#âš ï¸-é—­åŒ…çš„é™åˆ¶" class="headerlink" title="âš ï¸ é—­åŒ…çš„é™åˆ¶"></a>âš ï¸ é—­åŒ…çš„é™åˆ¶</h3><p>Javaä¸­çš„é—­åŒ…å˜é‡å¿…é¡»æ˜¯<strong>final</strong>æˆ–<strong>effectively final</strong>çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosureLimitations</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ˜¾å¼final</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        Function&lt;Integer, Integer&gt; addA = y -&gt; a + y;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. effectively finalï¼ˆæ²¡æœ‰é‡æ–°èµ‹å€¼ï¼‰</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">        Function&lt;Integer, Integer&gt; addB = y -&gt; b + y;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. é”™è¯¯ç¤ºä¾‹ï¼šä¸æ˜¯effectively final</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">        <span class="comment">// c = 40; // å¦‚æœå–æ¶ˆæ³¨é‡Šï¼Œä¸‹é¢çš„ä»£ç ä¼šç¼–è¯‘é”™è¯¯ï¼Œä½“ç°äº†é—­åŒ…ä¸å¯å˜æ€§å’Œæ— å‰¯ä½œç”¨!</span></span><br><span class="line">        <span class="comment">// Function&lt;Integer, Integer&gt; addC = y -&gt; c + y; // ç¼–è¯‘é”™è¯¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸ¯-é—­åŒ…çš„å®é™…åº”ç”¨"><a href="#ğŸ¯-é—­åŒ…çš„å®é™…åº”ç”¨" class="headerlink" title="ğŸ¯ é—­åŒ…çš„å®é™…åº”ç”¨"></a>ğŸ¯ é—­åŒ…çš„å®é™…åº”ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosureApplications</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºå¤šä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡æœ‰ä¸åŒçš„ç¼–å·</span></span><br><span class="line">        List&lt;Runnable&gt; tasks = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">taskId</span> <span class="operator">=</span> i + <span class="number">1</span>; <span class="comment">// æ¯æ¬¡å¾ªç¯åˆ›å»ºæ–°çš„å˜é‡</span></span><br><span class="line">            <span class="type">Runnable</span> <span class="variable">task</span> <span class="operator">=</span> () -&gt; System.out.println(</span><br><span class="line">                Thread.currentThread().getName() + <span class="string">&quot;: æ‰§è¡Œä»»åŠ¡&quot;</span> + taskId</span><br><span class="line">            );</span><br><span class="line">            tasks.add(task);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨è™šæ‹Ÿçº¿ç¨‹æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newVirtualThreadPerTaskExecutor();</span><br><span class="line">        <span class="keyword">for</span> (Runnable task : tasks) &#123;</span><br><span class="line">            executor.submit(task);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        executor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸ—ï¸-é—­åŒ…ä¸å¯¹è±¡çŠ¶æ€"><a href="#ğŸ—ï¸-é—­åŒ…ä¸å¯¹è±¡çŠ¶æ€" class="headerlink" title="ğŸ—ï¸ é—­åŒ…ä¸å¯¹è±¡çŠ¶æ€"></a>ğŸ—ï¸ é—­åŒ…ä¸å¯¹è±¡çŠ¶æ€</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosureWithObjects</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Counter</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">()</span> &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Counter</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Counter</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Lambdaè¡¨è¾¾å¼æ•è·äº†counterå¯¹è±¡å¼•ç”¨</span></span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">incrementTask</span> <span class="operator">=</span> () -&gt; &#123;</span><br><span class="line">            counter.increment();</span><br><span class="line">            System.out.println(<span class="string">&quot;å½“å‰è®¡æ•°: &quot;</span> + counter.getCount());</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œå¤šæ¬¡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            incrementTask.run();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¾“å‡º:</span></span><br><span class="line">        <span class="comment">// å½“å‰è®¡æ•°: 1</span></span><br><span class="line">        <span class="comment">// å½“å‰è®¡æ•°: 2</span></span><br><span class="line">        <span class="comment">// å½“å‰è®¡æ•°: 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ›-æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰"><a href="#ğŸ›-æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰" class="headerlink" title="ğŸ› æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰"></a>ğŸ› æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰</h2><p>æŸ¯é‡ŒåŒ–æ˜¯å°†æ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢ä¸ºä¸€ç³»åˆ—åªæ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°çš„æŠ€æœ¯ã€‚</p><h3 id="ğŸ”§-æŸ¯é‡ŒåŒ–çš„åŸºæœ¬æ¦‚å¿µ"><a href="#ğŸ”§-æŸ¯é‡ŒåŒ–çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ğŸ”§ æŸ¯é‡ŒåŒ–çš„åŸºæœ¬æ¦‚å¿µ"></a>ğŸ”§ æŸ¯é‡ŒåŒ–çš„åŸºæœ¬æ¦‚å¿µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CurryingExample</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¼ ç»Ÿæ–¹å¼ï¼šæ¥å—ä¸¤ä¸ªå‚æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æŸ¯é‡ŒåŒ–æ–¹å¼ï¼šè¿”å›ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Function&lt;Integer, Integer&gt; <span class="title function_">addCurried</span><span class="params">(<span class="type">int</span> a)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> b -&gt; a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// ä¼ ç»Ÿè°ƒç”¨</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">result1</span> <span class="operator">=</span> add(<span class="number">3</span>, <span class="number">5</span>); <span class="comment">// 8</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æŸ¯é‡ŒåŒ–è°ƒç”¨</span></span><br><span class="line">        Function&lt;Integer, Integer&gt; add3 = addCurried(<span class="number">3</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result2</span> <span class="operator">=</span> add3.apply(<span class="number">5</span>); <span class="comment">// 8</span></span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;ä¼ ç»Ÿæ–¹å¼: &quot;</span> + result1);</span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¯é‡ŒåŒ–æ–¹å¼: &quot;</span> + result2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸš€-æŸ¯é‡ŒåŒ–çš„é«˜çº§åº”ç”¨"><a href="#ğŸš€-æŸ¯é‡ŒåŒ–çš„é«˜çº§åº”ç”¨" class="headerlink" title="ğŸš€ æŸ¯é‡ŒåŒ–çš„é«˜çº§åº”ç”¨"></a>ğŸš€ æŸ¯é‡ŒåŒ–çš„é«˜çº§åº”ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdvancedCurrying</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å®šä¹‰æŸ¯é‡ŒåŒ–æ¥å£</span></span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CurriedFunction</span>&lt;T, U, R&gt; &#123;</span><br><span class="line">        Function&lt;U, R&gt; <span class="title function_">apply</span><span class="params">(T t)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¸‰å…ƒå‡½æ•°çš„æŸ¯é‡ŒåŒ–</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> CurriedFunction&lt;Integer, Integer, Function&lt;Integer, Integer&gt;&gt; </span><br><span class="line">        <span class="title function_">addThreeCurried</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a -&gt; b -&gt; c -&gt; a + b + c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    å«ä¹‰ï¼š</span></span><br><span class="line"><span class="comment">    æ¥å—ä¸€ä¸ª Integer å‚æ•° a</span></span><br><span class="line"><span class="comment">    è¿”å›ä¸€ä¸ª Function&lt;Integer, Function&lt;Integer, Integer&gt;&gt;</span></span><br><span class="line"><span class="comment">    è¿™ä¸ªè¿”å›çš„å‡½æ•°æ¥å— Integer å‚æ•° b</span></span><br><span class="line"><span class="comment">    å†è¿”å›ä¸€ä¸ª Function&lt;Integer, Integer&gt;</span></span><br><span class="line"><span class="comment">    æœ€åè¿™ä¸ªå‡½æ•°æ¥å— Integer å‚æ•° c</span></span><br><span class="line"><span class="comment">    è¿”å›æœ€ç»ˆçš„ Integer ç»“æœ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæŸ¯é‡ŒåŒ–å‡½æ•°</span></span><br><span class="line">        CurriedFunction&lt;Integer, Integer, Function&lt;Integer, Integer&gt;&gt; curriedAdd = </span><br><span class="line">            addThreeCurried();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ†æ­¥åº”ç”¨å‚æ•°</span></span><br><span class="line">        Function&lt;Integer, Function&lt;Integer, Integer&gt;&gt; add5 = curriedAdd.apply(<span class="number">5</span>);</span><br><span class="line">        Function&lt;Integer, Integer&gt; add5And3 = add5.apply(<span class="number">3</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">result</span> <span class="operator">=</span> add5And3.apply(<span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;ç»“æœ: &quot;</span> + result); <span class="comment">// 10</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é“¾å¼è°ƒç”¨</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">result2</span> <span class="operator">=</span> curriedAdd.apply(<span class="number">1</span>).apply(<span class="number">2</span>).apply(<span class="number">3</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;é“¾å¼ç»“æœ: &quot;</span> + result2); <span class="comment">// 6</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸª-æŸ¯é‡ŒåŒ–çš„å®é™…åº”ç”¨åœºæ™¯"><a href="#ğŸª-æŸ¯é‡ŒåŒ–çš„å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="ğŸª æŸ¯é‡ŒåŒ–çš„å®é™…åº”ç”¨åœºæ™¯"></a>ğŸª æŸ¯é‡ŒåŒ–çš„å®é™…åº”ç”¨åœºæ™¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CurryingApplications</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é…ç½®å‡½æ•°ï¼šå…ˆè®¾ç½®é…ç½®ï¼Œå†å¤„ç†æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Function&lt;String, String&gt; <span class="title function_">createFormatter</span><span class="params">(String prefix, String suffix)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data -&gt; prefix + data + suffix;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// éªŒè¯å‡½æ•°ï¼šå…ˆè®¾ç½®è§„åˆ™ï¼Œå†éªŒè¯æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Predicate&lt;String&gt; <span class="title function_">createValidator</span><span class="params">(<span class="type">int</span> minLength, <span class="type">int</span> maxLength)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> str -&gt; str.length() &gt;= minLength &amp;&amp; str.length() &lt;= maxLength;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ ¼å¼åŒ–å™¨</span></span><br><span class="line">        Function&lt;String, String&gt; formatter = createFormatter(<span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>);</span><br><span class="line">        System.out.println(formatter.apply(<span class="string">&quot;Hello&quot;</span>)); <span class="comment">// [Hello]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºéªŒè¯å™¨</span></span><br><span class="line">        Predicate&lt;String&gt; validator = createValidator(<span class="number">3</span>, <span class="number">10</span>);</span><br><span class="line">        System.out.println(validator.test(<span class="string">&quot;Hi&quot;</span>));     <span class="comment">// false</span></span><br><span class="line">        System.out.println(validator.test(<span class="string">&quot;Hello&quot;</span>));  <span class="comment">// true</span></span><br><span class="line">        System.out.println(validator.test(<span class="string">&quot;VeryLongString&quot;</span>)); <span class="comment">// false</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åœ¨Streamä¸­ä½¿ç”¨</span></span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;Hi&quot;</span>, <span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>, <span class="string">&quot;Java&quot;</span>);</span><br><span class="line">        words.stream()</span><br><span class="line">              .filter(validator)</span><br><span class="line">              .map(formatter)</span><br><span class="line">              .forEach(System.out::println);</span><br><span class="line">        <span class="comment">// è¾“å‡º:</span></span><br><span class="line">        <span class="comment">// [Hello]</span></span><br><span class="line">        <span class="comment">// [World]</span></span><br><span class="line">        <span class="comment">// [Java]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="âœ¨-é—­åŒ…ä¸æŸ¯é‡ŒåŒ–çš„ä¼˜åŠ¿"><a href="#âœ¨-é—­åŒ…ä¸æŸ¯é‡ŒåŒ–çš„ä¼˜åŠ¿" class="headerlink" title="âœ¨ é—­åŒ…ä¸æŸ¯é‡ŒåŒ–çš„ä¼˜åŠ¿"></a>âœ¨ é—­åŒ…ä¸æŸ¯é‡ŒåŒ–çš„ä¼˜åŠ¿</h2><h3 id="1ï¸âƒ£-éƒ¨åˆ†åº”ç”¨ï¼ˆPartial-Applicationï¼‰"><a href="#1ï¸âƒ£-éƒ¨åˆ†åº”ç”¨ï¼ˆPartial-Applicationï¼‰" class="headerlink" title="1ï¸âƒ£ éƒ¨åˆ†åº”ç”¨ï¼ˆPartial Applicationï¼‰"></a>1ï¸âƒ£ éƒ¨åˆ†åº”ç”¨ï¼ˆPartial Applicationï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…ˆå›ºå®šéƒ¨åˆ†å‚æ•°ï¼Œåç»­å†æä¾›å…¶ä»–å‚æ•°</span></span><br><span class="line">Function&lt;Integer, Integer&gt; add5 = addCurried(<span class="number">5</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> add5.apply(<span class="number">3</span>); <span class="comment">// 8</span></span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-å‡½æ•°ç»„åˆ"><a href="#2ï¸âƒ£-å‡½æ•°ç»„åˆ" class="headerlink" title="2ï¸âƒ£ å‡½æ•°ç»„åˆ"></a>2ï¸âƒ£ å‡½æ•°ç»„åˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾¿äºåˆ›å»ºå¯å¤ç”¨çš„å‡½æ•°</span></span><br><span class="line">Function&lt;Integer, Integer&gt; multiplyBy2 = x -&gt; x * <span class="number">2</span>;</span><br><span class="line">Function&lt;Integer, Integer&gt; add5AndMultiplyBy2 = addCurried(<span class="number">5</span>).andThen(multiplyBy2);</span><br></pre></td></tr></table></figure><h3 id="3ï¸âƒ£-å»¶è¿Ÿè®¡ç®—"><a href="#3ï¸âƒ£-å»¶è¿Ÿè®¡ç®—" class="headerlink" title="3ï¸âƒ£ å»¶è¿Ÿè®¡ç®—"></a>3ï¸âƒ£ å»¶è¿Ÿè®¡ç®—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥åœ¨éœ€è¦æ—¶æ‰è®¡ç®—æœ€ç»ˆç»“æœ</span></span><br><span class="line">Supplier&lt;Integer&gt; lazyCalculation = () -&gt; addCurried(<span class="number">10</span>).apply(<span class="number">20</span>);</span><br><span class="line"><span class="type">Integer</span> <span class="variable">result</span> <span class="operator">=</span> lazyCalculation.get(); <span class="comment">// 30</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æ€»ç»“</strong>ï¼šé—­åŒ…è®©å‡½æ•°å¯ä»¥æºå¸¦å¤–éƒ¨çŠ¶æ€ï¼ŒæŸ¯é‡ŒåŒ–è®©å‡½æ•°å¯ä»¥åˆ†æ­¥æ‰§è¡Œï¼Œä¸¤è€…éƒ½æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§ã€‚</p></blockquote><h1 id="ğŸŒŠ-Stream-APIè¯¦è§£"><a href="#ğŸŒŠ-Stream-APIè¯¦è§£" class="headerlink" title="ğŸŒŠ Stream APIè¯¦è§£"></a>ğŸŒŠ Stream APIè¯¦è§£</h1><p>Stream APIæ˜¯Java 8å¼•å…¥çš„å‡½æ•°å¼ç¼–ç¨‹æ ¸å¿ƒï¼Œå®ƒæä¾›äº†ä¸€ç§å£°æ˜å¼çš„æ–¹å¼æ¥å¤„ç†æ•°æ®é›†åˆã€‚</p><blockquote><p>ğŸ“‹ <strong>Stream APIé€ŸæŸ¥è¡¨</strong>ï¼šä¸ºäº†æ–¹ä¾¿æŸ¥é˜…ï¼Œæˆ‘ä¸ºæ‚¨å‡†å¤‡äº†ä¸€ä¸ªè¯¦ç»†çš„Stream APIé€ŸæŸ¥è¡¨ï¼ŒåŒ…å«äº†æ‰€æœ‰å¸¸ç”¨æ“ä½œçš„è¯­æ³•å’Œè¯´æ˜ï¼š<a href="/stream.html" target="_blank">ç‚¹å‡»æŸ¥çœ‹Stream APIé€ŸæŸ¥è¡¨</a></p></blockquote><h2 id="ğŸŒŠ-StreamåŸºç¡€æ¦‚å¿µ"><a href="#ğŸŒŠ-StreamåŸºç¡€æ¦‚å¿µ" class="headerlink" title="ğŸŒŠ StreamåŸºç¡€æ¦‚å¿µ"></a>ğŸŒŠ StreamåŸºç¡€æ¦‚å¿µ</h2><p>Streamæ˜¯ä¸€ä¸ªæ•°æ®æµï¼Œå®ƒæ”¯æŒé¡ºåºå’Œå¹¶è¡Œèšåˆæ“ä½œã€‚Streamä¸æ˜¯æ•°æ®ç»“æ„ï¼Œè€Œæ˜¯å¯¹æ•°æ®æºçš„æŠ½è±¡ã€‚</p><h3 id="âš¡-Streamçš„ç‰¹æ€§"><a href="#âš¡-Streamçš„ç‰¹æ€§" class="headerlink" title="âš¡ Streamçš„ç‰¹æ€§"></a>âš¡ Streamçš„ç‰¹æ€§</h3><ol><li><strong>æƒ°æ€§æ±‚å€¼</strong>ï¼šä¸­é—´æ“ä½œä¸ä¼šç«‹å³æ‰§è¡Œ</li><li><strong>ä¸€æ¬¡ä½¿ç”¨</strong>ï¼šStreamåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡</li><li><strong>å‡½æ•°å¼é£æ ¼</strong>ï¼šæ”¯æŒé“¾å¼è°ƒç”¨</li><li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šæ”¯æŒå¹¶è¡Œæµ</li></ol><h2 id="ğŸ¯-Streamæ“ä½œåˆ†ç±»"><a href="#ğŸ¯-Streamæ“ä½œåˆ†ç±»" class="headerlink" title="ğŸ¯ Streamæ“ä½œåˆ†ç±»"></a>ğŸ¯ Streamæ“ä½œåˆ†ç±»</h2><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå¦‚æœæ‚¨éœ€è¦å¿«é€ŸæŸ¥é˜…Stream APIçš„æ‰€æœ‰æ“ä½œæ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä»¬çš„<a href="/stream.html" target="_blank">Stream APIé€ŸæŸ¥è¡¨</a>ï¼Œå®ƒåŒ…å«äº†å®Œæ•´çš„æ“ä½œåˆ†ç±»å’Œè¯­æ³•è¯´æ˜ã€‚</p></blockquote><h3 id="1ï¸âƒ£-åˆ›å»ºStream"><a href="#1ï¸âƒ£-åˆ›å»ºStream" class="headerlink" title="1ï¸âƒ£ åˆ›å»ºStream"></a>1ï¸âƒ£ åˆ›å»ºStream</h3><h4 id="ğŸ—ï¸-åŸºç¡€åˆ›å»ºæ–¹æ³•"><a href="#ğŸ—ï¸-åŸºç¡€åˆ›å»ºæ–¹æ³•" class="headerlink" title="ğŸ—ï¸ åŸºç¡€åˆ›å»ºæ–¹æ³•"></a>ğŸ—ï¸ åŸºç¡€åˆ›å»ºæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamCreation</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. ä»é›†åˆåˆ›å»º</span></span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;Java&quot;</span>, <span class="string">&quot;Python&quot;</span>, <span class="string">&quot;C++&quot;</span>, <span class="string">&quot;JavaScript&quot;</span>);</span><br><span class="line">        Stream&lt;String&gt; stream1 = list.stream();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. ä»æ•°ç»„åˆ›å»º</span></span><br><span class="line">        String[] array = &#123;<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>, <span class="string">&quot;Java&quot;</span>&#125;;</span><br><span class="line">        Stream&lt;String&gt; stream2 = Arrays.stream(array);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. ç›´æ¥åˆ›å»º</span></span><br><span class="line">        Stream&lt;String&gt; stream3 = Stream.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. åˆ›å»ºç©ºæµ</span></span><br><span class="line">        Stream&lt;String&gt; emptyStream = Stream.empty();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5. åˆ›å»ºæ— é™æµ</span></span><br><span class="line">        Stream&lt;Integer&gt; infiniteStream = Stream.iterate(<span class="number">0</span>, n -&gt; n + <span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 6. ç”Ÿæˆæµ</span></span><br><span class="line">        Stream&lt;Double&gt; randomStream = Stream.generate(Math::random);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 7. å¹¶è¡Œæµ</span></span><br><span class="line">        Stream&lt;String&gt; parallelStream = list.parallelStream();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”¢-æ•°å€¼æµåˆ›å»º"><a href="#ğŸ”¢-æ•°å€¼æµåˆ›å»º" class="headerlink" title="ğŸ”¢ æ•°å€¼æµåˆ›å»º"></a>ğŸ”¢ æ•°å€¼æµåˆ›å»º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumericStreamCreation</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// IntStream - æ•´æ•°æµ</span></span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">intStream1</span> <span class="operator">=</span> IntStream.range(<span class="number">1</span>, <span class="number">5</span>);        <span class="comment">// 1,2,3,4 (ä¸å«5)</span></span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">intStream2</span> <span class="operator">=</span> IntStream.rangeClosed(<span class="number">1</span>, <span class="number">5</span>);  <span class="comment">// 1,2,3,4,5 (å«5)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// LongStream - é•¿æ•´å‹æµ</span></span><br><span class="line">        <span class="type">LongStream</span> <span class="variable">longStream</span> <span class="operator">=</span> LongStream.rangeClosed(<span class="number">1L</span>, <span class="number">1000000L</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// DoubleStream - åŒç²¾åº¦æµ</span></span><br><span class="line">        <span class="type">DoubleStream</span> <span class="variable">doubleStream</span> <span class="operator">=</span> DoubleStream.of(<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä»æ•°ç»„åˆ›å»ºæ•°å€¼æµ</span></span><br><span class="line">        <span class="type">int</span>[] intArray = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">fromArray</span> <span class="operator">=</span> Arrays.stream(intArray);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä»é›†åˆåˆ›å»ºæ•°å€¼æµ</span></span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">fromCollection</span> <span class="operator">=</span> numbers.stream().mapToInt(Integer::intValue);</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;IntStream range: &quot;</span> + Arrays.toString(intStream1.toArray()));</span><br><span class="line">        System.out.println(<span class="string">&quot;IntStream rangeClosed: &quot;</span> + Arrays.toString(intStream2.toArray()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”„-é«˜çº§åˆ›å»ºæ–¹æ³•"><a href="#ğŸ”„-é«˜çº§åˆ›å»ºæ–¹æ³•" class="headerlink" title="ğŸ”„ é«˜çº§åˆ›å»ºæ–¹æ³•"></a>ğŸ”„ é«˜çº§åˆ›å»ºæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdvancedStreamCreation</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. è¿­ä»£åˆ›å»º - ç”Ÿæˆæ–æ³¢é‚£å¥‘æ•°åˆ—</span></span><br><span class="line">        Stream.iterate(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, t -&gt; <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;t[<span class="number">1</span>], t[<span class="number">0</span>] + t[<span class="number">1</span>]&#125;)</span><br><span class="line">              .limit(<span class="number">10</span>)</span><br><span class="line">              .map(t -&gt; t[<span class="number">0</span>])</span><br><span class="line">              .forEach(System.out::println);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. ç”Ÿæˆå™¨åˆ›å»º - éšæœºæ•°æµ</span></span><br><span class="line">        Stream.generate(() -&gt; (<span class="type">int</span>)(Math.random() * <span class="number">100</span>))</span><br><span class="line">              .limit(<span class="number">5</span>)</span><br><span class="line">              .forEach(System.out::println);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. åˆå¹¶æµ</span></span><br><span class="line">        Stream&lt;String&gt; stream1 = Stream.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>);</span><br><span class="line">        Stream&lt;String&gt; stream2 = Stream.of(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>);</span><br><span class="line">        Stream&lt;String&gt; merged = Stream.concat(stream1, stream2);</span><br><span class="line">        merged.forEach(System.out::println); <span class="comment">// A B C X Y Z</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. æ„å»ºå™¨æ¨¡å¼</span></span><br><span class="line">        Stream&lt;String&gt; builtStream = Stream.&lt;String&gt;builder()</span><br><span class="line">                .add(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">                .add(<span class="string">&quot;World&quot;</span>)</span><br><span class="line">                .add(<span class="string">&quot;Java&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">        builtStream.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-ä¸­é—´æ“ä½œï¼ˆIntermediate-Operationsï¼‰"><a href="#2ï¸âƒ£-ä¸­é—´æ“ä½œï¼ˆIntermediate-Operationsï¼‰" class="headerlink" title="2ï¸âƒ£ ä¸­é—´æ“ä½œï¼ˆIntermediate Operationsï¼‰"></a>2ï¸âƒ£ ä¸­é—´æ“ä½œï¼ˆIntermediate Operationsï¼‰</h3><p>ä¸­é—´æ“ä½œè¿”å›æ–°çš„Streamï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ã€‚</p><h4 id="ğŸ”-è¿‡æ»¤ï¼ˆFilterï¼‰"><a href="#ğŸ”-è¿‡æ»¤ï¼ˆFilterï¼‰" class="headerlink" title="ğŸ” è¿‡æ»¤ï¼ˆFilterï¼‰"></a>ğŸ” è¿‡æ»¤ï¼ˆFilterï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamFilter</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿‡æ»¤å¶æ•°</span></span><br><span class="line">        List&lt;Integer&gt; evenNumbers = numbers.stream()</span><br><span class="line">                .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;å¶æ•°: &quot;</span> + evenNumbers); <span class="comment">// [2, 4, 6, 8, 10]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿‡æ»¤å¤§äº5çš„æ•°</span></span><br><span class="line">        List&lt;Integer&gt; greaterThan5 = numbers.stream()</span><br><span class="line">                .filter(n -&gt; n &gt; <span class="number">5</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;å¤§äº5çš„æ•°: &quot;</span> + greaterThan5); <span class="comment">// [6, 7, 8, 9, 10]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç»„åˆæ¡ä»¶</span></span><br><span class="line">        List&lt;Integer&gt; result = numbers.stream()</span><br><span class="line">                .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                .filter(n -&gt; n &gt; <span class="number">5</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;å¶æ•°ä¸”å¤§äº5: &quot;</span> + result); <span class="comment">// [6, 8, 10]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨Predicateç»„åˆ</span></span><br><span class="line">        Predicate&lt;Integer&gt; isEven = n -&gt; n % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">        Predicate&lt;Integer&gt; isGreaterThan5 = n -&gt; n &gt; <span class="number">5</span>;</span><br><span class="line">        </span><br><span class="line">        List&lt;Integer&gt; combined = numbers.stream()</span><br><span class="line">                .filter(isEven.and(isGreaterThan5))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;ç»„åˆæ¡ä»¶: &quot;</span> + combined); <span class="comment">// [6, 8, 10]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âœ‚ï¸-æˆªå–æ“ä½œ"><a href="#âœ‚ï¸-æˆªå–æ“ä½œ" class="headerlink" title="âœ‚ï¸ æˆªå–æ“ä½œ"></a>âœ‚ï¸ æˆªå–æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamSlicing</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;elderberry&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// skip - è·³è¿‡å‰nä¸ªå…ƒç´ </span></span><br><span class="line">        List&lt;String&gt; skipResult = words.stream()</span><br><span class="line">                .skip(<span class="number">2</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;è·³è¿‡å‰2ä¸ª: &quot;</span> + skipResult); <span class="comment">// [cherry, date, elderberry]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// limit - é™åˆ¶å…ƒç´ æ•°é‡</span></span><br><span class="line">        List&lt;String&gt; limitResult = words.stream()</span><br><span class="line">                .limit(<span class="number">3</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;é™åˆ¶3ä¸ª: &quot;</span> + limitResult); <span class="comment">// [apple, banana, cherry]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// takeWhile - å–æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼ˆJava 9+ï¼‰</span></span><br><span class="line">        List&lt;String&gt; takeWhileResult = words.stream()</span><br><span class="line">                .takeWhile(s -&gt; s.length() &lt; <span class="number">7</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;é•¿åº¦å°äº7: &quot;</span> + takeWhileResult); <span class="comment">// [apple, banana, cherry, date]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// dropWhile - ä¸¢å¼ƒæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼ˆJava 9+ï¼‰</span></span><br><span class="line">        List&lt;String&gt; dropWhileResult = words.stream()</span><br><span class="line">                .dropWhile(s -&gt; s.length() &lt; <span class="number">7</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸¢å¼ƒé•¿åº¦å°äº7çš„: &quot;</span> + dropWhileResult); <span class="comment">// [elderberry]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”„-å»é‡ä¸æ’åº"><a href="#ğŸ”„-å»é‡ä¸æ’åº" class="headerlink" title="ğŸ”„ å»é‡ä¸æ’åº"></a>ğŸ”„ å»é‡ä¸æ’åº</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamDistinctAndSort</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// distinct - å»é‡</span></span><br><span class="line">        List&lt;Integer&gt; distinct = numbers.stream()</span><br><span class="line">                .distinct()</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;å»é‡: &quot;</span> + distinct); <span class="comment">// [3, 1, 4, 5, 9, 2, 6]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// sorted - è‡ªç„¶æ’åº</span></span><br><span class="line">        List&lt;Integer&gt; sorted = numbers.stream()</span><br><span class="line">                .distinct()</span><br><span class="line">                .sorted()</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ’åº: &quot;</span> + sorted); <span class="comment">// [1, 2, 3, 4, 5, 6, 9]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// sorted - è‡ªå®šä¹‰æ’åº</span></span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>, <span class="string">&quot;date&quot;</span>);</span><br><span class="line">        List&lt;String&gt; customSorted = words.stream()</span><br><span class="line">                .sorted((a, b) -&gt; Integer.compare(a.length(), b.length()))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;æŒ‰é•¿åº¦æ’åº: &quot;</span> + customSorted); <span class="comment">// [date, apple, banana, cherry]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// sorted - æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">        List&lt;String&gt; methodRefSorted = words.stream()</span><br><span class="line">                .sorted(Comparator.comparing(String::length))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹æ³•å¼•ç”¨æ’åº: &quot;</span> + methodRefSorted); <span class="comment">// [date, apple, banana, cherry]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ—ºï¸-æ˜ å°„ï¼ˆMapï¼‰"><a href="#ğŸ—ºï¸-æ˜ å°„ï¼ˆMapï¼‰" class="headerlink" title="ğŸ—ºï¸ æ˜ å°„ï¼ˆMapï¼‰"></a>ğŸ—ºï¸ æ˜ å°„ï¼ˆMapï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamMap</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>, <span class="string">&quot;java&quot;</span>, <span class="string">&quot;stream&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è½¬æ¢ä¸ºå¤§å†™</span></span><br><span class="line">        List&lt;String&gt; upperCase = words.stream()</span><br><span class="line">                .map(String::toUpperCase)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;å¤§å†™: &quot;</span> + upperCase); <span class="comment">// [HELLO, WORLD, JAVA, STREAM]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–é•¿åº¦</span></span><br><span class="line">        List&lt;Integer&gt; lengths = words.stream()</span><br><span class="line">                .map(String::length)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;é•¿åº¦: &quot;</span> + lengths); <span class="comment">// [5, 5, 4, 6]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¤æ‚æ˜ å°„</span></span><br><span class="line">        List&lt;String&gt; result = words.stream()</span><br><span class="line">                .map(s -&gt; s.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + s.substring(<span class="number">1</span>))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;é¦–å­—æ¯å¤§å†™: &quot;</span> + result); <span class="comment">// [Hello, World, Java, Stream]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”„-æ•°å€¼æµæ˜ å°„"><a href="#ğŸ”„-æ•°å€¼æµæ˜ å°„" class="headerlink" title="ğŸ”„ æ•°å€¼æµæ˜ å°„"></a>ğŸ”„ æ•°å€¼æµæ˜ å°„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumericStreamMapping</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; numbers = Arrays.asList(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// mapToInt - è½¬æ¢ä¸ºIntStream</span></span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">intStream</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .mapToInt(Integer::parseInt);</span><br><span class="line">        System.out.println(<span class="string">&quot;IntStream: &quot;</span> + Arrays.toString(intStream.toArray())); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// mapToLong - è½¬æ¢ä¸ºLongStream</span></span><br><span class="line">        <span class="type">LongStream</span> <span class="variable">longStream</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .mapToLong(Long::parseLong);</span><br><span class="line">        System.out.println(<span class="string">&quot;LongStream: &quot;</span> + Arrays.toString(longStream.toArray())); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// mapToDouble - è½¬æ¢ä¸ºDoubleStream</span></span><br><span class="line">        <span class="type">DoubleStream</span> <span class="variable">doubleStream</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .mapToDouble(Double::parseDouble);</span><br><span class="line">        System.out.println(<span class="string">&quot;DoubleStream: &quot;</span> + Arrays.toString(doubleStream.toArray())); <span class="comment">// [1.0, 2.0, 3.0, 4.0, 5.0]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ•°å€¼æµæ“ä½œ</span></span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">totalLength</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .mapToInt(String::length)</span><br><span class="line">                .sum();</span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»é•¿åº¦: &quot;</span> + totalLength); <span class="comment">// 17</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¹³å‡å€¼</span></span><br><span class="line">        <span class="type">OptionalDouble</span> <span class="variable">avgLength</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .mapToInt(String::length)</span><br><span class="line">                .average();</span><br><span class="line">        avgLength.ifPresent(avg -&gt; System.out.println(<span class="string">&quot;å¹³å‡é•¿åº¦: &quot;</span> + avg)); <span class="comment">// 5.67</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”-è°ƒè¯•æ“ä½œ"><a href="#ğŸ”-è°ƒè¯•æ“ä½œ" class="headerlink" title="ğŸ” è°ƒè¯•æ“ä½œ"></a>ğŸ” è°ƒè¯•æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamDebugging</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// peek - è°ƒè¯•ä¸­é—´ç»“æœ</span></span><br><span class="line">        List&lt;Integer&gt; result = numbers.stream()</span><br><span class="line">                .peek(n -&gt; System.out.println(<span class="string">&quot;åŸå§‹: &quot;</span> + n))</span><br><span class="line">                .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                .peek(n -&gt; System.out.println(<span class="string">&quot;è¿‡æ»¤å: &quot;</span> + n))</span><br><span class="line">                .map(n -&gt; n * <span class="number">2</span>)</span><br><span class="line">                .peek(n -&gt; System.out.println(<span class="string">&quot;æ˜ å°„å: &quot;</span> + n))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€ç»ˆç»“æœ: &quot;</span> + result);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line">        <span class="comment">// åŸå§‹: 1</span></span><br><span class="line">        <span class="comment">// åŸå§‹: 2</span></span><br><span class="line">        <span class="comment">// è¿‡æ»¤å: 2</span></span><br><span class="line">        <span class="comment">// æ˜ å°„å: 4</span></span><br><span class="line">        <span class="comment">// åŸå§‹: 3</span></span><br><span class="line">        <span class="comment">// åŸå§‹: 4</span></span><br><span class="line">        <span class="comment">// è¿‡æ»¤å: 4</span></span><br><span class="line">        <span class="comment">// æ˜ å°„å: 8</span></span><br><span class="line">        <span class="comment">// åŸå§‹: 5</span></span><br><span class="line">        <span class="comment">// æœ€ç»ˆç»“æœ: [4, 8]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ“¦-æ‰å¹³åŒ–ï¼ˆFlatMapï¼‰"><a href="#ğŸ“¦-æ‰å¹³åŒ–ï¼ˆFlatMapï¼‰" class="headerlink" title="ğŸ“¦ æ‰å¹³åŒ–ï¼ˆFlatMapï¼‰"></a>ğŸ“¦ æ‰å¹³åŒ–ï¼ˆFlatMapï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamFlatMap</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;List&lt;String&gt;&gt; nestedList = Arrays.asList(</span><br><span class="line">                Arrays.asList(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>),</span><br><span class="line">                Arrays.asList(<span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>),</span><br><span class="line">                Arrays.asList(<span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰å¹³åŒ–</span></span><br><span class="line">        List&lt;String&gt; flattened = nestedList.stream()</span><br><span class="line">                .flatMap(List::stream)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰å¹³åŒ–ç»“æœ: &quot;</span> + flattened); <span class="comment">// [a, b, c, d, e, f, g, h, i]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å­—ç¬¦ä¸²åˆ†å‰²ç¤ºä¾‹</span></span><br><span class="line">        List&lt;String&gt; sentences = Arrays.asList(<span class="string">&quot;Hello World&quot;</span>, <span class="string">&quot;Java Stream&quot;</span>, <span class="string">&quot;Functional Programming&quot;</span>);</span><br><span class="line">        List&lt;String&gt; words = sentences.stream()</span><br><span class="line">                .flatMap(sentence -&gt; Arrays.stream(sentence.split(<span class="string">&quot; &quot;</span>)))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰€æœ‰å•è¯: &quot;</span> + words); <span class="comment">// [Hello, World, Java, Stream, Functional, Programming]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ï¸âƒ£-ç»ˆç»“æ“ä½œï¼ˆTerminal-Operationsï¼‰"><a href="#3ï¸âƒ£-ç»ˆç»“æ“ä½œï¼ˆTerminal-Operationsï¼‰" class="headerlink" title="3ï¸âƒ£ ç»ˆç»“æ“ä½œï¼ˆTerminal Operationsï¼‰"></a>3ï¸âƒ£ ç»ˆç»“æ“ä½œï¼ˆTerminal Operationsï¼‰</h3><p>ç»ˆç»“æ“ä½œä¼šè§¦å‘Streamçš„æ‰§è¡Œï¼Œè¿”å›å…·ä½“çš„ç»“æœã€‚</p><h4 id="ğŸ“¥-æ”¶é›†ï¼ˆCollectï¼‰"><a href="#ğŸ“¥-æ”¶é›†ï¼ˆCollectï¼‰" class="headerlink" title="ğŸ“¥ æ”¶é›†ï¼ˆCollectï¼‰"></a>ğŸ“¥ æ”¶é›†ï¼ˆCollectï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamCollect</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;elderberry&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ”¶é›†åˆ°List</span></span><br><span class="line">        List&lt;String&gt; longWords = words.stream()</span><br><span class="line">                .filter(s -&gt; s.length() &gt; <span class="number">5</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ”¶é›†åˆ°Set</span></span><br><span class="line">        Set&lt;String&gt; uniqueWords = words.stream()</span><br><span class="line">                .collect(Collectors.toSet());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ”¶é›†åˆ°Map</span></span><br><span class="line">        Map&lt;String, Integer&gt; wordLengthMap = words.stream()</span><br><span class="line">                .collect(Collectors.toMap(</span><br><span class="line">                        Function.identity(),</span><br><span class="line">                        String::length</span><br><span class="line">                ));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ”¶é›†åˆ°å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">joined</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .collect(Collectors.joining(<span class="string">&quot;, &quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;é•¿å•è¯: &quot;</span> + longWords);</span><br><span class="line">        System.out.println(<span class="string">&quot;å”¯ä¸€å•è¯: &quot;</span> + uniqueWords);</span><br><span class="line">        System.out.println(<span class="string">&quot;å•è¯é•¿åº¦æ˜ å°„: &quot;</span> + wordLengthMap);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿æ¥å­—ç¬¦ä¸²: &quot;</span> + joined);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”-æŸ¥æ‰¾æ“ä½œ"><a href="#ğŸ”-æŸ¥æ‰¾æ“ä½œ" class="headerlink" title="ğŸ” æŸ¥æ‰¾æ“ä½œ"></a>ğŸ” æŸ¥æ‰¾æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamSearch</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// findFirst - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        Optional&lt;Integer&gt; first = numbers.stream()</span><br><span class="line">                .filter(n -&gt; n &gt; <span class="number">5</span>)</span><br><span class="line">                .findFirst();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸€ä¸ªå¤§äº5çš„æ•°: &quot;</span> + first.orElse(-<span class="number">1</span>)); <span class="comment">// 6</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// findAny - æŸ¥æ‰¾ä»»æ„ä¸€ä¸ªå…ƒç´ ï¼ˆå¹¶è¡Œæµä¸­æ›´æœ‰æ•ˆï¼‰</span></span><br><span class="line">        Optional&lt;Integer&gt; any = numbers.stream()</span><br><span class="line">                .filter(n -&gt; n &gt; <span class="number">5</span>)</span><br><span class="line">                .findAny();</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»»æ„ä¸€ä¸ªå¤§äº5çš„æ•°: &quot;</span> + any.orElse(-<span class="number">1</span>)); <span class="comment">// 6</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¹¶è¡Œæµä¸­çš„findAny</span></span><br><span class="line">        Optional&lt;Integer&gt; parallelAny = numbers.parallelStream()</span><br><span class="line">                .filter(n -&gt; n &gt; <span class="number">5</span>)</span><br><span class="line">                .findAny();</span><br><span class="line">        System.out.println(<span class="string">&quot;å¹¶è¡Œæµä¸­ä»»æ„ä¸€ä¸ª: &quot;</span> + parallelAny.orElse(-<span class="number">1</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç©ºæµçš„æƒ…å†µ</span></span><br><span class="line">        Optional&lt;Integer&gt; empty = Stream.&lt;Integer&gt;empty()</span><br><span class="line">                .findFirst();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç©ºæµæŸ¥æ‰¾: &quot;</span> + empty.isPresent()); <span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âœ…-åŒ¹é…æ“ä½œ"><a href="#âœ…-åŒ¹é…æ“ä½œ" class="headerlink" title="âœ… åŒ¹é…æ“ä½œ"></a>âœ… åŒ¹é…æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamMatching</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// anyMatch - æ˜¯å¦æœ‰ä»»æ„ä¸€ä¸ªæ»¡è¶³æ¡ä»¶</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">hasEven</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .anyMatch(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦æœ‰å¶æ•°: &quot;</span> + hasEven); <span class="comment">// true</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// allMatch - æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">allPositive</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .allMatch(n -&gt; n &gt; <span class="number">0</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦éƒ½ä¸ºæ­£æ•°: &quot;</span> + allPositive); <span class="comment">// true</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// noneMatch - æ˜¯å¦æ²¡æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">noneNegative</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .noneMatch(n -&gt; n &lt; <span class="number">0</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦æ²¡æœ‰è´Ÿæ•°: &quot;</span> + noneNegative); <span class="comment">// true</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// çŸ­è·¯ç‰¹æ€§æ¼”ç¤º</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">shortCircuit</span> <span class="operator">=</span> Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">                .peek(n -&gt; System.out.println(<span class="string">&quot;æ£€æŸ¥: &quot;</span> + n))</span><br><span class="line">                .anyMatch(n -&gt; n &gt; <span class="number">3</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;çŸ­è·¯ç»“æœ: &quot;</span> + shortCircuit);</span><br><span class="line">        <span class="comment">// è¾“å‡ºï¼šæ£€æŸ¥: 1, æ£€æŸ¥: 2, æ£€æŸ¥: 3, æ£€æŸ¥: 4, çŸ­è·¯ç»“æœ: true</span></span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šä¸ä¼šæ£€æŸ¥5ï¼Œå› ä¸º4å·²ç»æ»¡è¶³æ¡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ¯-èšåˆæ“ä½œ"><a href="#ğŸ¯-èšåˆæ“ä½œ" class="headerlink" title="ğŸ¯ èšåˆæ“ä½œ"></a>ğŸ¯ èšåˆæ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamAggregation</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// count - è®¡æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                .count();</span><br><span class="line">        System.out.println(<span class="string">&quot;å¶æ•°ä¸ªæ•°: &quot;</span> + count); <span class="comment">// 2</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// min - æœ€å°å€¼</span></span><br><span class="line">        Optional&lt;Integer&gt; min = numbers.stream()</span><br><span class="line">                .min(Integer::compareTo);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€å°å€¼: &quot;</span> + min.orElse(-<span class="number">1</span>)); <span class="comment">// 1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// max - æœ€å¤§å€¼</span></span><br><span class="line">        Optional&lt;Integer&gt; max = numbers.stream()</span><br><span class="line">                .max(Integer::compareTo);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€å¤§å€¼: &quot;</span> + max.orElse(-<span class="number">1</span>)); <span class="comment">// 5</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰æ¯”è¾ƒå™¨</span></span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>);</span><br><span class="line">        Optional&lt;String&gt; shortest = words.stream()</span><br><span class="line">                .min(Comparator.comparing(String::length));</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€çŸ­å•è¯: &quot;</span> + shortest.orElse(<span class="string">&quot;&quot;</span>)); <span class="comment">// apple</span></span><br><span class="line">        </span><br><span class="line">        Optional&lt;String&gt; longest = words.stream()</span><br><span class="line">                .max(Comparator.comparing(String::length));</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€é•¿å•è¯: &quot;</span> + longest.orElse(<span class="string">&quot;&quot;</span>)); <span class="comment">// banana</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”„-å½’çº¦ï¼ˆReduceï¼‰"><a href="#ğŸ”„-å½’çº¦ï¼ˆReduceï¼‰" class="headerlink" title="ğŸ”„ å½’çº¦ï¼ˆReduceï¼‰"></a>ğŸ”„ å½’çº¦ï¼ˆReduceï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamReduce</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ±‚å’Œ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .reduce(<span class="number">0</span>, Integer::sum);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ±‚æœ€å¤§å€¼</span></span><br><span class="line">        Optional&lt;Integer&gt; max = numbers.stream()</span><br><span class="line">                .reduce(Integer::max);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ±‚æœ€å°å€¼</span></span><br><span class="line">        Optional&lt;Integer&gt; min = numbers.stream()</span><br><span class="line">                .reduce(Integer::min);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å­—ç¬¦ä¸²è¿æ¥</span></span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>, <span class="string">&quot;Java&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .reduce(<span class="string">&quot;&quot;</span>, (a, b) -&gt; a + <span class="string">&quot; &quot;</span> + b);</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;æ±‚å’Œ: &quot;</span> + sum);           <span class="comment">// 15</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€å¤§å€¼: &quot;</span> + max.get());   <span class="comment">// 5</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€å°å€¼: &quot;</span> + min.get());   <span class="comment">// 1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿æ¥: &quot;</span> + result.trim()); <span class="comment">// Hello World Java</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ“¦-é«˜çº§æ”¶é›†å™¨"><a href="#ğŸ“¦-é«˜çº§æ”¶é›†å™¨" class="headerlink" title="ğŸ“¦ é«˜çº§æ”¶é›†å™¨"></a>ğŸ“¦ é«˜çº§æ”¶é›†å™¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdvancedCollectors</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;elderberry&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ†ç»„æ”¶é›†</span></span><br><span class="line">        Map&lt;Integer, List&lt;String&gt;&gt; groupedByLength = words.stream()</span><br><span class="line">                .collect(Collectors.groupingBy(String::length));</span><br><span class="line">        System.out.println(<span class="string">&quot;æŒ‰é•¿åº¦åˆ†ç»„: &quot;</span> + groupedByLength);</span><br><span class="line">        <span class="comment">// &#123;5=[apple, cherry], 6=[banana], 4=[date], 10=[elderberry]&#125;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ†åŒºæ”¶é›†</span></span><br><span class="line">        Map&lt;Boolean, List&lt;String&gt;&gt; partitioned = words.stream()</span><br><span class="line">                .collect(Collectors.partitioningBy(s -&gt; s.length() &gt; <span class="number">5</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;æŒ‰é•¿åº¦åˆ†åŒº: &quot;</span> + partitioned);</span><br><span class="line">        <span class="comment">// &#123;false=[apple, cherry, date], true=[banana, elderberry]&#125;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç»Ÿè®¡æ”¶é›†</span></span><br><span class="line">        <span class="type">IntSummaryStatistics</span> <span class="variable">stats</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .collect(Collectors.summarizingInt(String::length));</span><br><span class="line">        System.out.println(<span class="string">&quot;é•¿åº¦ç»Ÿè®¡: &quot;</span> + stats);</span><br><span class="line">        <span class="comment">// IntSummaryStatistics&#123;count=5, sum=31, min=4, average=6.200000, max=10&#125;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿æ¥æ”¶é›†</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">joined</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .collect(Collectors.joining(<span class="string">&quot;, &quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿æ¥ç»“æœ: &quot;</span> + joined);</span><br><span class="line">        <span class="comment">// [apple, banana, cherry, date, elderberry]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ˜ å°„æ”¶é›†</span></span><br><span class="line">        Map&lt;String, Integer&gt; wordToLength = words.stream()</span><br><span class="line">                .collect(Collectors.toMap(</span><br><span class="line">                        Function.identity(),</span><br><span class="line">                        String::length,</span><br><span class="line">                        (existing, replacement) -&gt; existing <span class="comment">// å¤„ç†é‡å¤é”®</span></span><br><span class="line">                ));</span><br><span class="line">        System.out.println(<span class="string">&quot;å•è¯åˆ°é•¿åº¦æ˜ å°„: &quot;</span> + wordToLength);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ”„-è‡ªå®šä¹‰æ”¶é›†å™¨"><a href="#ğŸ”„-è‡ªå®šä¹‰æ”¶é›†å™¨" class="headerlink" title="ğŸ”„ è‡ªå®šä¹‰æ”¶é›†å™¨"></a>ğŸ”„ è‡ªå®šä¹‰æ”¶é›†å™¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomCollector</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰æ”¶é›†å™¨ï¼šæ”¶é›†ä¸ºè‡ªå®šä¹‰å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StringStats</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> count;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> totalLength;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String longest;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String shortest;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">StringStats</span><span class="params">(<span class="type">int</span> count, <span class="type">int</span> totalLength, String longest, String shortest)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count = count;</span><br><span class="line">            <span class="built_in">this</span>.totalLength = totalLength;</span><br><span class="line">            <span class="built_in">this</span>.longest = longest;</span><br><span class="line">            <span class="built_in">this</span>.shortest = shortest;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> String.format(<span class="string">&quot;StringStats&#123;count=%d, totalLength=%d, longest=&#x27;%s&#x27;, shortest=&#x27;%s&#x27;&#125;&quot;</span>, </span><br><span class="line">                    count, totalLength, longest, shortest);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; words = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>, <span class="string">&quot;date&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰æ”¶é›†å™¨</span></span><br><span class="line">        <span class="type">StringStats</span> <span class="variable">stats</span> <span class="operator">=</span> words.stream()</span><br><span class="line">                .collect(Collector.of(</span><br><span class="line">                        () -&gt; <span class="keyword">new</span> <span class="title class_">StringStats</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">                        (acc, word) -&gt; &#123;</span><br><span class="line">                            <span class="type">int</span> <span class="variable">newCount</span> <span class="operator">=</span> acc.count + <span class="number">1</span>;</span><br><span class="line">                            <span class="type">int</span> <span class="variable">newTotalLength</span> <span class="operator">=</span> acc.totalLength + word.length();</span><br><span class="line">                            <span class="type">String</span> <span class="variable">newLongest</span> <span class="operator">=</span> acc.longest.isEmpty() || word.length() &gt; acc.longest.length() ? word : acc.longest;</span><br><span class="line">                            <span class="type">String</span> <span class="variable">newShortest</span> <span class="operator">=</span> acc.shortest.isEmpty() || word.length() &lt; acc.shortest.length() ? word : acc.shortest;</span><br><span class="line">                            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StringStats</span>(newCount, newTotalLength, newLongest, newShortest);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        (acc1, acc2) -&gt; <span class="keyword">new</span> <span class="title class_">StringStats</span>(</span><br><span class="line">                                acc1.count + acc2.count,</span><br><span class="line">                                acc1.totalLength + acc2.totalLength,</span><br><span class="line">                                acc1.longest.length() &gt; acc2.longest.length() ? acc1.longest : acc2.longest,</span><br><span class="line">                                acc1.shortest.length() &lt; acc2.shortest.length() ? acc1.shortest : acc2.shortest</span><br><span class="line">                        )</span><br><span class="line">                ));</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;è‡ªå®šä¹‰ç»Ÿè®¡: &quot;</span> + stats);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ“-Streamå®é™…åº”ç”¨ç¤ºä¾‹"><a href="#ğŸ“-Streamå®é™…åº”ç”¨ç¤ºä¾‹" class="headerlink" title="ğŸ“ Streamå®é™…åº”ç”¨ç¤ºä¾‹"></a>ğŸ“ Streamå®é™…åº”ç”¨ç¤ºä¾‹</h2><h3 id="ğŸ“Š-å­¦ç”Ÿæˆç»©å¤„ç†"><a href="#ğŸ“Š-å­¦ç”Ÿæˆç»©å¤„ç†" class="headerlink" title="ğŸ“Š å­¦ç”Ÿæˆç»©å¤„ç†"></a>ğŸ“Š å­¦ç”Ÿæˆç»©å¤„ç†</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentGradeProcessor</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Integer&gt; grades;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age, List&lt;Integer&gt; grades)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">            <span class="built_in">this</span>.grades = grades;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123; <span class="keyword">return</span> age; &#125;</span><br><span class="line">        <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">getGrades</span><span class="params">()</span> &#123; <span class="keyword">return</span> grades; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getAverageGrade</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> grades.stream()</span><br><span class="line">                    .mapToInt(Integer::intValue)</span><br><span class="line">                    .average()</span><br><span class="line">                    .orElse(<span class="number">0.0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> String.format(<span class="string">&quot;Student&#123;name=&#x27;%s&#x27;, age=%d, avgGrade=%.2f&#125;&quot;</span>, </span><br><span class="line">                    name, age, getAverageGrade());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Student&gt; students = Arrays.asList(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>, Arrays.asList(<span class="number">85</span>, <span class="number">90</span>, <span class="number">78</span>, <span class="number">92</span>)),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;æå››&quot;</span>, <span class="number">19</span>, Arrays.asList(<span class="number">76</span>, <span class="number">88</span>, <span class="number">82</span>, <span class="number">90</span>)),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;ç‹äº”&quot;</span>, <span class="number">21</span>, Arrays.asList(<span class="number">92</span>, <span class="number">95</span>, <span class="number">88</span>, <span class="number">94</span>)),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;èµµå…­&quot;</span>, <span class="number">20</span>, Arrays.asList(<span class="number">68</span>, <span class="number">75</span>, <span class="number">72</span>, <span class="number">80</span>)),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;é’±ä¸ƒ&quot;</span>, <span class="number">22</span>, Arrays.asList(<span class="number">88</span>, <span class="number">92</span>, <span class="number">85</span>, <span class="number">90</span>))</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. æ‰¾å‡ºå¹³å‡åˆ†å¤§äº85çš„å­¦ç”Ÿ</span></span><br><span class="line">        List&lt;Student&gt; excellentStudents = students.stream()</span><br><span class="line">                .filter(s -&gt; s.getAverageGrade() &gt; <span class="number">85</span>)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;ä¼˜ç§€å­¦ç”Ÿ:&quot;</span>);</span><br><span class="line">        excellentStudents.forEach(System.out::println);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æŒ‰å¹´é¾„åˆ†ç»„</span></span><br><span class="line">        Map&lt;Integer, List&lt;Student&gt;&gt; studentsByAge = students.stream()</span><br><span class="line">                .collect(Collectors.groupingBy(Student::getAge));</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;\næŒ‰å¹´é¾„åˆ†ç»„:&quot;</span>);</span><br><span class="line">        studentsByAge.forEach((age, studentList) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å¹´é¾„ &quot;</span> + age + <span class="string">&quot;: &quot;</span> + studentList.size() + <span class="string">&quot; äºº&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. è®¡ç®—æ¯ä¸ªå¹´é¾„æ®µçš„å¹³å‡åˆ†</span></span><br><span class="line">        Map&lt;Integer, Double&gt; averageByAge = students.stream()</span><br><span class="line">                .collect(Collectors.groupingBy(</span><br><span class="line">                        Student::getAge,</span><br><span class="line">                        Collectors.averagingDouble(Student::getAverageGrade)</span><br><span class="line">                ));</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;\nå„å¹´é¾„æ®µå¹³å‡åˆ†:&quot;</span>);</span><br><span class="line">        averageByAge.forEach((age, avg) -&gt; </span><br><span class="line">                System.out.printf(<span class="string">&quot;å¹´é¾„ %d: %.2f%n&quot;</span>, age, avg));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. æ‰¾å‡ºæœ€é«˜åˆ†çš„å­¦ç”Ÿ</span></span><br><span class="line">        Optional&lt;Student&gt; topStudent = students.stream()</span><br><span class="line">                .max(Comparator.comparing(Student::getAverageGrade));</span><br><span class="line">        </span><br><span class="line">        topStudent.ifPresent(s -&gt; System.out.println(<span class="string">&quot;\næœ€é«˜åˆ†å­¦ç”Ÿ: &quot;</span> + s));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="âš¡-Streamæ€§èƒ½ä¼˜åŒ–"><a href="#âš¡-Streamæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="âš¡ Streamæ€§èƒ½ä¼˜åŒ–"></a>âš¡ Streamæ€§èƒ½ä¼˜åŒ–</h2><blockquote><p>ğŸ”§ <strong>æ€§èƒ½ä¼˜åŒ–å‚è€ƒ</strong>ï¼šæ›´å¤šStreamæ€§èƒ½ä¼˜åŒ–æŠ€å·§å’Œæœ€ä½³å®è·µï¼Œè¯·å‚è€ƒ<a href="/stream.html" target="_blank">Stream APIé€ŸæŸ¥è¡¨</a>ä¸­çš„æ€§èƒ½ä¼˜åŒ–éƒ¨åˆ†ã€‚</p></blockquote><h3 id="1ï¸âƒ£-ä½¿ç”¨åŸå§‹ç±»å‹æµ"><a href="#1ï¸âƒ£-ä½¿ç”¨åŸå§‹ç±»å‹æµ" class="headerlink" title="1ï¸âƒ£ ä½¿ç”¨åŸå§‹ç±»å‹æµ"></a>1ï¸âƒ£ ä½¿ç”¨åŸå§‹ç±»å‹æµ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamPerformance</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = IntStream.rangeClosed(<span class="number">1</span>, <span class="number">1000000</span>)</span><br><span class="line">                .boxed()</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨IntStreamï¼ˆæ¨èï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">start1</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum1</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .mapToInt(Integer::intValue)</span><br><span class="line">                .sum();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end1</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨Stream&lt;Integer&gt;ï¼ˆè¾ƒæ…¢ï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">start2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum2</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .reduce(<span class="number">0</span>, Integer::sum);</span><br><span class="line">        <span class="type">long</span> <span class="variable">end2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;IntStreamè€—æ—¶: &quot;</span> + (end1 - start1) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Stream&lt;Integer&gt;è€—æ—¶: &quot;</span> + (end2 - start2) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-å¹¶è¡Œæµçš„ä½¿ç”¨"><a href="#2ï¸âƒ£-å¹¶è¡Œæµçš„ä½¿ç”¨" class="headerlink" title="2ï¸âƒ£ å¹¶è¡Œæµçš„ä½¿ç”¨"></a>2ï¸âƒ£ å¹¶è¡Œæµçš„ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ParallelStreamExample</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; numbers = IntStream.rangeClosed(<span class="number">1</span>, <span class="number">10000000</span>)</span><br><span class="line">                .boxed()</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¸²è¡Œæµ</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">start1</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">count1</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                .count();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end1</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¹¶è¡Œæµ</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">start2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">count2</span> <span class="operator">=</span> numbers.parallelStream()</span><br><span class="line">                .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                .count();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸²è¡Œæµç»“æœ: &quot;</span> + count1 + <span class="string">&quot;, è€—æ—¶: &quot;</span> + (end1 - start1) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¹¶è¡Œæµç»“æœ: &quot;</span> + count2 + <span class="string">&quot;, è€—æ—¶: &quot;</span> + (end2 - start2) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>Streamæœ€ä½³å®è·µ</strong>ï¼š</p><ol><li>ä¼˜å…ˆä½¿ç”¨åŸå§‹ç±»å‹æµï¼ˆIntStream, LongStream, DoubleStreamï¼‰</li><li>å¤§æ•°æ®é‡æ—¶è€ƒè™‘å¹¶è¡Œæµ</li><li>é¿å…åœ¨Streamä¸­è¿›è¡Œå¤æ‚è®¡ç®—</li><li>åˆç†ä½¿ç”¨ä¸­é—´æ“ä½œï¼Œé¿å…ä¸å¿…è¦çš„æ“ä½œ</li></ol></blockquote><h1 id="ğŸ‰-æ€»ç»“ä¸æœ€ä½³å®è·µ"><a href="#ğŸ‰-æ€»ç»“ä¸æœ€ä½³å®è·µ" class="headerlink" title="ğŸ‰ æ€»ç»“ä¸æœ€ä½³å®è·µ"></a>ğŸ‰ æ€»ç»“ä¸æœ€ä½³å®è·µ</h1><h2 id="ğŸ”„-å‡½æ•°å¼ç¼–ç¨‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾"><a href="#ğŸ”„-å‡½æ•°å¼ç¼–ç¨‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾" class="headerlink" title="ğŸ”„ å‡½æ•°å¼ç¼–ç¨‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾"></a>ğŸ”„ å‡½æ•°å¼ç¼–ç¨‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾</h2><p>é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æ·±å…¥äº†è§£äº†Javaå‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µã€‚</p><h3 id="1ï¸âƒ£-å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€"><a href="#1ï¸âƒ£-å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€" class="headerlink" title="1ï¸âƒ£ å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€"></a>1ï¸âƒ£ å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€</h3><ul><li><strong>å‡½æ•°å³è§„åˆ™</strong>ï¼šç¡®å®šæ€§ã€æ— å‰¯ä½œç”¨ã€ä¸å˜æ€§</li><li><strong>Lambdaè¡¨è¾¾å¼</strong>ï¼šç®€æ´çš„å‡½æ•°è¡¨ç¤ºæ³•</li><li><strong>å‡½æ•°å¼æ¥å£</strong>ï¼šåªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£</li></ul><h3 id="2ï¸âƒ£-æ ¸å¿ƒç‰¹æ€§"><a href="#2ï¸âƒ£-æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="2ï¸âƒ£ æ ¸å¿ƒç‰¹æ€§"></a>2ï¸âƒ£ æ ¸å¿ƒç‰¹æ€§</h3><ul><li><strong>é—­åŒ…</strong>ï¼šå‡½æ•°å¯¹è±¡ä¸å¤–éƒ¨å˜é‡çš„ç»‘å®š</li><li><strong>æŸ¯é‡ŒåŒ–</strong>ï¼šå¤šå‚æ•°å‡½æ•°çš„åˆ†æ­¥æ‰§è¡Œ</li><li><strong>æ–¹æ³•å¼•ç”¨</strong>ï¼šLambdaè¡¨è¾¾å¼çš„ç®€åŒ–å½¢å¼</li><li><strong>Stream API</strong>ï¼šå£°æ˜å¼æ•°æ®å¤„ç†</li></ul><h2 id="ğŸš€-æ€§èƒ½ä¼˜åŒ–å»ºè®®"><a href="#ğŸš€-æ€§èƒ½ä¼˜åŒ–å»ºè®®" class="headerlink" title="ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®"></a>ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2><h3 id="1ï¸âƒ£-é€‰æ‹©åˆé€‚çš„å‡½æ•°å¼æ¥å£"><a href="#1ï¸âƒ£-é€‰æ‹©åˆé€‚çš„å‡½æ•°å¼æ¥å£" class="headerlink" title="1ï¸âƒ£ é€‰æ‹©åˆé€‚çš„å‡½æ•°å¼æ¥å£"></a>1ï¸âƒ£ é€‰æ‹©åˆé€‚çš„å‡½æ•°å¼æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èï¼šä½¿ç”¨å†…ç½®æ¥å£</span></span><br><span class="line">Predicate&lt;String&gt; isLong = s -&gt; s.length() &gt; <span class="number">5</span>;</span><br><span class="line">Function&lt;String, Integer&gt; getLength = String::length;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¿å…ï¼šé‡å¤å®šä¹‰ç›¸ä¼¼æ¥å£</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StringPredicate</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(String s)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-Streamæ€§èƒ½ä¼˜åŒ–"><a href="#2ï¸âƒ£-Streamæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="2ï¸âƒ£ Streamæ€§èƒ½ä¼˜åŒ–"></a>2ï¸âƒ£ Streamæ€§èƒ½ä¼˜åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èï¼šä½¿ç”¨åŸå§‹ç±»å‹æµ</span></span><br><span class="line">IntStream.rangeClosed(<span class="number">1</span>, <span class="number">1000000</span>)</span><br><span class="line">    .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    .sum();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¿å…ï¼šä¸å¿…è¦çš„è£…ç®±æ‹†ç®±</span></span><br><span class="line">Stream&lt;Integer&gt; boxedStream = IntStream.rangeClosed(<span class="number">1</span>, <span class="number">1000000</span>)</span><br><span class="line">    .boxed()</span><br><span class="line">    .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    .mapToInt(Integer::intValue)</span><br><span class="line">    .sum();</span><br></pre></td></tr></table></figure><h3 id="3ï¸âƒ£-å¹¶è¡Œæµä½¿ç”¨åŸåˆ™"><a href="#3ï¸âƒ£-å¹¶è¡Œæµä½¿ç”¨åŸåˆ™" class="headerlink" title="3ï¸âƒ£ å¹¶è¡Œæµä½¿ç”¨åŸåˆ™"></a>3ï¸âƒ£ å¹¶è¡Œæµä½¿ç”¨åŸåˆ™</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¤§æ•°æ®é‡æ—¶ä½¿ç”¨å¹¶è¡Œæµ</span></span><br><span class="line">List&lt;Integer&gt; largeList = IntStream.rangeClosed(<span class="number">1</span>, <span class="number">10000000</span>)</span><br><span class="line">    .boxed()</span><br><span class="line">    .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°æ®é‡å°æ—¶ä½¿ç”¨ä¸²è¡Œæµ</span></span><br><span class="line">List&lt;Integer&gt; smallList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><h2 id="ğŸ¯-å®é™…åº”ç”¨åœºæ™¯"><a href="#ğŸ¯-å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="ğŸ¯ å®é™…åº”ç”¨åœºæ™¯"></a>ğŸ¯ å®é™…åº”ç”¨åœºæ™¯</h2><h3 id="1ï¸âƒ£-æ•°æ®å¤„ç†"><a href="#1ï¸âƒ£-æ•°æ®å¤„ç†" class="headerlink" title="1ï¸âƒ£ æ•°æ®å¤„ç†"></a>1ï¸âƒ£ æ•°æ®å¤„ç†</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­¦ç”Ÿæˆç»©ç»Ÿè®¡</span></span><br><span class="line">students.stream()</span><br><span class="line">    .filter(s -&gt; s.getAverageGrade() &gt; <span class="number">85</span>)</span><br><span class="line">    .collect(Collectors.groupingBy(Student::getAge))</span><br><span class="line">    .forEach((age, list) -&gt; System.out.println(<span class="string">&quot;å¹´é¾„&quot;</span> + age + <span class="string">&quot;: &quot;</span> + list.size() + <span class="string">&quot;äºº&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-å¼‚æ­¥ç¼–ç¨‹"><a href="#2ï¸âƒ£-å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="2ï¸âƒ£ å¼‚æ­¥ç¼–ç¨‹"></a>2ï¸âƒ£ å¼‚æ­¥ç¼–ç¨‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼‚æ­¥ä»»åŠ¡å¤„ç†</span></span><br><span class="line">CompletableFuture.supplyAsync(() -&gt; fetchData())</span><br><span class="line">    .thenApply(<span class="built_in">this</span>::processData)</span><br><span class="line">    .thenAccept(<span class="built_in">this</span>::saveResult)</span><br><span class="line">    .exceptionally(<span class="built_in">this</span>::handleError);</span><br></pre></td></tr></table></figure><h3 id="3ï¸âƒ£-é…ç½®ç®¡ç†"><a href="#3ï¸âƒ£-é…ç½®ç®¡ç†" class="headerlink" title="3ï¸âƒ£ é…ç½®ç®¡ç†"></a>3ï¸âƒ£ é…ç½®ç®¡ç†</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½®éªŒè¯</span></span><br><span class="line">Predicate&lt;String&gt; isValidConfig = config -&gt; </span><br><span class="line">    config != <span class="literal">null</span> &amp;&amp; !config.trim().isEmpty() &amp;&amp; config.length() &gt; <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">Optional&lt;String&gt; validConfig = Optional.ofNullable(inputConfig)</span><br><span class="line">    .filter(isValidConfig)</span><br><span class="line">    .map(String::trim);</span><br></pre></td></tr></table></figure><h2 id="âš ï¸-å¸¸è§é™·é˜±ä¸é¿å…æ–¹æ³•"><a href="#âš ï¸-å¸¸è§é™·é˜±ä¸é¿å…æ–¹æ³•" class="headerlink" title="âš ï¸ å¸¸è§é™·é˜±ä¸é¿å…æ–¹æ³•"></a>âš ï¸ å¸¸è§é™·é˜±ä¸é¿å…æ–¹æ³•</h2><h3 id="1ï¸âƒ£-é—­åŒ…å˜é‡ä¿®æ”¹"><a href="#1ï¸âƒ£-é—­åŒ…å˜é‡ä¿®æ”¹" class="headerlink" title="1ï¸âƒ£ é—­åŒ…å˜é‡ä¿®æ”¹"></a>1ï¸âƒ£ é—­åŒ…å˜é‡ä¿®æ”¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ï¼šä¿®æ”¹é—­åŒ…å˜é‡</span></span><br><span class="line"><span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).forEach(n -&gt; counter++); <span class="comment">// ç¼–è¯‘é”™è¯¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®ï¼šä½¿ç”¨åŸå­ç±»æˆ–æ•°ç»„</span></span><br><span class="line"><span class="type">AtomicInteger</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).forEach(n -&gt; counter.incrementAndGet());</span><br></pre></td></tr></table></figure><h3 id="2ï¸âƒ£-Streamé‡å¤ä½¿ç”¨"><a href="#2ï¸âƒ£-Streamé‡å¤ä½¿ç”¨" class="headerlink" title="2ï¸âƒ£ Streamé‡å¤ä½¿ç”¨"></a>2ï¸âƒ£ Streamé‡å¤ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ï¼šé‡å¤ä½¿ç”¨Stream</span></span><br><span class="line">Stream&lt;String&gt; stream = list.stream();</span><br><span class="line">stream.filter(s -&gt; s.length() &gt; <span class="number">3</span>);</span><br><span class="line">stream.map(String::toUpperCase); <span class="comment">// è¿è¡Œæ—¶å¼‚å¸¸</span></span><br><span class="line"><span class="comment">// æ­£ç¡®ï¼šæ¯æ¬¡åˆ›å»ºæ–°çš„Stream</span></span><br><span class="line">list.stream().filter(s -&gt; s.length() &gt; <span class="number">3</span>);</span><br><span class="line">list.stream().map(String::toUpperCase);</span><br></pre></td></tr></table></figure><h3 id="3ï¸âƒ£-è¿‡åº¦ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹"><a href="#3ï¸âƒ£-è¿‡åº¦ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="3ï¸âƒ£ è¿‡åº¦ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹"></a>3ï¸âƒ£ è¿‡åº¦ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ï¼šè¿‡åº¦å¤æ‚åŒ–</span></span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> list.stream()</span><br><span class="line">    .filter(s -&gt; s != <span class="literal">null</span>)</span><br><span class="line">    .filter(s -&gt; !s.isEmpty())</span><br><span class="line">    .map(s -&gt; s.trim())</span><br><span class="line">    .filter(s -&gt; s.length() &gt; <span class="number">0</span>)</span><br><span class="line">    .map(s -&gt; s.toUpperCase())</span><br><span class="line">    .collect(Collectors.joining(<span class="string">&quot;, &quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®ï¼šä¿æŒç®€æ´</span></span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> list.stream()</span><br><span class="line">    .filter(Objects::nonNull)</span><br><span class="line">    .map(String::trim)</span><br><span class="line">    .filter(s -&gt; !s.isEmpty())</span><br><span class="line">    .map(String::toUpperCase)</span><br><span class="line">    .collect(Collectors.joining(<span class="string">&quot;, &quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="ğŸ“š-å­¦ä¹ å»ºè®®"><a href="#ğŸ“š-å­¦ä¹ å»ºè®®" class="headerlink" title="ğŸ“š å­¦ä¹ å»ºè®®"></a>ğŸ“š å­¦ä¹ å»ºè®®</h2><ol><li><strong>å¾ªåºæ¸è¿›</strong>ï¼šä»ç®€å•çš„Lambdaè¡¨è¾¾å¼å¼€å§‹ï¼Œé€æ­¥å­¦ä¹ é«˜çº§ç‰¹æ€§</li><li><strong>å®è·µä¸ºä¸»</strong>ï¼šå¤šå†™ä»£ç ï¼Œå¤šç»ƒä¹ ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨</li><li><strong>æ€§èƒ½æ„è¯†</strong>ï¼šäº†è§£æ€§èƒ½å½±å“ï¼Œåˆç†é€‰æ‹©ä½¿ç”¨åœºæ™¯</li><li><strong>ä»£ç å¯è¯»æ€§</strong>ï¼šå‡½æ•°å¼ç¼–ç¨‹åº”è¯¥æé«˜ä»£ç å¯è¯»æ€§ï¼Œè€Œä¸æ˜¯ç›¸å</li></ol><h2 id="ğŸŠ-ç»“è¯­"><a href="#ğŸŠ-ç»“è¯­" class="headerlink" title="ğŸŠ ç»“è¯­"></a>ğŸŠ ç»“è¯­</h2><p>Javaå‡½æ•°å¼ç¼–ç¨‹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å…¨æ–°çš„ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒå¼ºè°ƒä¸å¯å˜æ€§ã€å£°æ˜å¼ç¼–ç¨‹å’Œå‡½æ•°ç»„åˆã€‚é€šè¿‡åˆç†ä½¿ç”¨Lambdaè¡¨è¾¾å¼ã€Stream APIç­‰ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ã€‚<br>è®°ä½ï¼Œå‡½æ•°å¼ç¼–ç¨‹ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒåº”è¯¥ä¸ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹ç›¸ç»“åˆï¼Œåœ¨åˆé€‚çš„åœºæ™¯ä¸‹å‘æŒ¥å…¶ä¼˜åŠ¿ã€‚æŒæ¡å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µå’Œæœ€ä½³å®è·µï¼Œå°†å¤§å¤§æå‡æˆ‘ä»¬çš„ç¼–ç¨‹èƒ½åŠ›å’Œä»£ç è´¨é‡ã€‚</p><blockquote><p>ğŸ“š <strong>å»¶ä¼¸é˜…è¯»</strong>ï¼š</p><ul><li><a href="https://www.oreilly.com/library/view/java-8-in/9781449333071/">Java 8å‡½æ•°å¼ç¼–ç¨‹</a></li><li><a href="https://www.oreilly.com/library/view/effective-java-3rd/9780134686097/">Effective Java ç¬¬ä¸‰ç‰ˆ</a></li><li><a href="https://www.oreilly.com/library/view/functional-thinking/9781449365519/">å‡½æ•°å¼ç¼–ç¨‹æ€ç»´</a></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯ </category>
          
          <category> ç¼–ç¨‹æ€æƒ³ </category>
          
          <category> Lambda </category>
          
          <category> Stream </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å‡½æ•°å¼ç¼–ç¨‹ </tag>
            
            <tag> Lambda </tag>
            
            <tag> Stream </tag>
            
            <tag> ç¼–ç¨‹èŒƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>typoraå­¦ä¹ </title>
      <link href="/2025/10/02/typora%E5%AD%A6%E4%B9%A0/"/>
      <url>/2025/10/02/typora%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2025å¹´10æœˆå­¦ä¹ è§„åˆ’</title>
      <link href="//october-learning-plan/"/>
      <url>//october-learning-plan/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸ“…-2025å¹´10æœˆå­¦ä¹ è§„åˆ’"><a href="#ğŸ“…-2025å¹´10æœˆå­¦ä¹ è§„åˆ’" class="headerlink" title="ğŸ“… 2025å¹´10æœˆå­¦ä¹ è§„åˆ’"></a>ğŸ“… 2025å¹´10æœˆå­¦ä¹ è§„åˆ’</h1><h2 id="ğŸ¯-å­¦ä¹ ç›®æ ‡"><a href="#ğŸ¯-å­¦ä¹ ç›®æ ‡" class="headerlink" title="ğŸ¯ å­¦ä¹ ç›®æ ‡"></a>ğŸ¯ å­¦ä¹ ç›®æ ‡</h2><p>å›½åº†å‡æœŸæœŸé—´ï¼Œä¸ºè‡ªå·±åˆ¶å®šä¸€äº›ç®€å•çš„å­¦ä¹ ç›®æ ‡ï¼Œåœ¨æ”¾æ¾çš„åŒæ—¶å……å®æŠ€æœ¯çŸ¥è¯†1ã€‚</p><hr><h2 id="ğŸ“š-æŠ€æœ¯å­¦ä¹ "><a href="#ğŸ“š-æŠ€æœ¯å­¦ä¹ " class="headerlink" title="ğŸ“š æŠ€æœ¯å­¦ä¹ "></a>ğŸ“š æŠ€æœ¯å­¦ä¹ </h2><h3 id="ğŸ”§-ç¼–ç¨‹æŠ€èƒ½å¤ä¹ "><a href="#ğŸ”§-ç¼–ç¨‹æŠ€èƒ½å¤ä¹ " class="headerlink" title="ğŸ”§ ç¼–ç¨‹æŠ€èƒ½å¤ä¹ "></a>ğŸ”§ ç¼–ç¨‹æŠ€èƒ½å¤ä¹ </h3><ul><li><input checked="" disabled="" type="checkbox"> <strong>å‡½æ•°å¼ç¼–ç¨‹å¤ä¹ </strong> - æ•´ç†å­¦ä¹ ç¬”è®°åˆ°åšå®¢(ç›¸å…³lambdaåŸç†éœ€è¦æ›´æ–°ï¼Œå…·ä½“çš„åº”ç”¨éœ€è¦åœ¨ä»Šåçš„å®è·µä¸­è¡¥å……)</li><li><input checked="" disabled="" type="checkbox"> <strong>Gitæ“ä½œå®è·µ</strong> - ç³»ç»Ÿæ¢³ç†Gitå·¥ä½œæµç¨‹å¹¶æ•´ç†åšå®¢</li><li><input disabled="" type="checkbox"> <strong>Linuxç³»ç»Ÿå­¦ä¹ </strong> - æŒæ¡å¸¸ç”¨å‘½ä»¤å¹¶æ•´ç†å­¦ä¹ ç¬”è®°</li></ul><hr><h2 id="ğŸš€-ä¸ªäººæŠ€èƒ½æå‡"><a href="#ğŸš€-ä¸ªäººæŠ€èƒ½æå‡" class="headerlink" title="ğŸš€ ä¸ªäººæŠ€èƒ½æå‡"></a>ğŸš€ ä¸ªäººæŠ€èƒ½æå‡</h2><h3 id="ğŸ¤–-AIå·¥å…·å­¦ä¹ "><a href="#ğŸ¤–-AIå·¥å…·å­¦ä¹ " class="headerlink" title="ğŸ¤– AIå·¥å…·å­¦ä¹ "></a>ğŸ¤– AIå·¥å…·å­¦ä¹ </h3><ul><li><input checked="" disabled="" type="checkbox"> <strong>AI Cursorä½¿ç”¨æ€»ç»“</strong> - æ•´ç†ä½¿ç”¨ç»éªŒå’Œæœ€ä½³å®è·µ</li><li><input checked="" disabled="" type="checkbox"> <strong>MCPåè®®å­¦ä¹ </strong> - äº†è§£Model Context Protocolçš„åŸºæœ¬æ¦‚å¿µå’Œåº”ç”¨</li></ul>]]></content>
      
      
      <categories>
          
          <category> è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ è§„åˆ’ </tag>
            
            <tag> æŠ€æœ¯æå‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡å¤„ç†ç¤ºä¾‹</title>
      <link href="//image-handling-example/"/>
      <url>//image-handling-example/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexoåšå®¢å›¾ç‰‡å¤„ç†æœ€ä½³å®è·µ"><a href="#Hexoåšå®¢å›¾ç‰‡å¤„ç†æœ€ä½³å®è·µ" class="headerlink" title="Hexoåšå®¢å›¾ç‰‡å¤„ç†æœ€ä½³å®è·µ"></a>Hexoåšå®¢å›¾ç‰‡å¤„ç†æœ€ä½³å®è·µ</h1><h2 id="ğŸ¯-æ–¹æ¡ˆå¯¹æ¯”"><a href="#ğŸ¯-æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="ğŸ¯ æ–¹æ¡ˆå¯¹æ¯”"></a>ğŸ¯ æ–¹æ¡ˆå¯¹æ¯”</h2><h3 id="æ–¹æ¡ˆ1-ä½¿ç”¨source-imagesæ–‡ä»¶å¤¹-æ¨è"><a href="#æ–¹æ¡ˆ1-ä½¿ç”¨source-imagesæ–‡ä»¶å¤¹-æ¨è" class="headerlink" title="æ–¹æ¡ˆ1: ä½¿ç”¨source&#x2F;imagesæ–‡ä»¶å¤¹ (æ¨è)"></a>æ–¹æ¡ˆ1: ä½¿ç”¨source&#x2F;imagesæ–‡ä»¶å¤¹ (æ¨è)</h3><p>è¿™æ˜¯æœ€ç®€å•å¯é çš„æ–¹æ³•ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">æŠ€æœ¯æ¶æ„å›¾</span>](<span class="link">/images/tech-architecture.png</span>)</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>âœ… å›¾ç‰‡è‡ªåŠ¨éƒ¨ç½²åˆ°GitHub</li><li>âœ… è·¯å¾„ç®€å•ï¼Œä¸æ˜“å‡ºé”™</li><li>âœ… æœ¬åœ°å’Œçº¿ä¸Šè·¯å¾„ä¸€è‡´</li></ul><h3 id="æ–¹æ¡ˆ2-ä½¿ç”¨CDNåŠ é€Ÿ"><a href="#æ–¹æ¡ˆ2-ä½¿ç”¨CDNåŠ é€Ÿ" class="headerlink" title="æ–¹æ¡ˆ2: ä½¿ç”¨CDNåŠ é€Ÿ"></a>æ–¹æ¡ˆ2: ä½¿ç”¨CDNåŠ é€Ÿ</h3><h4 id="jsDelivr-GitHub"><a href="#jsDelivr-GitHub" class="headerlink" title="jsDelivr + GitHub"></a>jsDelivr + GitHub</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">å›¾ç‰‡</span>](<span class="link">https://cdn.jsdelivr.net/gh/suoChina/suoChina.github.io@main/images/å›¾ç‰‡å.jpg</span>)</span><br></pre></td></tr></table></figure><h4 id="GitHub-Raw"><a href="#GitHub-Raw" class="headerlink" title="GitHub Raw"></a>GitHub Raw</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">å›¾ç‰‡</span>](<span class="link">https://raw.githubusercontent.com/suoChina/suoChina.github.io/main/images/å›¾ç‰‡å.jpg</span>)</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>âœ… åŠ è½½é€Ÿåº¦å¿«</li><li>âœ… å‡å°‘GitHubä»“åº“å¤§å°</li><li>âœ… æ”¯æŒå›¾ç‰‡å‹ç¼©</li></ul><h3 id="æ–¹æ¡ˆ3-æ–‡ç« èµ„æºæ–‡ä»¶å¤¹"><a href="#æ–¹æ¡ˆ3-æ–‡ç« èµ„æºæ–‡ä»¶å¤¹" class="headerlink" title="æ–¹æ¡ˆ3: æ–‡ç« èµ„æºæ–‡ä»¶å¤¹"></a>æ–¹æ¡ˆ3: æ–‡ç« èµ„æºæ–‡ä»¶å¤¹</h3><p>åˆ›å»ºä¸æ–‡ç« åŒåçš„æ–‡ä»¶å¤¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">source/_posts/</span><br><span class="line">â”œâ”€â”€ å›¾ç‰‡å¤„ç†ç¤ºä¾‹.md</span><br><span class="line">â””â”€â”€ å›¾ç‰‡å¤„ç†ç¤ºä¾‹/</span><br><span class="line">    â”œâ”€â”€ example1.png</span><br><span class="line">    â””â”€â”€ example2.jpg</span><br></pre></td></tr></table></figure><p>åœ¨markdownä¸­ä½¿ç”¨ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">ç¤ºä¾‹å›¾ç‰‡1</span>](<span class="link">å›¾ç‰‡å¤„ç†ç¤ºä¾‹/example1.png</span>)</span><br><span class="line">![<span class="string">ç¤ºä¾‹å›¾ç‰‡2</span>](<span class="link">å›¾ç‰‡å¤„ç†ç¤ºä¾‹/example2.jpg</span>)</span><br></pre></td></tr></table></figure><h2 id="ğŸ› ï¸-å®é™…æ“ä½œæ­¥éª¤"><a href="#ğŸ› ï¸-å®é™…æ“ä½œæ­¥éª¤" class="headerlink" title="ğŸ› ï¸ å®é™…æ“ä½œæ­¥éª¤"></a>ğŸ› ï¸ å®é™…æ“ä½œæ­¥éª¤</h2><h3 id="1-åˆ›å»ºå›¾ç‰‡æ–‡ä»¶å¤¹"><a href="#1-åˆ›å»ºå›¾ç‰‡æ–‡ä»¶å¤¹" class="headerlink" title="1. åˆ›å»ºå›¾ç‰‡æ–‡ä»¶å¤¹"></a>1. åˆ›å»ºå›¾ç‰‡æ–‡ä»¶å¤¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> <span class="built_in">source</span>/images</span><br></pre></td></tr></table></figure><h3 id="2-æ”¾ç½®å›¾ç‰‡æ–‡ä»¶"><a href="#2-æ”¾ç½®å›¾ç‰‡æ–‡ä»¶" class="headerlink" title="2. æ”¾ç½®å›¾ç‰‡æ–‡ä»¶"></a>2. æ”¾ç½®å›¾ç‰‡æ–‡ä»¶</h3><p>å°†å›¾ç‰‡æ–‡ä»¶æ”¾åœ¨ <code>source/images/</code> ç›®å½•ä¸‹</p><h3 id="3-åœ¨æ–‡ç« ä¸­ä½¿ç”¨"><a href="#3-åœ¨æ–‡ç« ä¸­ä½¿ç”¨" class="headerlink" title="3. åœ¨æ–‡ç« ä¸­ä½¿ç”¨"></a>3. åœ¨æ–‡ç« ä¸­ä½¿ç”¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">å›¾ç‰‡æè¿°</span>](<span class="link">/images/å›¾ç‰‡æ–‡ä»¶å.jpg</span>)</span><br></pre></td></tr></table></figure><h3 id="4-é‡æ–°ç”Ÿæˆå’Œéƒ¨ç½²"><a href="#4-é‡æ–°ç”Ÿæˆå’Œéƒ¨ç½²" class="headerlink" title="4. é‡æ–°ç”Ÿæˆå’Œéƒ¨ç½²"></a>4. é‡æ–°ç”Ÿæˆå’Œéƒ¨ç½²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx hexo clean</span><br><span class="line">npx hexo generate</span><br><span class="line">npx hexo deploy</span><br></pre></td></tr></table></figure><h2 id="ğŸ“-æœ€ä½³å®è·µå»ºè®®"><a href="#ğŸ“-æœ€ä½³å®è·µå»ºè®®" class="headerlink" title="ğŸ“ æœ€ä½³å®è·µå»ºè®®"></a>ğŸ“ æœ€ä½³å®è·µå»ºè®®</h2><h3 id="å›¾ç‰‡å‘½åè§„èŒƒ"><a href="#å›¾ç‰‡å‘½åè§„èŒƒ" class="headerlink" title="å›¾ç‰‡å‘½åè§„èŒƒ"></a>å›¾ç‰‡å‘½åè§„èŒƒ</h3><ul><li>ä½¿ç”¨è‹±æ–‡å’Œæ•°å­—</li><li>é¿å…ç‰¹æ®Šå­—ç¬¦å’Œä¸­æ–‡</li><li>ä½¿ç”¨æè¿°æ€§åç§°</li></ul><h3 id="å›¾ç‰‡æ ¼å¼é€‰æ‹©"><a href="#å›¾ç‰‡æ ¼å¼é€‰æ‹©" class="headerlink" title="å›¾ç‰‡æ ¼å¼é€‰æ‹©"></a>å›¾ç‰‡æ ¼å¼é€‰æ‹©</h3><ul><li><strong>PNG</strong>: é€‚åˆå›¾æ ‡ã€æˆªå›¾ã€é€æ˜èƒŒæ™¯</li><li><strong>JPG</strong>: é€‚åˆç…§ç‰‡ã€å¤æ‚å›¾ç‰‡</li><li><strong>WebP</strong>: ç°ä»£æ ¼å¼ï¼Œä½“ç§¯å°ï¼Œè´¨é‡é«˜</li><li><strong>SVG</strong>: çŸ¢é‡å›¾ï¼Œé€‚åˆå›¾æ ‡å’Œç®€å•å›¾å½¢</li></ul><h3 id="å›¾ç‰‡SEOä¼˜åŒ–"><a href="#å›¾ç‰‡SEOä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡SEOä¼˜åŒ–"></a>å›¾ç‰‡SEOä¼˜åŒ–</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Vue.jsç»„ä»¶ç”Ÿå‘½å‘¨æœŸå›¾ - è¯¦ç»†å±•ç¤ºäº†Vueç»„ä»¶çš„åˆ›å»ºã€æ›´æ–°å’Œé”€æ¯è¿‡ç¨‹</span>](<span class="link">/images/vue-lifecycle.png</span>)</span><br></pre></td></tr></table></figure><h2 id="ğŸ”-å¸¸è§é—®é¢˜æ’æŸ¥"><a href="#ğŸ”-å¸¸è§é—®é¢˜æ’æŸ¥" class="headerlink" title="ğŸ” å¸¸è§é—®é¢˜æ’æŸ¥"></a>ğŸ” å¸¸è§é—®é¢˜æ’æŸ¥</h2><h3 id="é—®é¢˜1-å›¾ç‰‡æ˜¾ç¤ºä¸ºé“¾æ¥"><a href="#é—®é¢˜1-å›¾ç‰‡æ˜¾ç¤ºä¸ºé“¾æ¥" class="headerlink" title="é—®é¢˜1: å›¾ç‰‡æ˜¾ç¤ºä¸ºé“¾æ¥"></a>é—®é¢˜1: å›¾ç‰‡æ˜¾ç¤ºä¸ºé“¾æ¥</h3><p><strong>åŸå› </strong>: å›¾ç‰‡è·¯å¾„é”™è¯¯æˆ–æ–‡ä»¶ä¸å­˜åœ¨<br><strong>è§£å†³</strong>: æ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶å</p><h3 id="é—®é¢˜2-æœ¬åœ°æ˜¾ç¤ºæ­£å¸¸ï¼Œçº¿ä¸Šä¸æ˜¾ç¤º"><a href="#é—®é¢˜2-æœ¬åœ°æ˜¾ç¤ºæ­£å¸¸ï¼Œçº¿ä¸Šä¸æ˜¾ç¤º" class="headerlink" title="é—®é¢˜2: æœ¬åœ°æ˜¾ç¤ºæ­£å¸¸ï¼Œçº¿ä¸Šä¸æ˜¾ç¤º"></a>é—®é¢˜2: æœ¬åœ°æ˜¾ç¤ºæ­£å¸¸ï¼Œçº¿ä¸Šä¸æ˜¾ç¤º</h3><p><strong>åŸå› </strong>: å›¾ç‰‡æ–‡ä»¶æœªéƒ¨ç½²åˆ°GitHub<br><strong>è§£å†³</strong>: ç¡®ä¿å›¾ç‰‡åœ¨sourceç›®å½•ä¸‹</p><h3 id="é—®é¢˜3-å›¾ç‰‡åŠ è½½æ…¢"><a href="#é—®é¢˜3-å›¾ç‰‡åŠ è½½æ…¢" class="headerlink" title="é—®é¢˜3: å›¾ç‰‡åŠ è½½æ…¢"></a>é—®é¢˜3: å›¾ç‰‡åŠ è½½æ…¢</h3><p><strong>åŸå› </strong>: å›¾ç‰‡æ–‡ä»¶è¿‡å¤§æˆ–ç½‘ç»œé—®é¢˜<br><strong>è§£å†³</strong>: å‹ç¼©å›¾ç‰‡æˆ–ä½¿ç”¨CDN</p><h2 id="ğŸ¯-æ¨èå®æ–½æ­¥éª¤"><a href="#ğŸ¯-æ¨èå®æ–½æ­¥éª¤" class="headerlink" title="ğŸ¯ æ¨èå®æ–½æ­¥éª¤"></a>ğŸ¯ æ¨èå®æ–½æ­¥éª¤</h2><ol><li><strong>ç«‹å³</strong>: ä½¿ç”¨source&#x2F;imagesæ–¹æ¡ˆè§£å†³å½“å‰é—®é¢˜</li><li><strong>çŸ­æœŸ</strong>: ä¼˜åŒ–å›¾ç‰‡å¤§å°å’Œæ ¼å¼</li><li><strong>é•¿æœŸ</strong>: è€ƒè™‘ä½¿ç”¨CDNåŠ é€Ÿ</li><li><strong>æŒç»­</strong>: å»ºç«‹å›¾ç‰‡ç®¡ç†è§„èŒƒ</li></ol><hr><h2 id="ğŸ’¡-æ€»ç»“"><a href="#ğŸ’¡-æ€»ç»“" class="headerlink" title="ğŸ’¡ æ€»ç»“"></a>ğŸ’¡ æ€»ç»“</h2><p>é€‰æ‹©åˆé€‚çš„å›¾ç‰‡å¤„ç†æ–¹æ¡ˆå¯¹äºåšå®¢çš„åŠ è½½é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒéå¸¸é‡è¦ã€‚å»ºè®®ä»ç®€å•çš„source&#x2F;imagesæ–¹æ¡ˆå¼€å§‹ï¼Œéšç€åšå®¢å†…å®¹å¢åŠ å†è€ƒè™‘ä½¿ç”¨CDNåŠ é€Ÿã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
          <category> åšå®¢ä¼˜åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> å›¾ç‰‡å¤„ç† </tag>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/10/02/hello-world/"/>
      <url>/2025/10/02/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Gitæ“ä½œæŒ‡å— - ä»å…¥é—¨åˆ°ç²¾é€š</title>
      <link href="//git-operation-guide/"/>
      <url>//git-operation-guide/</url>
      
        <content type="html"><![CDATA[<h1 id="Gitæ“ä½œæŒ‡å—-ä»å…¥é—¨åˆ°ç²¾é€š-ğŸš€"><a href="#Gitæ“ä½œæŒ‡å—-ä»å…¥é—¨åˆ°ç²¾é€š-ğŸš€" class="headerlink" title="Gitæ“ä½œæŒ‡å— - ä»å…¥é—¨åˆ°ç²¾é€š ğŸš€"></a>Gitæ“ä½œæŒ‡å— - ä»å…¥é—¨åˆ°ç²¾é€š ğŸš€</h1><blockquote><p>æœ¬æ–‡åŸºäº <a href="https://liaoxuefeng.com/books/git/introduction/index.html">å»–é›ªå³°Gitæ•™ç¨‹</a> å’Œ <a href="https://mofan212.github.io/posts/Git/">Mofançš„Gitç†è®ºä¸ä½¿ç”¨</a> æ•´ç†ï¼Œæ—¨åœ¨æä¾›ä¸€ä»½å®ç”¨ä¸”å…¨é¢çš„Gitæ“ä½œæŒ‡å—ã€‚ğŸ“š</p></blockquote><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><ul><li><a href="#1-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">1. ç‰ˆæœ¬æ§åˆ¶</a></li><li><a href="#2-git%E7%9A%84%E5%8E%86%E5%8F%B2">2. Gitçš„å†å²</a></li><li><a href="#3-git%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">3. Gitç¯å¢ƒé…ç½®</a></li><li><a href="#4-git%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA">4. GitåŸºæœ¬ç†è®º</a></li><li><a href="#5-git%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA">5. Gité¡¹ç›®æ­å»º</a></li><li><a href="#6-git%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C">6. Gitæ–‡ä»¶æ“ä½œ</a></li><li><a href="#7-github%E7%9A%84%E4%BD%BF%E7%94%A8">7. GitHubçš„ä½¿ç”¨</a></li><li><a href="#8-idea%E4%B8%AD%E9%9B%86%E6%88%90git">8. IDEAä¸­é›†æˆGit</a></li><li><a href="#9-git%E5%88%86%E6%94%AF">9. Gitåˆ†æ”¯</a></li><li><a href="#10-%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C">10. å›¢é˜Ÿåä½œ</a></li><li><a href="#11-%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">11. å…¶ä»–å¸¸ç”¨å‘½ä»¤</a></li><li><a href="#12-%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C%E6%B5%81%E7%A8%8B">12. å…¶ä»–æ“ä½œæµç¨‹</a></li><li><a href="#13-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98">13. é‡åˆ°çš„é—®é¢˜</a></li><li><a href="#14-%E5%85%B6%E4%BB%96%E8%A1%A5%E5%85%85%E4%BF%A1%E6%81%AF">14. å…¶ä»–è¡¥å……ä¿¡æ¯</a></li><li><a href="#15-%E5%8F%AF%E8%83%BD%E6%9C%89%E7%94%A8%E7%9A%84%E5%B0%8F%E5%B7%A5%E5%85%B7">15. å¯èƒ½æœ‰ç”¨çš„å°å·¥å…·</a></li></ul><h2 id="1-ç‰ˆæœ¬æ§åˆ¶-ğŸ“š"><a href="#1-ç‰ˆæœ¬æ§åˆ¶-ğŸ“š" class="headerlink" title="1. ç‰ˆæœ¬æ§åˆ¶ ğŸ“š"></a>1. ç‰ˆæœ¬æ§åˆ¶ ğŸ“š</h2><h3 id="1-1-ç‰ˆæœ¬æ§åˆ¶å«ä¹‰-ğŸ“–"><a href="#1-1-ç‰ˆæœ¬æ§åˆ¶å«ä¹‰-ğŸ“–" class="headerlink" title="1.1 ç‰ˆæœ¬æ§åˆ¶å«ä¹‰ ğŸ“–"></a>1.1 ç‰ˆæœ¬æ§åˆ¶å«ä¹‰ ğŸ“–</h3><p>ç‰ˆæœ¬æ§åˆ¶ï¼ˆRevision Controlï¼‰æ˜¯ä¸€ç§åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯¹æ–‡ä»¶ã€ç›®å½•æˆ–å·¥ç¨‹ç­‰å†…å®¹çš„ä¿®æ”¹å†å²è¿›è¡Œç®¡ç†çš„è½¯ä»¶å·¥ç¨‹æŠ€æœ¯ï¼Œä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶åå¯ä»¥é€šè¿‡æŸ¥çœ‹å†å²ä¿®æ”¹è®°å½•ï¼Œæ›´æ–¹ä¾¿åœ°æ¢å¤åˆ°å…ˆå‰çš„ç‰ˆæœ¬ã€‚</p><p>ç‰ˆæœ¬æ§åˆ¶å¯ä»¥ï¼š</p><ul><li>ğŸŒ å®ç°è·¨åŒºåŸŸå¤šäººååŒå¼€å‘</li><li>ğŸ“ è¿½è¸ªå’Œè®°è½½ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶çš„å†å²è®°å½•</li><li>ğŸ—‚ï¸ ç»„ç»‡å’Œä¿æŠ¤ä½ çš„æºä»£ç å’Œæ–‡æ¡£</li><li>ğŸ“Š ç»Ÿè®¡å·¥ä½œé‡</li><li>âš¡ å¹¶è¡Œå¼€å‘ã€æé«˜å¼€å‘æ•ˆç‡</li><li>ğŸ“ˆ è·Ÿè¸ªè®°å½•æ•´ä¸ªè½¯ä»¶çš„å¼€å‘è¿‡ç¨‹</li><li>ğŸ›¡ï¸ å‡è½»å¼€å‘äººå‘˜çš„è´Ÿæ‹…ï¼ŒèŠ‚çœæ—¶é—´ï¼ŒåŒæ—¶é™ä½äººä¸ºé”™è¯¯</li></ul><p>ç®€å•æ¥è¯´å°±æ˜¯ <strong>ç”¨äºç®¡ç†å¤šäººååŒå¼€å‘é¡¹ç›®çš„æŠ€æœ¯</strong>ã€‚</p><h3 id="1-2-ç‰ˆæœ¬æ§åˆ¶å·¥å…·-ğŸ› ï¸"><a href="#1-2-ç‰ˆæœ¬æ§åˆ¶å·¥å…·-ğŸ› ï¸" class="headerlink" title="1.2 ç‰ˆæœ¬æ§åˆ¶å·¥å…· ğŸ› ï¸"></a>1.2 ç‰ˆæœ¬æ§åˆ¶å·¥å…· ğŸ› ï¸</h3><p>ä¸»æµçš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶æœ‰ï¼š</p><ul><li><strong>Git</strong> ğŸ™</li><li><strong>SVN</strong>ï¼ˆSubversionï¼‰ğŸ“</li><li><strong>CVS</strong>ï¼ˆConcurrent Versions Systemï¼‰</li><li><strong>VSS</strong>ï¼ˆMicorosoft Visual SourceSafeï¼‰</li><li><strong>TFS</strong>ï¼ˆTeam Foundation Serverï¼‰</li><li>Visual Studio Online</li></ul><p>ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯ Git ä¸ SVNã€‚</p><h3 id="1-3-ç‰ˆæœ¬æ§åˆ¶åˆ†ç±»-ğŸ“‹"><a href="#1-3-ç‰ˆæœ¬æ§åˆ¶åˆ†ç±»-ğŸ“‹" class="headerlink" title="1.3 ç‰ˆæœ¬æ§åˆ¶åˆ†ç±» ğŸ“‹"></a>1.3 ç‰ˆæœ¬æ§åˆ¶åˆ†ç±» ğŸ“‹</h3><h4 id="1-3-1-æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-ğŸ’»"><a href="#1-3-1-æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-ğŸ’»" class="headerlink" title="1.3.1 æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ğŸ’»"></a>1.3.1 æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ğŸ’»</h4><p>è®°å½•æ–‡ä»¶æ¯æ¬¡çš„æ›´æ–°ï¼Œå¯¹æ¯ä¸ªç‰ˆæœ¬åšä¸€ä¸ªå¿«ç…§ï¼Œæˆ–æ˜¯è®°å½•è¡¥ä¸æ–‡ä»¶ï¼Œé€‚åˆä¸ªäººç”¨ï¼Œå¦‚ RCSã€‚å®ƒæ˜¯åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œè®°å½•ç‰ˆæœ¬çš„ä¸åŒå˜åŒ–ï¼Œä¿è¯å†…å®¹ä¸ä¼šä¸¢å¤±ã€‚ä½†åœ¨å¤šäººå¼€å‘çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªäººéƒ½åœ¨ä¸åŒçš„ç³»ç»Ÿå’Œç”µè„‘ä¸Šå¼€å‘ï¼Œæ²¡åŠæ³•ååŒå·¥ä½œã€‚</p><h4 id="1-3-2-é›†ä¸­ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-ğŸ¢"><a href="#1-3-2-é›†ä¸­ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-ğŸ¢" class="headerlink" title="1.3.2 é›†ä¸­ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ğŸ¢"></a>1.3.2 é›†ä¸­ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ğŸ¢</h4><p>æ‰€æœ‰çš„ç‰ˆæœ¬æ•°æ®éƒ½ä¿å­˜åœ¨ä¸­å¤®æœåŠ¡å™¨ä¸Šï¼ŒååŒå¼€å‘è€…ä»æœåŠ¡å™¨ä¸ŠåŒæ­¥æ›´æ–°æˆ–ä¸Šä¼ è‡ªå·±çš„ä¿®æ”¹ï¼Œç”¨æˆ·åªæœ‰è‡ªå·±ä»¥å‰æ‰€åŒæ­¥çš„ç‰ˆæœ¬ï¼Œå¦‚æœä¸è¿ç½‘ï¼Œç”¨æˆ·å°±çœ‹ä¸åˆ°å†å²ç‰ˆæœ¬ï¼Œä¹Ÿæ— æ³•åˆ‡æ¢ç‰ˆæœ¬éªŒè¯ï¼Œæˆ–åœ¨ä¸åŒåˆ†æ”¯å·¥ä½œã€‚æ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å•ä¸€çš„æœåŠ¡å™¨ä¸Šï¼Œå½“æœåŠ¡å™¨æŸåæ—¶ï¼Œå¯èƒ½ä¼šä¸¢å¤±æ‰€æœ‰æ•°æ®ï¼Œä»£è¡¨äº§å“æœ‰ SVNã€CVSã€VSS ç­‰ã€‚</p><h4 id="1-3-3-åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-ğŸŒ"><a href="#1-3-3-åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-ğŸŒ" class="headerlink" title="1.3.3 åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ğŸŒ"></a>1.3.3 åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ğŸŒ</h4><p>éœ€è¦ä¸€å°æœåŠ¡å™¨ä½œä¸ºè¿œç¨‹ä»£ç ä»“åº“ï¼Œæ‰€æœ‰ç‰ˆæœ¬ä¿¡æ¯åŒæ­¥åˆ°æ¯ä¸ªç”¨æˆ·çš„æœ¬åœ°ã€‚ç”¨æˆ·å¯ä»¥æœ¬åœ°ç¦»çº¿æäº¤ï¼Œåªéœ€åœ¨è”ç½‘æ—¶å°†ä¿®æ”¹æ¨é€åˆ°è¿œç¨‹ä»£ç ä»“åº“å³å¯ã€‚æ¯ä¸ªç”¨æˆ·çš„ç”µè„‘éƒ½æ˜¯ä»£ç ä»“åº“ï¼Œæ˜¯è¿œç¨‹ä»£ç ä»“åº“çš„é•œåƒï¼Œç”¨æˆ·ä¿®æ”¹å’Œè·å–ä»£ç éƒ½æ˜¯åœ¨è‡ªå·±çš„æœ¬åœ°ä»“åº“ä¸­è¿›è¡Œæ“ä½œã€‚</p><p>ç”±äºæ¯ä¸ªç”¨æˆ·éƒ½ä¿å­˜äº†æ‰€æœ‰çš„ç‰ˆæœ¬æ•°æ®ï¼Œåªè¦æœ‰ä¸€ä¸ªç”¨æˆ·çš„è®¾å¤‡æ²¡æœ‰é—®é¢˜å°±å¯ä»¥æ¢å¤æ‰€æœ‰çš„æ•°æ®ï¼Œä¸ä¼šå› ä¸ºæœåŠ¡å™¨æŸåæˆ–è€…ç½‘ç»œé—®é¢˜ï¼Œå‡ºç°ä¸èƒ½å·¥ä½œçš„æƒ…å†µã€‚</p><h3 id="1-4-Git-ä¸-SVN-çš„åŒºåˆ«-âš–ï¸"><a href="#1-4-Git-ä¸-SVN-çš„åŒºåˆ«-âš–ï¸" class="headerlink" title="1.4 Git ä¸ SVN çš„åŒºåˆ« âš–ï¸"></a>1.4 Git ä¸ SVN çš„åŒºåˆ« âš–ï¸</h3><table><thead><tr><th>ç‰¹æ€§</th><th>Git ğŸ™</th><th>SVN ğŸ“</th></tr></thead><tbody><tr><td>æ¶æ„</td><td>åˆ†å¸ƒå¼ ğŸŒ</td><td>é›†ä¸­å¼ ğŸ¢</td></tr><tr><td>ç½‘ç»œä¾èµ–</td><td>æ”¯æŒç¦»çº¿æ“ä½œ ğŸ“±</td><td>å¿…é¡»è”ç½‘ ğŸŒ</td></tr><tr><td>åˆ†æ”¯æ“ä½œ</td><td>è½»é‡çº§ï¼Œæˆæœ¬ä½ âš¡</td><td>é‡é‡çº§ï¼Œæˆæœ¬é«˜ ğŸŒ</td></tr><tr><td>å­˜å‚¨æ–¹å¼</td><td>å…ƒæ•°æ®å­˜å‚¨ ğŸ’¾</td><td>åŸå§‹æ–‡ä»¶å­˜å‚¨ ğŸ“„</td></tr><tr><td>å®‰å…¨æ€§</td><td>æ¯ä¸ªç”¨æˆ·éƒ½æœ‰å®Œæ•´å‰¯æœ¬ ğŸ”’</td><td>ä¾èµ–ä¸­å¤®æœåŠ¡å™¨ âš ï¸</td></tr><tr><td>å¸¸ç”¨åœºæ™¯</td><td>ç»´æŠ¤ä»£ç  ğŸ’»</td><td>ç»´æŠ¤æ–‡æ¡£ ğŸ“„</td></tr></tbody></table><h2 id="2-Gitçš„å†å²-ğŸ“œ"><a href="#2-Gitçš„å†å²-ğŸ“œ" class="headerlink" title="2. Gitçš„å†å² ğŸ“œ"></a>2. Gitçš„å†å² ğŸ“œ</h2><p><strong>2002å¹´</strong> ğŸ“…ï¼šLinuxå†…æ ¸å¼€æºç¤¾åŒºå¼€å§‹å¯ç”¨åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»ŸBitKeeperæ¥ç®¡ç†å’Œç»´æŠ¤ä»£ç ã€‚</p><p><strong>2005å¹´</strong> ğŸ¯ï¼šå¼€å‘BitKeeperçš„BitMoverå…¬å¸ç»“æŸä¸Linuxå†…æ ¸å¼€æºç¤¾åŒºçš„åˆä½œå…³ç³»ï¼Œå¹¶æ”¶å›Linuxå†…æ ¸å¼€æºç¤¾åŒºçš„å…è´¹ä½¿ç”¨æƒã€‚</p><p><strong>ä¸¤å‘¨å</strong> âš¡ï¼šLinuxçš„ç¼”é€ è€…<strong>Linus Torvalds</strong>ä½¿ç”¨ä¸¤å‘¨å¼€å‘å‡ºè‡ªå·±çš„ç‰ˆæœ¬ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯å¦‚ä»Šçš„Gitï¼</p><p><img src="https://via.placeholder.com/200x200/4CAF50/FFFFFF?text=Linus+Torvalds" alt="Linus Torvalds"><br><em>Linuxå’ŒGitä¹‹çˆ¶æçº³æ–¯Â·æ‰˜æ²ƒå…¹ï¼ˆLinus Benedic Torvaldsï¼‰1969ã€èŠ¬å…°</em></p><blockquote><p>ğŸ† <strong>æˆå°±</strong>: ä¸€ä¸ªæ”¹å˜æ•´ä¸ªè½¯ä»¶å¼€å‘ä¸–ç•Œçš„å·¥å…·ï¼Œç«Ÿç„¶åªç”¨äº†ä¸¤å‘¨æ—¶é—´å¼€å‘ï¼</p></blockquote><h2 id="3-Gitç¯å¢ƒé…ç½®-âš™ï¸"><a href="#3-Gitç¯å¢ƒé…ç½®-âš™ï¸" class="headerlink" title="3. Gitç¯å¢ƒé…ç½® âš™ï¸"></a>3. Gitç¯å¢ƒé…ç½® âš™ï¸</h2><h3 id="3-1-å®‰è£…ä¸å¸è½½Git-ğŸ’»"><a href="#3-1-å®‰è£…ä¸å¸è½½Git-ğŸ’»" class="headerlink" title="3.1 å®‰è£…ä¸å¸è½½Git ğŸ’»"></a>3.1 å®‰è£…ä¸å¸è½½Git ğŸ’»</h3><h4 id="Windowsç³»ç»Ÿ-ğŸªŸ"><a href="#Windowsç³»ç»Ÿ-ğŸªŸ" class="headerlink" title="Windowsç³»ç»Ÿ ğŸªŸ"></a>Windowsç³»ç»Ÿ ğŸªŸ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½å¹¶å®‰è£…Git for Windows</span></span><br><span class="line"><span class="comment"># https://git-scm.com/download/win</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å®‰è£…</span></span><br><span class="line">git --version</span><br><span class="line"></span><br><span class="line">$ git --version</span><br><span class="line">git version 2.47.0.windows.1</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>æ¨è</strong>: å¦‚æœå®˜ç½‘ä¸‹è½½å¤ªæ…¢ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://registry.npmmirror.com/binary.html?path=git-for-windows/">æ·˜å®é•œåƒ</a>ä¸‹è½½ï¼</p></blockquote><h4 id="macOSç³»ç»Ÿ-ğŸ"><a href="#macOSç³»ç»Ÿ-ğŸ" class="headerlink" title="macOSç³»ç»Ÿ ğŸ"></a>macOSç³»ç»Ÿ ğŸ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨Homebrewå®‰è£…</span></span><br><span class="line">brew install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨Xcode Command Line Tools</span></span><br><span class="line">xcode-select --install</span><br></pre></td></tr></table></figure><h4 id="Linuxç³»ç»Ÿ-ğŸ§"><a href="#Linuxç³»ç»Ÿ-ğŸ§" class="headerlink" title="Linuxç³»ç»Ÿ ğŸ§"></a>Linuxç³»ç»Ÿ ğŸ§</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># CentOS/RHEL</span></span><br><span class="line"><span class="built_in">sudo</span> yum install git</span><br></pre></td></tr></table></figure><h3 id="3-2-Linuxå¸¸ç”¨å‘½ä»¤-ğŸ§"><a href="#3-2-Linuxå¸¸ç”¨å‘½ä»¤-ğŸ§" class="headerlink" title="3.2 Linuxå¸¸ç”¨å‘½ä»¤ ğŸ§"></a>3.2 Linuxå¸¸ç”¨å‘½ä»¤ ğŸ§</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åç»­æ…¢æ…¢è¡¥å……</span></span><br><span class="line"><span class="comment"># ç›®å½•æ“ä½œ</span></span><br><span class="line"><span class="built_in">pwd</span>                     <span class="comment"># æ˜¾ç¤ºå½“å‰ç›®å½•</span></span><br><span class="line"><span class="built_in">ls</span> -la                  <span class="comment"># æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="built_in">cd</span> /path/to/directory   <span class="comment"># åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> directory_name    <span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="built_in">rm</span> -rf directory_name   <span class="comment"># åˆ é™¤ç›®å½•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ä»¶æ“ä½œ</span></span><br><span class="line"><span class="built_in">touch</span> file_name         <span class="comment"># åˆ›å»ºæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cat</span> file_name          <span class="comment"># æŸ¥çœ‹æ–‡ä»¶å†…å®¹</span></span><br><span class="line">vim file_name          <span class="comment"># ç¼–è¾‘æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">rm</span> file_name           <span class="comment"># åˆ é™¤æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æƒé™æ“ä½œ</span></span><br><span class="line"><span class="built_in">chmod</span> 755 file_name    <span class="comment"># ä¿®æ”¹æ–‡ä»¶æƒé™</span></span><br><span class="line"><span class="built_in">chown</span> user:group file  <span class="comment"># ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…</span></span><br></pre></td></tr></table></figure><h3 id="3-3-Gitçš„é…ç½®-ğŸ”§"><a href="#3-3-Gitçš„é…ç½®-ğŸ”§" class="headerlink" title="3.3 Gitçš„é…ç½® ğŸ”§"></a>3.3 Gitçš„é…ç½® ğŸ”§</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ç”¨æˆ·ä¿¡æ¯ ğŸ‘¤</span></span><br><span class="line">git config --global user.name <span class="string">&quot;ä½ çš„å§“å&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;ä½ çš„é‚®ç®±@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é»˜è®¤ç¼–è¾‘å™¨ âœï¸</span></span><br><span class="line">git config --global core.editor <span class="string">&quot;code --wait&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é…ç½® ğŸ“‹</span></span><br><span class="line">git config --list</span><br><span class="line"></span><br><span class="line">$ git config --list</span><br><span class="line">diff.astextplain.textconv=astextplain</span><br><span class="line">filter.lfs.clean=git-lfs clean -- %f</span><br><span class="line">filter.lfs.smudge=git-lfs smudge -- %f</span><br><span class="line">filter.lfs.process=git-lfs filter-process</span><br><span class="line">filter.lfs.required=<span class="literal">true</span></span><br><span class="line">http.sslbackend=openssl</span><br><span class="line">http.sslcainfo=D:/Program Files/Git/mingw64/etc/ssl/certs/ca-bundle.crt</span><br><span class="line">core.autocrlf=<span class="literal">true</span></span><br><span class="line">core.fscache=<span class="literal">true</span></span><br><span class="line">core.symlinks=<span class="literal">false</span></span><br><span class="line">pull.rebase=<span class="literal">false</span></span><br><span class="line">credential.helper=manager</span><br><span class="line">credential.https://dev.azure.com.usehttppath=<span class="literal">true</span></span><br><span class="line">init.defaultbranch=master</span><br><span class="line">color.ui=<span class="literal">true</span></span><br><span class="line">user.name=chad.suo</span><br><span class="line">user.email=xxx</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸åŒçº§åˆ«çš„é…ç½®ä¿¡æ¯ï¼š</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç³»ç»Ÿ config</span></span><br><span class="line">git config --system --list</span><br><span class="line">ã€€ã€€</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼ˆglobalï¼‰é…ç½®</span></span><br><span class="line">git config --global  --list</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>âš ï¸ <strong>æ³¨æ„</strong>: å®‰è£…æ—¶è¿˜å¯ä»¥ä¿®æ”¹é»˜è®¤ç¼–è¾‘å™¨ï¼Œé»˜è®¤æ˜¯Vimç¼–è¾‘å™¨ã€‚æ¯”å¦‚å°†é»˜è®¤ç¼–è¾‘å™¨ä¿®æ”¹ä¸ºNotePad3ï¼Œæ‰¾åˆ°NotePad3çš„exeæ–‡ä»¶å¹¶é€‰æ‹©å³å¯ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Git ç›¸å…³çš„æœ¬åœ°é…ç½®æ–‡ä»¶ä½ç½®ï¼š</span><br><span class="line"></span><br><span class="line">â€‹Git å®‰è£…ç›®å½• \etc\gitconfigï¼šGit å®‰è£…ç›®å½•ä¸‹çš„ gitconfig --system ç³»ç»Ÿçº§é…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">â€‹C:\Users\ä½ çš„ç”¨æˆ·å\ .gitconfigï¼šåªé€‚ç”¨äºå½“å‰ç™»å½•ç”¨æˆ·çš„é…ç½® --global å…¨å±€é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="2-3-å¤šè´¦å·é…ç½®ï¼ˆè¿™é‡Œéœ€è¦è¡¥å……ï¼‰"><a href="#2-3-å¤šè´¦å·é…ç½®ï¼ˆè¿™é‡Œéœ€è¦è¡¥å……ï¼‰" class="headerlink" title="2.3 å¤šè´¦å·é…ç½®ï¼ˆè¿™é‡Œéœ€è¦è¡¥å……ï¼‰"></a>2.3 å¤šè´¦å·é…ç½®ï¼ˆè¿™é‡Œéœ€è¦è¡¥å……ï¼‰</h3><h4 id="SSHå¯†é’¥æ–¹å¼"><a href="#SSHå¯†é’¥æ–¹å¼" class="headerlink" title="SSHå¯†é’¥æ–¹å¼"></a>SSHå¯†é’¥æ–¹å¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Personal-Access-Tokenæ–¹å¼"><a href="#Personal-Access-Tokenæ–¹å¼" class="headerlink" title="Personal Access Tokenæ–¹å¼"></a>Personal Access Tokenæ–¹å¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-GitåŸºæœ¬ç†è®º-ğŸ§ "><a href="#4-GitåŸºæœ¬ç†è®º-ğŸ§ " class="headerlink" title="4. GitåŸºæœ¬ç†è®º ğŸ§ "></a>4. GitåŸºæœ¬ç†è®º ğŸ§ </h2><h3 id="4-1-Gitçš„ä¸‰ä¸ªåŒºåŸŸ-ğŸ—ï¸"><a href="#4-1-Gitçš„ä¸‰ä¸ªåŒºåŸŸ-ğŸ—ï¸" class="headerlink" title="4.1 Gitçš„ä¸‰ä¸ªåŒºåŸŸ ğŸ—ï¸"></a>4.1 Gitçš„ä¸‰ä¸ªåŒºåŸŸ ğŸ—ï¸</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å·¥ä½œåŒº (Working Directory) ğŸ“</span><br><span class="line">    â†“ git add</span><br><span class="line">æš‚å­˜åŒº (Staging Area) ğŸ“¦</span><br><span class="line">    â†“ git commit</span><br><span class="line">æœ¬åœ°ä»“åº“ (Local Repository) ğŸ’¾</span><br><span class="line">    â†“ git push</span><br><span class="line">è¿œç¨‹ä»“åº“ (Remote Repository) â˜ï¸</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>å°è´´å£«</strong>: ç†è§£è¿™ä¸‰ä¸ªåŒºåŸŸæ˜¯æŒæ¡Gitçš„å…³é”®ï¼å·¥ä½œåŒºæ˜¯ä½ ç¼–è¾‘æ–‡ä»¶çš„åœ°æ–¹ï¼Œæš‚å­˜åŒºæ˜¯å‡†å¤‡æäº¤çš„æ–‡ä»¶çš„ä¸´æ—¶å­˜å‚¨ï¼Œæœ¬åœ°ä»“åº“æ˜¯é¡¹ç›®çš„å®Œæ•´å†å²è®°å½•ã€‚</p></blockquote><h3 id="4-2-Gitå¯¹è±¡æ¨¡å‹-ğŸ”"><a href="#4-2-Gitå¯¹è±¡æ¨¡å‹-ğŸ”" class="headerlink" title="4.2 Gitå¯¹è±¡æ¨¡å‹ ğŸ”"></a>4.2 Gitå¯¹è±¡æ¨¡å‹ ğŸ”</h3><p>Gitä½¿ç”¨å››ç§ä¸»è¦å¯¹è±¡ç±»å‹ï¼š</p><ul><li><strong>Blobå¯¹è±¡</strong> ğŸ“„ï¼šå­˜å‚¨æ–‡ä»¶å†…å®¹</li><li><strong>Treeå¯¹è±¡</strong> ğŸŒ³ï¼šå­˜å‚¨ç›®å½•ç»“æ„å’Œæ–‡ä»¶å</li><li><strong>Commitå¯¹è±¡</strong> ğŸ“ï¼šå­˜å‚¨æäº¤ä¿¡æ¯</li><li><strong>Tagå¯¹è±¡</strong> ğŸ·ï¸ï¼šå­˜å‚¨æ ‡ç­¾ä¿¡æ¯</li></ul><h3 id="4-3-Gitçš„å“ˆå¸Œæœºåˆ¶-ğŸ”"><a href="#4-3-Gitçš„å“ˆå¸Œæœºåˆ¶-ğŸ”" class="headerlink" title="4.3 Gitçš„å“ˆå¸Œæœºåˆ¶ ğŸ”"></a>4.3 Gitçš„å“ˆå¸Œæœºåˆ¶ ğŸ”</h3><p>Gitä½¿ç”¨SHA-1å“ˆå¸Œç®—æ³•ä¸ºæ¯ä¸ªå¯¹è±¡ç”Ÿæˆå”¯ä¸€çš„40ä½åå…­è¿›åˆ¶æ ‡è¯†ç¬¦ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œå”¯ä¸€æ€§ã€‚</p><h2 id="5-Gité¡¹ç›®æ­å»º-ğŸš€"><a href="#5-Gité¡¹ç›®æ­å»º-ğŸš€" class="headerlink" title="5. Gité¡¹ç›®æ­å»º ğŸš€"></a>5. Gité¡¹ç›®æ­å»º ğŸš€</h2><h3 id="5-1-ä»“åº“åˆå§‹åŒ–-ğŸ"><a href="#5-1-ä»“åº“åˆå§‹åŒ–-ğŸ" class="headerlink" title="5.1 ä»“åº“åˆå§‹åŒ– ğŸ"></a>5.1 ä»“åº“åˆå§‹åŒ– ğŸ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–æœ¬åœ°ä»“åº“</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…‹éš†è¿œç¨‹ä»“åº“</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…‹éš†æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line">git <span class="built_in">clone</span> -b åˆ†æ”¯å https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h2 id="6-Gitæ–‡ä»¶æ“ä½œ-ğŸ“"><a href="#6-Gitæ–‡ä»¶æ“ä½œ-ğŸ“" class="headerlink" title="6. Gitæ–‡ä»¶æ“ä½œ ğŸ“"></a>6. Gitæ–‡ä»¶æ“ä½œ ğŸ“</h2><h3 id="6-1-åŸºæœ¬æ–‡ä»¶æ“ä½œ-ğŸ“„"><a href="#6-1-åŸºæœ¬æ–‡ä»¶æ“ä½œ-ğŸ“„" class="headerlink" title="6.1 åŸºæœ¬æ–‡ä»¶æ“ä½œ ğŸ“„"></a>6.1 åŸºæœ¬æ–‡ä»¶æ“ä½œ ğŸ“„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶çš„å››ç§çŠ¶æ€</span></span><br><span class="line">ç‰ˆæœ¬æ§åˆ¶å°±æ˜¯å¯¹æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶ï¼Œè¦å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€æäº¤ç­‰æ“ä½œï¼Œé¦–å…ˆè¦çŸ¥é“æ–‡ä»¶å½“å‰æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">1ã€Untrackedï¼šæœªè·Ÿè¸ªï¼Œæ­¤æ–‡ä»¶åœ¨æ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ²¡æœ‰åŠ å…¥åˆ° Git åº“ï¼Œä¸å‚ä¸ç‰ˆæœ¬æ§åˆ¶ã€‚å¯ä»¥é€šè¿‡ git add çŠ¶æ€å˜ä¸º Stagedã€‚</span><br><span class="line"></span><br><span class="line">2ã€Unmodifyï¼šæ–‡ä»¶å·²ç»å…¥åº“ï¼Œä¸”æœªä¿®æ”¹ï¼Œå³ç‰ˆæœ¬åº“ä¸­çš„æ–‡ä»¶å¿«ç…§å†…å®¹ä¸æ–‡ä»¶å¤¹ä¸­å®Œå…¨ä¸€è‡´ã€‚è¿™ç§ç±»å‹çš„æ–‡ä»¶æœ‰ä¸¤ç§å»å¤„ï¼Œå¦‚æœå®ƒè¢«ä¿®æ”¹ï¼Œå˜ä¸º Modifiedï¼›å¦‚æœä½¿ç”¨ git <span class="built_in">rm</span> ç§»å‡ºç‰ˆæœ¬åº“ï¼Œåˆ™å˜ä¸º Untrackedã€‚</span><br><span class="line"></span><br><span class="line">3ã€Modifiedï¼šæ–‡ä»¶å·²ä¿®æ”¹ï¼Œ ä»…ä»…æ˜¯ä¿®æ”¹ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå…¶ä»–çš„æ“ä½œã€‚è¿™ä¸ªæ–‡ä»¶ä¹Ÿæœ‰ä¸¤ä¸ªå»å¤„ï¼Œé€šè¿‡ git add å˜ä¸ºæš‚å­˜ Staged çŠ¶æ€ï¼›ä½¿ç”¨ git checkout ä¸¢å¼ƒä¿®æ”¹ï¼Œ è¿”å›åˆ° Unmodify çŠ¶æ€ã€‚git checkout è¡¨ç¤ºä»åº“ä¸­å–å‡ºæ–‡ä»¶ï¼Œè¦†ç›–å½“å‰ä¿®æ”¹ï¼Œå³ä¸¢å¼ƒå½“å‰ä¿®æ”¹ã€‚</span><br><span class="line"></span><br><span class="line">4ã€Stagedï¼šæš‚å­˜çŠ¶æ€ã€‚é€šè¿‡ git commit å°†ä¿®æ”¹æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œ æ–‡ä»¶å˜ä¸º Unmodify çŠ¶æ€ã€‚æ‰§è¡Œ git reset HEAD filename å–æ¶ˆæš‚å­˜ï¼Œ å˜ä¸º Modified çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€ ğŸ‘€</span></span><br><span class="line">git status</span><br><span class="line">git status [filename]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº â•</span></span><br><span class="line">git add æ–‡ä»¶å                    <span class="comment"># æ·»åŠ å•ä¸ªæ–‡ä»¶</span></span><br><span class="line">git add .                        <span class="comment"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">git add *.js                     <span class="comment"># æ·»åŠ æ‰€æœ‰jsæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤åˆ°æœ¬åœ°ä»“åº“ ğŸ’¾</span></span><br><span class="line">git commit -m <span class="string">&quot;æäº¤ä¿¡æ¯&quot;</span></span><br><span class="line">git commit -am <span class="string">&quot;æäº¤ä¿¡æ¯&quot;</span>         <span class="comment"># æ·»åŠ å¹¶æäº¤å·²è·Ÿè¸ªçš„æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤å†å² ğŸ“œ</span></span><br><span class="line">git <span class="built_in">log</span></span><br><span class="line">git <span class="built_in">log</span> --oneline               <span class="comment"># ç®€æ´æ˜¾ç¤º</span></span><br><span class="line">git <span class="built_in">log</span> --graph                 <span class="comment"># å›¾å½¢åŒ–æ˜¾ç¤º</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¿½ç•¥æ–‡ä»¶</span></span><br><span class="line">æœ‰æ—¶ä¸æƒ³æŠŠæŸäº›æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œæ¯”å¦‚æ•°æ®åº“æ–‡ä»¶ï¼Œä¸´æ—¶æ–‡ä»¶ï¼Œè®¾è®¡æ–‡ä»¶ç­‰ï¼Œè¦æ±‚å¿½ç•¥è¿™äº›æ–‡ä»¶çš„ä¿®æ”¹ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨æ ¹ç›®å½•ä¸‹å»ºç«‹ .gitignore æ–‡ä»¶ï¼Œå°†éœ€è¦è¢«å¿½ç•¥çš„æ–‡ä»¶åæ·»åŠ åˆ°æ­¤æ–‡ä»¶ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">.gitignore æ–‡ä»¶å†…å®¹è§£æï¼š</span><br><span class="line"></span><br><span class="line">1ã€ä»¥äº•å· <span class="comment"># å¼€å§‹çš„è¡Œè¡¨ç¤ºæ³¨é‡Šï¼›</span></span><br><span class="line"></span><br><span class="line">2ã€å¯ä»¥ä½¿ç”¨ Linux é€šé…ç¬¦ã€‚ä¾‹å¦‚ï¼šæ˜Ÿå· * ä»£è¡¨ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œé—®å· ? ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œæ–¹æ‹¬å· [] ä»£è¡¨å¯é€‰å­—ç¬¦èŒƒå›´ï¼Œå¤§æ‹¬å· &#123;&#125; ä»£è¡¨å¯é€‰çš„å­—ç¬¦ä¸²ç­‰ï¼›</span><br><span class="line"></span><br><span class="line">3ã€å¦‚æœåç§°çš„æœ€å‰é¢æœ‰ä¸€ä¸ªæ„Ÿå¹å· !ï¼Œè¡¨ç¤ºä¾‹å¤–è§„åˆ™ï¼Œæ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶ä¸ä¼šè¢«å¿½ç•¥ï¼›</span><br><span class="line"></span><br><span class="line">4ã€å¦‚æœåç§°çš„æœ€å‰é¢æ˜¯ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦ /ï¼Œè¡¨ç¤ºè¦å¿½ç•¥çš„æ–‡ä»¶åœ¨æ ¹ç›®å½•ä¸‹ï¼›</span><br><span class="line"></span><br><span class="line">5ã€å¦‚æœåç§°çš„æœ€åé¢æ˜¯ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦ /ï¼Œè¡¨ç¤ºè¦å¿½ç•¥çš„æ˜¯æ­¤ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">*.txt        <span class="comment"># å¿½ç•¥æ‰€æœ‰ .txt ç»“å°¾çš„æ–‡ä»¶</span></span><br><span class="line">!lib.txt     <span class="comment"># lib.txt é™¤å¤–</span></span><br><span class="line">/temp        <span class="comment"># å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ temp æ–‡ä»¶</span></span><br><span class="line">build/       <span class="comment"># å¿½ç•¥ build ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">doc/*.txt    <span class="comment"># å¿½ç•¥ doc ç›®å½•ä¸‹çš„æ‰€æœ‰ txt æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬å­ç›®å½•ä¸‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># IDEA ä¸­å¸¸ç”¨çš„ .gitignore æ–‡ä»¶å†…å®¹ï¼š</span></span><br><span class="line"><span class="comment"># Compiled class file</span></span><br><span class="line">*.class</span><br><span class="line"></span><br><span class="line"><span class="comment"># Log file</span></span><br><span class="line">*.<span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># BlueJ files</span></span><br><span class="line">*.ctxt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mobile Tools for Java (J2ME)</span></span><br><span class="line">.mtj.tmp/</span><br><span class="line"></span><br><span class="line"><span class="comment"># Package Files #</span></span><br><span class="line">*.jar</span><br><span class="line">*.war</span><br><span class="line">*.nar</span><br><span class="line">*.ear</span><br><span class="line">*.zip</span><br><span class="line">*.tar.gz</span><br><span class="line">*.rar</span><br><span class="line"></span><br><span class="line"><span class="comment"># virtual machine crash logs</span></span><br><span class="line">hs_err_pid*</span><br><span class="line">.classpath</span><br><span class="line">.project</span><br><span class="line">.settings</span><br><span class="line">target</span><br><span class="line">.idea</span><br><span class="line">*.iml</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-2-æ–‡ä»¶ç®¡ç†-ğŸ“‚"><a href="#6-2-æ–‡ä»¶ç®¡ç†-ğŸ“‚" class="headerlink" title="6.2 æ–‡ä»¶ç®¡ç† ğŸ“‚"></a>6.2 æ–‡ä»¶ç®¡ç† ğŸ“‚</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">rm</span> æ–‡ä»¶å                    <span class="comment"># åˆ é™¤æ–‡ä»¶å¹¶æ·»åŠ åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git <span class="built_in">rm</span> --cached æ–‡ä»¶å           <span class="comment"># åªä»æš‚å­˜åŒºåˆ é™¤ï¼Œä¿ç•™å·¥ä½œåŒºæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">mv</span> æ—§æ–‡ä»¶å æ–°æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¿½ç•¥æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># åˆ›å»º.gitignoreæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;node_modules/&quot;</span> &gt;&gt; .gitignore</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;*.log&quot;</span> &gt;&gt; .gitignore</span><br></pre></td></tr></table></figure><h3 id="6-3-æ’¤é”€æ“ä½œ-â†©ï¸"><a href="#6-3-æ’¤é”€æ“ä½œ-â†©ï¸" class="headerlink" title="6.3 æ’¤é”€æ“ä½œ â†©ï¸"></a>6.3 æ’¤é”€æ“ä½œ â†©ï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’¤é”€å·¥ä½œåŒºä¿®æ”¹</span></span><br><span class="line">git checkout -- æ–‡ä»¶å</span><br><span class="line">git restore æ–‡ä»¶å               <span class="comment"># Git 2.23+æ–°å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’¤é”€æš‚å­˜åŒºä¿®æ”¹</span></span><br><span class="line">git reset HEAD æ–‡ä»¶å</span><br><span class="line">git restore --staged æ–‡ä»¶å      <span class="comment"># Git 2.23+æ–°å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤</span></span><br><span class="line">git reset --soft HEAD~1         <span class="comment"># ä¿ç•™ä¿®æ”¹åœ¨æš‚å­˜åŒº</span></span><br><span class="line">git reset --mixed HEAD~1        <span class="comment"># ä¿ç•™ä¿®æ”¹åœ¨å·¥ä½œåŒº</span></span><br><span class="line">git reset --hard HEAD~1         <span class="comment"># å®Œå…¨åˆ é™¤ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤</span></span><br><span class="line">git commit --amend -m <span class="string">&quot;æ–°çš„æäº¤ä¿¡æ¯&quot;</span></span><br></pre></td></tr></table></figure><h2 id="7-GitHubçš„ä½¿ç”¨-ğŸŒ"><a href="#7-GitHubçš„ä½¿ç”¨-ğŸŒ" class="headerlink" title="7. GitHubçš„ä½¿ç”¨ ğŸŒ"></a>7. GitHubçš„ä½¿ç”¨ ğŸŒ</h2><h3 id="7-1-GitHubåŸºç¡€æ“ä½œ-ğŸš€"><a href="#7-1-GitHubåŸºç¡€æ“ä½œ-ğŸš€" class="headerlink" title="7.1 GitHubåŸºç¡€æ“ä½œ ğŸš€"></a>7.1 GitHubåŸºç¡€æ“ä½œ ğŸš€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºGitHubä»“åº“</span></span><br><span class="line"><span class="comment"># 1. åœ¨GitHubç½‘ç«™ä¸Šåˆ›å»ºæ–°ä»“åº“</span></span><br><span class="line"><span class="comment"># 2. å…‹éš†åˆ°æœ¬åœ°</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€ä»£ç åˆ°GitHub</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><h3 id="7-2-GitHubåŠŸèƒ½ç‰¹æ€§-âœ¨"><a href="#7-2-GitHubåŠŸèƒ½ç‰¹æ€§-âœ¨" class="headerlink" title="7.2 GitHubåŠŸèƒ½ç‰¹æ€§ âœ¨"></a>7.2 GitHubåŠŸèƒ½ç‰¹æ€§ âœ¨</h3><ul><li><strong>Issues</strong> ğŸ›ï¼šé—®é¢˜è·Ÿè¸ªå’Œè®¨è®º</li><li><strong>Pull Requests</strong> ğŸ”„ï¼šä»£ç å®¡æŸ¥å’Œåˆå¹¶</li><li><strong>Actions</strong> âš™ï¸ï¼šCI&#x2F;CDè‡ªåŠ¨åŒ–</li><li><strong>Pages</strong> ğŸ“„ï¼šé™æ€ç½‘ç«™æ‰˜ç®¡</li><li><strong>Wiki</strong> ğŸ“šï¼šé¡¹ç›®æ–‡æ¡£</li><li><strong>Releases</strong> ğŸ·ï¸ï¼šç‰ˆæœ¬å‘å¸ƒ</li></ul><h3 id="7-3-GitHubåä½œæµç¨‹-ğŸ¤"><a href="#7-3-GitHubåä½œæµç¨‹-ğŸ¤" class="headerlink" title="7.3 GitHubåä½œæµç¨‹ ğŸ¤"></a>7.3 GitHubåä½œæµç¨‹ ğŸ¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Forkä»“åº“</span></span><br><span class="line"><span class="comment"># 2. å…‹éš†Forkçš„ä»“åº“</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/ä½ çš„ç”¨æˆ·å/ä»“åº“å.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ·»åŠ ä¸Šæ¸¸ä»“åº“</span></span><br><span class="line">git remote add upstream https://github.com/åŸä½œè€…/ä»“åº“å.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯</span></span><br><span class="line">git checkout -b feature/æ–°åŠŸèƒ½</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æäº¤æ›´æ”¹</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;feat: æ·»åŠ æ–°åŠŸèƒ½&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. æ¨é€åˆ°Forkä»“åº“</span></span><br><span class="line">git push origin feature/æ–°åŠŸèƒ½</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. åˆ›å»ºPull Request</span></span><br></pre></td></tr></table></figure><h3 id="æœ¬æœºç»‘å®š-SSH-å…¬é’¥"><a href="#æœ¬æœºç»‘å®š-SSH-å…¬é’¥" class="headerlink" title="æœ¬æœºç»‘å®š SSH å…¬é’¥"></a>æœ¬æœºç»‘å®š SSH å…¬é’¥</h3><h2 id="8-IDEAä¸­é›†æˆGit-ğŸ’»"><a href="#8-IDEAä¸­é›†æˆGit-ğŸ’»" class="headerlink" title="8. IDEAä¸­é›†æˆGit ğŸ’»"></a>8. IDEAä¸­é›†æˆGit ğŸ’»</h2><h3 id="8-1-é…ç½®Git-ğŸ”§"><a href="#8-1-é…ç½®Git-ğŸ”§" class="headerlink" title="8.1 é…ç½®Git ğŸ”§"></a>8.1 é…ç½®Git ğŸ”§</h3><ol><li><strong>è®¾ç½®Gitè·¯å¾„</strong>ï¼šFile â†’ Settings â†’ Version Control â†’ Git</li><li><strong>é…ç½®ç”¨æˆ·ä¿¡æ¯</strong>ï¼šFile â†’ Settings â†’ Version Control â†’ Git â†’ User</li><li><strong>å¯ç”¨Gité›†æˆ</strong>ï¼šVCS â†’ Enable Version Control Integration</li></ol><h3 id="8-2-å¸¸ç”¨æ“ä½œ-ğŸ› ï¸"><a href="#8-2-å¸¸ç”¨æ“ä½œ-ğŸ› ï¸" class="headerlink" title="8.2 å¸¸ç”¨æ“ä½œ ğŸ› ï¸"></a>8.2 å¸¸ç”¨æ“ä½œ ğŸ› ï¸</h3><ul><li><strong>æäº¤æ›´æ”¹</strong>ï¼šCtrl+K æˆ– VCS â†’ Commit</li><li><strong>æ¨é€ä»£ç </strong>ï¼šCtrl+Shift+K æˆ– VCS â†’ Git â†’ Push</li><li><strong>æ‹‰å–ä»£ç </strong>ï¼šCtrl+T æˆ– VCS â†’ Git â†’ Pull</li><li><strong>æŸ¥çœ‹å†å²</strong>ï¼šVCS â†’ Git â†’ Show History</li><li><strong>åˆ†æ”¯ç®¡ç†</strong>ï¼šVCS â†’ Git â†’ Branches</li></ul><h2 id="9-Gitåˆ†æ”¯-ğŸŒ¿"><a href="#9-Gitåˆ†æ”¯-ğŸŒ¿" class="headerlink" title="9. Gitåˆ†æ”¯ ğŸŒ¿"></a>9. Gitåˆ†æ”¯ ğŸŒ¿</h2><h3 id="9-1-åˆ†æ”¯åŸºç¡€æ“ä½œ-ğŸ”€"><a href="#9-1-åˆ†æ”¯åŸºç¡€æ“ä½œ-ğŸ”€" class="headerlink" title="9.1 åˆ†æ”¯åŸºç¡€æ“ä½œ ğŸ”€"></a>9.1 åˆ†æ”¯åŸºç¡€æ“ä½œ ğŸ”€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯</span></span><br><span class="line">git branch                      <span class="comment"># æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -r                   <span class="comment"># æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch -a                   <span class="comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºåˆ†æ”¯</span></span><br><span class="line">git branch åˆ†æ”¯å</span><br><span class="line">git checkout -b åˆ†æ”¯å           <span class="comment"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</span></span><br><span class="line">git switch -c åˆ†æ”¯å            <span class="comment"># Git 2.23+æ–°å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ†æ”¯</span></span><br><span class="line">git checkout åˆ†æ”¯å</span><br><span class="line">git switch åˆ†æ”¯å               <span class="comment"># Git 2.23+æ–°å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åˆ†æ”¯</span></span><br><span class="line">git branch -d åˆ†æ”¯å            <span class="comment"># åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯</span></span><br><span class="line">git branch -D åˆ†æ”¯å            <span class="comment"># å¼ºåˆ¶åˆ é™¤åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><h3 id="9-2-åˆ†æ”¯åˆå¹¶-ğŸ”€"><a href="#9-2-åˆ†æ”¯åˆå¹¶-ğŸ”€" class="headerlink" title="9.2 åˆ†æ”¯åˆå¹¶ ğŸ”€"></a>9.2 åˆ†æ”¯åˆå¹¶ ğŸ”€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå¹¶åˆ†æ”¯</span></span><br><span class="line">git merge åˆ†æ”¯å                <span class="comment"># å¿«è¿›åˆå¹¶</span></span><br><span class="line">git merge --no-ff åˆ†æ”¯å        <span class="comment"># éå¿«è¿›åˆå¹¶ï¼Œä¿ç•™åˆ†æ”¯å†å²</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å˜åŸºåˆå¹¶</span></span><br><span class="line">git rebase ç›®æ ‡åˆ†æ”¯</span><br><span class="line">git rebase -i HEAD~3           <span class="comment"># äº¤äº’å¼å˜åŸº</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³åˆå¹¶å†²çª</span></span><br><span class="line"><span class="comment"># 1. ç¼–è¾‘å†²çªæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># 2. æ·»åŠ è§£å†³åçš„æ–‡ä»¶</span></span><br><span class="line">git add æ–‡ä»¶å</span><br><span class="line"><span class="comment"># 3. å®Œæˆåˆå¹¶</span></span><br><span class="line">git commit</span><br></pre></td></tr></table></figure><h3 id="9-3-åˆ†æ”¯ç­–ç•¥-ğŸ“‹"><a href="#9-3-åˆ†æ”¯ç­–ç•¥-ğŸ“‹" class="headerlink" title="9.3 åˆ†æ”¯ç­–ç•¥ ğŸ“‹"></a>9.3 åˆ†æ”¯ç­–ç•¥ ğŸ“‹</h3><h4 id="Git-Flowæ¨¡å‹"><a href="#Git-Flowæ¨¡å‹" class="headerlink" title="Git Flowæ¨¡å‹"></a>Git Flowæ¨¡å‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">main (ç”Ÿäº§ç¯å¢ƒ)</span><br><span class="line">â”œâ”€â”€ develop (å¼€å‘ç¯å¢ƒ)</span><br><span class="line">â”‚   â”œâ”€â”€ feature/æ–°åŠŸèƒ½1</span><br><span class="line">â”‚   â”œâ”€â”€ feature/æ–°åŠŸèƒ½2</span><br><span class="line">â”‚   â””â”€â”€ hotfix/ç´§æ€¥ä¿®å¤</span><br><span class="line">â””â”€â”€ release/ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure><h4 id="GitHub-Flowæ¨¡å‹"><a href="#GitHub-Flowæ¨¡å‹" class="headerlink" title="GitHub Flowæ¨¡å‹"></a>GitHub Flowæ¨¡å‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">main (ä¸»åˆ†æ”¯)</span><br><span class="line">â”œâ”€â”€ feature/æ–°åŠŸèƒ½1</span><br><span class="line">â”œâ”€â”€ feature/æ–°åŠŸèƒ½2</span><br><span class="line">â””â”€â”€ hotfix/ç´§æ€¥ä¿®å¤</span><br></pre></td></tr></table></figure><h2 id="10-å›¢é˜Ÿåä½œ-ğŸ‘¥"><a href="#10-å›¢é˜Ÿåä½œ-ğŸ‘¥" class="headerlink" title="10. å›¢é˜Ÿåä½œ ğŸ‘¥"></a>10. å›¢é˜Ÿåä½œ ğŸ‘¥</h2><h3 id="10-1-å›¢é˜Ÿå†…åä½œ-ğŸ¤"><a href="#10-1-å›¢é˜Ÿå†…åä½œ-ğŸ¤" class="headerlink" title="10.1 å›¢é˜Ÿå†…åä½œ ğŸ¤"></a>10.1 å›¢é˜Ÿå†…åä½œ ğŸ¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote add origin https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class="line">git remote set-url origin æ–°çš„ä»“åº“åœ°å€</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote remove origin</span><br></pre></td></tr></table></figure><h3 id="5-2-æ¨é€å’Œæ‹‰å–"><a href="#5-2-æ¨é€å’Œæ‹‰å–" class="headerlink" title="5.2 æ¨é€å’Œæ‹‰å–"></a>5.2 æ¨é€å’Œæ‹‰å–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨é€åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line">git push origin åˆ†æ”¯å</span><br><span class="line">git push -u origin åˆ†æ”¯å       <span class="comment"># è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯</span></span><br><span class="line">git push --all                  <span class="comment"># æ¨é€æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»è¿œç¨‹ä»“åº“æ‹‰å–</span></span><br><span class="line">git pull origin åˆ†æ”¯å</span><br><span class="line">git fetch origin                <span class="comment"># åªæ‹‰å–ä¸åˆå¹¶</span></span><br><span class="line">git merge origin/åˆ†æ”¯å         <span class="comment"># æ‰‹åŠ¨åˆå¹¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶æ¨é€ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</span></span><br><span class="line">git push --force origin åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h3 id="5-3-æ ‡ç­¾ç®¡ç†"><a href="#5-3-æ ‡ç­¾ç®¡ç†" class="headerlink" title="5.3 æ ‡ç­¾ç®¡ç†"></a>5.3 æ ‡ç­¾ç®¡ç†</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ ‡ç­¾</span></span><br><span class="line">git tag æ ‡ç­¾å                  <span class="comment"># è½»é‡æ ‡ç­¾</span></span><br><span class="line">git tag -a æ ‡ç­¾å -m <span class="string">&quot;æ ‡ç­¾è¯´æ˜&quot;</span>  <span class="comment"># é™„æ³¨æ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ ‡ç­¾</span></span><br><span class="line">git tag</span><br><span class="line">git show æ ‡ç­¾å</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ ‡ç­¾</span></span><br><span class="line">git push origin æ ‡ç­¾å</span><br><span class="line">git push origin --tags          <span class="comment"># æ¨é€æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æ ‡ç­¾</span></span><br><span class="line">git tag -d æ ‡ç­¾å               <span class="comment"># åˆ é™¤æœ¬åœ°æ ‡ç­¾</span></span><br><span class="line">git push origin :refs/tags/æ ‡ç­¾å <span class="comment"># åˆ é™¤è¿œç¨‹æ ‡ç­¾</span></span><br></pre></td></tr></table></figure><h2 id="11-å…¶ä»–å¸¸ç”¨å‘½ä»¤-âš¡"><a href="#11-å…¶ä»–å¸¸ç”¨å‘½ä»¤-âš¡" class="headerlink" title="11. å…¶ä»–å¸¸ç”¨å‘½ä»¤ âš¡"></a>11. å…¶ä»–å¸¸ç”¨å‘½ä»¤ âš¡</h2><h3 id="11-1-å…¶ä»–å¸¸ç”¨å‘½ä»¤ä¸€è§ˆ-ğŸ“‹"><a href="#11-1-å…¶ä»–å¸¸ç”¨å‘½ä»¤ä¸€è§ˆ-ğŸ“‹" class="headerlink" title="11.1 å…¶ä»–å¸¸ç”¨å‘½ä»¤ä¸€è§ˆ ğŸ“‹"></a>11.1 å…¶ä»–å¸¸ç”¨å‘½ä»¤ä¸€è§ˆ ğŸ“‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤å†å²</span></span><br><span class="line">git <span class="built_in">log</span> --oneline --graph --all    <span class="comment"># å›¾å½¢åŒ–æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line">git <span class="built_in">log</span> --<span class="built_in">stat</span>                     <span class="comment"># æ˜¾ç¤ºæ–‡ä»¶ä¿®æ”¹ç»Ÿè®¡</span></span><br><span class="line">git <span class="built_in">log</span> --pretty=format:<span class="string">&quot;%h %s&quot;</span>    <span class="comment"># è‡ªå®šä¹‰æ ¼å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶å·®å¼‚</span></span><br><span class="line">git diff                           <span class="comment"># å·¥ä½œåŒºä¸æš‚å­˜åŒºå·®å¼‚</span></span><br><span class="line">git diff --cached                  <span class="comment"># æš‚å­˜åŒºä¸ä»“åº“å·®å¼‚</span></span><br><span class="line">git diff HEAD                      <span class="comment"># å·¥ä½œåŒºä¸ä»“åº“å·®å¼‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ“ä½œå†å²</span></span><br><span class="line">git reflog                         <span class="comment"># æŸ¥çœ‹æ‰€æœ‰æ“ä½œè®°å½•</span></span><br><span class="line">git reflog --oneline               <span class="comment"># ç®€æ´æ˜¾ç¤ºæ“ä½œè®°å½•</span></span><br></pre></td></tr></table></figure><h3 id="11-2-logä¸reflogåŒºåˆ«-ğŸ”"><a href="#11-2-logä¸reflogåŒºåˆ«-ğŸ”" class="headerlink" title="11.2 logä¸reflogåŒºåˆ« ğŸ”"></a>11.2 logä¸reflogåŒºåˆ« ğŸ”</h3><table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th><th>èŒƒå›´</th></tr></thead><tbody><tr><td><code>git log</code></td><td>æŸ¥çœ‹æäº¤å†å²</td><td>å½“å‰åˆ†æ”¯çš„æäº¤è®°å½•</td></tr><tr><td><code>git reflog</code></td><td>æŸ¥çœ‹æ“ä½œå†å²</td><td>æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…æ‹¬resetã€rebaseç­‰ï¼‰</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤ä½œç”¨</span></span><br><span class="line">git <span class="built_in">log</span> --oneline<span class="comment"># æŸ¥çœ‹å˜æ›´åˆ—è¡¨ä¿¡æ¯</span></span><br><span class="line">git <span class="built_in">log</span> -n2 --oneline<span class="comment"># æŸ¥çœ‹æœ€è¿‘ 2 æ¬¡å˜æ›´ä¿¡æ¯</span></span><br><span class="line">git <span class="built_in">log</span><span class="comment"># æŸ¥çœ‹å½“å‰åˆ†æ”¯ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">git <span class="built_in">log</span> --all<span class="comment"># æŸ¥çœ‹å…¨éƒ¨åˆ†æ”¯å˜æ›´å†å²</span></span><br><span class="line">git <span class="built_in">log</span> --graph<span class="comment"># ä»¥å›¾è°±çš„æ–¹å¼æ˜¾ç¤ºå½“å‰åˆ†æ”¯ç‰ˆæœ¬ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><h3 id="11-3-git-stash-ğŸ’¾"><a href="#11-3-git-stash-ğŸ’¾" class="headerlink" title="11.3 git stash ğŸ’¾"></a>11.3 git stash ğŸ’¾</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æš‚å­˜å½“å‰å·¥ä½œ</span></span><br><span class="line">git stash                          <span class="comment"># æš‚å­˜æ‰€æœ‰ä¿®æ”¹</span></span><br><span class="line">git stash save <span class="string">&quot;æš‚å­˜è¯´æ˜&quot;</span>           <span class="comment"># å¸¦è¯´æ˜çš„æš‚å­˜</span></span><br><span class="line">git stash -u                       <span class="comment"># åŒ…æ‹¬æœªè·Ÿè¸ªæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æš‚å­˜åˆ—è¡¨</span></span><br><span class="line">git stash list                     <span class="comment"># æŸ¥çœ‹æ‰€æœ‰æš‚å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤æš‚å­˜</span></span><br><span class="line">git stash pop                      <span class="comment"># æ¢å¤å¹¶åˆ é™¤æœ€æ–°æš‚å­˜</span></span><br><span class="line">git stash apply                    <span class="comment"># æ¢å¤ä½†ä¿ç•™æš‚å­˜</span></span><br><span class="line">git stash apply stash@&#123;0&#125;          <span class="comment"># æ¢å¤æŒ‡å®šæš‚å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æš‚å­˜</span></span><br><span class="line">git stash drop stash@&#123;0&#125;           <span class="comment"># åˆ é™¤æŒ‡å®šæš‚å­˜</span></span><br><span class="line">git stash clear                    <span class="comment"># æ¸…ç©ºæ‰€æœ‰æš‚å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åªä¿å­˜éƒ¨åˆ†å†…å®¹åˆ°å †æ ˆ</span></span><br><span class="line">git stash ä¼šå°†æ‰€æœ‰æœªæäº¤çš„ä¿®æ”¹ï¼ˆå·¥ä½œåŒºå’Œæš‚å­˜åŒºï¼‰ä¿å­˜è‡³å †æ ˆä¸­ï¼Œé‚£ä¹ˆå¦‚æœåªä¿å­˜éƒ¨åˆ†å†…å®¹å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">1ã€å°†ä¸æƒ³å­˜å‚¨çš„æ–‡ä»¶ä¿å­˜è‡³æš‚å­˜åŒºï¼Œæ¯”å¦‚ git add a.java, b.javaï¼›</span><br><span class="line"></span><br><span class="line">2ã€ä½¿ç”¨ git stash â€“keep-index ä¿å­˜é‚£äº›æœªè¢«æäº¤è‡³æš‚å­˜åŒºçš„æ–‡ä»¶åˆ°å †æ ˆï¼›</span><br><span class="line"></span><br><span class="line">3ã€ä½¿ç”¨ git reset å°†æš‚å­˜å¤„çš„æ–‡ä»¶ç§»åŠ¨åˆ°å·¥ä½œåŒºã€‚</span><br></pre></td></tr></table></figure><h3 id="11-4-cherry-pick-ğŸ’"><a href="#11-4-cherry-pick-ğŸ’" class="headerlink" title="11.4 cherry-pick ğŸ’"></a>11.4 cherry-pick ğŸ’</h3><blockquote><p>cherry-pick æ˜¯Gitä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„å‘½ä»¤ï¼Œç”¨äºå°†æŒ‡å®šçš„æäº¤åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ä¸Šï¼Œå°±åƒâ€æŒ‘é€‰æ¨±æ¡ƒâ€ä¸€æ ·ï¼Œé€‰æ‹©æ€§åœ°åº”ç”¨æŸäº›æäº¤ã€‚</p></blockquote><h4 id="11-4-1-åŸºæœ¬è¯­æ³•-ğŸ“"><a href="#11-4-1-åŸºæœ¬è¯­æ³•-ğŸ“" class="headerlink" title="11.4.1 åŸºæœ¬è¯­æ³• ğŸ“"></a>11.4.1 åŸºæœ¬è¯­æ³• ğŸ“</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹£é€‰å•ä¸ªæäº¤</span></span><br><span class="line">git cherry-pick æäº¤å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹£é€‰å¤šä¸ªæäº¤ï¼ˆä¸è¿ç»­ï¼‰</span></span><br><span class="line">git cherry-pick æäº¤1 æäº¤2 æäº¤3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹£é€‰æäº¤èŒƒå›´ï¼ˆè¿ç»­ï¼‰</span></span><br><span class="line">git cherry-pick æäº¤1..æäº¤2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹£é€‰æäº¤èŒƒå›´ï¼ˆä¸åŒ…å«èµ·å§‹æäº¤ï¼‰</span></span><br><span class="line">git cherry-pick æäº¤1^..æäº¤2</span><br></pre></td></tr></table></figure><h4 id="11-4-2-ä½¿ç”¨åœºæ™¯-ğŸ¯"><a href="#11-4-2-ä½¿ç”¨åœºæ™¯-ğŸ¯" class="headerlink" title="11.4.2 ä½¿ç”¨åœºæ™¯ ğŸ¯"></a>11.4.2 ä½¿ç”¨åœºæ™¯ ğŸ¯</h4><p><strong>åœºæ™¯1ï¼šä¿®å¤bugåˆ°å¤šä¸ªåˆ†æ”¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨mainåˆ†æ”¯ä¿®å¤äº†ä¸€ä¸ªbug</span></span><br><span class="line">git checkout main</span><br><span class="line">git commit -m <span class="string">&quot;fix: ä¿®å¤ç™»å½•bug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éœ€è¦å°†è¿™ä¸ªä¿®å¤åº”ç”¨åˆ°releaseåˆ†æ”¯</span></span><br><span class="line">git checkout release</span><br><span class="line">git cherry-pick mainåˆ†æ”¯çš„æäº¤å“ˆå¸Œ</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯2ï¼šä»å…¶ä»–åˆ†æ”¯è·å–ç‰¹å®šåŠŸèƒ½</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»featureåˆ†æ”¯è·å–æŸä¸ªç‰¹å®šæäº¤</span></span><br><span class="line">git checkout main</span><br><span class="line">git cherry-pick featureåˆ†æ”¯çš„æäº¤å“ˆå¸Œ</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯3ï¼šæ’¤é”€é”™è¯¯çš„åˆå¹¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæŸä¸ªåˆå¹¶æœ‰é—®é¢˜ï¼Œå¯ä»¥cherry-pickå…¶ä»–æäº¤æ¥ä¿®å¤</span></span><br><span class="line">git cherry-pick ä¿®å¤æäº¤çš„å“ˆå¸Œ</span><br></pre></td></tr></table></figure><h4 id="11-4-3-è¯¦ç»†ç¤ºä¾‹-ğŸ“š"><a href="#11-4-3-è¯¦ç»†ç¤ºä¾‹-ğŸ“š" class="headerlink" title="11.4.3 è¯¦ç»†ç¤ºä¾‹ ğŸ“š"></a>11.4.3 è¯¦ç»†ç¤ºä¾‹ ğŸ“š</h4><p><strong>ç¤ºä¾‹1ï¼šåŸºæœ¬cherry-pickæ“ä½œ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤å†å²</span></span><br><span class="line">git <span class="built_in">log</span> --oneline</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># a1b2c3d (HEAD -&gt; main) æ·»åŠ æ–°åŠŸèƒ½</span></span><br><span class="line"><span class="comment"># e4f5g6h ä¿®å¤bug</span></span><br><span class="line"><span class="comment"># i7j8k9l æ›´æ–°æ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹£é€‰ç‰¹å®šæäº¤åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line">git cherry-pick e4f5g6h</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># [main 1a2b3c4] ä¿®å¤bug</span></span><br><span class="line"><span class="comment"># 1 file changed, 2 insertions(+), 1 deletion(-)</span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹2ï¼šæ‹£é€‰å¤šä¸ªæäº¤</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹£é€‰å¤šä¸ªä¸è¿ç»­çš„æäº¤</span></span><br><span class="line">git cherry-pick e4f5g6h i7j8k9l</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹£é€‰è¿ç»­çš„æäº¤èŒƒå›´</span></span><br><span class="line">git cherry-pick e4f5g6h..i7j8k9l</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹3ï¼šä»å…¶ä»–åˆ†æ”¯æ‹£é€‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°ç›®æ ‡åˆ†æ”¯</span></span><br><span class="line">git checkout feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»mainåˆ†æ”¯æ‹£é€‰æäº¤</span></span><br><span class="line">git cherry-pick mainåˆ†æ”¯çš„æäº¤å“ˆå¸Œ</span><br></pre></td></tr></table></figure><h4 id="11-4-4-å¸¸ç”¨é€‰é¡¹-âš™ï¸"><a href="#11-4-4-å¸¸ç”¨é€‰é¡¹-âš™ï¸" class="headerlink" title="11.4.4 å¸¸ç”¨é€‰é¡¹ âš™ï¸"></a>11.4.4 å¸¸ç”¨é€‰é¡¹ âš™ï¸</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åªåº”ç”¨æ›´æ”¹ï¼Œä¸è‡ªåŠ¨æäº¤</span></span><br><span class="line">git cherry-pick --no-commit æäº¤å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘æäº¤ä¿¡æ¯</span></span><br><span class="line">git cherry-pick --edit æäº¤å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šä½œè€…ä¿¡æ¯</span></span><br><span class="line">git cherry-pick --author=<span class="string">&quot;æ–°ä½œè€… &lt;email@example.com&gt;&quot;</span> æäº¤å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»§ç»­cherry-pickï¼ˆè§£å†³å†²çªåï¼‰</span></span><br><span class="line">git cherry-pick --<span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·³è¿‡å½“å‰cherry-pick</span></span><br><span class="line">git cherry-pick --skip</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»ˆæ­¢cherry-pick</span></span><br><span class="line">git cherry-pick --abort</span><br></pre></td></tr></table></figure><h4 id="11-4-5-å¤„ç†å†²çª-ğŸ”§"><a href="#11-4-5-å¤„ç†å†²çª-ğŸ”§" class="headerlink" title="11.4.5 å¤„ç†å†²çª ğŸ”§"></a>11.4.5 å¤„ç†å†²çª ğŸ”§</h4><p><strong>å½“cherry-pické‡åˆ°å†²çªæ—¶ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. æŸ¥çœ‹å†²çªæ–‡ä»¶</span></span><br><span class="line">git status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ‰‹åŠ¨è§£å†³å†²çª</span></span><br><span class="line"><span class="comment"># ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œé€‰æ‹©è¦ä¿ç•™çš„ä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ·»åŠ è§£å†³åçš„æ–‡ä»¶</span></span><br><span class="line">git add å†²çªæ–‡ä»¶</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. ç»§ç»­cherry-pick</span></span><br><span class="line">git cherry-pick --<span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…è·³è¿‡è¿™ä¸ªæäº¤</span></span><br><span class="line">git cherry-pick --skip</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ç»ˆæ­¢æ•´ä¸ªæ“ä½œ</span></span><br><span class="line">git cherry-pick --abort</span><br></pre></td></tr></table></figure><h4 id="11-4-6-å®é™…å·¥ä½œæµç¨‹-ğŸ”„"><a href="#11-4-6-å®é™…å·¥ä½œæµç¨‹-ğŸ”„" class="headerlink" title="11.4.6 å®é™…å·¥ä½œæµç¨‹ ğŸ”„"></a>11.4.6 å®é™…å·¥ä½œæµç¨‹ ğŸ”„</h4><p><strong>å®Œæ•´çš„cherry-pickå·¥ä½œæµç¨‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. æŸ¥çœ‹å¯ç”¨çš„æäº¤</span></span><br><span class="line">git <span class="built_in">log</span> --oneline --graph --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. é€‰æ‹©è¦æ‹£é€‰çš„æäº¤</span></span><br><span class="line">git cherry-pick æäº¤å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¦‚æœæœ‰å†²çªï¼Œè§£å†³å†²çª</span></span><br><span class="line"><span class="comment"># ç¼–è¾‘å†²çªæ–‡ä»¶...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æ·»åŠ è§£å†³åçš„æ–‡ä»¶</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. ç»§ç»­cherry-pick</span></span><br><span class="line">git cherry-pick --<span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. æ¨é€åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line">git push origin åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h4 id="11-4-7-æ³¨æ„äº‹é¡¹-âš ï¸"><a href="#11-4-7-æ³¨æ„äº‹é¡¹-âš ï¸" class="headerlink" title="11.4.7 æ³¨æ„äº‹é¡¹ âš ï¸"></a>11.4.7 æ³¨æ„äº‹é¡¹ âš ï¸</h4><ol><li><strong>æäº¤å“ˆå¸Œä¼šæ”¹å˜</strong>ï¼šcherry-pickä¼šåˆ›å»ºæ–°çš„æäº¤ï¼Œå“ˆå¸Œå€¼ä¼šä¸åŒ</li><li><strong>å¯èƒ½äº§ç”Ÿå†²çª</strong>ï¼šå¦‚æœç›®æ ‡åˆ†æ”¯æœ‰ç›¸å…³ä¿®æ”¹ï¼Œå¯èƒ½äº§ç”Ÿå†²çª</li><li><strong>æäº¤å†å²</strong>ï¼šcherry-pickä¼šä¿ç•™åŸå§‹æäº¤çš„æäº¤ä¿¡æ¯</li><li><strong>åˆ†æ”¯å…³ç³»</strong>ï¼šcherry-pickä¸ä¼šå»ºç«‹åˆ†æ”¯é—´çš„ç›´æ¥å…³ç³»</li></ol><h4 id="11-4-8-ä¸å…¶ä»–å‘½ä»¤çš„åŒºåˆ«-ğŸ”"><a href="#11-4-8-ä¸å…¶ä»–å‘½ä»¤çš„åŒºåˆ«-ğŸ”" class="headerlink" title="11.4.8 ä¸å…¶ä»–å‘½ä»¤çš„åŒºåˆ« ğŸ”"></a>11.4.8 ä¸å…¶ä»–å‘½ä»¤çš„åŒºåˆ« ğŸ”</h4><table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th><th>æäº¤å†å²</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>git merge</code></td><td>åˆå¹¶åˆ†æ”¯</td><td>ä¿ç•™åˆ†æ”¯ç»“æ„</td><td>åˆå¹¶æ•´ä¸ªåˆ†æ”¯</td></tr><tr><td><code>git rebase</code></td><td>å˜åŸº</td><td>çº¿æ€§å†å²</td><td>æ•´ç†æäº¤å†å²</td></tr><tr><td><code>git cherry-pick</code></td><td>æ‹£é€‰æäº¤</td><td>å¤åˆ¶æäº¤</td><td>é€‰æ‹©æ€§åº”ç”¨æäº¤</td></tr></tbody></table><h4 id="11-4-9-é«˜çº§ç”¨æ³•-ğŸš€"><a href="#11-4-9-é«˜çº§ç”¨æ³•-ğŸš€" class="headerlink" title="11.4.9 é«˜çº§ç”¨æ³• ğŸš€"></a>11.4.9 é«˜çº§ç”¨æ³• ğŸš€</h4><p><strong>æ‰¹é‡cherry-pickï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»æŸä¸ªåˆ†æ”¯æ‹£é€‰å¤šä¸ªæäº¤</span></span><br><span class="line">git cherry-pick æäº¤1^..æäº¤2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹£é€‰æ‰€æœ‰æäº¤ï¼ˆä»æŸä¸ªç‚¹å¼€å§‹ï¼‰</span></span><br><span class="line">git cherry-pick èµ·å§‹æäº¤^..HEAD</span><br></pre></td></tr></table></figure><p><strong>äº¤äº’å¼cherry-pickï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨rebaseè¿›è¡Œäº¤äº’å¼cherry-pick</span></span><br><span class="line">git rebase -i èµ·å§‹æäº¤</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­æ ‡è®°è¦æ‹£é€‰çš„æäº¤</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>å°è´´å£«</strong>: cherry-pickæ˜¯Gitåä½œå¼€å‘ä¸­éå¸¸å®ç”¨çš„å·¥å…·ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦å°†ç‰¹å®šä¿®å¤æˆ–åŠŸèƒ½åº”ç”¨åˆ°å¤šä¸ªåˆ†æ”¯çš„åœºæ™¯ã€‚è®°ä½ï¼Œå®ƒåˆ›å»ºçš„æ˜¯æ–°çš„æäº¤ï¼Œè€Œä¸æ˜¯ç§»åŠ¨åŸæœ‰çš„æäº¤ã€‚</p></blockquote><h3 id="11-5-git-diff-ğŸ”"><a href="#11-5-git-diff-ğŸ”" class="headerlink" title="11.5 git diff ğŸ”"></a>11.5 git diff ğŸ”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å·®å¼‚</span></span><br><span class="line">git diff                           <span class="comment"># å·¥ä½œåŒºä¸æš‚å­˜åŒº</span></span><br><span class="line">git diff --cached                  <span class="comment"># æš‚å­˜åŒºä¸ä»“åº“</span></span><br><span class="line">git diff HEAD                      <span class="comment"># å·¥ä½œåŒºä¸ä»“åº“</span></span><br><span class="line">git diff åˆ†æ”¯1 åˆ†æ”¯2               <span class="comment"># ä¸¤ä¸ªåˆ†æ”¯å·®å¼‚</span></span><br><span class="line">git diff æäº¤1 æäº¤2               <span class="comment"># ä¸¤ä¸ªæäº¤å·®å¼‚</span></span><br></pre></td></tr></table></figure><h3 id="11-6-é‡å†™å†å²-ğŸ“"><a href="#11-6-é‡å†™å†å²-ğŸ“" class="headerlink" title="11.6 é‡å†™å†å² ğŸ“"></a>11.6 é‡å†™å†å² ğŸ“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># äº¤äº’å¼å˜åŸº</span></span><br><span class="line">git rebase -i HEAD~3               <span class="comment"># ä¿®æ”¹æœ€è¿‘3ä¸ªæäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æäº¤ä¿¡æ¯</span></span><br><span class="line">git commit --amend -m <span class="string">&quot;æ–°ä¿¡æ¯&quot;</span>     <span class="comment"># ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶æäº¤</span></span><br><span class="line">git rebase -i HEAD~3</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹pickä¸ºsquash</span></span><br></pre></td></tr></table></figure><h3 id="11-7-å›æ»šä¸æ’¤é”€-â†©ï¸"><a href="#11-7-å›æ»šä¸æ’¤é”€-â†©ï¸" class="headerlink" title="11.7 å›æ»šä¸æ’¤é”€ â†©ï¸"></a>11.7 å›æ»šä¸æ’¤é”€ â†©ï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’¤é”€å·¥ä½œåŒºä¿®æ”¹</span></span><br><span class="line">git checkout -- æ–‡ä»¶å</span><br><span class="line">git restore æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’¤é”€æš‚å­˜åŒºä¿®æ”¹</span></span><br><span class="line">git reset HEAD æ–‡ä»¶å</span><br><span class="line">git restore --staged æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›é€€æäº¤</span></span><br><span class="line">git reset --soft HEAD~1            <span class="comment"># ä¿ç•™ä¿®æ”¹åœ¨æš‚å­˜åŒº</span></span><br><span class="line">git reset --mixed HEAD~1           <span class="comment"># ä¿ç•™ä¿®æ”¹åœ¨å·¥ä½œåŒº</span></span><br><span class="line">git reset --hard HEAD~1            <span class="comment"># å®Œå…¨åˆ é™¤ä¿®æ”¹</span></span><br></pre></td></tr></table></figure><h3 id="11-8-å…¶ä»–åæ‚”è¯-ğŸ’Š"><a href="#11-8-å…¶ä»–åæ‚”è¯-ğŸ’Š" class="headerlink" title="11.8 å…¶ä»–åæ‚”è¯ ğŸ’Š"></a>11.8 å…¶ä»–åæ‚”è¯ ğŸ’Š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’¤é”€å·²æ¨é€çš„æäº¤</span></span><br><span class="line">git revert æäº¤å“ˆå¸Œ                <span class="comment"># åˆ›å»ºæ–°æäº¤æ’¤é”€æŒ‡å®šæäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹å†å²æäº¤</span></span><br><span class="line">git rebase -i HEAD~3</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹pickä¸ºedit</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶å</span></span><br><span class="line">git add .</span><br><span class="line">git commit --amend</span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure><h3 id="11-9-abortç»ˆæ­¢-ğŸ›‘"><a href="#11-9-abortç»ˆæ­¢-ğŸ›‘" class="headerlink" title="11.9 abortç»ˆæ­¢ ğŸ›‘"></a>11.9 abortç»ˆæ­¢ ğŸ›‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»ˆæ­¢å„ç§æ“ä½œ</span></span><br><span class="line">git merge --abort                  <span class="comment"># ç»ˆæ­¢åˆå¹¶</span></span><br><span class="line">git rebase --abort                 <span class="comment"># ç»ˆæ­¢å˜åŸº</span></span><br><span class="line">git cherry-pick --abort            <span class="comment"># ç»ˆæ­¢æ‹£é€‰</span></span><br></pre></td></tr></table></figure><h3 id="11-10-åˆå¹¶commit-ğŸ”€"><a href="#11-10-åˆå¹¶commit-ğŸ”€" class="headerlink" title="11.10 åˆå¹¶commit ğŸ”€"></a>11.10 åˆå¹¶commit ğŸ”€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># äº¤äº’å¼å˜åŸºåˆå¹¶æäº¤</span></span><br><span class="line">git rebase -i HEAD~3</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹pickä¸ºsquashæˆ–s</span></span><br></pre></td></tr></table></figure><h3 id="11-11-æŒ‡å®šå½“å‰å·¥ä½œåˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„é“¾æ¥å…³ç³»-ğŸ”—"><a href="#11-11-æŒ‡å®šå½“å‰å·¥ä½œåˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„é“¾æ¥å…³ç³»-ğŸ”—" class="headerlink" title="11.11 æŒ‡å®šå½“å‰å·¥ä½œåˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„é“¾æ¥å…³ç³» ğŸ”—"></a>11.11 æŒ‡å®šå½“å‰å·¥ä½œåˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„é“¾æ¥å…³ç³» ğŸ”—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯</span></span><br><span class="line">git branch --set-upstream-to=origin/åˆ†æ”¯å æœ¬åœ°åˆ†æ”¯å</span><br><span class="line">git push -u origin åˆ†æ”¯å</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³»</span></span><br><span class="line">git branch -vv</span><br></pre></td></tr></table></figure><h3 id="11-12-æ›´å®‰å…¨çš„å¼ºåˆ¶æ¨é€-ğŸš€"><a href="#11-12-æ›´å®‰å…¨çš„å¼ºåˆ¶æ¨é€-ğŸš€" class="headerlink" title="11.12 æ›´å®‰å…¨çš„å¼ºåˆ¶æ¨é€ ğŸš€"></a>11.12 æ›´å®‰å…¨çš„å¼ºåˆ¶æ¨é€ ğŸš€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰å…¨çš„å¼ºåˆ¶æ¨é€</span></span><br><span class="line">git push --force-with-lease origin åˆ†æ”¯å</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶æ¨é€ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</span></span><br><span class="line">git push --force origin åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h2 id="12-å…¶ä»–æ“ä½œæµç¨‹-ğŸ”„"><a href="#12-å…¶ä»–æ“ä½œæµç¨‹-ğŸ”„" class="headerlink" title="12. å…¶ä»–æ“ä½œæµç¨‹ ğŸ”„"></a>12. å…¶ä»–æ“ä½œæµç¨‹ ğŸ”„</h2><h3 id="12-1-æ¨é€åˆ°è¿œç¨‹ä»“åº“-ğŸ“¤"><a href="#12-1-æ¨é€åˆ°è¿œç¨‹ä»“åº“-ğŸ“¤" class="headerlink" title="12.1 æ¨é€åˆ°è¿œç¨‹ä»“åº“ ğŸ“¤"></a>12.1 æ¨é€åˆ°è¿œç¨‹ä»“åº“ ğŸ“¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ‡å‡†æ¨é€æµç¨‹</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;æäº¤ä¿¡æ¯&quot;</span></span><br><span class="line">git push origin åˆ†æ”¯å</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¦–æ¬¡æ¨é€</span></span><br><span class="line">git push -u origin åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h3 id="12-2-æ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°-ğŸ“¥"><a href="#12-2-æ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°-ğŸ“¥" class="headerlink" title="12.2 æ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ° ğŸ“¥"></a>12.2 æ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ° ğŸ“¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹‰å–å¹¶åˆå¹¶</span></span><br><span class="line">git pull origin åˆ†æ”¯å</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªæ‹‰å–ä¸åˆå¹¶</span></span><br><span class="line">git fetch origin</span><br><span class="line">git merge origin/åˆ†æ”¯å</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°</span></span><br><span class="line">git checkout -b æœ¬åœ°åˆ†æ”¯å origin/è¿œç¨‹åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h3 id="12-3-GitHubçš„é»˜è®¤åˆ†æ”¯-ğŸŒ¿"><a href="#12-3-GitHubçš„é»˜è®¤åˆ†æ”¯-ğŸŒ¿" class="headerlink" title="12.3 GitHubçš„é»˜è®¤åˆ†æ”¯ ğŸŒ¿"></a>12.3 GitHubçš„é»˜è®¤åˆ†æ”¯ ğŸŒ¿</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é»˜è®¤åˆ†æ”¯</span></span><br><span class="line">git symbolic-ref refs/remotes/origin/HEAD</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é»˜è®¤åˆ†æ”¯</span></span><br><span class="line">git remote set-head origin main</span><br></pre></td></tr></table></figure><h3 id="12-4-ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€-ğŸ”„"><a href="#12-4-ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€-ğŸ”„" class="headerlink" title="12.4 ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€ ğŸ”„"></a>12.4 ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€ ğŸ”„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class="line">git remote set-url origin æ–°åœ°å€</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ–°çš„è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote add upstream æ–°åœ°å€</span><br></pre></td></tr></table></figure><h3 id="12-5-ä¿®æ”¹å†å²commitç”¨æˆ·åå’Œé‚®ç®±-ğŸ‘¤"><a href="#12-5-ä¿®æ”¹å†å²commitç”¨æˆ·åå’Œé‚®ç®±-ğŸ‘¤" class="headerlink" title="12.5 ä¿®æ”¹å†å²commitç”¨æˆ·åå’Œé‚®ç®± ğŸ‘¤"></a>12.5 ä¿®æ”¹å†å²commitç”¨æˆ·åå’Œé‚®ç®± ğŸ‘¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤</span></span><br><span class="line">git commit --amend --author=<span class="string">&quot;æ–°ç”¨æˆ·å &lt;æ–°é‚®ç®±&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹å¤šä¸ªæäº¤</span></span><br><span class="line">git rebase -i HEAD~3</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹pickä¸ºedit</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹å</span></span><br><span class="line">git commit --amend --author=<span class="string">&quot;æ–°ç”¨æˆ·å &lt;æ–°é‚®ç®±&gt;&quot;</span></span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure><h3 id="12-6-åˆ é™¤æŸæ¬¡æäº¤-ğŸ—‘ï¸"><a href="#12-6-åˆ é™¤æŸæ¬¡æäº¤-ğŸ—‘ï¸" class="headerlink" title="12.6 åˆ é™¤æŸæ¬¡æäº¤ ğŸ—‘ï¸"></a>12.6 åˆ é™¤æŸæ¬¡æäº¤ ğŸ—‘ï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨revertï¼ˆæ¨èï¼‰</span></span><br><span class="line">git revert æäº¤å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨resetï¼ˆå±é™©ï¼‰</span></span><br><span class="line">git reset --hard æäº¤å“ˆå¸Œ</span><br><span class="line">git push --force origin åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h3 id="12-7-ä¿®æ”¹å†å²æäº¤å†…å®¹-âœï¸"><a href="#12-7-ä¿®æ”¹å†å²æäº¤å†…å®¹-âœï¸" class="headerlink" title="12.7 ä¿®æ”¹å†å²æäº¤å†…å®¹ âœï¸"></a>12.7 ä¿®æ”¹å†å²æäº¤å†…å®¹ âœï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># äº¤äº’å¼å˜åŸº</span></span><br><span class="line">git rebase -i HEAD~3</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹pickä¸ºedit</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶å</span></span><br><span class="line">git add .</span><br><span class="line">git commit --amend</span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure><h3 id="12-8-mergeçš„å›é€€-â†©ï¸"><a href="#12-8-mergeçš„å›é€€-â†©ï¸" class="headerlink" title="12.8 mergeçš„å›é€€ â†©ï¸"></a>12.8 mergeçš„å›é€€ â†©ï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å›é€€åˆå¹¶</span></span><br><span class="line">git reset --hard HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨revert</span></span><br><span class="line">git revert -m 1 åˆå¹¶æäº¤å“ˆå¸Œ</span><br></pre></td></tr></table></figure><h3 id="12-9-ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡çš„commitæ—¶é—´-â°"><a href="#12-9-ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡çš„commitæ—¶é—´-â°" class="headerlink" title="12.9 ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡çš„commitæ—¶é—´ â°"></a>12.9 ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡çš„commitæ—¶é—´ â°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹æäº¤æ—¶é—´</span></span><br><span class="line">git commit --amend --<span class="built_in">date</span>=<span class="string">&quot;2025-01-02 12:00:00&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹ä½œè€…æ—¶é—´</span></span><br><span class="line">git commit --amend --<span class="built_in">date</span>=<span class="string">&quot;2025-01-02 12:00:00&quot;</span> --no-edit</span><br></pre></td></tr></table></figure><h3 id="12-10-å°†å…¶ä»–åˆ†æ”¯å®Œå…¨è¦†ç›–åˆ°å½“å‰åˆ†æ”¯-ğŸ”„"><a href="#12-10-å°†å…¶ä»–åˆ†æ”¯å®Œå…¨è¦†ç›–åˆ°å½“å‰åˆ†æ”¯-ğŸ”„" class="headerlink" title="12.10 å°†å…¶ä»–åˆ†æ”¯å®Œå…¨è¦†ç›–åˆ°å½“å‰åˆ†æ”¯ ğŸ”„"></a>12.10 å°†å…¶ä»–åˆ†æ”¯å®Œå…¨è¦†ç›–åˆ°å½“å‰åˆ†æ”¯ ğŸ”„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡ç½®åˆ°æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line">git reset --hard å…¶ä»–åˆ†æ”¯å</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶æ¨é€ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</span></span><br><span class="line">git push --force origin å½“å‰åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h3 id="13-1-IDEA-Gitå‡ºç°Line-Separators-Warning-âš ï¸"><a href="#13-1-IDEA-Gitå‡ºç°Line-Separators-Warning-âš ï¸" class="headerlink" title="13.1 IDEA Gitå‡ºç°Line Separators Warning âš ï¸"></a>13.1 IDEA Gitå‡ºç°Line Separators Warning âš ï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³æ¢è¡Œç¬¦è­¦å‘Š</span></span><br><span class="line">git config --global core.autocrlf <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="13-2-LF-will-be-replaced-by-CRLF-ğŸ”„"><a href="#13-2-LF-will-be-replaced-by-CRLF-ğŸ”„" class="headerlink" title="13.2 LF will be replaced by CRLF ğŸ”„"></a>13.2 LF will be replaced by CRLF ğŸ”„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windowsç³»ç»Ÿæ¢è¡Œç¬¦é—®é¢˜</span></span><br><span class="line">git config --global core.autocrlf <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="13-3-git-reset-â€“hard-HEAD-åæ˜¾ç¤º-more-ğŸ¤”"><a href="#13-3-git-reset-â€“hard-HEAD-åæ˜¾ç¤º-more-ğŸ¤”" class="headerlink" title="13.3 git reset â€“hard HEAD^ åæ˜¾ç¤º more? ğŸ¤”"></a>13.3 git reset â€“hard HEAD^ åæ˜¾ç¤º more? ğŸ¤”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Windows CMDä¸­ï¼Œ^ æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨å¼•å·</span></span><br><span class="line">git reset --hard <span class="string">&quot;HEAD^&quot;</span></span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨</span></span><br><span class="line">git reset --hard HEAD~1</span><br></pre></td></tr></table></figure><h3 id="13-4-git-pull-æç¤º-warning-ignoring-broken-ref-refs-remotes-origin-HEAD-âš ï¸"><a href="#13-4-git-pull-æç¤º-warning-ignoring-broken-ref-refs-remotes-origin-HEAD-âš ï¸" class="headerlink" title="13.4 git pull æç¤º warning: ignoring broken ref refs&#x2F;remotes&#x2F;origin&#x2F;HEAD âš ï¸"></a>13.4 git pull æç¤º warning: ignoring broken ref refs&#x2F;remotes&#x2F;origin&#x2F;HEAD âš ï¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®å¤æŸåçš„è¿œç¨‹HEADå¼•ç”¨</span></span><br><span class="line">git remote set-head origin main</span><br></pre></td></tr></table></figure><h3 id="13-5-unable-to-get-local-issuer-certificate-ğŸ”"><a href="#13-5-unable-to-get-local-issuer-certificate-ğŸ”" class="headerlink" title="13.5 unable to get local issuer certificate ğŸ”"></a>13.5 unable to get local issuer certificate ğŸ”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³SSLè¯ä¹¦é—®é¢˜</span></span><br><span class="line">git config --global http.sslVerify <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="13-6-git-status-ä¸­æ–‡æ–‡ä»¶åä¹±ç -ğŸ”¤"><a href="#13-6-git-status-ä¸­æ–‡æ–‡ä»¶åä¹±ç -ğŸ”¤" class="headerlink" title="13.6 git status ä¸­æ–‡æ–‡ä»¶åä¹±ç  ğŸ”¤"></a>13.6 git status ä¸­æ–‡æ–‡ä»¶åä¹±ç  ğŸ”¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³ä¸­æ–‡æ–‡ä»¶åæ˜¾ç¤ºé—®é¢˜</span></span><br><span class="line">git config --global core.quotepath <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="13-7-å³é”®èœå•æ²¡æœ‰-Git-Bash-here-ğŸ“"><a href="#13-7-å³é”®èœå•æ²¡æœ‰-Git-Bash-here-ğŸ“" class="headerlink" title="13.7 å³é”®èœå•æ²¡æœ‰ Git Bash here ğŸ“"></a>13.7 å³é”®èœå•æ²¡æœ‰ Git Bash here ğŸ“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡æ–°å®‰è£…Gitæ—¶é€‰æ‹©&quot;Git Bash Here&quot;é€‰é¡¹</span></span><br><span class="line"><span class="comment"># æˆ–æ‰‹åŠ¨æ·»åŠ åˆ°æ³¨å†Œè¡¨</span></span><br></pre></td></tr></table></figure><h3 id="13-8-fatal-detected-dubious-ownership-in-repository-ğŸš«"><a href="#13-8-fatal-detected-dubious-ownership-in-repository-ğŸš«" class="headerlink" title="13.8 fatal: detected dubious ownership in repository ğŸš«"></a>13.8 fatal: detected dubious ownership in repository ğŸš«</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³ä»“åº“æ‰€æœ‰æƒé—®é¢˜</span></span><br><span class="line">git config --global --add safe.directory /path/to/your/repo</span><br></pre></td></tr></table></figure><h3 id="13-9-èƒ½è®¿é—®GitHubä½†ä¸èƒ½è¿›è¡ŒGitç›¸å…³æ“ä½œ-ğŸŒ"><a href="#13-9-èƒ½è®¿é—®GitHubä½†ä¸èƒ½è¿›è¡ŒGitç›¸å…³æ“ä½œ-ğŸŒ" class="headerlink" title="13.9 èƒ½è®¿é—®GitHubä½†ä¸èƒ½è¿›è¡ŒGitç›¸å…³æ“ä½œ ğŸŒ"></a>13.9 èƒ½è®¿é—®GitHubä½†ä¸èƒ½è¿›è¡ŒGitç›¸å…³æ“ä½œ ğŸŒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥ç½‘ç»œä»£ç†è®¾ç½®</span></span><br><span class="line">git config --global http.proxy http://proxy:port</span><br><span class="line">git config --global https.proxy https://proxy:port</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…é™¤ä»£ç†è®¾ç½®</span></span><br><span class="line">git config --global --<span class="built_in">unset</span> http.proxy</span><br><span class="line">git config --global --<span class="built_in">unset</span> https.proxy</span><br></pre></td></tr></table></figure><h3 id="13-10-æŸ¥çœ‹Gitè¿œç¨‹ä»“åº“ä¿¡æ¯å®Œæ•´æŒ‡å—-ğŸ”"><a href="#13-10-æŸ¥çœ‹Gitè¿œç¨‹ä»“åº“ä¿¡æ¯å®Œæ•´æŒ‡å—-ğŸ”" class="headerlink" title="13.10 æŸ¥çœ‹Gitè¿œç¨‹ä»“åº“ä¿¡æ¯å®Œæ•´æŒ‡å— ğŸ”"></a>13.10 æŸ¥çœ‹Gitè¿œç¨‹ä»“åº“ä¿¡æ¯å®Œæ•´æŒ‡å— ğŸ”</h3><h4 id="13-10-1-åŸºæœ¬æŸ¥çœ‹å‘½ä»¤-ğŸ“‹"><a href="#13-10-1-åŸºæœ¬æŸ¥çœ‹å‘½ä»¤-ğŸ“‹" class="headerlink" title="13.10.1 åŸºæœ¬æŸ¥çœ‹å‘½ä»¤ ğŸ“‹"></a>13.10.1 åŸºæœ¬æŸ¥çœ‹å‘½ä»¤ ğŸ“‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“ï¼ˆç®€æ´ç‰ˆï¼‰</span></span><br><span class="line">git remote</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“ï¼ˆè¯¦ç»†ç‰ˆï¼‰</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰¹å®šè¿œç¨‹ä»“åº“çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">git remote show origin</span><br></pre></td></tr></table></figure><h4 id="13-10-2-git-remote-å‘½ä»¤è¯¦è§£-ğŸ”"><a href="#13-10-2-git-remote-å‘½ä»¤è¯¦è§£-ğŸ”" class="headerlink" title="13.10.2 git remote å‘½ä»¤è¯¦è§£ ğŸ”"></a>13.10.2 git remote å‘½ä»¤è¯¦è§£ ğŸ”</h4><h5 id="git-remoteï¼ˆç®€æ´ç‰ˆï¼‰"><a href="#git-remoteï¼ˆç®€æ´ç‰ˆï¼‰" class="headerlink" title="git remoteï¼ˆç®€æ´ç‰ˆï¼‰"></a><strong>git remoteï¼ˆç®€æ´ç‰ˆï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git remote</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># origin</span></span><br><span class="line"><span class="comment"># upstream</span></span><br></pre></td></tr></table></figure><h5 id="git-remote-vï¼ˆè¯¦ç»†ç‰ˆï¼‰"><a href="#git-remote-vï¼ˆè¯¦ç»†ç‰ˆï¼‰" class="headerlink" title="git remote -vï¼ˆè¯¦ç»†ç‰ˆï¼‰"></a><strong>git remote -vï¼ˆè¯¦ç»†ç‰ˆï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git remote -v</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># origin    https://github.com/ç”¨æˆ·å/ä»“åº“å.git (fetch)</span></span><br><span class="line"><span class="comment"># origin    https://github.com/ç”¨æˆ·å/ä»“åº“å.git (push)</span></span><br><span class="line"><span class="comment"># upstream  https://github.com/åŸä½œè€…/ä»“åº“å.git (fetch)</span></span><br><span class="line"><span class="comment"># upstream  https://github.com/åŸä½œè€…/ä»“åº“å.git (push)</span></span><br></pre></td></tr></table></figure><h5 id="git-remote-showï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰"><a href="#git-remote-showï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰" class="headerlink" title="git remote showï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰"></a><strong>git remote showï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">git remote show origin</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># * remote origin</span></span><br><span class="line"><span class="comment">#   Fetch URL: https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span></span><br><span class="line"><span class="comment">#   Push  URL: https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span></span><br><span class="line"><span class="comment">#   HEAD branch: main</span></span><br><span class="line"><span class="comment">#   Remote branches:</span></span><br><span class="line"><span class="comment">#     main tracked</span></span><br><span class="line"><span class="comment">#     dev  tracked</span></span><br><span class="line"><span class="comment">#   Local branch configured for &#x27;git pull&#x27;:</span></span><br><span class="line"><span class="comment">#     main merges with remote main</span></span><br><span class="line"><span class="comment">#   Local ref configured for &#x27;git push&#x27;:</span></span><br><span class="line"><span class="comment">#     main pushes to main (up to date)</span></span><br></pre></td></tr></table></figure><h4 id="13-10-3-è¿œç¨‹ä»“åº“ä¿¡æ¯è§£è¯»-ğŸ“–"><a href="#13-10-3-è¿œç¨‹ä»“åº“ä¿¡æ¯è§£è¯»-ğŸ“–" class="headerlink" title="13.10.3 è¿œç¨‹ä»“åº“ä¿¡æ¯è§£è¯» ğŸ“–"></a>13.10.3 è¿œç¨‹ä»“åº“ä¿¡æ¯è§£è¯» ğŸ“–</h4><h5 id="è¿œç¨‹ä»“åº“åç§°"><a href="#è¿œç¨‹ä»“åº“åç§°" class="headerlink" title="è¿œç¨‹ä»“åº“åç§°"></a><strong>è¿œç¨‹ä»“åº“åç§°</strong></h5><ul><li><strong>origin</strong>ï¼šé»˜è®¤çš„è¿œç¨‹ä»“åº“åç§°</li><li><strong>upstream</strong>ï¼šä¸Šæ¸¸ä»“åº“ï¼ˆé€šå¸¸ç”¨äºForké¡¹ç›®ï¼‰</li><li><strong>å…¶ä»–åç§°</strong>ï¼šè‡ªå®šä¹‰çš„è¿œç¨‹ä»“åº“åç§°</li></ul><h5 id="URLç±»å‹"><a href="#URLç±»å‹" class="headerlink" title="URLç±»å‹"></a><strong>URLç±»å‹</strong></h5><ul><li><strong>HTTPS</strong>ï¼š<code>https://github.com/ç”¨æˆ·å/ä»“åº“å.git</code></li><li><strong>SSH</strong>ï¼š<code>git@github.com:ç”¨æˆ·å/ä»“åº“å.git</code></li></ul><h5 id="æ“ä½œç±»å‹"><a href="#æ“ä½œç±»å‹" class="headerlink" title="æ“ä½œç±»å‹"></a><strong>æ“ä½œç±»å‹</strong></h5><ul><li><strong>fetch</strong>ï¼šæ‹‰å–æ“ä½œå¯¹åº”çš„URL</li><li><strong>push</strong>ï¼šæ¨é€æ“ä½œå¯¹åº”çš„URL</li></ul><h4 id="13-10-4-æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³»-ğŸŒ¿"><a href="#13-10-4-æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³»-ğŸŒ¿" class="headerlink" title="13.10.4 æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³» ğŸŒ¿"></a>13.10.4 æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³» ğŸŒ¿</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„è·Ÿè¸ªå…³ç³»</span></span><br><span class="line">git branch -vv</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="comment"># * main    a1b2c3d [origin/main] æœ€æ–°æäº¤ä¿¡æ¯</span></span><br><span class="line"><span class="comment">#   dev     e4f5g6h [origin/dev] å¼€å‘åˆ†æ”¯</span></span><br><span class="line"><span class="comment">#   feature f7g8h9i åŠŸèƒ½åˆ†æ”¯ï¼ˆæ— è·Ÿè¸ªå…³ç³»ï¼‰</span></span><br></pre></td></tr></table></figure><h4 id="13-10-5-æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ä¿¡æ¯-ğŸ“¡"><a href="#13-10-5-æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ä¿¡æ¯-ğŸ“¡" class="headerlink" title="13.10.5 æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ä¿¡æ¯ ğŸ“¡"></a>13.10.5 æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ä¿¡æ¯ ğŸ“¡</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch -r</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># origin/main</span></span><br><span class="line"><span class="comment"># origin/dev</span></span><br><span class="line"><span class="comment"># origin/feature</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆæœ¬åœ°+è¿œç¨‹ï¼‰</span></span><br><span class="line">git branch -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># * main</span></span><br><span class="line"><span class="comment">#   dev</span></span><br><span class="line"><span class="comment">#   feature</span></span><br><span class="line"><span class="comment">#   remotes/origin/main</span></span><br><span class="line"><span class="comment">#   remotes/origin/dev</span></span><br><span class="line"><span class="comment">#   remotes/origin/feature</span></span><br></pre></td></tr></table></figure><h4 id="13-10-6-æŸ¥çœ‹è¿œç¨‹ä»“åº“çŠ¶æ€-ğŸ“Š"><a href="#13-10-6-æŸ¥çœ‹è¿œç¨‹ä»“åº“çŠ¶æ€-ğŸ“Š" class="headerlink" title="13.10.6 æŸ¥çœ‹è¿œç¨‹ä»“åº“çŠ¶æ€ ğŸ“Š"></a>13.10.6 æŸ¥çœ‹è¿œç¨‹ä»“åº“çŠ¶æ€ ğŸ“Š</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">git remote show origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºåŒ…å«ï¼š</span></span><br><span class="line"><span class="comment"># - è¿œç¨‹ä»“åº“URL</span></span><br><span class="line"><span class="comment"># - HEADåˆ†æ”¯</span></span><br><span class="line"><span class="comment"># - è¿œç¨‹åˆ†æ”¯åˆ—è¡¨</span></span><br><span class="line"><span class="comment"># - æœ¬åœ°åˆ†æ”¯é…ç½®</span></span><br><span class="line"><span class="comment"># - æ¨é€/æ‹‰å–é…ç½®</span></span><br></pre></td></tr></table></figure><h4 id="13-10-7-å®é™…ä½¿ç”¨åœºæ™¯-ğŸ¯"><a href="#13-10-7-å®é™…ä½¿ç”¨åœºæ™¯-ğŸ¯" class="headerlink" title="13.10.7 å®é™…ä½¿ç”¨åœºæ™¯ ğŸ¯"></a>13.10.7 å®é™…ä½¿ç”¨åœºæ™¯ ğŸ¯</h4><h5 id="åœºæ™¯1ï¼šæ£€æŸ¥ä»“åº“é…ç½®"><a href="#åœºæ™¯1ï¼šæ£€æŸ¥ä»“åº“é…ç½®" class="headerlink" title="åœºæ™¯1ï¼šæ£€æŸ¥ä»“åº“é…ç½®"></a><strong>åœºæ™¯1ï¼šæ£€æŸ¥ä»“åº“é…ç½®</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> ä½ çš„é¡¹ç›®</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥åˆ†æ”¯è·Ÿè¸ªå…³ç³»</span></span><br><span class="line">git branch -vv</span><br></pre></td></tr></table></figure><h5 id="åœºæ™¯2ï¼šForké¡¹ç›®åä½œ"><a href="#åœºæ™¯2ï¼šForké¡¹ç›®åä½œ" class="headerlink" title="åœºæ™¯2ï¼šForké¡¹ç›®åä½œ"></a><strong>åœºæ™¯2ï¼šForké¡¹ç›®åä½œ</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹Forké¡¹ç›®çš„è¿œç¨‹é…ç½®</span></span><br><span class="line">git remote -v</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># origin    https://github.com/ä½ çš„ç”¨æˆ·å/ä»“åº“å.git (fetch)</span></span><br><span class="line"><span class="comment"># origin    https://github.com/ä½ çš„ç”¨æˆ·å/ä»“åº“å.git (push)</span></span><br><span class="line"><span class="comment"># upstream  https://github.com/åŸä½œè€…/ä»“åº“å.git (fetch)</span></span><br><span class="line"><span class="comment"># upstream  https://github.com/åŸä½œè€…/ä»“åº“å.git (push)</span></span><br></pre></td></tr></table></figure><h5 id="åœºæ™¯3ï¼šå¤šè¿œç¨‹ä»“åº“ç®¡ç†"><a href="#åœºæ™¯3ï¼šå¤šè¿œç¨‹ä»“åº“ç®¡ç†" class="headerlink" title="åœºæ™¯3ï¼šå¤šè¿œç¨‹ä»“åº“ç®¡ç†"></a><strong>åœºæ™¯3ï¼šå¤šè¿œç¨‹ä»“åº“ç®¡ç†</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰¹å®šè¿œç¨‹ä»“åº“è¯¦æƒ…</span></span><br><span class="line">git remote show upstream</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³»</span></span><br><span class="line">git branch -vv</span><br></pre></td></tr></table></figure><h4 id="13-10-8-å¸¸è§é—®é¢˜è§£å†³-ğŸ”§"><a href="#13-10-8-å¸¸è§é—®é¢˜è§£å†³-ğŸ”§" class="headerlink" title="13.10.8 å¸¸è§é—®é¢˜è§£å†³ ğŸ”§"></a>13.10.8 å¸¸è§é—®é¢˜è§£å†³ ğŸ”§</h4><h5 id="é—®é¢˜1ï¼šæ²¡æœ‰è¿œç¨‹ä»“åº“"><a href="#é—®é¢˜1ï¼šæ²¡æœ‰è¿œç¨‹ä»“åº“" class="headerlink" title="é—®é¢˜1ï¼šæ²¡æœ‰è¿œç¨‹ä»“åº“"></a><strong>é—®é¢˜1ï¼šæ²¡æœ‰è¿œç¨‹ä»“åº“</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæ˜¾ç¤ºæ²¡æœ‰è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote -v</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼šç©ºï¼ˆæ²¡æœ‰è¿œç¨‹ä»“åº“ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote add origin https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h5 id="é—®é¢˜2ï¼šè¿œç¨‹ä»“åº“åœ°å€é”™è¯¯"><a href="#é—®é¢˜2ï¼šè¿œç¨‹ä»“åº“åœ°å€é”™è¯¯" class="headerlink" title="é—®é¢˜2ï¼šè¿œç¨‹ä»“åº“åœ°å€é”™è¯¯"></a><strong>é—®é¢˜2ï¼šè¿œç¨‹ä»“åº“åœ°å€é”™è¯¯</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰åœ°å€</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class="line">git remote set-url origin æ–°çš„ä»“åº“åœ°å€</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯ä¿®æ”¹</span></span><br><span class="line">git remote -v</span><br></pre></td></tr></table></figure><h5 id="é—®é¢˜3ï¼šåˆ†æ”¯è·Ÿè¸ªå…³ç³»ä¸¢å¤±"><a href="#é—®é¢˜3ï¼šåˆ†æ”¯è·Ÿè¸ªå…³ç³»ä¸¢å¤±" class="headerlink" title="é—®é¢˜3ï¼šåˆ†æ”¯è·Ÿè¸ªå…³ç³»ä¸¢å¤±"></a><strong>é—®é¢˜3ï¼šåˆ†æ”¯è·Ÿè¸ªå…³ç³»ä¸¢å¤±</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯çŠ¶æ€</span></span><br><span class="line">git branch -vv</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°è®¾ç½®è·Ÿè¸ªå…³ç³»</span></span><br><span class="line">git branch --set-upstream-to=origin/main main</span><br></pre></td></tr></table></figure><h4 id="13-10-9-é«˜çº§ç”¨æ³•-ğŸš€"><a href="#13-10-9-é«˜çº§ç”¨æ³•-ğŸš€" class="headerlink" title="13.10.9 é«˜çº§ç”¨æ³• ğŸš€"></a>13.10.9 é«˜çº§ç”¨æ³• ğŸš€</h4><h5 id="æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„å®Œæ•´ä¿¡æ¯"><a href="#æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„å®Œæ•´ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„å®Œæ•´ä¿¡æ¯"></a><strong>æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„å®Œæ•´ä¿¡æ¯</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–è¿œç¨‹ä»“åº“çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">git remote show origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ…å«å†…å®¹ï¼š</span></span><br><span class="line"><span class="comment"># - è¿œç¨‹ä»“åº“URL</span></span><br><span class="line"><span class="comment"># - HEADåˆ†æ”¯</span></span><br><span class="line"><span class="comment"># - è¿œç¨‹åˆ†æ”¯åˆ—è¡¨</span></span><br><span class="line"><span class="comment"># - æœ¬åœ°åˆ†æ”¯é…ç½®</span></span><br><span class="line"><span class="comment"># - æ¨é€/æ‹‰å–é…ç½®</span></span><br><span class="line"><span class="comment"># - è¿‡æ—¶çš„åˆ†æ”¯ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><h5 id="æ£€æŸ¥è¿œç¨‹ä»“åº“è¿æ¥"><a href="#æ£€æŸ¥è¿œç¨‹ä»“åº“è¿æ¥" class="headerlink" title="æ£€æŸ¥è¿œç¨‹ä»“åº“è¿æ¥"></a><strong>æ£€æŸ¥è¿œç¨‹ä»“åº“è¿æ¥</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æµ‹è¯•è¿œç¨‹ä»“åº“è¿æ¥</span></span><br><span class="line">git ls-remote origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># a1b2c3d4e5f6... refs/heads/main</span></span><br><span class="line"><span class="comment"># e7f8g9h0i1j2... refs/heads/dev</span></span><br><span class="line"><span class="comment"># k3l4m5n6o7p8... refs/tags/v1.0.0</span></span><br></pre></td></tr></table></figure><h5 id="æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„æ ‡ç­¾"><a href="#æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„æ ‡ç­¾" class="headerlink" title="æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„æ ‡ç­¾"></a><strong>æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„æ ‡ç­¾</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹æ ‡ç­¾</span></span><br><span class="line">git ls-remote --tags origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># a1b2c3d4e5f6... refs/tags/v1.0.0</span></span><br><span class="line"><span class="comment"># e7f8g9h0i1j2... refs/tags/v1.1.0</span></span><br></pre></td></tr></table></figure><h4 id="13-10-10-æœ€ä½³å®è·µå»ºè®®-ğŸ’¡"><a href="#13-10-10-æœ€ä½³å®è·µå»ºè®®-ğŸ’¡" class="headerlink" title="13.10.10 æœ€ä½³å®è·µå»ºè®® ğŸ’¡"></a>13.10.10 æœ€ä½³å®è·µå»ºè®® ğŸ’¡</h4><h5 id="1-å®šæœŸæ£€æŸ¥è¿œç¨‹ä»“åº“çŠ¶æ€"><a href="#1-å®šæœŸæ£€æŸ¥è¿œç¨‹ä»“åº“çŠ¶æ€" class="headerlink" title="1. å®šæœŸæ£€æŸ¥è¿œç¨‹ä»“åº“çŠ¶æ€"></a><strong>1. å®šæœŸæ£€æŸ¥è¿œç¨‹ä»“åº“çŠ¶æ€</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šæœŸæ‰§è¡Œ</span></span><br><span class="line">git remote -v</span><br><span class="line">git branch -vv</span><br><span class="line">git status</span><br></pre></td></tr></table></figure><h5 id="2-ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰"><a href="#2-ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰" class="headerlink" title="2. ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰"></a><strong>2. ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦ä½¿ç”¨SSH</span></span><br><span class="line">git remote -v</span><br><span class="line"><span class="comment"># åº”è¯¥æ˜¾ç¤ºï¼šgit@github.com:ç”¨æˆ·å/ä»“åº“å.git</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸æ˜¯SSHï¼Œå¯ä»¥ä¿®æ”¹</span></span><br><span class="line">git remote set-url origin git@github.com:ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h5 id="3-éªŒè¯è¿œç¨‹ä»“åº“æƒé™"><a href="#3-éªŒè¯è¿œç¨‹ä»“åº“æƒé™" class="headerlink" title="3. éªŒè¯è¿œç¨‹ä»“åº“æƒé™"></a><strong>3. éªŒè¯è¿œç¨‹ä»“åº“æƒé™</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æµ‹è¯•æ¨é€æƒé™</span></span><br><span class="line">git push origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•æ‹‰å–æƒé™</span></span><br><span class="line">git pull origin main</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>å°è´´å£«</strong>: å®šæœŸæ£€æŸ¥è¿œç¨‹ä»“åº“ä¿¡æ¯æ˜¯Gitåä½œå¼€å‘çš„é‡è¦ä¹ æƒ¯ï¼Œç¡®ä¿ä½ çš„æœ¬åœ°ä»“åº“ä¸è¿œç¨‹ä»“åº“ä¿æŒæ­£ç¡®çš„è¿æ¥å…³ç³»ï¼</p></blockquote><h3 id="13-11-æ–°å»ºGitHubä»“åº“æœ¬åœ°æ¨é€å®Œæ•´æŒ‡å—-ğŸš€"><a href="#13-11-æ–°å»ºGitHubä»“åº“æœ¬åœ°æ¨é€å®Œæ•´æŒ‡å—-ğŸš€" class="headerlink" title="13.11 æ–°å»ºGitHubä»“åº“æœ¬åœ°æ¨é€å®Œæ•´æŒ‡å— ğŸš€"></a>13.11 æ–°å»ºGitHubä»“åº“æœ¬åœ°æ¨é€å®Œæ•´æŒ‡å— ğŸš€</h3><h4 id="13-10-1-åœ¨GitHubä¸Šåˆ›å»ºæ–°ä»“åº“-ğŸŒ"><a href="#13-10-1-åœ¨GitHubä¸Šåˆ›å»ºæ–°ä»“åº“-ğŸŒ" class="headerlink" title="13.10.1 åœ¨GitHubä¸Šåˆ›å»ºæ–°ä»“åº“ ğŸŒ"></a>13.10.1 åœ¨GitHubä¸Šåˆ›å»ºæ–°ä»“åº“ ğŸŒ</h4><ol><li><strong>ç™»å½•GitHub</strong>ï¼šè®¿é—® <a href="https://github.com/">https://github.com</a></li><li><strong>ç‚¹å‡»â€New repositoryâ€</strong>ï¼šå³ä¸Šè§’çš„â€+â€æŒ‰é’® â†’ â€œNew repositoryâ€</li><li><strong>å¡«å†™ä»“åº“ä¿¡æ¯</strong>ï¼š<ul><li>Repository name: <code>test_create_repo</code>ï¼ˆä½ çš„ä»“åº“åï¼‰</li><li>Description: <code>æµ‹è¯•ä»“åº“</code>ï¼ˆå¯é€‰ï¼‰</li><li>Public&#x2F;Private: é€‰æ‹©å¯è§æ€§</li><li><strong>ä¸è¦å‹¾é€‰</strong> â€œAdd a README fileâ€</li><li><strong>ä¸è¦å‹¾é€‰</strong> â€œAdd .gitignoreâ€</li><li><strong>ä¸è¦å‹¾é€‰</strong> â€œChoose a licenseâ€</li></ul></li><li><strong>ç‚¹å‡»â€Create repositoryâ€</strong></li></ol><h4 id="13-10-2-æœ¬åœ°æ“ä½œå®Œæ•´æµç¨‹-ğŸ’»"><a href="#13-10-2-æœ¬åœ°æ“ä½œå®Œæ•´æµç¨‹-ğŸ’»" class="headerlink" title="13.10.2 æœ¬åœ°æ“ä½œå®Œæ•´æµç¨‹ ğŸ’»"></a>13.10.2 æœ¬åœ°æ“ä½œå®Œæ•´æµç¨‹ ğŸ’»</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. è¿›å…¥ä½ çš„é¡¹ç›®ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/å½’æ¡£ææ–™/test_create_repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆå§‹åŒ–Gitä»“åº“ï¼ˆå¦‚æœè¿˜æ²¡åšï¼‰</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…ä»“åº“åœ°å€ï¼‰</span></span><br><span class="line">git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/test_create_repo.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. åˆ›å»ºç¬¬ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;# æµ‹è¯•ä»“åº“&quot;</span> &gt; README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git add README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. æäº¤åˆ°æœ¬åœ°ä»“åº“</span></span><br><span class="line">git commit -m <span class="string">&quot;Initial commit: æ·»åŠ READMEæ–‡ä»¶&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. æ¨é€åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><h4 id="13-10-3-git-pushå‘½ä»¤è¯¦è§£-ğŸ”"><a href="#13-10-3-git-pushå‘½ä»¤è¯¦è§£-ğŸ”" class="headerlink" title="13.10.3 git pushå‘½ä»¤è¯¦è§£ ğŸ”"></a>13.10.3 git pushå‘½ä»¤è¯¦è§£ ğŸ”</h4><h5 id="å‘½ä»¤ç»“æ„"><a href="#å‘½ä»¤ç»“æ„" class="headerlink" title="å‘½ä»¤ç»“æ„"></a><strong>å‘½ä»¤ç»“æ„</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br><span class="line"><span class="comment">#     â†‘    â†‘      â†‘</span></span><br><span class="line"><span class="comment">#     â”‚    â”‚      â””â”€â”€ æœ¬åœ°åˆ†æ”¯å</span></span><br><span class="line"><span class="comment">#     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿œç¨‹ä»“åº“å</span></span><br><span class="line"><span class="comment">#     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><h5 id="åˆ†æ”¯å…³ç³»è¯´æ˜"><a href="#åˆ†æ”¯å…³ç³»è¯´æ˜" class="headerlink" title="åˆ†æ”¯å…³ç³»è¯´æ˜"></a><strong>åˆ†æ”¯å…³ç³»è¯´æ˜</strong></h5><ul><li><strong>æœ¬åœ°åˆ†æ”¯</strong>ï¼š<code>master</code>ï¼ˆå‘½ä»¤æœ€åçš„å‚æ•°ï¼‰</li><li><strong>è¿œç¨‹åˆ†æ”¯</strong>ï¼š<code>origin/master</code>ï¼ˆè¿œç¨‹ä»“åº“å + â€œ&#x2F;â€œ + åˆ†æ”¯åï¼‰</li></ul><h5 id="åˆ†æ”¯å…³ç³»å›¾"><a href="#åˆ†æ”¯å…³ç³»å›¾" class="headerlink" title="åˆ†æ”¯å…³ç³»å›¾"></a><strong>åˆ†æ”¯å…³ç³»å›¾</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°ä»“åº“                   è¿œç¨‹ä»“åº“(origin)</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   master    â”‚ â”€â”€â”€â”€â”€â”€â†’   â”‚   master    â”‚</span><br><span class="line">â”‚  (æœ¬åœ°åˆ†æ”¯)  â”‚           â”‚ (è¿œç¨‹åˆ†æ”¯)   â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><h4 id="13-10-4-æ¨é€è¿‡ç¨‹è¯¦è§£-ğŸ”„"><a href="#13-10-4-æ¨é€è¿‡ç¨‹è¯¦è§£-ğŸ”„" class="headerlink" title="13.10.4 æ¨é€è¿‡ç¨‹è¯¦è§£ ğŸ”„"></a>13.10.4 æ¨é€è¿‡ç¨‹è¯¦è§£ ğŸ”„</h4><p><strong>æ¨é€å‰çŠ¶æ€</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°ä»“åº“: master (æœ‰æ–°çš„æäº¤)</span><br><span class="line">è¿œç¨‹ä»“åº“: origin/master (æ²¡æœ‰æ–°æäº¤)</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p><strong>æ¨é€åçŠ¶æ€</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°ä»“åº“: master (ä¸è¿œç¨‹åŒæ­¥)</span><br><span class="line">è¿œç¨‹ä»“åº“: origin/master (æœ‰äº†æ–°æäº¤)</span><br></pre></td></tr></table></figure><h4 id="13-10-5-ä¸åŒåˆ†æ”¯åæ¨é€ç¤ºä¾‹-ğŸ› ï¸"><a href="#13-10-5-ä¸åŒåˆ†æ”¯åæ¨é€ç¤ºä¾‹-ğŸ› ï¸" class="headerlink" title="13.10.5 ä¸åŒåˆ†æ”¯åæ¨é€ç¤ºä¾‹ ğŸ› ï¸"></a>13.10.5 ä¸åŒåˆ†æ”¯åæ¨é€ç¤ºä¾‹ ğŸ› ï¸</h4><h5 id="æ¨é€åˆ°ä¸åŒåˆ†æ”¯å"><a href="#æ¨é€åˆ°ä¸åŒåˆ†æ”¯å" class="headerlink" title="æ¨é€åˆ°ä¸åŒåˆ†æ”¯å"></a><strong>æ¨é€åˆ°ä¸åŒåˆ†æ”¯å</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ¬åœ°masteræ¨é€åˆ°è¿œç¨‹mainåˆ†æ”¯</span></span><br><span class="line">git push -u origin master:main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ¬åœ°featureæ¨é€åˆ°è¿œç¨‹developåˆ†æ”¯</span></span><br><span class="line">git push -u origin feature:develop</span><br></pre></td></tr></table></figure><h5 id="æœ¬åœ°åˆ†æ”¯4055æ¨é€åˆ°è¿œç¨‹4056"><a href="#æœ¬åœ°åˆ†æ”¯4055æ¨é€åˆ°è¿œç¨‹4056" class="headerlink" title="æœ¬åœ°åˆ†æ”¯4055æ¨é€åˆ°è¿œç¨‹4056"></a><strong>æœ¬åœ°åˆ†æ”¯4055æ¨é€åˆ°è¿œç¨‹4056</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin 4055:4056</span><br><span class="line"><span class="comment">#     â†‘    â†‘      â†‘    â†‘</span></span><br><span class="line"><span class="comment">#     â”‚    â”‚      â”‚    â””â”€â”€ è¿œç¨‹åˆ†æ”¯å</span></span><br><span class="line"><span class="comment">#     â”‚    â”‚      â””â”€â”€â”€â”€â”€â”€â”€ æœ¬åœ°åˆ†æ”¯å</span></span><br><span class="line"><span class="comment">#     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿œç¨‹ä»“åº“å</span></span><br><span class="line"><span class="comment">#     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><p><strong>åˆ†æ”¯å…³ç³»å›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°ä»“åº“                   è¿œç¨‹ä»“åº“(origin)</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚     4055    â”‚ â”€â”€â”€â”€â”€â”€â†’   â”‚     4056    â”‚</span><br><span class="line">â”‚  (æœ¬åœ°åˆ†æ”¯)  â”‚           â”‚ (è¿œç¨‹åˆ†æ”¯)   â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><h4 id="13-10-6-uå‚æ•°è¯¦è§£-âš™ï¸"><a href="#13-10-6-uå‚æ•°è¯¦è§£-âš™ï¸" class="headerlink" title="13.10.6 -uå‚æ•°è¯¦è§£ âš™ï¸"></a>13.10.6 -uå‚æ•°è¯¦è§£ âš™ï¸</h4><h5 id="uå‚æ•°çš„ä½œç”¨"><a href="#uå‚æ•°çš„ä½œç”¨" class="headerlink" title="-uå‚æ•°çš„ä½œç”¨"></a><strong>-uå‚æ•°çš„ä½œç”¨</strong></h5><ul><li><strong>å…¨ç§°</strong>ï¼š<code>--set-upstream</code></li><li><strong>ä½œç”¨</strong>ï¼šè®¾ç½®ä¸Šæ¸¸åˆ†æ”¯ï¼ˆupstream branchï¼‰</li><li><strong>æ•ˆæœ</strong>ï¼šå»ºç«‹æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„è·Ÿè¸ªå…³ç³»</li></ul><h5 id="ä½¿ç”¨-uçš„å¥½å¤„"><a href="#ä½¿ç”¨-uçš„å¥½å¤„" class="headerlink" title="ä½¿ç”¨-uçš„å¥½å¤„"></a><strong>ä½¿ç”¨-uçš„å¥½å¤„</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®äº†ä¸Šæ¸¸åˆ†æ”¯åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨</span></span><br><span class="line">git push                    <span class="comment"># ç­‰åŒäº git push origin master</span></span><br><span class="line">git pull                    <span class="comment"># ç­‰åŒäº git pull origin master</span></span><br><span class="line">git status                  <span class="comment"># ä¼šæ˜¾ç¤ºä¸è¿œç¨‹åˆ†æ”¯çš„å…³ç³»</span></span><br></pre></td></tr></table></figure><h5 id="å¯¹æ¯”ï¼šæœ‰-uå’Œæ²¡æœ‰-u"><a href="#å¯¹æ¯”ï¼šæœ‰-uå’Œæ²¡æœ‰-u" class="headerlink" title="å¯¹æ¯”ï¼šæœ‰-uå’Œæ²¡æœ‰-u"></a><strong>å¯¹æ¯”ï¼šæœ‰-uå’Œæ²¡æœ‰-u</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨-uå‚æ•°</span></span><br><span class="line">git push -u origin master</span><br><span class="line"><span class="comment"># ç»“æœï¼šæœ¬åœ°masteråˆ†æ”¯è·Ÿè¸ªè¿œç¨‹origin/masteråˆ†æ”¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ä½¿ç”¨-uå‚æ•°</span></span><br><span class="line">git push origin master</span><br><span class="line"><span class="comment"># ç»“æœï¼šæ²¡æœ‰å»ºç«‹è·Ÿè¸ªå…³ç³»</span></span><br></pre></td></tr></table></figure><h4 id="13-10-7-å¸¸è§é—®é¢˜è§£å†³-ğŸ”§"><a href="#13-10-7-å¸¸è§é—®é¢˜è§£å†³-ğŸ”§" class="headerlink" title="13.10.7 å¸¸è§é—®é¢˜è§£å†³ ğŸ”§"></a>13.10.7 å¸¸è§é—®é¢˜è§£å†³ ğŸ”§</h4><h5 id="é—®é¢˜1ï¼šåˆ†æ”¯åç§°ä¸åŒ¹é…"><a href="#é—®é¢˜1ï¼šåˆ†æ”¯åç§°ä¸åŒ¹é…" class="headerlink" title="é—®é¢˜1ï¼šåˆ†æ”¯åç§°ä¸åŒ¹é…"></a><strong>é—®é¢˜1ï¼šåˆ†æ”¯åç§°ä¸åŒ¹é…</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœGitHubé»˜è®¤åˆ†æ”¯æ˜¯mainï¼Œè€Œæœ¬åœ°æ˜¯master</span></span><br><span class="line">git branch -M main</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><h5 id="é—®é¢˜2ï¼šæƒé™é—®é¢˜"><a href="#é—®é¢˜2ï¼šæƒé™é—®é¢˜" class="headerlink" title="é—®é¢˜2ï¼šæƒé™é—®é¢˜"></a><strong>é—®é¢˜2ï¼šæƒé™é—®é¢˜</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨Personal Access Token</span></span><br><span class="line">git remote set-url origin https://ä½ çš„ç”¨æˆ·å:ä½ çš„Token@github.com/ä½ çš„ç”¨æˆ·å/test_create_repo.git</span><br></pre></td></tr></table></figure><h5 id="é—®é¢˜3ï¼šSSHå¯†é’¥é—®é¢˜"><a href="#é—®é¢˜3ï¼šSSHå¯†é’¥é—®é¢˜" class="headerlink" title="é—®é¢˜3ï¼šSSHå¯†é’¥é—®é¢˜"></a><strong>é—®é¢˜3ï¼šSSHå¯†é’¥é—®é¢˜</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨SSHåœ°å€</span></span><br><span class="line">git remote set-url origin git@github.com:ä½ çš„ç”¨æˆ·å/test_create_repo.git</span><br></pre></td></tr></table></figure><h4 id="13-10-8-éªŒè¯æ¨é€ç»“æœ-âœ…"><a href="#13-10-8-éªŒè¯æ¨é€ç»“æœ-âœ…" class="headerlink" title="13.10.8 éªŒè¯æ¨é€ç»“æœ âœ…"></a>13.10.8 éªŒè¯æ¨é€ç»“æœ âœ…</h4><h5 id="æ£€æŸ¥æœ¬åœ°çŠ¶æ€"><a href="#æ£€æŸ¥æœ¬åœ°çŠ¶æ€" class="headerlink" title="æ£€æŸ¥æœ¬åœ°çŠ¶æ€"></a><strong>æ£€æŸ¥æœ¬åœ°çŠ¶æ€</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰çŠ¶æ€</span></span><br><span class="line">git status</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤å†å²</span></span><br><span class="line">git <span class="built_in">log</span> --oneline</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯è·Ÿè¸ªå…³ç³»</span></span><br><span class="line">git branch -vv</span><br></pre></td></tr></table></figure><h5 id="æ£€æŸ¥è¿œç¨‹ä»“åº“"><a href="#æ£€æŸ¥è¿œç¨‹ä»“åº“" class="headerlink" title="æ£€æŸ¥è¿œç¨‹ä»“åº“"></a><strong>æ£€æŸ¥è¿œç¨‹ä»“åº“</strong></h5><ul><li>è®¿é—®ä½ çš„GitHubä»“åº“é¡µé¢</li><li>ç¡®è®¤README.mdæ–‡ä»¶å·²ä¸Šä¼ </li><li>ç¡®è®¤æäº¤å†å²æ˜¾ç¤ºæ­£ç¡®</li></ul><h4 id="13-10-9-æœ€ä½³å®è·µå»ºè®®-ğŸ’¡"><a href="#13-10-9-æœ€ä½³å®è·µå»ºè®®-ğŸ’¡" class="headerlink" title="13.10.9 æœ€ä½³å®è·µå»ºè®® ğŸ’¡"></a>13.10.9 æœ€ä½³å®è·µå»ºè®® ğŸ’¡</h4><h5 id="1-ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰"><a href="#1-ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰" class="headerlink" title="1. ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰"></a><strong>1. ä½¿ç”¨SSHå¯†é’¥ï¼ˆæ¨èï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”ŸæˆSSHå¯†é’¥</span></span><br><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;ä½ çš„é‚®ç®±@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åˆ°GitHub</span></span><br><span class="line"><span class="comment"># 1. å¤åˆ¶å…¬é’¥å†…å®¹</span></span><br><span class="line"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span><br><span class="line"><span class="comment"># 2. åœ¨GitHub Settings â†’ SSH and GPG keys ä¸­æ·»åŠ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨SSHåœ°å€</span></span><br><span class="line">git remote add origin git@github.com:ä½ çš„ç”¨æˆ·å/test_create_repo.git</span><br></pre></td></tr></table></figure><h5 id="2-ç»Ÿä¸€åˆ†æ”¯åç§°"><a href="#2-ç»Ÿä¸€åˆ†æ”¯åç§°" class="headerlink" title="2. ç»Ÿä¸€åˆ†æ”¯åç§°"></a><strong>2. ç»Ÿä¸€åˆ†æ”¯åç§°</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®é»˜è®¤åˆ†æ”¯ä¸ºmain</span></span><br><span class="line">git branch -M main</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><h5 id="3-æ·»åŠ -gitignoreæ–‡ä»¶"><a href="#3-æ·»åŠ -gitignoreæ–‡ä»¶" class="headerlink" title="3. æ·»åŠ .gitignoreæ–‡ä»¶"></a><strong>3. æ·»åŠ .gitignoreæ–‡ä»¶</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º.gitignoreæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;node_modules/&quot;</span> &gt; .gitignore</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;*.log&quot;</span> &gt;&gt; .gitignore</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å¹¶æäº¤</span></span><br><span class="line">git add .gitignore</span><br><span class="line">git commit -m <span class="string">&quot;feat: æ·»åŠ .gitignoreæ–‡ä»¶&quot;</span></span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>å°è´´å£«</strong>: æ–°å»ºGitHubä»“åº“çš„æ¨é€æ“ä½œæ˜¯Gitåä½œå¼€å‘çš„åŸºç¡€ï¼Œç†è§£æ¯ä¸ªå‚æ•°çš„ä½œç”¨å’Œåˆ†æ”¯å…³ç³»å¯¹äºæŒæ¡Gitéå¸¸é‡è¦ï¼</p></blockquote><h2 id="14-å…¶ä»–è¡¥å……ä¿¡æ¯-ğŸ“š"><a href="#14-å…¶ä»–è¡¥å……ä¿¡æ¯-ğŸ“š" class="headerlink" title="14. å…¶ä»–è¡¥å……ä¿¡æ¯ ğŸ“š"></a>14. å…¶ä»–è¡¥å……ä¿¡æ¯ ğŸ“š</h2><h3 id="14-1-Commit-Type-ç±»åˆ«-ğŸ“‹"><a href="#14-1-Commit-Type-ç±»åˆ«-ğŸ“‹" class="headerlink" title="14.1 Commit Type ç±»åˆ« ğŸ“‹"></a>14.1 Commit Type ç±»åˆ« ğŸ“‹</h3><table><thead><tr><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>feat</code></td><td>æ–°åŠŸèƒ½</td><td><code>feat: æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½</code></td></tr><tr><td><code>fix</code></td><td>ä¿®å¤bug</td><td><code>fix: ä¿®å¤ç™»å½•éªŒè¯bug</code></td></tr><tr><td><code>docs</code></td><td>æ–‡æ¡£æ›´æ–°</td><td><code>docs: æ›´æ–°APIæ–‡æ¡£</code></td></tr><tr><td><code>style</code></td><td>ä»£ç æ ¼å¼è°ƒæ•´</td><td><code>style: è°ƒæ•´ä»£ç ç¼©è¿›</code></td></tr><tr><td><code>refactor</code></td><td>ä»£ç é‡æ„</td><td><code>refactor: é‡æ„ç”¨æˆ·æ¨¡å—</code></td></tr><tr><td><code>test</code></td><td>æµ‹è¯•ç›¸å…³</td><td><code>test: æ·»åŠ å•å…ƒæµ‹è¯•</code></td></tr><tr><td><code>chore</code></td><td>æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨</td><td><code>chore: æ›´æ–°ä¾èµ–ç‰ˆæœ¬</code></td></tr></tbody></table><h3 id="14-2-ç®¡ç†å¤šä¸ªç”¨æˆ·ä¿¡æ¯-ğŸ‘¥"><a href="#14-2-ç®¡ç†å¤šä¸ªç”¨æˆ·ä¿¡æ¯-ğŸ‘¥" class="headerlink" title="14.2 ç®¡ç†å¤šä¸ªç”¨æˆ·ä¿¡æ¯ ğŸ‘¥"></a>14.2 ç®¡ç†å¤šä¸ªç”¨æˆ·ä¿¡æ¯ ğŸ‘¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…¨å±€é…ç½®</span></span><br><span class="line">git config --global user.name <span class="string">&quot;å…¨å±€ç”¨æˆ·å&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;å…¨å±€é‚®ç®±@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¡¹ç›®çº§é…ç½®</span></span><br><span class="line">git config user.name <span class="string">&quot;é¡¹ç›®ç”¨æˆ·å&quot;</span></span><br><span class="line">git config user.email <span class="string">&quot;é¡¹ç›®é‚®ç®±@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é…ç½®</span></span><br><span class="line">git config --list</span><br><span class="line">git config user.name</span><br><span class="line">git config user.email</span><br></pre></td></tr></table></figure><h2 id="15-å¯èƒ½æœ‰ç”¨çš„å°å·¥å…·-ğŸ› ï¸"><a href="#15-å¯èƒ½æœ‰ç”¨çš„å°å·¥å…·-ğŸ› ï¸" class="headerlink" title="15. å¯èƒ½æœ‰ç”¨çš„å°å·¥å…· ğŸ› ï¸"></a>15. å¯èƒ½æœ‰ç”¨çš„å°å·¥å…· ğŸ› ï¸</h2><h3 id="15-1-push-sh-æ™ºèƒ½æ¨é€è„šæœ¬-ğŸ¤–"><a href="#15-1-push-sh-æ™ºèƒ½æ¨é€è„šæœ¬-ğŸ¤–" class="headerlink" title="15.1 push.sh - æ™ºèƒ½æ¨é€è„šæœ¬ ğŸ¤–"></a>15.1 push.sh - æ™ºèƒ½æ¨é€è„šæœ¬ ğŸ¤–</h3><blockquote><p>æ ¹æ®<a href="https://mofan212.github.io/posts/Git/">Mofançš„Gitç†è®ºä¸ä½¿ç”¨</a>æ–‡ç« æ•´ç†</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># è‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š</span></span><br><span class="line"><span class="comment"># 1. æ£€æŸ¥å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="comment"># 2. æ‹‰å–æœ€æ–°ä»£ç </span></span><br><span class="line"><span class="comment"># 3. åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯</span></span><br><span class="line"><span class="comment"># 4. æ¨é€åˆ°è¿œç«¯</span></span><br><span class="line"><span class="comment"># 5. æ£€å‡ºåˆ°åŸåˆ†æ”¯</span></span><br><span class="line"><span class="comment"># 6. cherry-pickåˆ°åŸåˆ†æ”¯å¹¶æ¨é€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è„šæœ¬åœ°å€ï¼šmy-tools/git/push.sh</span></span><br></pre></td></tr></table></figure><h3 id="15-2-pull-sh-æ‰¹é‡æ‹‰å–è„šæœ¬-ğŸ“¥"><a href="#15-2-pull-sh-æ‰¹é‡æ‹‰å–è„šæœ¬-ğŸ“¥" class="headerlink" title="15.2 pull.sh - æ‰¹é‡æ‹‰å–è„šæœ¬ ğŸ“¥"></a>15.2 pull.sh - æ‰¹é‡æ‹‰å–è„šæœ¬ ğŸ“¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># é€šè¿‡é¡¹ç›®åç§°åœ¨GitHubã€Giteeä¸Šæ‹‰å–ä»£ç </span></span><br><span class="line"><span class="comment"># é€‚ç”¨åœºæ™¯ï¼šçŸ¥é“é¡¹ç›®åä½†ä¸çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è„šæœ¬åœ°å€ï¼šmy-tools/git/pull.sh</span></span><br></pre></td></tr></table></figure><h3 id="15-3-å¸¸ç”¨åˆ«åé…ç½®-âš¡"><a href="#15-3-å¸¸ç”¨åˆ«åé…ç½®-âš¡" class="headerlink" title="15.3 å¸¸ç”¨åˆ«åé…ç½® âš¡"></a>15.3 å¸¸ç”¨åˆ«åé…ç½® âš¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å¸¸ç”¨Gitåˆ«å</span></span><br><span class="line">git config --global alias.st status</span><br><span class="line">git config --global alias.co checkout</span><br><span class="line">git config --global alias.br branch</span><br><span class="line">git config --global alias.ci commit</span><br><span class="line">git config --global alias.unstage <span class="string">&#x27;reset HEAD --&#x27;</span></span><br><span class="line">git config --global alias.last <span class="string">&#x27;log -1 HEAD&#x27;</span></span><br><span class="line">git config --global alias.visual <span class="string">&#x27;!gitk&#x27;</span></span><br><span class="line">git config --global alias.lg <span class="string">&quot;log --color --graph --pretty=format:&#x27;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#x27; --abbrev-commit&quot;</span></span><br></pre></td></tr></table></figure><h2 id="ğŸ”—-å‚è€ƒèµ„æº"><a href="#ğŸ”—-å‚è€ƒèµ„æº" class="headerlink" title="ğŸ”— å‚è€ƒèµ„æº"></a>ğŸ”— å‚è€ƒèµ„æº</h2><ul><li><a href="https://liaoxuefeng.com/books/git/introduction/index.html">å»–é›ªå³°Gitæ•™ç¨‹</a> - ä¸­æ–‡Gitæ•™ç¨‹ç»å…¸ ğŸ“š</li><li><a href="https://mofan212.github.io/posts/Git/">Mofançš„Gitç†è®ºä¸ä½¿ç”¨</a> - è¯¦ç»†çš„Gitç†è®ºè®²è§£ ğŸ¯</li><li><a href="https://git-scm.com/book">Pro Git Book</a> - Gitå®˜æ–¹æ–‡æ¡£ ğŸ“–</li><li><a href="https://docs.github.com/">GitHubå®˜æ–¹æ–‡æ¡£</a> - GitHubä½¿ç”¨æŒ‡å— ğŸŒ</li></ul><h2 id="ğŸ“-æ€»ç»“"><a href="#ğŸ“-æ€»ç»“" class="headerlink" title="ğŸ“ æ€»ç»“"></a>ğŸ“ æ€»ç»“</h2><p>Gitä½œä¸ºç°ä»£è½¯ä»¶å¼€å‘çš„æ ¸å¿ƒå·¥å…·ï¼ŒæŒæ¡å…¶åŸºæœ¬æ“ä½œå’Œæœ€ä½³å®è·µå¯¹äºå¼€å‘è€…æ¥è¯´è‡³å…³é‡è¦ã€‚æœ¬æ–‡æ¶µç›–äº†ä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´Gitæ“ä½œæŒ‡å—ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ åœ¨æ—¥å¸¸å¼€å‘ä¸­æ›´å¥½åœ°ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶å’Œå›¢é˜Ÿåä½œã€‚</p><p>è®°ä½ï¼ŒGitæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†æ›´é‡è¦çš„æ˜¯ç†è§£å…¶èƒŒåçš„è®¾è®¡ç†å¿µå’Œå·¥ä½œåŸç†ã€‚é€šè¿‡ä¸æ–­çš„å®è·µå’Œå­¦ä¹ ï¼Œä½ å°†èƒ½å¤Ÿç†Ÿç»ƒè¿ç”¨Gitçš„å„ç§åŠŸèƒ½ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><hr><p><strong>æœ€åæ›´æ–°</strong>: 2025-01-02<br><strong>ä½œè€…</strong>: suoChina<br><strong>æ ‡ç­¾</strong>: Git, ç‰ˆæœ¬æ§åˆ¶, å¼€å‘å·¥å…·, åä½œå¼€å‘</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> ç‰ˆæœ¬æ§åˆ¶ </tag>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
            <tag> åä½œå¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
